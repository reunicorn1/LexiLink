function nle(e,i){for(var a=0;a<i.length;a++){const l=i[a];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in e)){const p=Object.getOwnPropertyDescriptor(l,u);p&&Object.defineProperty(e,u,p.get?p:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const p of u)if(p.type==="childList")for(const m of p.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&l(m)}).observe(document,{childList:!0,subtree:!0});function a(u){const p={};return u.integrity&&(p.integrity=u.integrity),u.referrerPolicy&&(p.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?p.credentials="include":u.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function l(u){if(u.ep)return;u.ep=!0;const p=a(u);fetch(u.href,p)}})();var rn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Uh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Mz={exports:{}},Ab={},Uz={exports:{}},fn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv=Symbol.for("react.element"),rle=Symbol.for("react.portal"),ile=Symbol.for("react.fragment"),ole=Symbol.for("react.strict_mode"),sle=Symbol.for("react.profiler"),ale=Symbol.for("react.provider"),cle=Symbol.for("react.context"),lle=Symbol.for("react.forward_ref"),dle=Symbol.for("react.suspense"),ule=Symbol.for("react.memo"),hle=Symbol.for("react.lazy"),Q4=Symbol.iterator;function ple(e){return e===null||typeof e!="object"?null:(e=Q4&&e[Q4]||e["@@iterator"],typeof e=="function"?e:null)}var jz={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Fz=Object.assign,Vz={};function Am(e,i,a){this.props=e,this.context=i,this.refs=Vz,this.updater=a||jz}Am.prototype.isReactComponent={};Am.prototype.setState=function(e,i){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,i,"setState")};Am.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Bz(){}Bz.prototype=Am.prototype;function pk(e,i,a){this.props=e,this.context=i,this.refs=Vz,this.updater=a||jz}var fk=pk.prototype=new Bz;fk.constructor=pk;Fz(fk,Am.prototype);fk.isPureReactComponent=!0;var Z4=Array.isArray,Wz=Object.prototype.hasOwnProperty,mk={current:null},zz={key:!0,ref:!0,__self:!0,__source:!0};function Gz(e,i,a){var l,u={},p=null,m=null;if(i!=null)for(l in i.ref!==void 0&&(m=i.ref),i.key!==void 0&&(p=""+i.key),i)Wz.call(i,l)&&!zz.hasOwnProperty(l)&&(u[l]=i[l]);var v=arguments.length-2;if(v===1)u.children=a;else if(1<v){for(var y=Array(v),S=0;S<v;S++)y[S]=arguments[S+2];u.children=y}if(e&&e.defaultProps)for(l in v=e.defaultProps,v)u[l]===void 0&&(u[l]=v[l]);return{$$typeof:Xv,type:e,key:p,ref:m,props:u,_owner:mk.current}}function fle(e,i){return{$$typeof:Xv,type:e.type,key:i,ref:e.ref,props:e.props,_owner:e._owner}}function gk(e){return typeof e=="object"&&e!==null&&e.$$typeof===Xv}function mle(e){var i={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return i[a]})}var e5=/\/+/g;function M1(e,i){return typeof e=="object"&&e!==null&&e.key!=null?mle(""+e.key):i.toString(36)}function YS(e,i,a,l,u){var p=typeof e;(p==="undefined"||p==="boolean")&&(e=null);var m=!1;if(e===null)m=!0;else switch(p){case"string":case"number":m=!0;break;case"object":switch(e.$$typeof){case Xv:case rle:m=!0}}if(m)return m=e,u=u(m),e=l===""?"."+M1(m,0):l,Z4(u)?(a="",e!=null&&(a=e.replace(e5,"$&/")+"/"),YS(u,i,a,"",function(S){return S})):u!=null&&(gk(u)&&(u=fle(u,a+(!u.key||m&&m.key===u.key?"":(""+u.key).replace(e5,"$&/")+"/")+e)),i.push(u)),1;if(m=0,l=l===""?".":l+":",Z4(e))for(var v=0;v<e.length;v++){p=e[v];var y=l+M1(p,v);m+=YS(p,i,a,y,u)}else if(y=ple(e),typeof y=="function")for(e=y.call(e),v=0;!(p=e.next()).done;)p=p.value,y=l+M1(p,v++),m+=YS(p,i,a,y,u);else if(p==="object")throw i=String(e),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return m}function dS(e,i,a){if(e==null)return e;var l=[],u=0;return YS(e,l,"","",function(p){return i.call(a,p,u++)}),l}function gle(e){if(e._status===-1){var i=e._result;i=i(),i.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=i)}if(e._status===1)return e._result.default;throw e._result}var Do={current:null},qS={transition:null},_le={ReactCurrentDispatcher:Do,ReactCurrentBatchConfig:qS,ReactCurrentOwner:mk};fn.Children={map:dS,forEach:function(e,i,a){dS(e,function(){i.apply(this,arguments)},a)},count:function(e){var i=0;return dS(e,function(){i++}),i},toArray:function(e){return dS(e,function(i){return i})||[]},only:function(e){if(!gk(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};fn.Component=Am;fn.Fragment=ile;fn.Profiler=sle;fn.PureComponent=pk;fn.StrictMode=ole;fn.Suspense=dle;fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_le;fn.cloneElement=function(e,i,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=Fz({},e.props),u=e.key,p=e.ref,m=e._owner;if(i!=null){if(i.ref!==void 0&&(p=i.ref,m=mk.current),i.key!==void 0&&(u=""+i.key),e.type&&e.type.defaultProps)var v=e.type.defaultProps;for(y in i)Wz.call(i,y)&&!zz.hasOwnProperty(y)&&(l[y]=i[y]===void 0&&v!==void 0?v[y]:i[y])}var y=arguments.length-2;if(y===1)l.children=a;else if(1<y){v=Array(y);for(var S=0;S<y;S++)v[S]=arguments[S+2];l.children=v}return{$$typeof:Xv,type:e.type,key:u,ref:p,props:l,_owner:m}};fn.createContext=function(e){return e={$$typeof:cle,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ale,_context:e},e.Consumer=e};fn.createElement=Gz;fn.createFactory=function(e){var i=Gz.bind(null,e);return i.type=e,i};fn.createRef=function(){return{current:null}};fn.forwardRef=function(e){return{$$typeof:lle,render:e}};fn.isValidElement=gk;fn.lazy=function(e){return{$$typeof:hle,_payload:{_status:-1,_result:e},_init:gle}};fn.memo=function(e,i){return{$$typeof:ule,type:e,compare:i===void 0?null:i}};fn.startTransition=function(e){var i=qS.transition;qS.transition={};try{e()}finally{qS.transition=i}};fn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};fn.useCallback=function(e,i){return Do.current.useCallback(e,i)};fn.useContext=function(e){return Do.current.useContext(e)};fn.useDebugValue=function(){};fn.useDeferredValue=function(e){return Do.current.useDeferredValue(e)};fn.useEffect=function(e,i){return Do.current.useEffect(e,i)};fn.useId=function(){return Do.current.useId()};fn.useImperativeHandle=function(e,i,a){return Do.current.useImperativeHandle(e,i,a)};fn.useInsertionEffect=function(e,i){return Do.current.useInsertionEffect(e,i)};fn.useLayoutEffect=function(e,i){return Do.current.useLayoutEffect(e,i)};fn.useMemo=function(e,i){return Do.current.useMemo(e,i)};fn.useReducer=function(e,i,a){return Do.current.useReducer(e,i,a)};fn.useRef=function(e){return Do.current.useRef(e)};fn.useState=function(e){return Do.current.useState(e)};fn.useSyncExternalStore=function(e,i,a){return Do.current.useSyncExternalStore(e,i,a)};fn.useTransition=function(){return Do.current.useTransition()};fn.version="18.2.0";Uz.exports=fn;var F=Uz.exports;const ns=Uh(F),fN=nle({__proto__:null,default:ns},[F]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vle=F,Ele=Symbol.for("react.element"),yle=Symbol.for("react.fragment"),Sle=Object.prototype.hasOwnProperty,Tle=vle.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ble={key:!0,ref:!0,__self:!0,__source:!0};function Hz(e,i,a){var l,u={},p=null,m=null;a!==void 0&&(p=""+a),i.key!==void 0&&(p=""+i.key),i.ref!==void 0&&(m=i.ref);for(l in i)Sle.call(i,l)&&!ble.hasOwnProperty(l)&&(u[l]=i[l]);if(e&&e.defaultProps)for(l in i=e.defaultProps,i)u[l]===void 0&&(u[l]=i[l]);return{$$typeof:Ele,type:e,key:p,ref:m,props:u,_owner:Tle.current}}Ab.Fragment=yle;Ab.jsx=Hz;Ab.jsxs=Hz;Mz.exports=Ab;var b=Mz.exports,mN={},$z={exports:{}},Ms={},Kz={exports:{}},Yz={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function i(ue,be){var xe=ue.length;ue.push(be);e:for(;0<xe;){var He=xe-1>>>1,rt=ue[He];if(0<u(rt,be))ue[He]=be,ue[xe]=rt,xe=He;else break e}}function a(ue){return ue.length===0?null:ue[0]}function l(ue){if(ue.length===0)return null;var be=ue[0],xe=ue.pop();if(xe!==be){ue[0]=xe;e:for(var He=0,rt=ue.length,Ye=rt>>>1;He<Ye;){var Ge=2*(He+1)-1,_t=ue[Ge],kt=Ge+1,sn=ue[kt];if(0>u(_t,xe))kt<rt&&0>u(sn,_t)?(ue[He]=sn,ue[kt]=xe,He=kt):(ue[He]=_t,ue[Ge]=xe,He=Ge);else if(kt<rt&&0>u(sn,xe))ue[He]=sn,ue[kt]=xe,He=kt;else break e}}return be}function u(ue,be){var xe=ue.sortIndex-be.sortIndex;return xe!==0?xe:ue.id-be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var p=performance;e.unstable_now=function(){return p.now()}}else{var m=Date,v=m.now();e.unstable_now=function(){return m.now()-v}}var y=[],S=[],C=1,R=null,N=3,x=!1,U=!1,M=!1,z=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function H(ue){for(var be=a(S);be!==null;){if(be.callback===null)l(S);else if(be.startTime<=ue)l(S),be.sortIndex=be.expirationTime,i(y,be);else break;be=a(S)}}function q(ue){if(M=!1,H(ue),!U)if(a(y)!==null)U=!0,Te(ee);else{var be=a(S);be!==null&&de(q,be.startTime-ue)}}function ee(ue,be){U=!1,M&&(M=!1,V(re),re=-1),x=!0;var xe=N;try{for(H(be),R=a(y);R!==null&&(!(R.expirationTime>be)||ue&&!Re());){var He=R.callback;if(typeof He=="function"){R.callback=null,N=R.priorityLevel;var rt=He(R.expirationTime<=be);be=e.unstable_now(),typeof rt=="function"?R.callback=rt:R===a(y)&&l(y),H(be)}else l(y);R=a(y)}if(R!==null)var Ye=!0;else{var Ge=a(S);Ge!==null&&de(q,Ge.startTime-be),Ye=!1}return Ye}finally{R=null,N=xe,x=!1}}var oe=!1,se=null,re=-1,me=5,pe=-1;function Re(){return!(e.unstable_now()-pe<me)}function Ze(){if(se!==null){var ue=e.unstable_now();pe=ue;var be=!0;try{be=se(!0,ue)}finally{be?Qe():(oe=!1,se=null)}}else oe=!1}var Qe;if(typeof W=="function")Qe=function(){W(Ze)};else if(typeof MessageChannel<"u"){var Oe=new MessageChannel,Ie=Oe.port2;Oe.port1.onmessage=Ze,Qe=function(){Ie.postMessage(null)}}else Qe=function(){z(Ze,0)};function Te(ue){se=ue,oe||(oe=!0,Qe())}function de(ue,be){re=z(function(){ue(e.unstable_now())},be)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ue){ue.callback=null},e.unstable_continueExecution=function(){U||x||(U=!0,Te(ee))},e.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):me=0<ue?Math.floor(1e3/ue):5},e.unstable_getCurrentPriorityLevel=function(){return N},e.unstable_getFirstCallbackNode=function(){return a(y)},e.unstable_next=function(ue){switch(N){case 1:case 2:case 3:var be=3;break;default:be=N}var xe=N;N=be;try{return ue()}finally{N=xe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ue,be){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var xe=N;N=ue;try{return be()}finally{N=xe}},e.unstable_scheduleCallback=function(ue,be,xe){var He=e.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?He+xe:He):xe=He,ue){case 1:var rt=-1;break;case 2:rt=250;break;case 5:rt=1073741823;break;case 4:rt=1e4;break;default:rt=5e3}return rt=xe+rt,ue={id:C++,callback:be,priorityLevel:ue,startTime:xe,expirationTime:rt,sortIndex:-1},xe>He?(ue.sortIndex=xe,i(S,ue),a(y)===null&&ue===a(S)&&(M?(V(re),re=-1):M=!0,de(q,xe-He))):(ue.sortIndex=rt,i(y,ue),U||x||(U=!0,Te(ee))),ue},e.unstable_shouldYield=Re,e.unstable_wrapCallback=function(ue){var be=N;return function(){var xe=N;N=be;try{return ue.apply(this,arguments)}finally{N=xe}}}})(Yz);Kz.exports=Yz;var Cle=Kz.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qz=F,Ds=Cle;function Ke(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jz=new Set,hv={};function jh(e,i){dm(e,i),dm(e+"Capture",i)}function dm(e,i){for(hv[e]=i,e=0;e<i.length;e++)Jz.add(i[e])}var Ol=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gN=Object.prototype.hasOwnProperty,wle=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,t5={},n5={};function Rle(e){return gN.call(n5,e)?!0:gN.call(t5,e)?!1:wle.test(e)?n5[e]=!0:(t5[e]=!0,!1)}function Ile(e,i,a,l){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return l?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ale(e,i,a,l){if(i===null||typeof i>"u"||Ile(e,i,a,l))return!0;if(l)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function xo(e,i,a,l,u,p,m){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=l,this.attributeNamespace=u,this.mustUseProperty=a,this.propertyName=e,this.type=i,this.sanitizeURL=p,this.removeEmptyString=m}var qi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){qi[e]=new xo(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var i=e[0];qi[i]=new xo(i,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){qi[e]=new xo(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){qi[e]=new xo(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){qi[e]=new xo(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){qi[e]=new xo(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){qi[e]=new xo(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){qi[e]=new xo(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){qi[e]=new xo(e,5,!1,e.toLowerCase(),null,!1,!1)});var _k=/[\-:]([a-z])/g;function vk(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var i=e.replace(_k,vk);qi[i]=new xo(i,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var i=e.replace(_k,vk);qi[i]=new xo(i,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var i=e.replace(_k,vk);qi[i]=new xo(i,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){qi[e]=new xo(e,1,!1,e.toLowerCase(),null,!1,!1)});qi.xlinkHref=new xo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){qi[e]=new xo(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ek(e,i,a,l){var u=qi.hasOwnProperty(i)?qi[i]:null;(u!==null?u.type!==0:l||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(Ale(i,a,u,l)&&(a=null),l||u===null?Rle(i)&&(a===null?e.removeAttribute(i):e.setAttribute(i,""+a)):u.mustUseProperty?e[u.propertyName]=a===null?u.type===3?!1:"":a:(i=u.attributeName,l=u.attributeNamespace,a===null?e.removeAttribute(i):(u=u.type,a=u===3||u===4&&a===!0?"":""+a,l?e.setAttributeNS(l,i,a):e.setAttribute(i,a))))}var Ll=qz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,uS=Symbol.for("react.element"),Ef=Symbol.for("react.portal"),yf=Symbol.for("react.fragment"),yk=Symbol.for("react.strict_mode"),_N=Symbol.for("react.profiler"),Xz=Symbol.for("react.provider"),Qz=Symbol.for("react.context"),Sk=Symbol.for("react.forward_ref"),vN=Symbol.for("react.suspense"),EN=Symbol.for("react.suspense_list"),Tk=Symbol.for("react.memo"),jd=Symbol.for("react.lazy"),Zz=Symbol.for("react.offscreen"),r5=Symbol.iterator;function m_(e){return e===null||typeof e!="object"?null:(e=r5&&e[r5]||e["@@iterator"],typeof e=="function"?e:null)}var Hr=Object.assign,U1;function k_(e){if(U1===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);U1=i&&i[1]||""}return`
`+U1+e}var j1=!1;function F1(e,i){if(!e||j1)return"";j1=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(S){var l=S}Reflect.construct(e,[],i)}else{try{i.call()}catch(S){l=S}e.call(i.prototype)}else{try{throw Error()}catch(S){l=S}e()}}catch(S){if(S&&l&&typeof S.stack=="string"){for(var u=S.stack.split(`
`),p=l.stack.split(`
`),m=u.length-1,v=p.length-1;1<=m&&0<=v&&u[m]!==p[v];)v--;for(;1<=m&&0<=v;m--,v--)if(u[m]!==p[v]){if(m!==1||v!==1)do if(m--,v--,0>v||u[m]!==p[v]){var y=`
`+u[m].replace(" at new "," at ");return e.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",e.displayName)),y}while(1<=m&&0<=v);break}}}finally{j1=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?k_(e):""}function Ole(e){switch(e.tag){case 5:return k_(e.type);case 16:return k_("Lazy");case 13:return k_("Suspense");case 19:return k_("SuspenseList");case 0:case 2:case 15:return e=F1(e.type,!1),e;case 11:return e=F1(e.type.render,!1),e;case 1:return e=F1(e.type,!0),e;default:return""}}function yN(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yf:return"Fragment";case Ef:return"Portal";case _N:return"Profiler";case yk:return"StrictMode";case vN:return"Suspense";case EN:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Qz:return(e.displayName||"Context")+".Consumer";case Xz:return(e._context.displayName||"Context")+".Provider";case Sk:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tk:return i=e.displayName||null,i!==null?i:yN(e.type)||"Memo";case jd:i=e._payload,e=e._init;try{return yN(e(i))}catch{}}return null}function Nle(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return yN(i);case 8:return i===yk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function ou(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function eG(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ple(e){var i=eG(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),l=""+e[i];if(!e.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var u=a.get,p=a.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return u.call(this)},set:function(m){l=""+m,p.call(this,m)}}),Object.defineProperty(e,i,{enumerable:a.enumerable}),{getValue:function(){return l},setValue:function(m){l=""+m},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function hS(e){e._valueTracker||(e._valueTracker=Ple(e))}function tG(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var a=i.getValue(),l="";return e&&(l=eG(e)?e.checked?"true":"false":e.value),e=l,e!==a?(i.setValue(e),!0):!1}function xT(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function SN(e,i){var a=i.checked;return Hr({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function i5(e,i){var a=i.defaultValue==null?"":i.defaultValue,l=i.checked!=null?i.checked:i.defaultChecked;a=ou(i.value!=null?i.value:a),e._wrapperState={initialChecked:l,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function nG(e,i){i=i.checked,i!=null&&Ek(e,"checked",i,!1)}function TN(e,i){nG(e,i);var a=ou(i.value),l=i.type;if(a!=null)l==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}i.hasOwnProperty("value")?bN(e,i.type,a):i.hasOwnProperty("defaultValue")&&bN(e,i.type,ou(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(e.defaultChecked=!!i.defaultChecked)}function o5(e,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var l=i.type;if(!(l!=="submit"&&l!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+e._wrapperState.initialValue,a||i===e.value||(e.value=i),e.defaultValue=i}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function bN(e,i,a){(i!=="number"||xT(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var D_=Array.isArray;function zf(e,i,a,l){if(e=e.options,i){i={};for(var u=0;u<a.length;u++)i["$"+a[u]]=!0;for(a=0;a<e.length;a++)u=i.hasOwnProperty("$"+e[a].value),e[a].selected!==u&&(e[a].selected=u),u&&l&&(e[a].defaultSelected=!0)}else{for(a=""+ou(a),i=null,u=0;u<e.length;u++){if(e[u].value===a){e[u].selected=!0,l&&(e[u].defaultSelected=!0);return}i!==null||e[u].disabled||(i=e[u])}i!==null&&(i.selected=!0)}}function CN(e,i){if(i.dangerouslySetInnerHTML!=null)throw Error(Ke(91));return Hr({},i,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function s5(e,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(Ke(92));if(D_(a)){if(1<a.length)throw Error(Ke(93));a=a[0]}i=a}i==null&&(i=""),a=i}e._wrapperState={initialValue:ou(a)}}function rG(e,i){var a=ou(i.value),l=ou(i.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),i.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),l!=null&&(e.defaultValue=""+l)}function a5(e){var i=e.textContent;i===e._wrapperState.initialValue&&i!==""&&i!==null&&(e.value=i)}function iG(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wN(e,i){return e==null||e==="http://www.w3.org/1999/xhtml"?iG(i):e==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var pS,oG=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,l,u){MSApp.execUnsafeLocalFunction(function(){return e(i,a,l,u)})}:e}(function(e,i){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=i;else{for(pS=pS||document.createElement("div"),pS.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=pS.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}});function pv(e,i){if(i){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=i;return}}e.textContent=i}var H_={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kle=["Webkit","ms","Moz","O"];Object.keys(H_).forEach(function(e){kle.forEach(function(i){i=i+e.charAt(0).toUpperCase()+e.substring(1),H_[i]=H_[e]})});function sG(e,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||H_.hasOwnProperty(e)&&H_[e]?(""+i).trim():i+"px"}function aG(e,i){e=e.style;for(var a in i)if(i.hasOwnProperty(a)){var l=a.indexOf("--")===0,u=sG(a,i[a],l);a==="float"&&(a="cssFloat"),l?e.setProperty(a,u):e[a]=u}}var Dle=Hr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function RN(e,i){if(i){if(Dle[e]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(Ke(137,e));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(Ke(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(Ke(61))}if(i.style!=null&&typeof i.style!="object")throw Error(Ke(62))}}function IN(e,i){if(e.indexOf("-")===-1)return typeof i.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var AN=null;function bk(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ON=null,Gf=null,Hf=null;function c5(e){if(e=eE(e)){if(typeof ON!="function")throw Error(Ke(280));var i=e.stateNode;i&&(i=Db(i),ON(e.stateNode,e.type,i))}}function cG(e){Gf?Hf?Hf.push(e):Hf=[e]:Gf=e}function lG(){if(Gf){var e=Gf,i=Hf;if(Hf=Gf=null,c5(e),i)for(e=0;e<i.length;e++)c5(i[e])}}function dG(e,i){return e(i)}function uG(){}var V1=!1;function hG(e,i,a){if(V1)return e(i,a);V1=!0;try{return dG(e,i,a)}finally{V1=!1,(Gf!==null||Hf!==null)&&(uG(),lG())}}function fv(e,i){var a=e.stateNode;if(a===null)return null;var l=Db(a);if(l===null)return null;a=l[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(Ke(231,i,typeof a));return a}var NN=!1;if(Ol)try{var g_={};Object.defineProperty(g_,"passive",{get:function(){NN=!0}}),window.addEventListener("test",g_,g_),window.removeEventListener("test",g_,g_)}catch{NN=!1}function xle(e,i,a,l,u,p,m,v,y){var S=Array.prototype.slice.call(arguments,3);try{i.apply(a,S)}catch(C){this.onError(C)}}var $_=!1,LT=null,MT=!1,PN=null,Lle={onError:function(e){$_=!0,LT=e}};function Mle(e,i,a,l,u,p,m,v,y){$_=!1,LT=null,xle.apply(Lle,arguments)}function Ule(e,i,a,l,u,p,m,v,y){if(Mle.apply(this,arguments),$_){if($_){var S=LT;$_=!1,LT=null}else throw Error(Ke(198));MT||(MT=!0,PN=S)}}function Fh(e){var i=e,a=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(a=i.return),e=i.return;while(e)}return i.tag===3?a:null}function pG(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function l5(e){if(Fh(e)!==e)throw Error(Ke(188))}function jle(e){var i=e.alternate;if(!i){if(i=Fh(e),i===null)throw Error(Ke(188));return i!==e?null:e}for(var a=e,l=i;;){var u=a.return;if(u===null)break;var p=u.alternate;if(p===null){if(l=u.return,l!==null){a=l;continue}break}if(u.child===p.child){for(p=u.child;p;){if(p===a)return l5(u),e;if(p===l)return l5(u),i;p=p.sibling}throw Error(Ke(188))}if(a.return!==l.return)a=u,l=p;else{for(var m=!1,v=u.child;v;){if(v===a){m=!0,a=u,l=p;break}if(v===l){m=!0,l=u,a=p;break}v=v.sibling}if(!m){for(v=p.child;v;){if(v===a){m=!0,a=p,l=u;break}if(v===l){m=!0,l=p,a=u;break}v=v.sibling}if(!m)throw Error(Ke(189))}}if(a.alternate!==l)throw Error(Ke(190))}if(a.tag!==3)throw Error(Ke(188));return a.stateNode.current===a?e:i}function fG(e){return e=jle(e),e!==null?mG(e):null}function mG(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=mG(e);if(i!==null)return i;e=e.sibling}return null}var gG=Ds.unstable_scheduleCallback,d5=Ds.unstable_cancelCallback,Fle=Ds.unstable_shouldYield,Vle=Ds.unstable_requestPaint,oi=Ds.unstable_now,Ble=Ds.unstable_getCurrentPriorityLevel,Ck=Ds.unstable_ImmediatePriority,_G=Ds.unstable_UserBlockingPriority,UT=Ds.unstable_NormalPriority,Wle=Ds.unstable_LowPriority,vG=Ds.unstable_IdlePriority,Ob=null,Ic=null;function zle(e){if(Ic&&typeof Ic.onCommitFiberRoot=="function")try{Ic.onCommitFiberRoot(Ob,e,void 0,(e.current.flags&128)===128)}catch{}}var Ga=Math.clz32?Math.clz32:$le,Gle=Math.log,Hle=Math.LN2;function $le(e){return e>>>=0,e===0?32:31-(Gle(e)/Hle|0)|0}var fS=64,mS=4194304;function x_(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function jT(e,i){var a=e.pendingLanes;if(a===0)return 0;var l=0,u=e.suspendedLanes,p=e.pingedLanes,m=a&268435455;if(m!==0){var v=m&~u;v!==0?l=x_(v):(p&=m,p!==0&&(l=x_(p)))}else m=a&~u,m!==0?l=x_(m):p!==0&&(l=x_(p));if(l===0)return 0;if(i!==0&&i!==l&&!(i&u)&&(u=l&-l,p=i&-i,u>=p||u===16&&(p&4194240)!==0))return i;if(l&4&&(l|=a&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=l;0<i;)a=31-Ga(i),u=1<<a,l|=e[a],i&=~u;return l}function Kle(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yle(e,i){for(var a=e.suspendedLanes,l=e.pingedLanes,u=e.expirationTimes,p=e.pendingLanes;0<p;){var m=31-Ga(p),v=1<<m,y=u[m];y===-1?(!(v&a)||v&l)&&(u[m]=Kle(v,i)):y<=i&&(e.expiredLanes|=v),p&=~v}}function kN(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function EG(){var e=fS;return fS<<=1,!(fS&4194240)&&(fS=64),e}function B1(e){for(var i=[],a=0;31>a;a++)i.push(e);return i}function Qv(e,i,a){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-Ga(i),e[i]=a}function qle(e,i){var a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<a;){var u=31-Ga(a),p=1<<u;i[u]=0,l[u]=-1,e[u]=-1,a&=~p}}function wk(e,i){var a=e.entangledLanes|=i;for(e=e.entanglements;a;){var l=31-Ga(a),u=1<<l;u&i|e[l]&i&&(e[l]|=i),a&=~u}}var Jn=0;function yG(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var SG,Rk,TG,bG,CG,DN=!1,gS=[],Kd=null,Yd=null,qd=null,mv=new Map,gv=new Map,Bd=[],Jle="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function u5(e,i){switch(e){case"focusin":case"focusout":Kd=null;break;case"dragenter":case"dragleave":Yd=null;break;case"mouseover":case"mouseout":qd=null;break;case"pointerover":case"pointerout":mv.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":gv.delete(i.pointerId)}}function __(e,i,a,l,u,p){return e===null||e.nativeEvent!==p?(e={blockedOn:i,domEventName:a,eventSystemFlags:l,nativeEvent:p,targetContainers:[u]},i!==null&&(i=eE(i),i!==null&&Rk(i)),e):(e.eventSystemFlags|=l,i=e.targetContainers,u!==null&&i.indexOf(u)===-1&&i.push(u),e)}function Xle(e,i,a,l,u){switch(i){case"focusin":return Kd=__(Kd,e,i,a,l,u),!0;case"dragenter":return Yd=__(Yd,e,i,a,l,u),!0;case"mouseover":return qd=__(qd,e,i,a,l,u),!0;case"pointerover":var p=u.pointerId;return mv.set(p,__(mv.get(p)||null,e,i,a,l,u)),!0;case"gotpointercapture":return p=u.pointerId,gv.set(p,__(gv.get(p)||null,e,i,a,l,u)),!0}return!1}function wG(e){var i=ch(e.target);if(i!==null){var a=Fh(i);if(a!==null){if(i=a.tag,i===13){if(i=pG(a),i!==null){e.blockedOn=i,CG(e.priority,function(){TG(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function JS(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var a=xN(e.domEventName,e.eventSystemFlags,i[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var l=new a.constructor(a.type,a);AN=l,a.target.dispatchEvent(l),AN=null}else return i=eE(a),i!==null&&Rk(i),e.blockedOn=a,!1;i.shift()}return!0}function h5(e,i,a){JS(e)&&a.delete(i)}function Qle(){DN=!1,Kd!==null&&JS(Kd)&&(Kd=null),Yd!==null&&JS(Yd)&&(Yd=null),qd!==null&&JS(qd)&&(qd=null),mv.forEach(h5),gv.forEach(h5)}function v_(e,i){e.blockedOn===i&&(e.blockedOn=null,DN||(DN=!0,Ds.unstable_scheduleCallback(Ds.unstable_NormalPriority,Qle)))}function _v(e){function i(u){return v_(u,e)}if(0<gS.length){v_(gS[0],e);for(var a=1;a<gS.length;a++){var l=gS[a];l.blockedOn===e&&(l.blockedOn=null)}}for(Kd!==null&&v_(Kd,e),Yd!==null&&v_(Yd,e),qd!==null&&v_(qd,e),mv.forEach(i),gv.forEach(i),a=0;a<Bd.length;a++)l=Bd[a],l.blockedOn===e&&(l.blockedOn=null);for(;0<Bd.length&&(a=Bd[0],a.blockedOn===null);)wG(a),a.blockedOn===null&&Bd.shift()}var $f=Ll.ReactCurrentBatchConfig,FT=!0;function Zle(e,i,a,l){var u=Jn,p=$f.transition;$f.transition=null;try{Jn=1,Ik(e,i,a,l)}finally{Jn=u,$f.transition=p}}function ede(e,i,a,l){var u=Jn,p=$f.transition;$f.transition=null;try{Jn=4,Ik(e,i,a,l)}finally{Jn=u,$f.transition=p}}function Ik(e,i,a,l){if(FT){var u=xN(e,i,a,l);if(u===null)X1(e,i,l,VT,a),u5(e,l);else if(Xle(u,e,i,a,l))l.stopPropagation();else if(u5(e,l),i&4&&-1<Jle.indexOf(e)){for(;u!==null;){var p=eE(u);if(p!==null&&SG(p),p=xN(e,i,a,l),p===null&&X1(e,i,l,VT,a),p===u)break;u=p}u!==null&&l.stopPropagation()}else X1(e,i,l,null,a)}}var VT=null;function xN(e,i,a,l){if(VT=null,e=bk(l),e=ch(e),e!==null)if(i=Fh(e),i===null)e=null;else if(a=i.tag,a===13){if(e=pG(i),e!==null)return e;e=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null);return VT=e,null}function RG(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ble()){case Ck:return 1;case _G:return 4;case UT:case Wle:return 16;case vG:return 536870912;default:return 16}default:return 16}}var Gd=null,Ak=null,XS=null;function IG(){if(XS)return XS;var e,i=Ak,a=i.length,l,u="value"in Gd?Gd.value:Gd.textContent,p=u.length;for(e=0;e<a&&i[e]===u[e];e++);var m=a-e;for(l=1;l<=m&&i[a-l]===u[p-l];l++);return XS=u.slice(e,1<l?1-l:void 0)}function QS(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function _S(){return!0}function p5(){return!1}function Us(e){function i(a,l,u,p,m){this._reactName=a,this._targetInst=u,this.type=l,this.nativeEvent=p,this.target=m,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(a=e[v],this[v]=a?a(p):p[v]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?_S:p5,this.isPropagationStopped=p5,this}return Hr(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=_S)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=_S)},persist:function(){},isPersistent:_S}),i}var Om={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ok=Us(Om),Zv=Hr({},Om,{view:0,detail:0}),tde=Us(Zv),W1,z1,E_,Nb=Hr({},Zv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nk,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==E_&&(E_&&e.type==="mousemove"?(W1=e.screenX-E_.screenX,z1=e.screenY-E_.screenY):z1=W1=0,E_=e),W1)},movementY:function(e){return"movementY"in e?e.movementY:z1}}),f5=Us(Nb),nde=Hr({},Nb,{dataTransfer:0}),rde=Us(nde),ide=Hr({},Zv,{relatedTarget:0}),G1=Us(ide),ode=Hr({},Om,{animationName:0,elapsedTime:0,pseudoElement:0}),sde=Us(ode),ade=Hr({},Om,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cde=Us(ade),lde=Hr({},Om,{data:0}),m5=Us(lde),dde={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ude={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hde={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pde(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=hde[e])?!!i[e]:!1}function Nk(){return pde}var fde=Hr({},Zv,{key:function(e){if(e.key){var i=dde[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=QS(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ude[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nk,charCode:function(e){return e.type==="keypress"?QS(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?QS(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),mde=Us(fde),gde=Hr({},Nb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),g5=Us(gde),_de=Hr({},Zv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nk}),vde=Us(_de),Ede=Hr({},Om,{propertyName:0,elapsedTime:0,pseudoElement:0}),yde=Us(Ede),Sde=Hr({},Nb,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Tde=Us(Sde),bde=[9,13,27,32],Pk=Ol&&"CompositionEvent"in window,K_=null;Ol&&"documentMode"in document&&(K_=document.documentMode);var Cde=Ol&&"TextEvent"in window&&!K_,AG=Ol&&(!Pk||K_&&8<K_&&11>=K_),_5=" ",v5=!1;function OG(e,i){switch(e){case"keyup":return bde.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function NG(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Sf=!1;function wde(e,i){switch(e){case"compositionend":return NG(i);case"keypress":return i.which!==32?null:(v5=!0,_5);case"textInput":return e=i.data,e===_5&&v5?null:e;default:return null}}function Rde(e,i){if(Sf)return e==="compositionend"||!Pk&&OG(e,i)?(e=IG(),XS=Ak=Gd=null,Sf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return AG&&i.locale!=="ko"?null:i.data;default:return null}}var Ide={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function E5(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!Ide[e.type]:i==="textarea"}function PG(e,i,a,l){cG(l),i=BT(i,"onChange"),0<i.length&&(a=new Ok("onChange","change",null,a,l),e.push({event:a,listeners:i}))}var Y_=null,vv=null;function Ade(e){WG(e,0)}function Pb(e){var i=Cf(e);if(tG(i))return e}function Ode(e,i){if(e==="change")return i}var kG=!1;if(Ol){var H1;if(Ol){var $1="oninput"in document;if(!$1){var y5=document.createElement("div");y5.setAttribute("oninput","return;"),$1=typeof y5.oninput=="function"}H1=$1}else H1=!1;kG=H1&&(!document.documentMode||9<document.documentMode)}function S5(){Y_&&(Y_.detachEvent("onpropertychange",DG),vv=Y_=null)}function DG(e){if(e.propertyName==="value"&&Pb(vv)){var i=[];PG(i,vv,e,bk(e)),hG(Ade,i)}}function Nde(e,i,a){e==="focusin"?(S5(),Y_=i,vv=a,Y_.attachEvent("onpropertychange",DG)):e==="focusout"&&S5()}function Pde(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Pb(vv)}function kde(e,i){if(e==="click")return Pb(i)}function Dde(e,i){if(e==="input"||e==="change")return Pb(i)}function xde(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var $a=typeof Object.is=="function"?Object.is:xde;function Ev(e,i){if($a(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var a=Object.keys(e),l=Object.keys(i);if(a.length!==l.length)return!1;for(l=0;l<a.length;l++){var u=a[l];if(!gN.call(i,u)||!$a(e[u],i[u]))return!1}return!0}function T5(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function b5(e,i){var a=T5(e);e=0;for(var l;a;){if(a.nodeType===3){if(l=e+a.textContent.length,e<=i&&l>=i)return{node:a,offset:i-e};e=l}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=T5(a)}}function xG(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?xG(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function LG(){for(var e=window,i=xT();i instanceof e.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)e=i.contentWindow;else break;i=xT(e.document)}return i}function kk(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}function Lde(e){var i=LG(),a=e.focusedElem,l=e.selectionRange;if(i!==a&&a&&a.ownerDocument&&xG(a.ownerDocument.documentElement,a)){if(l!==null&&kk(a)){if(i=l.start,e=l.end,e===void 0&&(e=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(e,a.value.length);else if(e=(i=a.ownerDocument||document)&&i.defaultView||window,e.getSelection){e=e.getSelection();var u=a.textContent.length,p=Math.min(l.start,u);l=l.end===void 0?p:Math.min(l.end,u),!e.extend&&p>l&&(u=l,l=p,p=u),u=b5(a,p);var m=b5(a,l);u&&m&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(i=i.createRange(),i.setStart(u.node,u.offset),e.removeAllRanges(),p>l?(e.addRange(i),e.extend(m.node,m.offset)):(i.setEnd(m.node,m.offset),e.addRange(i)))}}for(i=[],e=a;e=e.parentNode;)e.nodeType===1&&i.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)e=i[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Mde=Ol&&"documentMode"in document&&11>=document.documentMode,Tf=null,LN=null,q_=null,MN=!1;function C5(e,i,a){var l=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;MN||Tf==null||Tf!==xT(l)||(l=Tf,"selectionStart"in l&&kk(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),q_&&Ev(q_,l)||(q_=l,l=BT(LN,"onSelect"),0<l.length&&(i=new Ok("onSelect","select",null,i,a),e.push({event:i,listeners:l}),i.target=Tf)))}function vS(e,i){var a={};return a[e.toLowerCase()]=i.toLowerCase(),a["Webkit"+e]="webkit"+i,a["Moz"+e]="moz"+i,a}var bf={animationend:vS("Animation","AnimationEnd"),animationiteration:vS("Animation","AnimationIteration"),animationstart:vS("Animation","AnimationStart"),transitionend:vS("Transition","TransitionEnd")},K1={},MG={};Ol&&(MG=document.createElement("div").style,"AnimationEvent"in window||(delete bf.animationend.animation,delete bf.animationiteration.animation,delete bf.animationstart.animation),"TransitionEvent"in window||delete bf.transitionend.transition);function kb(e){if(K1[e])return K1[e];if(!bf[e])return e;var i=bf[e],a;for(a in i)if(i.hasOwnProperty(a)&&a in MG)return K1[e]=i[a];return e}var UG=kb("animationend"),jG=kb("animationiteration"),FG=kb("animationstart"),VG=kb("transitionend"),BG=new Map,w5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function uu(e,i){BG.set(e,i),jh(i,[e])}for(var Y1=0;Y1<w5.length;Y1++){var q1=w5[Y1],Ude=q1.toLowerCase(),jde=q1[0].toUpperCase()+q1.slice(1);uu(Ude,"on"+jde)}uu(UG,"onAnimationEnd");uu(jG,"onAnimationIteration");uu(FG,"onAnimationStart");uu("dblclick","onDoubleClick");uu("focusin","onFocus");uu("focusout","onBlur");uu(VG,"onTransitionEnd");dm("onMouseEnter",["mouseout","mouseover"]);dm("onMouseLeave",["mouseout","mouseover"]);dm("onPointerEnter",["pointerout","pointerover"]);dm("onPointerLeave",["pointerout","pointerover"]);jh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));jh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));jh("onBeforeInput",["compositionend","keypress","textInput","paste"]);jh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));jh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));jh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var L_="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fde=new Set("cancel close invalid load scroll toggle".split(" ").concat(L_));function R5(e,i,a){var l=e.type||"unknown-event";e.currentTarget=a,Ule(l,i,void 0,e),e.currentTarget=null}function WG(e,i){i=(i&4)!==0;for(var a=0;a<e.length;a++){var l=e[a],u=l.event;l=l.listeners;e:{var p=void 0;if(i)for(var m=l.length-1;0<=m;m--){var v=l[m],y=v.instance,S=v.currentTarget;if(v=v.listener,y!==p&&u.isPropagationStopped())break e;R5(u,v,S),p=y}else for(m=0;m<l.length;m++){if(v=l[m],y=v.instance,S=v.currentTarget,v=v.listener,y!==p&&u.isPropagationStopped())break e;R5(u,v,S),p=y}}}if(MT)throw e=PN,MT=!1,PN=null,e}function Rr(e,i){var a=i[BN];a===void 0&&(a=i[BN]=new Set);var l=e+"__bubble";a.has(l)||(zG(i,e,2,!1),a.add(l))}function J1(e,i,a){var l=0;i&&(l|=4),zG(a,e,l,i)}var ES="_reactListening"+Math.random().toString(36).slice(2);function yv(e){if(!e[ES]){e[ES]=!0,Jz.forEach(function(a){a!=="selectionchange"&&(Fde.has(a)||J1(a,!1,e),J1(a,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[ES]||(i[ES]=!0,J1("selectionchange",!1,i))}}function zG(e,i,a,l){switch(RG(i)){case 1:var u=Zle;break;case 4:u=ede;break;default:u=Ik}a=u.bind(null,i,a,e),u=void 0,!NN||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(u=!0),l?u!==void 0?e.addEventListener(i,a,{capture:!0,passive:u}):e.addEventListener(i,a,!0):u!==void 0?e.addEventListener(i,a,{passive:u}):e.addEventListener(i,a,!1)}function X1(e,i,a,l,u){var p=l;if(!(i&1)&&!(i&2)&&l!==null)e:for(;;){if(l===null)return;var m=l.tag;if(m===3||m===4){var v=l.stateNode.containerInfo;if(v===u||v.nodeType===8&&v.parentNode===u)break;if(m===4)for(m=l.return;m!==null;){var y=m.tag;if((y===3||y===4)&&(y=m.stateNode.containerInfo,y===u||y.nodeType===8&&y.parentNode===u))return;m=m.return}for(;v!==null;){if(m=ch(v),m===null)return;if(y=m.tag,y===5||y===6){l=p=m;continue e}v=v.parentNode}}l=l.return}hG(function(){var S=p,C=bk(a),R=[];e:{var N=BG.get(e);if(N!==void 0){var x=Ok,U=e;switch(e){case"keypress":if(QS(a)===0)break e;case"keydown":case"keyup":x=mde;break;case"focusin":U="focus",x=G1;break;case"focusout":U="blur",x=G1;break;case"beforeblur":case"afterblur":x=G1;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=f5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=rde;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=vde;break;case UG:case jG:case FG:x=sde;break;case VG:x=yde;break;case"scroll":x=tde;break;case"wheel":x=Tde;break;case"copy":case"cut":case"paste":x=cde;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=g5}var M=(i&4)!==0,z=!M&&e==="scroll",V=M?N!==null?N+"Capture":null:N;M=[];for(var W=S,H;W!==null;){H=W;var q=H.stateNode;if(H.tag===5&&q!==null&&(H=q,V!==null&&(q=fv(W,V),q!=null&&M.push(Sv(W,q,H)))),z)break;W=W.return}0<M.length&&(N=new x(N,U,null,a,C),R.push({event:N,listeners:M}))}}if(!(i&7)){e:{if(N=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",N&&a!==AN&&(U=a.relatedTarget||a.fromElement)&&(ch(U)||U[Nl]))break e;if((x||N)&&(N=C.window===C?C:(N=C.ownerDocument)?N.defaultView||N.parentWindow:window,x?(U=a.relatedTarget||a.toElement,x=S,U=U?ch(U):null,U!==null&&(z=Fh(U),U!==z||U.tag!==5&&U.tag!==6)&&(U=null)):(x=null,U=S),x!==U)){if(M=f5,q="onMouseLeave",V="onMouseEnter",W="mouse",(e==="pointerout"||e==="pointerover")&&(M=g5,q="onPointerLeave",V="onPointerEnter",W="pointer"),z=x==null?N:Cf(x),H=U==null?N:Cf(U),N=new M(q,W+"leave",x,a,C),N.target=z,N.relatedTarget=H,q=null,ch(C)===S&&(M=new M(V,W+"enter",U,a,C),M.target=H,M.relatedTarget=z,q=M),z=q,x&&U)t:{for(M=x,V=U,W=0,H=M;H;H=cf(H))W++;for(H=0,q=V;q;q=cf(q))H++;for(;0<W-H;)M=cf(M),W--;for(;0<H-W;)V=cf(V),H--;for(;W--;){if(M===V||V!==null&&M===V.alternate)break t;M=cf(M),V=cf(V)}M=null}else M=null;x!==null&&I5(R,N,x,M,!1),U!==null&&z!==null&&I5(R,z,U,M,!0)}}e:{if(N=S?Cf(S):window,x=N.nodeName&&N.nodeName.toLowerCase(),x==="select"||x==="input"&&N.type==="file")var ee=Ode;else if(E5(N))if(kG)ee=Dde;else{ee=Pde;var oe=Nde}else(x=N.nodeName)&&x.toLowerCase()==="input"&&(N.type==="checkbox"||N.type==="radio")&&(ee=kde);if(ee&&(ee=ee(e,S))){PG(R,ee,a,C);break e}oe&&oe(e,N,S),e==="focusout"&&(oe=N._wrapperState)&&oe.controlled&&N.type==="number"&&bN(N,"number",N.value)}switch(oe=S?Cf(S):window,e){case"focusin":(E5(oe)||oe.contentEditable==="true")&&(Tf=oe,LN=S,q_=null);break;case"focusout":q_=LN=Tf=null;break;case"mousedown":MN=!0;break;case"contextmenu":case"mouseup":case"dragend":MN=!1,C5(R,a,C);break;case"selectionchange":if(Mde)break;case"keydown":case"keyup":C5(R,a,C)}var se;if(Pk)e:{switch(e){case"compositionstart":var re="onCompositionStart";break e;case"compositionend":re="onCompositionEnd";break e;case"compositionupdate":re="onCompositionUpdate";break e}re=void 0}else Sf?OG(e,a)&&(re="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(re="onCompositionStart");re&&(AG&&a.locale!=="ko"&&(Sf||re!=="onCompositionStart"?re==="onCompositionEnd"&&Sf&&(se=IG()):(Gd=C,Ak="value"in Gd?Gd.value:Gd.textContent,Sf=!0)),oe=BT(S,re),0<oe.length&&(re=new m5(re,e,null,a,C),R.push({event:re,listeners:oe}),se?re.data=se:(se=NG(a),se!==null&&(re.data=se)))),(se=Cde?wde(e,a):Rde(e,a))&&(S=BT(S,"onBeforeInput"),0<S.length&&(C=new m5("onBeforeInput","beforeinput",null,a,C),R.push({event:C,listeners:S}),C.data=se))}WG(R,i)})}function Sv(e,i,a){return{instance:e,listener:i,currentTarget:a}}function BT(e,i){for(var a=i+"Capture",l=[];e!==null;){var u=e,p=u.stateNode;u.tag===5&&p!==null&&(u=p,p=fv(e,a),p!=null&&l.unshift(Sv(e,p,u)),p=fv(e,i),p!=null&&l.push(Sv(e,p,u))),e=e.return}return l}function cf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function I5(e,i,a,l,u){for(var p=i._reactName,m=[];a!==null&&a!==l;){var v=a,y=v.alternate,S=v.stateNode;if(y!==null&&y===l)break;v.tag===5&&S!==null&&(v=S,u?(y=fv(a,p),y!=null&&m.unshift(Sv(a,y,v))):u||(y=fv(a,p),y!=null&&m.push(Sv(a,y,v)))),a=a.return}m.length!==0&&e.push({event:i,listeners:m})}var Vde=/\r\n?/g,Bde=/\u0000|\uFFFD/g;function A5(e){return(typeof e=="string"?e:""+e).replace(Vde,`
`).replace(Bde,"")}function yS(e,i,a){if(i=A5(i),A5(e)!==i&&a)throw Error(Ke(425))}function WT(){}var UN=null,jN=null;function FN(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var VN=typeof setTimeout=="function"?setTimeout:void 0,Wde=typeof clearTimeout=="function"?clearTimeout:void 0,O5=typeof Promise=="function"?Promise:void 0,zde=typeof queueMicrotask=="function"?queueMicrotask:typeof O5<"u"?function(e){return O5.resolve(null).then(e).catch(Gde)}:VN;function Gde(e){setTimeout(function(){throw e})}function Q1(e,i){var a=i,l=0;do{var u=a.nextSibling;if(e.removeChild(a),u&&u.nodeType===8)if(a=u.data,a==="/$"){if(l===0){e.removeChild(u),_v(i);return}l--}else a!=="$"&&a!=="$?"&&a!=="$!"||l++;a=u}while(a);_v(i)}function Jd(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return e}function N5(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return e;i--}else a==="/$"&&i++}e=e.previousSibling}return null}var Nm=Math.random().toString(36).slice(2),Tc="__reactFiber$"+Nm,Tv="__reactProps$"+Nm,Nl="__reactContainer$"+Nm,BN="__reactEvents$"+Nm,Hde="__reactListeners$"+Nm,$de="__reactHandles$"+Nm;function ch(e){var i=e[Tc];if(i)return i;for(var a=e.parentNode;a;){if(i=a[Nl]||a[Tc]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(e=N5(e);e!==null;){if(a=e[Tc])return a;e=N5(e)}return i}e=a,a=e.parentNode}return null}function eE(e){return e=e[Tc]||e[Nl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Cf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ke(33))}function Db(e){return e[Tv]||null}var WN=[],wf=-1;function hu(e){return{current:e}}function Ar(e){0>wf||(e.current=WN[wf],WN[wf]=null,wf--)}function Sr(e,i){wf++,WN[wf]=e.current,e.current=i}var su={},vo=hu(su),rs=hu(!1),Ch=su;function um(e,i){var a=e.type.contextTypes;if(!a)return su;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===i)return l.__reactInternalMemoizedMaskedChildContext;var u={},p;for(p in a)u[p]=i[p];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=u),u}function is(e){return e=e.childContextTypes,e!=null}function zT(){Ar(rs),Ar(vo)}function P5(e,i,a){if(vo.current!==su)throw Error(Ke(168));Sr(vo,i),Sr(rs,a)}function GG(e,i,a){var l=e.stateNode;if(i=i.childContextTypes,typeof l.getChildContext!="function")return a;l=l.getChildContext();for(var u in l)if(!(u in i))throw Error(Ke(108,Nle(e)||"Unknown",u));return Hr({},a,l)}function GT(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||su,Ch=vo.current,Sr(vo,e),Sr(rs,rs.current),!0}function k5(e,i,a){var l=e.stateNode;if(!l)throw Error(Ke(169));a?(e=GG(e,i,Ch),l.__reactInternalMemoizedMergedChildContext=e,Ar(rs),Ar(vo),Sr(vo,e)):Ar(rs),Sr(rs,a)}var pl=null,xb=!1,Z1=!1;function HG(e){pl===null?pl=[e]:pl.push(e)}function Kde(e){xb=!0,HG(e)}function pu(){if(!Z1&&pl!==null){Z1=!0;var e=0,i=Jn;try{var a=pl;for(Jn=1;e<a.length;e++){var l=a[e];do l=l(!0);while(l!==null)}pl=null,xb=!1}catch(u){throw pl!==null&&(pl=pl.slice(e+1)),gG(Ck,pu),u}finally{Jn=i,Z1=!1}}return null}var Rf=[],If=0,HT=null,$T=0,ua=[],ha=0,wh=null,_l=1,vl="";function th(e,i){Rf[If++]=$T,Rf[If++]=HT,HT=e,$T=i}function $G(e,i,a){ua[ha++]=_l,ua[ha++]=vl,ua[ha++]=wh,wh=e;var l=_l;e=vl;var u=32-Ga(l)-1;l&=~(1<<u),a+=1;var p=32-Ga(i)+u;if(30<p){var m=u-u%5;p=(l&(1<<m)-1).toString(32),l>>=m,u-=m,_l=1<<32-Ga(i)+u|a<<u|l,vl=p+e}else _l=1<<p|a<<u|l,vl=e}function Dk(e){e.return!==null&&(th(e,1),$G(e,1,0))}function xk(e){for(;e===HT;)HT=Rf[--If],Rf[If]=null,$T=Rf[--If],Rf[If]=null;for(;e===wh;)wh=ua[--ha],ua[ha]=null,vl=ua[--ha],ua[ha]=null,_l=ua[--ha],ua[ha]=null}var Ns=null,Os=null,Mr=!1,Wa=null;function KG(e,i){var a=pa(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=e,i=e.deletions,i===null?(e.deletions=[a],e.flags|=16):i.push(a)}function D5(e,i){switch(e.tag){case 5:var a=e.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(e.stateNode=i,Ns=e,Os=Jd(i.firstChild),!0):!1;case 6:return i=e.pendingProps===""||i.nodeType!==3?null:i,i!==null?(e.stateNode=i,Ns=e,Os=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=wh!==null?{id:_l,overflow:vl}:null,e.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=pa(18,null,null,0),a.stateNode=i,a.return=e,e.child=a,Ns=e,Os=null,!0):!1;default:return!1}}function zN(e){return(e.mode&1)!==0&&(e.flags&128)===0}function GN(e){if(Mr){var i=Os;if(i){var a=i;if(!D5(e,i)){if(zN(e))throw Error(Ke(418));i=Jd(a.nextSibling);var l=Ns;i&&D5(e,i)?KG(l,a):(e.flags=e.flags&-4097|2,Mr=!1,Ns=e)}}else{if(zN(e))throw Error(Ke(418));e.flags=e.flags&-4097|2,Mr=!1,Ns=e}}}function x5(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ns=e}function SS(e){if(e!==Ns)return!1;if(!Mr)return x5(e),Mr=!0,!1;var i;if((i=e.tag!==3)&&!(i=e.tag!==5)&&(i=e.type,i=i!=="head"&&i!=="body"&&!FN(e.type,e.memoizedProps)),i&&(i=Os)){if(zN(e))throw YG(),Error(Ke(418));for(;i;)KG(e,i),i=Jd(i.nextSibling)}if(x5(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ke(317));e:{for(e=e.nextSibling,i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(i===0){Os=Jd(e.nextSibling);break e}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}e=e.nextSibling}Os=null}}else Os=Ns?Jd(e.stateNode.nextSibling):null;return!0}function YG(){for(var e=Os;e;)e=Jd(e.nextSibling)}function hm(){Os=Ns=null,Mr=!1}function Lk(e){Wa===null?Wa=[e]:Wa.push(e)}var Yde=Ll.ReactCurrentBatchConfig;function Va(e,i){if(e&&e.defaultProps){i=Hr({},i),e=e.defaultProps;for(var a in e)i[a]===void 0&&(i[a]=e[a]);return i}return i}var KT=hu(null),YT=null,Af=null,Mk=null;function Uk(){Mk=Af=YT=null}function jk(e){var i=KT.current;Ar(KT),e._currentValue=i}function HN(e,i,a){for(;e!==null;){var l=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,l!==null&&(l.childLanes|=i)):l!==null&&(l.childLanes&i)!==i&&(l.childLanes|=i),e===a)break;e=e.return}}function Kf(e,i){YT=e,Mk=Af=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(es=!0),e.firstContext=null)}function Ea(e){var i=e._currentValue;if(Mk!==e)if(e={context:e,memoizedValue:i,next:null},Af===null){if(YT===null)throw Error(Ke(308));Af=e,YT.dependencies={lanes:0,firstContext:e}}else Af=Af.next=e;return i}var lh=null;function Fk(e){lh===null?lh=[e]:lh.push(e)}function qG(e,i,a,l){var u=i.interleaved;return u===null?(a.next=a,Fk(i)):(a.next=u.next,u.next=a),i.interleaved=a,Pl(e,l)}function Pl(e,i){e.lanes|=i;var a=e.alternate;for(a!==null&&(a.lanes|=i),a=e,e=e.return;e!==null;)e.childLanes|=i,a=e.alternate,a!==null&&(a.childLanes|=i),a=e,e=e.return;return a.tag===3?a.stateNode:null}var Fd=!1;function Vk(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function JG(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Tl(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function Xd(e,i,a){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,Rn&2){var u=l.pending;return u===null?i.next=i:(i.next=u.next,u.next=i),l.pending=i,Pl(e,a)}return u=l.interleaved,u===null?(i.next=i,Fk(l)):(i.next=u.next,u.next=i),l.interleaved=i,Pl(e,a)}function ZS(e,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var l=i.lanes;l&=e.pendingLanes,a|=l,i.lanes=a,wk(e,a)}}function L5(e,i){var a=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,a===l)){var u=null,p=null;if(a=a.firstBaseUpdate,a!==null){do{var m={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};p===null?u=p=m:p=p.next=m,a=a.next}while(a!==null);p===null?u=p=i:p=p.next=i}else u=p=i;a={baseState:l.baseState,firstBaseUpdate:u,lastBaseUpdate:p,shared:l.shared,effects:l.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=i:e.next=i,a.lastBaseUpdate=i}function qT(e,i,a,l){var u=e.updateQueue;Fd=!1;var p=u.firstBaseUpdate,m=u.lastBaseUpdate,v=u.shared.pending;if(v!==null){u.shared.pending=null;var y=v,S=y.next;y.next=null,m===null?p=S:m.next=S,m=y;var C=e.alternate;C!==null&&(C=C.updateQueue,v=C.lastBaseUpdate,v!==m&&(v===null?C.firstBaseUpdate=S:v.next=S,C.lastBaseUpdate=y))}if(p!==null){var R=u.baseState;m=0,C=S=y=null,v=p;do{var N=v.lane,x=v.eventTime;if((l&N)===N){C!==null&&(C=C.next={eventTime:x,lane:0,tag:v.tag,payload:v.payload,callback:v.callback,next:null});e:{var U=e,M=v;switch(N=i,x=a,M.tag){case 1:if(U=M.payload,typeof U=="function"){R=U.call(x,R,N);break e}R=U;break e;case 3:U.flags=U.flags&-65537|128;case 0:if(U=M.payload,N=typeof U=="function"?U.call(x,R,N):U,N==null)break e;R=Hr({},R,N);break e;case 2:Fd=!0}}v.callback!==null&&v.lane!==0&&(e.flags|=64,N=u.effects,N===null?u.effects=[v]:N.push(v))}else x={eventTime:x,lane:N,tag:v.tag,payload:v.payload,callback:v.callback,next:null},C===null?(S=C=x,y=R):C=C.next=x,m|=N;if(v=v.next,v===null){if(v=u.shared.pending,v===null)break;N=v,v=N.next,N.next=null,u.lastBaseUpdate=N,u.shared.pending=null}}while(!0);if(C===null&&(y=R),u.baseState=y,u.firstBaseUpdate=S,u.lastBaseUpdate=C,i=u.shared.interleaved,i!==null){u=i;do m|=u.lane,u=u.next;while(u!==i)}else p===null&&(u.shared.lanes=0);Ih|=m,e.lanes=m,e.memoizedState=R}}function M5(e,i,a){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var l=e[i],u=l.callback;if(u!==null){if(l.callback=null,l=a,typeof u!="function")throw Error(Ke(191,u));u.call(l)}}}var XG=new qz.Component().refs;function $N(e,i,a,l){i=e.memoizedState,a=a(l,i),a=a==null?i:Hr({},i,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Lb={isMounted:function(e){return(e=e._reactInternals)?Fh(e)===e:!1},enqueueSetState:function(e,i,a){e=e._reactInternals;var l=Po(),u=Zd(e),p=Tl(l,u);p.payload=i,a!=null&&(p.callback=a),i=Xd(e,p,u),i!==null&&(Ha(i,e,u,l),ZS(i,e,u))},enqueueReplaceState:function(e,i,a){e=e._reactInternals;var l=Po(),u=Zd(e),p=Tl(l,u);p.tag=1,p.payload=i,a!=null&&(p.callback=a),i=Xd(e,p,u),i!==null&&(Ha(i,e,u,l),ZS(i,e,u))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var a=Po(),l=Zd(e),u=Tl(a,l);u.tag=2,i!=null&&(u.callback=i),i=Xd(e,u,l),i!==null&&(Ha(i,e,l,a),ZS(i,e,l))}};function U5(e,i,a,l,u,p,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,p,m):i.prototype&&i.prototype.isPureReactComponent?!Ev(a,l)||!Ev(u,p):!0}function QG(e,i,a){var l=!1,u=su,p=i.contextType;return typeof p=="object"&&p!==null?p=Ea(p):(u=is(i)?Ch:vo.current,l=i.contextTypes,p=(l=l!=null)?um(e,u):su),i=new i(a,p),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Lb,e.stateNode=i,i._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=p),i}function j5(e,i,a,l){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,l),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,l),i.state!==e&&Lb.enqueueReplaceState(i,i.state,null)}function KN(e,i,a,l){var u=e.stateNode;u.props=a,u.state=e.memoizedState,u.refs=XG,Vk(e);var p=i.contextType;typeof p=="object"&&p!==null?u.context=Ea(p):(p=is(i)?Ch:vo.current,u.context=um(e,p)),u.state=e.memoizedState,p=i.getDerivedStateFromProps,typeof p=="function"&&($N(e,i,p,a),u.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(i=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),i!==u.state&&Lb.enqueueReplaceState(u,u.state,null),qT(e,a,u,l),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}function y_(e,i,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(Ke(309));var l=a.stateNode}if(!l)throw Error(Ke(147,e));var u=l,p=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===p?i.ref:(i=function(m){var v=u.refs;v===XG&&(v=u.refs={}),m===null?delete v[p]:v[p]=m},i._stringRef=p,i)}if(typeof e!="string")throw Error(Ke(284));if(!a._owner)throw Error(Ke(290,e))}return e}function TS(e,i){throw e=Object.prototype.toString.call(i),Error(Ke(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function F5(e){var i=e._init;return i(e._payload)}function ZG(e){function i(V,W){if(e){var H=V.deletions;H===null?(V.deletions=[W],V.flags|=16):H.push(W)}}function a(V,W){if(!e)return null;for(;W!==null;)i(V,W),W=W.sibling;return null}function l(V,W){for(V=new Map;W!==null;)W.key!==null?V.set(W.key,W):V.set(W.index,W),W=W.sibling;return V}function u(V,W){return V=eu(V,W),V.index=0,V.sibling=null,V}function p(V,W,H){return V.index=H,e?(H=V.alternate,H!==null?(H=H.index,H<W?(V.flags|=2,W):H):(V.flags|=2,W)):(V.flags|=1048576,W)}function m(V){return e&&V.alternate===null&&(V.flags|=2),V}function v(V,W,H,q){return W===null||W.tag!==6?(W=sO(H,V.mode,q),W.return=V,W):(W=u(W,H),W.return=V,W)}function y(V,W,H,q){var ee=H.type;return ee===yf?C(V,W,H.props.children,q,H.key):W!==null&&(W.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===jd&&F5(ee)===W.type)?(q=u(W,H.props),q.ref=y_(V,W,H),q.return=V,q):(q=oT(H.type,H.key,H.props,null,V.mode,q),q.ref=y_(V,W,H),q.return=V,q)}function S(V,W,H,q){return W===null||W.tag!==4||W.stateNode.containerInfo!==H.containerInfo||W.stateNode.implementation!==H.implementation?(W=aO(H,V.mode,q),W.return=V,W):(W=u(W,H.children||[]),W.return=V,W)}function C(V,W,H,q,ee){return W===null||W.tag!==7?(W=fh(H,V.mode,q,ee),W.return=V,W):(W=u(W,H),W.return=V,W)}function R(V,W,H){if(typeof W=="string"&&W!==""||typeof W=="number")return W=sO(""+W,V.mode,H),W.return=V,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case uS:return H=oT(W.type,W.key,W.props,null,V.mode,H),H.ref=y_(V,null,W),H.return=V,H;case Ef:return W=aO(W,V.mode,H),W.return=V,W;case jd:var q=W._init;return R(V,q(W._payload),H)}if(D_(W)||m_(W))return W=fh(W,V.mode,H,null),W.return=V,W;TS(V,W)}return null}function N(V,W,H,q){var ee=W!==null?W.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return ee!==null?null:v(V,W,""+H,q);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case uS:return H.key===ee?y(V,W,H,q):null;case Ef:return H.key===ee?S(V,W,H,q):null;case jd:return ee=H._init,N(V,W,ee(H._payload),q)}if(D_(H)||m_(H))return ee!==null?null:C(V,W,H,q,null);TS(V,H)}return null}function x(V,W,H,q,ee){if(typeof q=="string"&&q!==""||typeof q=="number")return V=V.get(H)||null,v(W,V,""+q,ee);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case uS:return V=V.get(q.key===null?H:q.key)||null,y(W,V,q,ee);case Ef:return V=V.get(q.key===null?H:q.key)||null,S(W,V,q,ee);case jd:var oe=q._init;return x(V,W,H,oe(q._payload),ee)}if(D_(q)||m_(q))return V=V.get(H)||null,C(W,V,q,ee,null);TS(W,q)}return null}function U(V,W,H,q){for(var ee=null,oe=null,se=W,re=W=0,me=null;se!==null&&re<H.length;re++){se.index>re?(me=se,se=null):me=se.sibling;var pe=N(V,se,H[re],q);if(pe===null){se===null&&(se=me);break}e&&se&&pe.alternate===null&&i(V,se),W=p(pe,W,re),oe===null?ee=pe:oe.sibling=pe,oe=pe,se=me}if(re===H.length)return a(V,se),Mr&&th(V,re),ee;if(se===null){for(;re<H.length;re++)se=R(V,H[re],q),se!==null&&(W=p(se,W,re),oe===null?ee=se:oe.sibling=se,oe=se);return Mr&&th(V,re),ee}for(se=l(V,se);re<H.length;re++)me=x(se,V,re,H[re],q),me!==null&&(e&&me.alternate!==null&&se.delete(me.key===null?re:me.key),W=p(me,W,re),oe===null?ee=me:oe.sibling=me,oe=me);return e&&se.forEach(function(Re){return i(V,Re)}),Mr&&th(V,re),ee}function M(V,W,H,q){var ee=m_(H);if(typeof ee!="function")throw Error(Ke(150));if(H=ee.call(H),H==null)throw Error(Ke(151));for(var oe=ee=null,se=W,re=W=0,me=null,pe=H.next();se!==null&&!pe.done;re++,pe=H.next()){se.index>re?(me=se,se=null):me=se.sibling;var Re=N(V,se,pe.value,q);if(Re===null){se===null&&(se=me);break}e&&se&&Re.alternate===null&&i(V,se),W=p(Re,W,re),oe===null?ee=Re:oe.sibling=Re,oe=Re,se=me}if(pe.done)return a(V,se),Mr&&th(V,re),ee;if(se===null){for(;!pe.done;re++,pe=H.next())pe=R(V,pe.value,q),pe!==null&&(W=p(pe,W,re),oe===null?ee=pe:oe.sibling=pe,oe=pe);return Mr&&th(V,re),ee}for(se=l(V,se);!pe.done;re++,pe=H.next())pe=x(se,V,re,pe.value,q),pe!==null&&(e&&pe.alternate!==null&&se.delete(pe.key===null?re:pe.key),W=p(pe,W,re),oe===null?ee=pe:oe.sibling=pe,oe=pe);return e&&se.forEach(function(Ze){return i(V,Ze)}),Mr&&th(V,re),ee}function z(V,W,H,q){if(typeof H=="object"&&H!==null&&H.type===yf&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case uS:e:{for(var ee=H.key,oe=W;oe!==null;){if(oe.key===ee){if(ee=H.type,ee===yf){if(oe.tag===7){a(V,oe.sibling),W=u(oe,H.props.children),W.return=V,V=W;break e}}else if(oe.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===jd&&F5(ee)===oe.type){a(V,oe.sibling),W=u(oe,H.props),W.ref=y_(V,oe,H),W.return=V,V=W;break e}a(V,oe);break}else i(V,oe);oe=oe.sibling}H.type===yf?(W=fh(H.props.children,V.mode,q,H.key),W.return=V,V=W):(q=oT(H.type,H.key,H.props,null,V.mode,q),q.ref=y_(V,W,H),q.return=V,V=q)}return m(V);case Ef:e:{for(oe=H.key;W!==null;){if(W.key===oe)if(W.tag===4&&W.stateNode.containerInfo===H.containerInfo&&W.stateNode.implementation===H.implementation){a(V,W.sibling),W=u(W,H.children||[]),W.return=V,V=W;break e}else{a(V,W);break}else i(V,W);W=W.sibling}W=aO(H,V.mode,q),W.return=V,V=W}return m(V);case jd:return oe=H._init,z(V,W,oe(H._payload),q)}if(D_(H))return U(V,W,H,q);if(m_(H))return M(V,W,H,q);TS(V,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,W!==null&&W.tag===6?(a(V,W.sibling),W=u(W,H),W.return=V,V=W):(a(V,W),W=sO(H,V.mode,q),W.return=V,V=W),m(V)):a(V,W)}return z}var pm=ZG(!0),eH=ZG(!1),tE={},Ac=hu(tE),bv=hu(tE),Cv=hu(tE);function dh(e){if(e===tE)throw Error(Ke(174));return e}function Bk(e,i){switch(Sr(Cv,i),Sr(bv,e),Sr(Ac,tE),e=i.nodeType,e){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:wN(null,"");break;default:e=e===8?i.parentNode:i,i=e.namespaceURI||null,e=e.tagName,i=wN(i,e)}Ar(Ac),Sr(Ac,i)}function fm(){Ar(Ac),Ar(bv),Ar(Cv)}function tH(e){dh(Cv.current);var i=dh(Ac.current),a=wN(i,e.type);i!==a&&(Sr(bv,e),Sr(Ac,a))}function Wk(e){bv.current===e&&(Ar(Ac),Ar(bv))}var Wr=hu(0);function JT(e){for(var i=e;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var eO=[];function zk(){for(var e=0;e<eO.length;e++)eO[e]._workInProgressVersionPrimary=null;eO.length=0}var eT=Ll.ReactCurrentDispatcher,tO=Ll.ReactCurrentBatchConfig,Rh=0,Gr=null,wi=null,xi=null,XT=!1,J_=!1,wv=0,qde=0;function so(){throw Error(Ke(321))}function Gk(e,i){if(i===null)return!1;for(var a=0;a<i.length&&a<e.length;a++)if(!$a(e[a],i[a]))return!1;return!0}function Hk(e,i,a,l,u,p){if(Rh=p,Gr=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,eT.current=e===null||e.memoizedState===null?Zde:eue,e=a(l,u),J_){p=0;do{if(J_=!1,wv=0,25<=p)throw Error(Ke(301));p+=1,xi=wi=null,i.updateQueue=null,eT.current=tue,e=a(l,u)}while(J_)}if(eT.current=QT,i=wi!==null&&wi.next!==null,Rh=0,xi=wi=Gr=null,XT=!1,i)throw Error(Ke(300));return e}function $k(){var e=wv!==0;return wv=0,e}function vc(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xi===null?Gr.memoizedState=xi=e:xi=xi.next=e,xi}function ya(){if(wi===null){var e=Gr.alternate;e=e!==null?e.memoizedState:null}else e=wi.next;var i=xi===null?Gr.memoizedState:xi.next;if(i!==null)xi=i,wi=e;else{if(e===null)throw Error(Ke(310));wi=e,e={memoizedState:wi.memoizedState,baseState:wi.baseState,baseQueue:wi.baseQueue,queue:wi.queue,next:null},xi===null?Gr.memoizedState=xi=e:xi=xi.next=e}return xi}function Rv(e,i){return typeof i=="function"?i(e):i}function nO(e){var i=ya(),a=i.queue;if(a===null)throw Error(Ke(311));a.lastRenderedReducer=e;var l=wi,u=l.baseQueue,p=a.pending;if(p!==null){if(u!==null){var m=u.next;u.next=p.next,p.next=m}l.baseQueue=u=p,a.pending=null}if(u!==null){p=u.next,l=l.baseState;var v=m=null,y=null,S=p;do{var C=S.lane;if((Rh&C)===C)y!==null&&(y=y.next={lane:0,action:S.action,hasEagerState:S.hasEagerState,eagerState:S.eagerState,next:null}),l=S.hasEagerState?S.eagerState:e(l,S.action);else{var R={lane:C,action:S.action,hasEagerState:S.hasEagerState,eagerState:S.eagerState,next:null};y===null?(v=y=R,m=l):y=y.next=R,Gr.lanes|=C,Ih|=C}S=S.next}while(S!==null&&S!==p);y===null?m=l:y.next=v,$a(l,i.memoizedState)||(es=!0),i.memoizedState=l,i.baseState=m,i.baseQueue=y,a.lastRenderedState=l}if(e=a.interleaved,e!==null){u=e;do p=u.lane,Gr.lanes|=p,Ih|=p,u=u.next;while(u!==e)}else u===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function rO(e){var i=ya(),a=i.queue;if(a===null)throw Error(Ke(311));a.lastRenderedReducer=e;var l=a.dispatch,u=a.pending,p=i.memoizedState;if(u!==null){a.pending=null;var m=u=u.next;do p=e(p,m.action),m=m.next;while(m!==u);$a(p,i.memoizedState)||(es=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),a.lastRenderedState=p}return[p,l]}function nH(){}function rH(e,i){var a=Gr,l=ya(),u=i(),p=!$a(l.memoizedState,u);if(p&&(l.memoizedState=u,es=!0),l=l.queue,Kk(sH.bind(null,a,l,e),[e]),l.getSnapshot!==i||p||xi!==null&&xi.memoizedState.tag&1){if(a.flags|=2048,Iv(9,oH.bind(null,a,l,u,i),void 0,null),Li===null)throw Error(Ke(349));Rh&30||iH(a,i,u)}return u}function iH(e,i,a){e.flags|=16384,e={getSnapshot:i,value:a},i=Gr.updateQueue,i===null?(i={lastEffect:null,stores:null},Gr.updateQueue=i,i.stores=[e]):(a=i.stores,a===null?i.stores=[e]:a.push(e))}function oH(e,i,a,l){i.value=a,i.getSnapshot=l,aH(i)&&cH(e)}function sH(e,i,a){return a(function(){aH(i)&&cH(e)})}function aH(e){var i=e.getSnapshot;e=e.value;try{var a=i();return!$a(e,a)}catch{return!0}}function cH(e){var i=Pl(e,1);i!==null&&Ha(i,e,1,-1)}function V5(e){var i=vc();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rv,lastRenderedState:e},i.queue=e,e=e.dispatch=Qde.bind(null,Gr,e),[i.memoizedState,e]}function Iv(e,i,a,l){return e={tag:e,create:i,destroy:a,deps:l,next:null},i=Gr.updateQueue,i===null?(i={lastEffect:null,stores:null},Gr.updateQueue=i,i.lastEffect=e.next=e):(a=i.lastEffect,a===null?i.lastEffect=e.next=e:(l=a.next,a.next=e,e.next=l,i.lastEffect=e)),e}function lH(){return ya().memoizedState}function tT(e,i,a,l){var u=vc();Gr.flags|=e,u.memoizedState=Iv(1|i,a,void 0,l===void 0?null:l)}function Mb(e,i,a,l){var u=ya();l=l===void 0?null:l;var p=void 0;if(wi!==null){var m=wi.memoizedState;if(p=m.destroy,l!==null&&Gk(l,m.deps)){u.memoizedState=Iv(i,a,p,l);return}}Gr.flags|=e,u.memoizedState=Iv(1|i,a,p,l)}function B5(e,i){return tT(8390656,8,e,i)}function Kk(e,i){return Mb(2048,8,e,i)}function dH(e,i){return Mb(4,2,e,i)}function uH(e,i){return Mb(4,4,e,i)}function hH(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function pH(e,i,a){return a=a!=null?a.concat([e]):null,Mb(4,4,hH.bind(null,i,e),a)}function Yk(){}function fH(e,i){var a=ya();i=i===void 0?null:i;var l=a.memoizedState;return l!==null&&i!==null&&Gk(i,l[1])?l[0]:(a.memoizedState=[e,i],e)}function mH(e,i){var a=ya();i=i===void 0?null:i;var l=a.memoizedState;return l!==null&&i!==null&&Gk(i,l[1])?l[0]:(e=e(),a.memoizedState=[e,i],e)}function gH(e,i,a){return Rh&21?($a(a,i)||(a=EG(),Gr.lanes|=a,Ih|=a,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,es=!0),e.memoizedState=a)}function Jde(e,i){var a=Jn;Jn=a!==0&&4>a?a:4,e(!0);var l=tO.transition;tO.transition={};try{e(!1),i()}finally{Jn=a,tO.transition=l}}function _H(){return ya().memoizedState}function Xde(e,i,a){var l=Zd(e);if(a={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null},vH(e))EH(i,a);else if(a=qG(e,i,a,l),a!==null){var u=Po();Ha(a,e,l,u),yH(a,i,l)}}function Qde(e,i,a){var l=Zd(e),u={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null};if(vH(e))EH(i,u);else{var p=e.alternate;if(e.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var m=i.lastRenderedState,v=p(m,a);if(u.hasEagerState=!0,u.eagerState=v,$a(v,m)){var y=i.interleaved;y===null?(u.next=u,Fk(i)):(u.next=y.next,y.next=u),i.interleaved=u;return}}catch{}finally{}a=qG(e,i,u,l),a!==null&&(u=Po(),Ha(a,e,l,u),yH(a,i,l))}}function vH(e){var i=e.alternate;return e===Gr||i!==null&&i===Gr}function EH(e,i){J_=XT=!0;var a=e.pending;a===null?i.next=i:(i.next=a.next,a.next=i),e.pending=i}function yH(e,i,a){if(a&4194240){var l=i.lanes;l&=e.pendingLanes,a|=l,i.lanes=a,wk(e,a)}}var QT={readContext:Ea,useCallback:so,useContext:so,useEffect:so,useImperativeHandle:so,useInsertionEffect:so,useLayoutEffect:so,useMemo:so,useReducer:so,useRef:so,useState:so,useDebugValue:so,useDeferredValue:so,useTransition:so,useMutableSource:so,useSyncExternalStore:so,useId:so,unstable_isNewReconciler:!1},Zde={readContext:Ea,useCallback:function(e,i){return vc().memoizedState=[e,i===void 0?null:i],e},useContext:Ea,useEffect:B5,useImperativeHandle:function(e,i,a){return a=a!=null?a.concat([e]):null,tT(4194308,4,hH.bind(null,i,e),a)},useLayoutEffect:function(e,i){return tT(4194308,4,e,i)},useInsertionEffect:function(e,i){return tT(4,2,e,i)},useMemo:function(e,i){var a=vc();return i=i===void 0?null:i,e=e(),a.memoizedState=[e,i],e},useReducer:function(e,i,a){var l=vc();return i=a!==void 0?a(i):i,l.memoizedState=l.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},l.queue=e,e=e.dispatch=Xde.bind(null,Gr,e),[l.memoizedState,e]},useRef:function(e){var i=vc();return e={current:e},i.memoizedState=e},useState:V5,useDebugValue:Yk,useDeferredValue:function(e){return vc().memoizedState=e},useTransition:function(){var e=V5(!1),i=e[0];return e=Jde.bind(null,e[1]),vc().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,a){var l=Gr,u=vc();if(Mr){if(a===void 0)throw Error(Ke(407));a=a()}else{if(a=i(),Li===null)throw Error(Ke(349));Rh&30||iH(l,i,a)}u.memoizedState=a;var p={value:a,getSnapshot:i};return u.queue=p,B5(sH.bind(null,l,p,e),[e]),l.flags|=2048,Iv(9,oH.bind(null,l,p,a,i),void 0,null),a},useId:function(){var e=vc(),i=Li.identifierPrefix;if(Mr){var a=vl,l=_l;a=(l&~(1<<32-Ga(l)-1)).toString(32)+a,i=":"+i+"R"+a,a=wv++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=qde++,i=":"+i+"r"+a.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},eue={readContext:Ea,useCallback:fH,useContext:Ea,useEffect:Kk,useImperativeHandle:pH,useInsertionEffect:dH,useLayoutEffect:uH,useMemo:mH,useReducer:nO,useRef:lH,useState:function(){return nO(Rv)},useDebugValue:Yk,useDeferredValue:function(e){var i=ya();return gH(i,wi.memoizedState,e)},useTransition:function(){var e=nO(Rv)[0],i=ya().memoizedState;return[e,i]},useMutableSource:nH,useSyncExternalStore:rH,useId:_H,unstable_isNewReconciler:!1},tue={readContext:Ea,useCallback:fH,useContext:Ea,useEffect:Kk,useImperativeHandle:pH,useInsertionEffect:dH,useLayoutEffect:uH,useMemo:mH,useReducer:rO,useRef:lH,useState:function(){return rO(Rv)},useDebugValue:Yk,useDeferredValue:function(e){var i=ya();return wi===null?i.memoizedState=e:gH(i,wi.memoizedState,e)},useTransition:function(){var e=rO(Rv)[0],i=ya().memoizedState;return[e,i]},useMutableSource:nH,useSyncExternalStore:rH,useId:_H,unstable_isNewReconciler:!1};function mm(e,i){try{var a="",l=i;do a+=Ole(l),l=l.return;while(l);var u=a}catch(p){u=`
Error generating stack: `+p.message+`
`+p.stack}return{value:e,source:i,stack:u,digest:null}}function iO(e,i,a){return{value:e,source:null,stack:null,digest:i??null}}function YN(e,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var nue=typeof WeakMap=="function"?WeakMap:Map;function SH(e,i,a){a=Tl(-1,a),a.tag=3,a.payload={element:null};var l=i.value;return a.callback=function(){eb||(eb=!0,iP=l),YN(e,i)},a}function TH(e,i,a){a=Tl(-1,a),a.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var u=i.value;a.payload=function(){return l(u)},a.callback=function(){YN(e,i)}}var p=e.stateNode;return p!==null&&typeof p.componentDidCatch=="function"&&(a.callback=function(){YN(e,i),typeof l!="function"&&(Qd===null?Qd=new Set([this]):Qd.add(this));var m=i.stack;this.componentDidCatch(i.value,{componentStack:m!==null?m:""})}),a}function W5(e,i,a){var l=e.pingCache;if(l===null){l=e.pingCache=new nue;var u=new Set;l.set(i,u)}else u=l.get(i),u===void 0&&(u=new Set,l.set(i,u));u.has(a)||(u.add(a),e=gue.bind(null,e,i,a),i.then(e,e))}function z5(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function G5(e,i,a,l,u){return e.mode&1?(e.flags|=65536,e.lanes=u,e):(e===i?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=Tl(-1,1),i.tag=2,Xd(a,i,1))),a.lanes|=1),e)}var rue=Ll.ReactCurrentOwner,es=!1;function Oo(e,i,a,l){i.child=e===null?eH(i,null,a,l):pm(i,e.child,a,l)}function H5(e,i,a,l,u){a=a.render;var p=i.ref;return Kf(i,u),l=Hk(e,i,a,l,p,u),a=$k(),e!==null&&!es?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~u,kl(e,i,u)):(Mr&&a&&Dk(i),i.flags|=1,Oo(e,i,l,u),i.child)}function $5(e,i,a,l,u){if(e===null){var p=a.type;return typeof p=="function"&&!nD(p)&&p.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=p,bH(e,i,p,l,u)):(e=oT(a.type,null,l,i,i.mode,u),e.ref=i.ref,e.return=i,i.child=e)}if(p=e.child,!(e.lanes&u)){var m=p.memoizedProps;if(a=a.compare,a=a!==null?a:Ev,a(m,l)&&e.ref===i.ref)return kl(e,i,u)}return i.flags|=1,e=eu(p,l),e.ref=i.ref,e.return=i,i.child=e}function bH(e,i,a,l,u){if(e!==null){var p=e.memoizedProps;if(Ev(p,l)&&e.ref===i.ref)if(es=!1,i.pendingProps=l=p,(e.lanes&u)!==0)e.flags&131072&&(es=!0);else return i.lanes=e.lanes,kl(e,i,u)}return qN(e,i,a,l,u)}function CH(e,i,a){var l=i.pendingProps,u=l.children,p=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sr(Nf,ws),ws|=a;else{if(!(a&1073741824))return e=p!==null?p.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,Sr(Nf,ws),ws|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=p!==null?p.baseLanes:a,Sr(Nf,ws),ws|=l}else p!==null?(l=p.baseLanes|a,i.memoizedState=null):l=a,Sr(Nf,ws),ws|=l;return Oo(e,i,u,a),i.child}function wH(e,i){var a=i.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function qN(e,i,a,l,u){var p=is(a)?Ch:vo.current;return p=um(i,p),Kf(i,u),a=Hk(e,i,a,l,p,u),l=$k(),e!==null&&!es?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~u,kl(e,i,u)):(Mr&&l&&Dk(i),i.flags|=1,Oo(e,i,a,u),i.child)}function K5(e,i,a,l,u){if(is(a)){var p=!0;GT(i)}else p=!1;if(Kf(i,u),i.stateNode===null)nT(e,i),QG(i,a,l),KN(i,a,l,u),l=!0;else if(e===null){var m=i.stateNode,v=i.memoizedProps;m.props=v;var y=m.context,S=a.contextType;typeof S=="object"&&S!==null?S=Ea(S):(S=is(a)?Ch:vo.current,S=um(i,S));var C=a.getDerivedStateFromProps,R=typeof C=="function"||typeof m.getSnapshotBeforeUpdate=="function";R||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==l||y!==S)&&j5(i,m,l,S),Fd=!1;var N=i.memoizedState;m.state=N,qT(i,l,m,u),y=i.memoizedState,v!==l||N!==y||rs.current||Fd?(typeof C=="function"&&($N(i,a,C,l),y=i.memoizedState),(v=Fd||U5(i,a,v,l,N,y,S))?(R||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(i.flags|=4194308)):(typeof m.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=l,i.memoizedState=y),m.props=l,m.state=y,m.context=S,l=v):(typeof m.componentDidMount=="function"&&(i.flags|=4194308),l=!1)}else{m=i.stateNode,JG(e,i),v=i.memoizedProps,S=i.type===i.elementType?v:Va(i.type,v),m.props=S,R=i.pendingProps,N=m.context,y=a.contextType,typeof y=="object"&&y!==null?y=Ea(y):(y=is(a)?Ch:vo.current,y=um(i,y));var x=a.getDerivedStateFromProps;(C=typeof x=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==R||N!==y)&&j5(i,m,l,y),Fd=!1,N=i.memoizedState,m.state=N,qT(i,l,m,u);var U=i.memoizedState;v!==R||N!==U||rs.current||Fd?(typeof x=="function"&&($N(i,a,x,l),U=i.memoizedState),(S=Fd||U5(i,a,S,l,N,U,y)||!1)?(C||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(l,U,y),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(l,U,y)),typeof m.componentDidUpdate=="function"&&(i.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===e.memoizedProps&&N===e.memoizedState||(i.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&N===e.memoizedState||(i.flags|=1024),i.memoizedProps=l,i.memoizedState=U),m.props=l,m.state=U,m.context=y,l=S):(typeof m.componentDidUpdate!="function"||v===e.memoizedProps&&N===e.memoizedState||(i.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&N===e.memoizedState||(i.flags|=1024),l=!1)}return JN(e,i,a,l,p,u)}function JN(e,i,a,l,u,p){wH(e,i);var m=(i.flags&128)!==0;if(!l&&!m)return u&&k5(i,a,!1),kl(e,i,p);l=i.stateNode,rue.current=i;var v=m&&typeof a.getDerivedStateFromError!="function"?null:l.render();return i.flags|=1,e!==null&&m?(i.child=pm(i,e.child,null,p),i.child=pm(i,null,v,p)):Oo(e,i,v,p),i.memoizedState=l.state,u&&k5(i,a,!0),i.child}function RH(e){var i=e.stateNode;i.pendingContext?P5(e,i.pendingContext,i.pendingContext!==i.context):i.context&&P5(e,i.context,!1),Bk(e,i.containerInfo)}function Y5(e,i,a,l,u){return hm(),Lk(u),i.flags|=256,Oo(e,i,a,l),i.child}var XN={dehydrated:null,treeContext:null,retryLane:0};function QN(e){return{baseLanes:e,cachePool:null,transitions:null}}function IH(e,i,a){var l=i.pendingProps,u=Wr.current,p=!1,m=(i.flags&128)!==0,v;if((v=m)||(v=e!==null&&e.memoizedState===null?!1:(u&2)!==0),v?(p=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),Sr(Wr,u&1),e===null)return GN(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?e.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(m=l.children,e=l.fallback,p?(l=i.mode,p=i.child,m={mode:"hidden",children:m},!(l&1)&&p!==null?(p.childLanes=0,p.pendingProps=m):p=Fb(m,l,0,null),e=fh(e,l,a,null),p.return=i,e.return=i,p.sibling=e,i.child=p,i.child.memoizedState=QN(a),i.memoizedState=XN,e):qk(i,m));if(u=e.memoizedState,u!==null&&(v=u.dehydrated,v!==null))return iue(e,i,m,l,v,u,a);if(p){p=l.fallback,m=i.mode,u=e.child,v=u.sibling;var y={mode:"hidden",children:l.children};return!(m&1)&&i.child!==u?(l=i.child,l.childLanes=0,l.pendingProps=y,i.deletions=null):(l=eu(u,y),l.subtreeFlags=u.subtreeFlags&14680064),v!==null?p=eu(v,p):(p=fh(p,m,a,null),p.flags|=2),p.return=i,l.return=i,l.sibling=p,i.child=l,l=p,p=i.child,m=e.child.memoizedState,m=m===null?QN(a):{baseLanes:m.baseLanes|a,cachePool:null,transitions:m.transitions},p.memoizedState=m,p.childLanes=e.childLanes&~a,i.memoizedState=XN,l}return p=e.child,e=p.sibling,l=eu(p,{mode:"visible",children:l.children}),!(i.mode&1)&&(l.lanes=a),l.return=i,l.sibling=null,e!==null&&(a=i.deletions,a===null?(i.deletions=[e],i.flags|=16):a.push(e)),i.child=l,i.memoizedState=null,l}function qk(e,i){return i=Fb({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function bS(e,i,a,l){return l!==null&&Lk(l),pm(i,e.child,null,a),e=qk(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function iue(e,i,a,l,u,p,m){if(a)return i.flags&256?(i.flags&=-257,l=iO(Error(Ke(422))),bS(e,i,m,l)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(p=l.fallback,u=i.mode,l=Fb({mode:"visible",children:l.children},u,0,null),p=fh(p,u,m,null),p.flags|=2,l.return=i,p.return=i,l.sibling=p,i.child=l,i.mode&1&&pm(i,e.child,null,m),i.child.memoizedState=QN(m),i.memoizedState=XN,p);if(!(i.mode&1))return bS(e,i,m,null);if(u.data==="$!"){if(l=u.nextSibling&&u.nextSibling.dataset,l)var v=l.dgst;return l=v,p=Error(Ke(419)),l=iO(p,l),bS(e,i,m,l)}if(v=(m&e.childLanes)!==0,es||v){if(l=Li,l!==null){switch(m&-m){case 4:u=2;break;case 16:u=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:u=32;break;case 536870912:u=268435456;break;default:u=0}u=u&(l.suspendedLanes|m)?0:u,u!==0&&u!==p.retryLane&&(p.retryLane=u,Pl(e,u),Ha(l,e,u,-1))}return tD(),l=iO(Error(Ke(421))),bS(e,i,m,l)}return u.data==="$?"?(i.flags|=128,i.child=e.child,i=_ue.bind(null,e),u._reactRetry=i,null):(e=p.treeContext,Os=Jd(u.nextSibling),Ns=i,Mr=!0,Wa=null,e!==null&&(ua[ha++]=_l,ua[ha++]=vl,ua[ha++]=wh,_l=e.id,vl=e.overflow,wh=i),i=qk(i,l.children),i.flags|=4096,i)}function q5(e,i,a){e.lanes|=i;var l=e.alternate;l!==null&&(l.lanes|=i),HN(e.return,i,a)}function oO(e,i,a,l,u){var p=e.memoizedState;p===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:l,tail:a,tailMode:u}:(p.isBackwards=i,p.rendering=null,p.renderingStartTime=0,p.last=l,p.tail=a,p.tailMode=u)}function AH(e,i,a){var l=i.pendingProps,u=l.revealOrder,p=l.tail;if(Oo(e,i,l.children,a),l=Wr.current,l&2)l=l&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&q5(e,a,i);else if(e.tag===19)q5(e,a,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break e;for(;e.sibling===null;){if(e.return===null||e.return===i)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Sr(Wr,l),!(i.mode&1))i.memoizedState=null;else switch(u){case"forwards":for(a=i.child,u=null;a!==null;)e=a.alternate,e!==null&&JT(e)===null&&(u=a),a=a.sibling;a=u,a===null?(u=i.child,i.child=null):(u=a.sibling,a.sibling=null),oO(i,!1,u,a,p);break;case"backwards":for(a=null,u=i.child,i.child=null;u!==null;){if(e=u.alternate,e!==null&&JT(e)===null){i.child=u;break}e=u.sibling,u.sibling=a,a=u,u=e}oO(i,!0,a,null,p);break;case"together":oO(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function nT(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function kl(e,i,a){if(e!==null&&(i.dependencies=e.dependencies),Ih|=i.lanes,!(a&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(Ke(153));if(i.child!==null){for(e=i.child,a=eu(e,e.pendingProps),i.child=a,a.return=i;e.sibling!==null;)e=e.sibling,a=a.sibling=eu(e,e.pendingProps),a.return=i;a.sibling=null}return i.child}function oue(e,i,a){switch(i.tag){case 3:RH(i),hm();break;case 5:tH(i);break;case 1:is(i.type)&&GT(i);break;case 4:Bk(i,i.stateNode.containerInfo);break;case 10:var l=i.type._context,u=i.memoizedProps.value;Sr(KT,l._currentValue),l._currentValue=u;break;case 13:if(l=i.memoizedState,l!==null)return l.dehydrated!==null?(Sr(Wr,Wr.current&1),i.flags|=128,null):a&i.child.childLanes?IH(e,i,a):(Sr(Wr,Wr.current&1),e=kl(e,i,a),e!==null?e.sibling:null);Sr(Wr,Wr.current&1);break;case 19:if(l=(a&i.childLanes)!==0,e.flags&128){if(l)return AH(e,i,a);i.flags|=128}if(u=i.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Sr(Wr,Wr.current),l)break;return null;case 22:case 23:return i.lanes=0,CH(e,i,a)}return kl(e,i,a)}var OH,ZN,NH,PH;OH=function(e,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};ZN=function(){};NH=function(e,i,a,l){var u=e.memoizedProps;if(u!==l){e=i.stateNode,dh(Ac.current);var p=null;switch(a){case"input":u=SN(e,u),l=SN(e,l),p=[];break;case"select":u=Hr({},u,{value:void 0}),l=Hr({},l,{value:void 0}),p=[];break;case"textarea":u=CN(e,u),l=CN(e,l),p=[];break;default:typeof u.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=WT)}RN(a,l);var m;a=null;for(S in u)if(!l.hasOwnProperty(S)&&u.hasOwnProperty(S)&&u[S]!=null)if(S==="style"){var v=u[S];for(m in v)v.hasOwnProperty(m)&&(a||(a={}),a[m]="")}else S!=="dangerouslySetInnerHTML"&&S!=="children"&&S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(hv.hasOwnProperty(S)?p||(p=[]):(p=p||[]).push(S,null));for(S in l){var y=l[S];if(v=u!=null?u[S]:void 0,l.hasOwnProperty(S)&&y!==v&&(y!=null||v!=null))if(S==="style")if(v){for(m in v)!v.hasOwnProperty(m)||y&&y.hasOwnProperty(m)||(a||(a={}),a[m]="");for(m in y)y.hasOwnProperty(m)&&v[m]!==y[m]&&(a||(a={}),a[m]=y[m])}else a||(p||(p=[]),p.push(S,a)),a=y;else S==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,v=v?v.__html:void 0,y!=null&&v!==y&&(p=p||[]).push(S,y)):S==="children"?typeof y!="string"&&typeof y!="number"||(p=p||[]).push(S,""+y):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&(hv.hasOwnProperty(S)?(y!=null&&S==="onScroll"&&Rr("scroll",e),p||v===y||(p=[])):(p=p||[]).push(S,y))}a&&(p=p||[]).push("style",a);var S=p;(i.updateQueue=S)&&(i.flags|=4)}};PH=function(e,i,a,l){a!==l&&(i.flags|=4)};function S_(e,i){if(!Mr)switch(e.tailMode){case"hidden":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function ao(e){var i=e.alternate!==null&&e.alternate.child===e.child,a=0,l=0;if(i)for(var u=e.child;u!==null;)a|=u.lanes|u.childLanes,l|=u.subtreeFlags&14680064,l|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)a|=u.lanes|u.childLanes,l|=u.subtreeFlags,l|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=l,e.childLanes=a,i}function sue(e,i,a){var l=i.pendingProps;switch(xk(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ao(i),null;case 1:return is(i.type)&&zT(),ao(i),null;case 3:return l=i.stateNode,fm(),Ar(rs),Ar(vo),zk(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(SS(i)?i.flags|=4:e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,Wa!==null&&(aP(Wa),Wa=null))),ZN(e,i),ao(i),null;case 5:Wk(i);var u=dh(Cv.current);if(a=i.type,e!==null&&i.stateNode!=null)NH(e,i,a,l,u),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!l){if(i.stateNode===null)throw Error(Ke(166));return ao(i),null}if(e=dh(Ac.current),SS(i)){l=i.stateNode,a=i.type;var p=i.memoizedProps;switch(l[Tc]=i,l[Tv]=p,e=(i.mode&1)!==0,a){case"dialog":Rr("cancel",l),Rr("close",l);break;case"iframe":case"object":case"embed":Rr("load",l);break;case"video":case"audio":for(u=0;u<L_.length;u++)Rr(L_[u],l);break;case"source":Rr("error",l);break;case"img":case"image":case"link":Rr("error",l),Rr("load",l);break;case"details":Rr("toggle",l);break;case"input":i5(l,p),Rr("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!p.multiple},Rr("invalid",l);break;case"textarea":s5(l,p),Rr("invalid",l)}RN(a,p),u=null;for(var m in p)if(p.hasOwnProperty(m)){var v=p[m];m==="children"?typeof v=="string"?l.textContent!==v&&(p.suppressHydrationWarning!==!0&&yS(l.textContent,v,e),u=["children",v]):typeof v=="number"&&l.textContent!==""+v&&(p.suppressHydrationWarning!==!0&&yS(l.textContent,v,e),u=["children",""+v]):hv.hasOwnProperty(m)&&v!=null&&m==="onScroll"&&Rr("scroll",l)}switch(a){case"input":hS(l),o5(l,p,!0);break;case"textarea":hS(l),a5(l);break;case"select":case"option":break;default:typeof p.onClick=="function"&&(l.onclick=WT)}l=u,i.updateQueue=l,l!==null&&(i.flags|=4)}else{m=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=iG(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=m.createElement(a,{is:l.is}):(e=m.createElement(a),a==="select"&&(m=e,l.multiple?m.multiple=!0:l.size&&(m.size=l.size))):e=m.createElementNS(e,a),e[Tc]=i,e[Tv]=l,OH(e,i,!1,!1),i.stateNode=e;e:{switch(m=IN(a,l),a){case"dialog":Rr("cancel",e),Rr("close",e),u=l;break;case"iframe":case"object":case"embed":Rr("load",e),u=l;break;case"video":case"audio":for(u=0;u<L_.length;u++)Rr(L_[u],e);u=l;break;case"source":Rr("error",e),u=l;break;case"img":case"image":case"link":Rr("error",e),Rr("load",e),u=l;break;case"details":Rr("toggle",e),u=l;break;case"input":i5(e,l),u=SN(e,l),Rr("invalid",e);break;case"option":u=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},u=Hr({},l,{value:void 0}),Rr("invalid",e);break;case"textarea":s5(e,l),u=CN(e,l),Rr("invalid",e);break;default:u=l}RN(a,u),v=u;for(p in v)if(v.hasOwnProperty(p)){var y=v[p];p==="style"?aG(e,y):p==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&oG(e,y)):p==="children"?typeof y=="string"?(a!=="textarea"||y!=="")&&pv(e,y):typeof y=="number"&&pv(e,""+y):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(hv.hasOwnProperty(p)?y!=null&&p==="onScroll"&&Rr("scroll",e):y!=null&&Ek(e,p,y,m))}switch(a){case"input":hS(e),o5(e,l,!1);break;case"textarea":hS(e),a5(e);break;case"option":l.value!=null&&e.setAttribute("value",""+ou(l.value));break;case"select":e.multiple=!!l.multiple,p=l.value,p!=null?zf(e,!!l.multiple,p,!1):l.defaultValue!=null&&zf(e,!!l.multiple,l.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=WT)}switch(a){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return ao(i),null;case 6:if(e&&i.stateNode!=null)PH(e,i,e.memoizedProps,l);else{if(typeof l!="string"&&i.stateNode===null)throw Error(Ke(166));if(a=dh(Cv.current),dh(Ac.current),SS(i)){if(l=i.stateNode,a=i.memoizedProps,l[Tc]=i,(p=l.nodeValue!==a)&&(e=Ns,e!==null))switch(e.tag){case 3:yS(l.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&yS(l.nodeValue,a,(e.mode&1)!==0)}p&&(i.flags|=4)}else l=(a.nodeType===9?a:a.ownerDocument).createTextNode(l),l[Tc]=i,i.stateNode=l}return ao(i),null;case 13:if(Ar(Wr),l=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Mr&&Os!==null&&i.mode&1&&!(i.flags&128))YG(),hm(),i.flags|=98560,p=!1;else if(p=SS(i),l!==null&&l.dehydrated!==null){if(e===null){if(!p)throw Error(Ke(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(Ke(317));p[Tc]=i}else hm(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;ao(i),p=!1}else Wa!==null&&(aP(Wa),Wa=null),p=!0;if(!p)return i.flags&65536?i:null}return i.flags&128?(i.lanes=a,i):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(i.child.flags|=8192,i.mode&1&&(e===null||Wr.current&1?Ri===0&&(Ri=3):tD())),i.updateQueue!==null&&(i.flags|=4),ao(i),null);case 4:return fm(),ZN(e,i),e===null&&yv(i.stateNode.containerInfo),ao(i),null;case 10:return jk(i.type._context),ao(i),null;case 17:return is(i.type)&&zT(),ao(i),null;case 19:if(Ar(Wr),p=i.memoizedState,p===null)return ao(i),null;if(l=(i.flags&128)!==0,m=p.rendering,m===null)if(l)S_(p,!1);else{if(Ri!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(m=JT(e),m!==null){for(i.flags|=128,S_(p,!1),l=m.updateQueue,l!==null&&(i.updateQueue=l,i.flags|=4),i.subtreeFlags=0,l=a,a=i.child;a!==null;)p=a,e=l,p.flags&=14680066,m=p.alternate,m===null?(p.childLanes=0,p.lanes=e,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=m.childLanes,p.lanes=m.lanes,p.child=m.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=m.memoizedProps,p.memoizedState=m.memoizedState,p.updateQueue=m.updateQueue,p.type=m.type,e=m.dependencies,p.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return Sr(Wr,Wr.current&1|2),i.child}e=e.sibling}p.tail!==null&&oi()>gm&&(i.flags|=128,l=!0,S_(p,!1),i.lanes=4194304)}else{if(!l)if(e=JT(m),e!==null){if(i.flags|=128,l=!0,a=e.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),S_(p,!0),p.tail===null&&p.tailMode==="hidden"&&!m.alternate&&!Mr)return ao(i),null}else 2*oi()-p.renderingStartTime>gm&&a!==1073741824&&(i.flags|=128,l=!0,S_(p,!1),i.lanes=4194304);p.isBackwards?(m.sibling=i.child,i.child=m):(a=p.last,a!==null?a.sibling=m:i.child=m,p.last=m)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=oi(),i.sibling=null,a=Wr.current,Sr(Wr,l?a&1|2:a&1),i):(ao(i),null);case 22:case 23:return eD(),l=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(i.flags|=8192),l&&i.mode&1?ws&1073741824&&(ao(i),i.subtreeFlags&6&&(i.flags|=8192)):ao(i),null;case 24:return null;case 25:return null}throw Error(Ke(156,i.tag))}function aue(e,i){switch(xk(i),i.tag){case 1:return is(i.type)&&zT(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return fm(),Ar(rs),Ar(vo),zk(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return Wk(i),null;case 13:if(Ar(Wr),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(Ke(340));hm()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return Ar(Wr),null;case 4:return fm(),null;case 10:return jk(i.type._context),null;case 22:case 23:return eD(),null;case 24:return null;default:return null}}var CS=!1,ho=!1,cue=typeof WeakSet=="function"?WeakSet:Set,ct=null;function Of(e,i){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(l){qr(e,i,l)}else a.current=null}function eP(e,i,a){try{a()}catch(l){qr(e,i,l)}}var J5=!1;function lue(e,i){if(UN=FT,e=LG(),kk(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var u=l.anchorOffset,p=l.focusNode;l=l.focusOffset;try{a.nodeType,p.nodeType}catch{a=null;break e}var m=0,v=-1,y=-1,S=0,C=0,R=e,N=null;t:for(;;){for(var x;R!==a||u!==0&&R.nodeType!==3||(v=m+u),R!==p||l!==0&&R.nodeType!==3||(y=m+l),R.nodeType===3&&(m+=R.nodeValue.length),(x=R.firstChild)!==null;)N=R,R=x;for(;;){if(R===e)break t;if(N===a&&++S===u&&(v=m),N===p&&++C===l&&(y=m),(x=R.nextSibling)!==null)break;R=N,N=R.parentNode}R=x}a=v===-1||y===-1?null:{start:v,end:y}}else a=null}a=a||{start:0,end:0}}else a=null;for(jN={focusedElem:e,selectionRange:a},FT=!1,ct=i;ct!==null;)if(i=ct,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,ct=e;else for(;ct!==null;){i=ct;try{var U=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(U!==null){var M=U.memoizedProps,z=U.memoizedState,V=i.stateNode,W=V.getSnapshotBeforeUpdate(i.elementType===i.type?M:Va(i.type,M),z);V.__reactInternalSnapshotBeforeUpdate=W}break;case 3:var H=i.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ke(163))}}catch(q){qr(i,i.return,q)}if(e=i.sibling,e!==null){e.return=i.return,ct=e;break}ct=i.return}return U=J5,J5=!1,U}function X_(e,i,a){var l=i.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&e)===e){var p=u.destroy;u.destroy=void 0,p!==void 0&&eP(i,a,p)}u=u.next}while(u!==l)}}function Ub(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&e)===e){var l=a.create;a.destroy=l()}a=a.next}while(a!==i)}}function tP(e){var i=e.ref;if(i!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof i=="function"?i(e):i.current=e}}function kH(e){var i=e.alternate;i!==null&&(e.alternate=null,kH(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&(delete i[Tc],delete i[Tv],delete i[BN],delete i[Hde],delete i[$de])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function DH(e){return e.tag===5||e.tag===3||e.tag===4}function X5(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||DH(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function nP(e,i,a){var l=e.tag;if(l===5||l===6)e=e.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(e,i):a.insertBefore(e,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(e,a)):(i=a,i.appendChild(e)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=WT));else if(l!==4&&(e=e.child,e!==null))for(nP(e,i,a),e=e.sibling;e!==null;)nP(e,i,a),e=e.sibling}function rP(e,i,a){var l=e.tag;if(l===5||l===6)e=e.stateNode,i?a.insertBefore(e,i):a.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(rP(e,i,a),e=e.sibling;e!==null;)rP(e,i,a),e=e.sibling}var Gi=null,Ba=!1;function kd(e,i,a){for(a=a.child;a!==null;)xH(e,i,a),a=a.sibling}function xH(e,i,a){if(Ic&&typeof Ic.onCommitFiberUnmount=="function")try{Ic.onCommitFiberUnmount(Ob,a)}catch{}switch(a.tag){case 5:ho||Of(a,i);case 6:var l=Gi,u=Ba;Gi=null,kd(e,i,a),Gi=l,Ba=u,Gi!==null&&(Ba?(e=Gi,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):Gi.removeChild(a.stateNode));break;case 18:Gi!==null&&(Ba?(e=Gi,a=a.stateNode,e.nodeType===8?Q1(e.parentNode,a):e.nodeType===1&&Q1(e,a),_v(e)):Q1(Gi,a.stateNode));break;case 4:l=Gi,u=Ba,Gi=a.stateNode.containerInfo,Ba=!0,kd(e,i,a),Gi=l,Ba=u;break;case 0:case 11:case 14:case 15:if(!ho&&(l=a.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){u=l=l.next;do{var p=u,m=p.destroy;p=p.tag,m!==void 0&&(p&2||p&4)&&eP(a,i,m),u=u.next}while(u!==l)}kd(e,i,a);break;case 1:if(!ho&&(Of(a,i),l=a.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=a.memoizedProps,l.state=a.memoizedState,l.componentWillUnmount()}catch(v){qr(a,i,v)}kd(e,i,a);break;case 21:kd(e,i,a);break;case 22:a.mode&1?(ho=(l=ho)||a.memoizedState!==null,kd(e,i,a),ho=l):kd(e,i,a);break;default:kd(e,i,a)}}function Q5(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new cue),i.forEach(function(l){var u=vue.bind(null,e,l);a.has(l)||(a.add(l),l.then(u,u))})}}function Ua(e,i){var a=i.deletions;if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];try{var p=e,m=i,v=m;e:for(;v!==null;){switch(v.tag){case 5:Gi=v.stateNode,Ba=!1;break e;case 3:Gi=v.stateNode.containerInfo,Ba=!0;break e;case 4:Gi=v.stateNode.containerInfo,Ba=!0;break e}v=v.return}if(Gi===null)throw Error(Ke(160));xH(p,m,u),Gi=null,Ba=!1;var y=u.alternate;y!==null&&(y.return=null),u.return=null}catch(S){qr(u,i,S)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)LH(i,e),i=i.sibling}function LH(e,i){var a=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ua(i,e),gc(e),l&4){try{X_(3,e,e.return),Ub(3,e)}catch(M){qr(e,e.return,M)}try{X_(5,e,e.return)}catch(M){qr(e,e.return,M)}}break;case 1:Ua(i,e),gc(e),l&512&&a!==null&&Of(a,a.return);break;case 5:if(Ua(i,e),gc(e),l&512&&a!==null&&Of(a,a.return),e.flags&32){var u=e.stateNode;try{pv(u,"")}catch(M){qr(e,e.return,M)}}if(l&4&&(u=e.stateNode,u!=null)){var p=e.memoizedProps,m=a!==null?a.memoizedProps:p,v=e.type,y=e.updateQueue;if(e.updateQueue=null,y!==null)try{v==="input"&&p.type==="radio"&&p.name!=null&&nG(u,p),IN(v,m);var S=IN(v,p);for(m=0;m<y.length;m+=2){var C=y[m],R=y[m+1];C==="style"?aG(u,R):C==="dangerouslySetInnerHTML"?oG(u,R):C==="children"?pv(u,R):Ek(u,C,R,S)}switch(v){case"input":TN(u,p);break;case"textarea":rG(u,p);break;case"select":var N=u._wrapperState.wasMultiple;u._wrapperState.wasMultiple=!!p.multiple;var x=p.value;x!=null?zf(u,!!p.multiple,x,!1):N!==!!p.multiple&&(p.defaultValue!=null?zf(u,!!p.multiple,p.defaultValue,!0):zf(u,!!p.multiple,p.multiple?[]:"",!1))}u[Tv]=p}catch(M){qr(e,e.return,M)}}break;case 6:if(Ua(i,e),gc(e),l&4){if(e.stateNode===null)throw Error(Ke(162));u=e.stateNode,p=e.memoizedProps;try{u.nodeValue=p}catch(M){qr(e,e.return,M)}}break;case 3:if(Ua(i,e),gc(e),l&4&&a!==null&&a.memoizedState.isDehydrated)try{_v(i.containerInfo)}catch(M){qr(e,e.return,M)}break;case 4:Ua(i,e),gc(e);break;case 13:Ua(i,e),gc(e),u=e.child,u.flags&8192&&(p=u.memoizedState!==null,u.stateNode.isHidden=p,!p||u.alternate!==null&&u.alternate.memoizedState!==null||(Qk=oi())),l&4&&Q5(e);break;case 22:if(C=a!==null&&a.memoizedState!==null,e.mode&1?(ho=(S=ho)||C,Ua(i,e),ho=S):Ua(i,e),gc(e),l&8192){if(S=e.memoizedState!==null,(e.stateNode.isHidden=S)&&!C&&e.mode&1)for(ct=e,C=e.child;C!==null;){for(R=ct=C;ct!==null;){switch(N=ct,x=N.child,N.tag){case 0:case 11:case 14:case 15:X_(4,N,N.return);break;case 1:Of(N,N.return);var U=N.stateNode;if(typeof U.componentWillUnmount=="function"){l=N,a=N.return;try{i=l,U.props=i.memoizedProps,U.state=i.memoizedState,U.componentWillUnmount()}catch(M){qr(l,a,M)}}break;case 5:Of(N,N.return);break;case 22:if(N.memoizedState!==null){e6(R);continue}}x!==null?(x.return=N,ct=x):e6(R)}C=C.sibling}e:for(C=null,R=e;;){if(R.tag===5){if(C===null){C=R;try{u=R.stateNode,S?(p=u.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none"):(v=R.stateNode,y=R.memoizedProps.style,m=y!=null&&y.hasOwnProperty("display")?y.display:null,v.style.display=sG("display",m))}catch(M){qr(e,e.return,M)}}}else if(R.tag===6){if(C===null)try{R.stateNode.nodeValue=S?"":R.memoizedProps}catch(M){qr(e,e.return,M)}}else if((R.tag!==22&&R.tag!==23||R.memoizedState===null||R===e)&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===e)break e;for(;R.sibling===null;){if(R.return===null||R.return===e)break e;C===R&&(C=null),R=R.return}C===R&&(C=null),R.sibling.return=R.return,R=R.sibling}}break;case 19:Ua(i,e),gc(e),l&4&&Q5(e);break;case 21:break;default:Ua(i,e),gc(e)}}function gc(e){var i=e.flags;if(i&2){try{e:{for(var a=e.return;a!==null;){if(DH(a)){var l=a;break e}a=a.return}throw Error(Ke(160))}switch(l.tag){case 5:var u=l.stateNode;l.flags&32&&(pv(u,""),l.flags&=-33);var p=X5(e);rP(e,p,u);break;case 3:case 4:var m=l.stateNode.containerInfo,v=X5(e);nP(e,v,m);break;default:throw Error(Ke(161))}}catch(y){qr(e,e.return,y)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function due(e,i,a){ct=e,MH(e)}function MH(e,i,a){for(var l=(e.mode&1)!==0;ct!==null;){var u=ct,p=u.child;if(u.tag===22&&l){var m=u.memoizedState!==null||CS;if(!m){var v=u.alternate,y=v!==null&&v.memoizedState!==null||ho;v=CS;var S=ho;if(CS=m,(ho=y)&&!S)for(ct=u;ct!==null;)m=ct,y=m.child,m.tag===22&&m.memoizedState!==null?t6(u):y!==null?(y.return=m,ct=y):t6(u);for(;p!==null;)ct=p,MH(p),p=p.sibling;ct=u,CS=v,ho=S}Z5(e)}else u.subtreeFlags&8772&&p!==null?(p.return=u,ct=p):Z5(e)}}function Z5(e){for(;ct!==null;){var i=ct;if(i.flags&8772){var a=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:ho||Ub(5,i);break;case 1:var l=i.stateNode;if(i.flags&4&&!ho)if(a===null)l.componentDidMount();else{var u=i.elementType===i.type?a.memoizedProps:Va(i.type,a.memoizedProps);l.componentDidUpdate(u,a.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var p=i.updateQueue;p!==null&&M5(i,p,l);break;case 3:var m=i.updateQueue;if(m!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}M5(i,m,a)}break;case 5:var v=i.stateNode;if(a===null&&i.flags&4){a=v;var y=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&a.focus();break;case"img":y.src&&(a.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var S=i.alternate;if(S!==null){var C=S.memoizedState;if(C!==null){var R=C.dehydrated;R!==null&&_v(R)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ke(163))}ho||i.flags&512&&tP(i)}catch(N){qr(i,i.return,N)}}if(i===e){ct=null;break}if(a=i.sibling,a!==null){a.return=i.return,ct=a;break}ct=i.return}}function e6(e){for(;ct!==null;){var i=ct;if(i===e){ct=null;break}var a=i.sibling;if(a!==null){a.return=i.return,ct=a;break}ct=i.return}}function t6(e){for(;ct!==null;){var i=ct;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{Ub(4,i)}catch(y){qr(i,a,y)}break;case 1:var l=i.stateNode;if(typeof l.componentDidMount=="function"){var u=i.return;try{l.componentDidMount()}catch(y){qr(i,u,y)}}var p=i.return;try{tP(i)}catch(y){qr(i,p,y)}break;case 5:var m=i.return;try{tP(i)}catch(y){qr(i,m,y)}}}catch(y){qr(i,i.return,y)}if(i===e){ct=null;break}var v=i.sibling;if(v!==null){v.return=i.return,ct=v;break}ct=i.return}}var uue=Math.ceil,ZT=Ll.ReactCurrentDispatcher,Jk=Ll.ReactCurrentOwner,ma=Ll.ReactCurrentBatchConfig,Rn=0,Li=null,vi=null,Yi=0,ws=0,Nf=hu(0),Ri=0,Av=null,Ih=0,jb=0,Xk=0,Q_=null,Qo=null,Qk=0,gm=1/0,hl=null,eb=!1,iP=null,Qd=null,wS=!1,Hd=null,tb=0,Z_=0,oP=null,rT=-1,iT=0;function Po(){return Rn&6?oi():rT!==-1?rT:rT=oi()}function Zd(e){return e.mode&1?Rn&2&&Yi!==0?Yi&-Yi:Yde.transition!==null?(iT===0&&(iT=EG()),iT):(e=Jn,e!==0||(e=window.event,e=e===void 0?16:RG(e.type)),e):1}function Ha(e,i,a,l){if(50<Z_)throw Z_=0,oP=null,Error(Ke(185));Qv(e,a,l),(!(Rn&2)||e!==Li)&&(e===Li&&(!(Rn&2)&&(jb|=a),Ri===4&&Wd(e,Yi)),os(e,l),a===1&&Rn===0&&!(i.mode&1)&&(gm=oi()+500,xb&&pu()))}function os(e,i){var a=e.callbackNode;Yle(e,i);var l=jT(e,e===Li?Yi:0);if(l===0)a!==null&&d5(a),e.callbackNode=null,e.callbackPriority=0;else if(i=l&-l,e.callbackPriority!==i){if(a!=null&&d5(a),i===1)e.tag===0?Kde(n6.bind(null,e)):HG(n6.bind(null,e)),zde(function(){!(Rn&6)&&pu()}),a=null;else{switch(yG(l)){case 1:a=Ck;break;case 4:a=_G;break;case 16:a=UT;break;case 536870912:a=vG;break;default:a=UT}a=GH(a,UH.bind(null,e))}e.callbackPriority=i,e.callbackNode=a}}function UH(e,i){if(rT=-1,iT=0,Rn&6)throw Error(Ke(327));var a=e.callbackNode;if(Yf()&&e.callbackNode!==a)return null;var l=jT(e,e===Li?Yi:0);if(l===0)return null;if(l&30||l&e.expiredLanes||i)i=nb(e,l);else{i=l;var u=Rn;Rn|=2;var p=FH();(Li!==e||Yi!==i)&&(hl=null,gm=oi()+500,ph(e,i));do try{fue();break}catch(v){jH(e,v)}while(!0);Uk(),ZT.current=p,Rn=u,vi!==null?i=0:(Li=null,Yi=0,i=Ri)}if(i!==0){if(i===2&&(u=kN(e),u!==0&&(l=u,i=sP(e,u))),i===1)throw a=Av,ph(e,0),Wd(e,l),os(e,oi()),a;if(i===6)Wd(e,l);else{if(u=e.current.alternate,!(l&30)&&!hue(u)&&(i=nb(e,l),i===2&&(p=kN(e),p!==0&&(l=p,i=sP(e,p))),i===1))throw a=Av,ph(e,0),Wd(e,l),os(e,oi()),a;switch(e.finishedWork=u,e.finishedLanes=l,i){case 0:case 1:throw Error(Ke(345));case 2:nh(e,Qo,hl);break;case 3:if(Wd(e,l),(l&130023424)===l&&(i=Qk+500-oi(),10<i)){if(jT(e,0)!==0)break;if(u=e.suspendedLanes,(u&l)!==l){Po(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=VN(nh.bind(null,e,Qo,hl),i);break}nh(e,Qo,hl);break;case 4:if(Wd(e,l),(l&4194240)===l)break;for(i=e.eventTimes,u=-1;0<l;){var m=31-Ga(l);p=1<<m,m=i[m],m>u&&(u=m),l&=~p}if(l=u,l=oi()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*uue(l/1960))-l,10<l){e.timeoutHandle=VN(nh.bind(null,e,Qo,hl),l);break}nh(e,Qo,hl);break;case 5:nh(e,Qo,hl);break;default:throw Error(Ke(329))}}}return os(e,oi()),e.callbackNode===a?UH.bind(null,e):null}function sP(e,i){var a=Q_;return e.current.memoizedState.isDehydrated&&(ph(e,i).flags|=256),e=nb(e,i),e!==2&&(i=Qo,Qo=a,i!==null&&aP(i)),e}function aP(e){Qo===null?Qo=e:Qo.push.apply(Qo,e)}function hue(e){for(var i=e;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var l=0;l<a.length;l++){var u=a[l],p=u.getSnapshot;u=u.value;try{if(!$a(p(),u))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Wd(e,i){for(i&=~Xk,i&=~jb,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var a=31-Ga(i),l=1<<a;e[a]=-1,i&=~l}}function n6(e){if(Rn&6)throw Error(Ke(327));Yf();var i=jT(e,0);if(!(i&1))return os(e,oi()),null;var a=nb(e,i);if(e.tag!==0&&a===2){var l=kN(e);l!==0&&(i=l,a=sP(e,l))}if(a===1)throw a=Av,ph(e,0),Wd(e,i),os(e,oi()),a;if(a===6)throw Error(Ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,nh(e,Qo,hl),os(e,oi()),null}function Zk(e,i){var a=Rn;Rn|=1;try{return e(i)}finally{Rn=a,Rn===0&&(gm=oi()+500,xb&&pu())}}function Ah(e){Hd!==null&&Hd.tag===0&&!(Rn&6)&&Yf();var i=Rn;Rn|=1;var a=ma.transition,l=Jn;try{if(ma.transition=null,Jn=1,e)return e()}finally{Jn=l,ma.transition=a,Rn=i,!(Rn&6)&&pu()}}function eD(){ws=Nf.current,Ar(Nf)}function ph(e,i){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,Wde(a)),vi!==null)for(a=vi.return;a!==null;){var l=a;switch(xk(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&zT();break;case 3:fm(),Ar(rs),Ar(vo),zk();break;case 5:Wk(l);break;case 4:fm();break;case 13:Ar(Wr);break;case 19:Ar(Wr);break;case 10:jk(l.type._context);break;case 22:case 23:eD()}a=a.return}if(Li=e,vi=e=eu(e.current,null),Yi=ws=i,Ri=0,Av=null,Xk=jb=Ih=0,Qo=Q_=null,lh!==null){for(i=0;i<lh.length;i++)if(a=lh[i],l=a.interleaved,l!==null){a.interleaved=null;var u=l.next,p=a.pending;if(p!==null){var m=p.next;p.next=u,l.next=m}a.pending=l}lh=null}return e}function jH(e,i){do{var a=vi;try{if(Uk(),eT.current=QT,XT){for(var l=Gr.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}XT=!1}if(Rh=0,xi=wi=Gr=null,J_=!1,wv=0,Jk.current=null,a===null||a.return===null){Ri=1,Av=i,vi=null;break}e:{var p=e,m=a.return,v=a,y=i;if(i=Yi,v.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var S=y,C=v,R=C.tag;if(!(C.mode&1)&&(R===0||R===11||R===15)){var N=C.alternate;N?(C.updateQueue=N.updateQueue,C.memoizedState=N.memoizedState,C.lanes=N.lanes):(C.updateQueue=null,C.memoizedState=null)}var x=z5(m);if(x!==null){x.flags&=-257,G5(x,m,v,p,i),x.mode&1&&W5(p,S,i),i=x,y=S;var U=i.updateQueue;if(U===null){var M=new Set;M.add(y),i.updateQueue=M}else U.add(y);break e}else{if(!(i&1)){W5(p,S,i),tD();break e}y=Error(Ke(426))}}else if(Mr&&v.mode&1){var z=z5(m);if(z!==null){!(z.flags&65536)&&(z.flags|=256),G5(z,m,v,p,i),Lk(mm(y,v));break e}}p=y=mm(y,v),Ri!==4&&(Ri=2),Q_===null?Q_=[p]:Q_.push(p),p=m;do{switch(p.tag){case 3:p.flags|=65536,i&=-i,p.lanes|=i;var V=SH(p,y,i);L5(p,V);break e;case 1:v=y;var W=p.type,H=p.stateNode;if(!(p.flags&128)&&(typeof W.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Qd===null||!Qd.has(H)))){p.flags|=65536,i&=-i,p.lanes|=i;var q=TH(p,v,i);L5(p,q);break e}}p=p.return}while(p!==null)}BH(a)}catch(ee){i=ee,vi===a&&a!==null&&(vi=a=a.return);continue}break}while(!0)}function FH(){var e=ZT.current;return ZT.current=QT,e===null?QT:e}function tD(){(Ri===0||Ri===3||Ri===2)&&(Ri=4),Li===null||!(Ih&268435455)&&!(jb&268435455)||Wd(Li,Yi)}function nb(e,i){var a=Rn;Rn|=2;var l=FH();(Li!==e||Yi!==i)&&(hl=null,ph(e,i));do try{pue();break}catch(u){jH(e,u)}while(!0);if(Uk(),Rn=a,ZT.current=l,vi!==null)throw Error(Ke(261));return Li=null,Yi=0,Ri}function pue(){for(;vi!==null;)VH(vi)}function fue(){for(;vi!==null&&!Fle();)VH(vi)}function VH(e){var i=zH(e.alternate,e,ws);e.memoizedProps=e.pendingProps,i===null?BH(e):vi=i,Jk.current=null}function BH(e){var i=e;do{var a=i.alternate;if(e=i.return,i.flags&32768){if(a=aue(a,i),a!==null){a.flags&=32767,vi=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ri=6,vi=null;return}}else if(a=sue(a,i,ws),a!==null){vi=a;return}if(i=i.sibling,i!==null){vi=i;return}vi=i=e}while(i!==null);Ri===0&&(Ri=5)}function nh(e,i,a){var l=Jn,u=ma.transition;try{ma.transition=null,Jn=1,mue(e,i,a,l)}finally{ma.transition=u,Jn=l}return null}function mue(e,i,a,l){do Yf();while(Hd!==null);if(Rn&6)throw Error(Ke(327));a=e.finishedWork;var u=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(Ke(177));e.callbackNode=null,e.callbackPriority=0;var p=a.lanes|a.childLanes;if(qle(e,p),e===Li&&(vi=Li=null,Yi=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||wS||(wS=!0,GH(UT,function(){return Yf(),null})),p=(a.flags&15990)!==0,a.subtreeFlags&15990||p){p=ma.transition,ma.transition=null;var m=Jn;Jn=1;var v=Rn;Rn|=4,Jk.current=null,lue(e,a),LH(a,e),Lde(jN),FT=!!UN,jN=UN=null,e.current=a,due(a),Vle(),Rn=v,Jn=m,ma.transition=p}else e.current=a;if(wS&&(wS=!1,Hd=e,tb=u),p=e.pendingLanes,p===0&&(Qd=null),zle(a.stateNode),os(e,oi()),i!==null)for(l=e.onRecoverableError,a=0;a<i.length;a++)u=i[a],l(u.value,{componentStack:u.stack,digest:u.digest});if(eb)throw eb=!1,e=iP,iP=null,e;return tb&1&&e.tag!==0&&Yf(),p=e.pendingLanes,p&1?e===oP?Z_++:(Z_=0,oP=e):Z_=0,pu(),null}function Yf(){if(Hd!==null){var e=yG(tb),i=ma.transition,a=Jn;try{if(ma.transition=null,Jn=16>e?16:e,Hd===null)var l=!1;else{if(e=Hd,Hd=null,tb=0,Rn&6)throw Error(Ke(331));var u=Rn;for(Rn|=4,ct=e.current;ct!==null;){var p=ct,m=p.child;if(ct.flags&16){var v=p.deletions;if(v!==null){for(var y=0;y<v.length;y++){var S=v[y];for(ct=S;ct!==null;){var C=ct;switch(C.tag){case 0:case 11:case 15:X_(8,C,p)}var R=C.child;if(R!==null)R.return=C,ct=R;else for(;ct!==null;){C=ct;var N=C.sibling,x=C.return;if(kH(C),C===S){ct=null;break}if(N!==null){N.return=x,ct=N;break}ct=x}}}var U=p.alternate;if(U!==null){var M=U.child;if(M!==null){U.child=null;do{var z=M.sibling;M.sibling=null,M=z}while(M!==null)}}ct=p}}if(p.subtreeFlags&2064&&m!==null)m.return=p,ct=m;else e:for(;ct!==null;){if(p=ct,p.flags&2048)switch(p.tag){case 0:case 11:case 15:X_(9,p,p.return)}var V=p.sibling;if(V!==null){V.return=p.return,ct=V;break e}ct=p.return}}var W=e.current;for(ct=W;ct!==null;){m=ct;var H=m.child;if(m.subtreeFlags&2064&&H!==null)H.return=m,ct=H;else e:for(m=W;ct!==null;){if(v=ct,v.flags&2048)try{switch(v.tag){case 0:case 11:case 15:Ub(9,v)}}catch(ee){qr(v,v.return,ee)}if(v===m){ct=null;break e}var q=v.sibling;if(q!==null){q.return=v.return,ct=q;break e}ct=v.return}}if(Rn=u,pu(),Ic&&typeof Ic.onPostCommitFiberRoot=="function")try{Ic.onPostCommitFiberRoot(Ob,e)}catch{}l=!0}return l}finally{Jn=a,ma.transition=i}}return!1}function r6(e,i,a){i=mm(a,i),i=SH(e,i,1),e=Xd(e,i,1),i=Po(),e!==null&&(Qv(e,1,i),os(e,i))}function qr(e,i,a){if(e.tag===3)r6(e,e,a);else for(;i!==null;){if(i.tag===3){r6(i,e,a);break}else if(i.tag===1){var l=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Qd===null||!Qd.has(l))){e=mm(a,e),e=TH(i,e,1),i=Xd(i,e,1),e=Po(),i!==null&&(Qv(i,1,e),os(i,e));break}}i=i.return}}function gue(e,i,a){var l=e.pingCache;l!==null&&l.delete(i),i=Po(),e.pingedLanes|=e.suspendedLanes&a,Li===e&&(Yi&a)===a&&(Ri===4||Ri===3&&(Yi&130023424)===Yi&&500>oi()-Qk?ph(e,0):Xk|=a),os(e,i)}function WH(e,i){i===0&&(e.mode&1?(i=mS,mS<<=1,!(mS&130023424)&&(mS=4194304)):i=1);var a=Po();e=Pl(e,i),e!==null&&(Qv(e,i,a),os(e,a))}function _ue(e){var i=e.memoizedState,a=0;i!==null&&(a=i.retryLane),WH(e,a)}function vue(e,i){var a=0;switch(e.tag){case 13:var l=e.stateNode,u=e.memoizedState;u!==null&&(a=u.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(Ke(314))}l!==null&&l.delete(i),WH(e,a)}var zH;zH=function(e,i,a){if(e!==null)if(e.memoizedProps!==i.pendingProps||rs.current)es=!0;else{if(!(e.lanes&a)&&!(i.flags&128))return es=!1,oue(e,i,a);es=!!(e.flags&131072)}else es=!1,Mr&&i.flags&1048576&&$G(i,$T,i.index);switch(i.lanes=0,i.tag){case 2:var l=i.type;nT(e,i),e=i.pendingProps;var u=um(i,vo.current);Kf(i,a),u=Hk(null,i,l,e,u,a);var p=$k();return i.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,is(l)?(p=!0,GT(i)):p=!1,i.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,Vk(i),u.updater=Lb,i.stateNode=u,u._reactInternals=i,KN(i,l,e,a),i=JN(null,i,l,!0,p,a)):(i.tag=0,Mr&&p&&Dk(i),Oo(null,i,u,a),i=i.child),i;case 16:l=i.elementType;e:{switch(nT(e,i),e=i.pendingProps,u=l._init,l=u(l._payload),i.type=l,u=i.tag=yue(l),e=Va(l,e),u){case 0:i=qN(null,i,l,e,a);break e;case 1:i=K5(null,i,l,e,a);break e;case 11:i=H5(null,i,l,e,a);break e;case 14:i=$5(null,i,l,Va(l.type,e),a);break e}throw Error(Ke(306,l,""))}return i;case 0:return l=i.type,u=i.pendingProps,u=i.elementType===l?u:Va(l,u),qN(e,i,l,u,a);case 1:return l=i.type,u=i.pendingProps,u=i.elementType===l?u:Va(l,u),K5(e,i,l,u,a);case 3:e:{if(RH(i),e===null)throw Error(Ke(387));l=i.pendingProps,p=i.memoizedState,u=p.element,JG(e,i),qT(i,l,null,a);var m=i.memoizedState;if(l=m.element,p.isDehydrated)if(p={element:l,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){u=mm(Error(Ke(423)),i),i=Y5(e,i,l,a,u);break e}else if(l!==u){u=mm(Error(Ke(424)),i),i=Y5(e,i,l,a,u);break e}else for(Os=Jd(i.stateNode.containerInfo.firstChild),Ns=i,Mr=!0,Wa=null,a=eH(i,null,l,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(hm(),l===u){i=kl(e,i,a);break e}Oo(e,i,l,a)}i=i.child}return i;case 5:return tH(i),e===null&&GN(i),l=i.type,u=i.pendingProps,p=e!==null?e.memoizedProps:null,m=u.children,FN(l,u)?m=null:p!==null&&FN(l,p)&&(i.flags|=32),wH(e,i),Oo(e,i,m,a),i.child;case 6:return e===null&&GN(i),null;case 13:return IH(e,i,a);case 4:return Bk(i,i.stateNode.containerInfo),l=i.pendingProps,e===null?i.child=pm(i,null,l,a):Oo(e,i,l,a),i.child;case 11:return l=i.type,u=i.pendingProps,u=i.elementType===l?u:Va(l,u),H5(e,i,l,u,a);case 7:return Oo(e,i,i.pendingProps,a),i.child;case 8:return Oo(e,i,i.pendingProps.children,a),i.child;case 12:return Oo(e,i,i.pendingProps.children,a),i.child;case 10:e:{if(l=i.type._context,u=i.pendingProps,p=i.memoizedProps,m=u.value,Sr(KT,l._currentValue),l._currentValue=m,p!==null)if($a(p.value,m)){if(p.children===u.children&&!rs.current){i=kl(e,i,a);break e}}else for(p=i.child,p!==null&&(p.return=i);p!==null;){var v=p.dependencies;if(v!==null){m=p.child;for(var y=v.firstContext;y!==null;){if(y.context===l){if(p.tag===1){y=Tl(-1,a&-a),y.tag=2;var S=p.updateQueue;if(S!==null){S=S.shared;var C=S.pending;C===null?y.next=y:(y.next=C.next,C.next=y),S.pending=y}}p.lanes|=a,y=p.alternate,y!==null&&(y.lanes|=a),HN(p.return,a,i),v.lanes|=a;break}y=y.next}}else if(p.tag===10)m=p.type===i.type?null:p.child;else if(p.tag===18){if(m=p.return,m===null)throw Error(Ke(341));m.lanes|=a,v=m.alternate,v!==null&&(v.lanes|=a),HN(m,a,i),m=p.sibling}else m=p.child;if(m!==null)m.return=p;else for(m=p;m!==null;){if(m===i){m=null;break}if(p=m.sibling,p!==null){p.return=m.return,m=p;break}m=m.return}p=m}Oo(e,i,u.children,a),i=i.child}return i;case 9:return u=i.type,l=i.pendingProps.children,Kf(i,a),u=Ea(u),l=l(u),i.flags|=1,Oo(e,i,l,a),i.child;case 14:return l=i.type,u=Va(l,i.pendingProps),u=Va(l.type,u),$5(e,i,l,u,a);case 15:return bH(e,i,i.type,i.pendingProps,a);case 17:return l=i.type,u=i.pendingProps,u=i.elementType===l?u:Va(l,u),nT(e,i),i.tag=1,is(l)?(e=!0,GT(i)):e=!1,Kf(i,a),QG(i,l,u),KN(i,l,u,a),JN(null,i,l,!0,e,a);case 19:return AH(e,i,a);case 22:return CH(e,i,a)}throw Error(Ke(156,i.tag))};function GH(e,i){return gG(e,i)}function Eue(e,i,a,l){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pa(e,i,a,l){return new Eue(e,i,a,l)}function nD(e){return e=e.prototype,!(!e||!e.isReactComponent)}function yue(e){if(typeof e=="function")return nD(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Sk)return 11;if(e===Tk)return 14}return 2}function eu(e,i){var a=e.alternate;return a===null?(a=pa(e.tag,i,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=i,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,i=e.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function oT(e,i,a,l,u,p){var m=2;if(l=e,typeof e=="function")nD(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case yf:return fh(a.children,u,p,i);case yk:m=8,u|=8;break;case _N:return e=pa(12,a,i,u|2),e.elementType=_N,e.lanes=p,e;case vN:return e=pa(13,a,i,u),e.elementType=vN,e.lanes=p,e;case EN:return e=pa(19,a,i,u),e.elementType=EN,e.lanes=p,e;case Zz:return Fb(a,u,p,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xz:m=10;break e;case Qz:m=9;break e;case Sk:m=11;break e;case Tk:m=14;break e;case jd:m=16,l=null;break e}throw Error(Ke(130,e==null?e:typeof e,""))}return i=pa(m,a,i,u),i.elementType=e,i.type=l,i.lanes=p,i}function fh(e,i,a,l){return e=pa(7,e,l,i),e.lanes=a,e}function Fb(e,i,a,l){return e=pa(22,e,l,i),e.elementType=Zz,e.lanes=a,e.stateNode={isHidden:!1},e}function sO(e,i,a){return e=pa(6,e,null,i),e.lanes=a,e}function aO(e,i,a){return i=pa(4,e.children!==null?e.children:[],e.key,i),i.lanes=a,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function Sue(e,i,a,l,u){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=B1(0),this.expirationTimes=B1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=B1(0),this.identifierPrefix=l,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function rD(e,i,a,l,u,p,m,v,y){return e=new Sue(e,i,a,v,y),i===1?(i=1,p===!0&&(i|=8)):i=0,p=pa(3,null,null,i),e.current=p,p.stateNode=e,p.memoizedState={element:l,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vk(p),e}function Tue(e,i,a){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ef,key:l==null?null:""+l,children:e,containerInfo:i,implementation:a}}function HH(e){if(!e)return su;e=e._reactInternals;e:{if(Fh(e)!==e||e.tag!==1)throw Error(Ke(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(is(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(Ke(171))}if(e.tag===1){var a=e.type;if(is(a))return GG(e,a,i)}return i}function $H(e,i,a,l,u,p,m,v,y){return e=rD(a,l,!0,e,u,p,m,v,y),e.context=HH(null),a=e.current,l=Po(),u=Zd(a),p=Tl(l,u),p.callback=i??null,Xd(a,p,u),e.current.lanes=u,Qv(e,u,l),os(e,l),e}function Vb(e,i,a,l){var u=i.current,p=Po(),m=Zd(u);return a=HH(a),i.context===null?i.context=a:i.pendingContext=a,i=Tl(p,m),i.payload={element:e},l=l===void 0?null:l,l!==null&&(i.callback=l),e=Xd(u,i,m),e!==null&&(Ha(e,u,m,p),ZS(e,u,m)),m}function rb(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function i6(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<i?a:i}}function iD(e,i){i6(e,i),(e=e.alternate)&&i6(e,i)}function bue(){return null}var KH=typeof reportError=="function"?reportError:function(e){console.error(e)};function oD(e){this._internalRoot=e}Bb.prototype.render=oD.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(Ke(409));Vb(e,i,null,null)};Bb.prototype.unmount=oD.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Ah(function(){Vb(null,e,null,null)}),i[Nl]=null}};function Bb(e){this._internalRoot=e}Bb.prototype.unstable_scheduleHydration=function(e){if(e){var i=bG();e={blockedOn:null,target:e,priority:i};for(var a=0;a<Bd.length&&i!==0&&i<Bd[a].priority;a++);Bd.splice(a,0,e),a===0&&wG(e)}};function sD(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Wb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function o6(){}function Cue(e,i,a,l,u){if(u){if(typeof l=="function"){var p=l;l=function(){var S=rb(m);p.call(S)}}var m=$H(i,l,e,0,null,!1,!1,"",o6);return e._reactRootContainer=m,e[Nl]=m.current,yv(e.nodeType===8?e.parentNode:e),Ah(),m}for(;u=e.lastChild;)e.removeChild(u);if(typeof l=="function"){var v=l;l=function(){var S=rb(y);v.call(S)}}var y=rD(e,0,!1,null,null,!1,!1,"",o6);return e._reactRootContainer=y,e[Nl]=y.current,yv(e.nodeType===8?e.parentNode:e),Ah(function(){Vb(i,y,a,l)}),y}function zb(e,i,a,l,u){var p=a._reactRootContainer;if(p){var m=p;if(typeof u=="function"){var v=u;u=function(){var y=rb(m);v.call(y)}}Vb(i,m,e,u)}else m=Cue(a,i,e,u,l);return rb(m)}SG=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var a=x_(i.pendingLanes);a!==0&&(wk(i,a|1),os(i,oi()),!(Rn&6)&&(gm=oi()+500,pu()))}break;case 13:Ah(function(){var l=Pl(e,1);if(l!==null){var u=Po();Ha(l,e,1,u)}}),iD(e,1)}};Rk=function(e){if(e.tag===13){var i=Pl(e,134217728);if(i!==null){var a=Po();Ha(i,e,134217728,a)}iD(e,134217728)}};TG=function(e){if(e.tag===13){var i=Zd(e),a=Pl(e,i);if(a!==null){var l=Po();Ha(a,e,i,l)}iD(e,i)}};bG=function(){return Jn};CG=function(e,i){var a=Jn;try{return Jn=e,i()}finally{Jn=a}};ON=function(e,i,a){switch(i){case"input":if(TN(e,a),i=a.name,a.type==="radio"&&i!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var l=a[i];if(l!==e&&l.form===e.form){var u=Db(l);if(!u)throw Error(Ke(90));tG(l),TN(l,u)}}}break;case"textarea":rG(e,a);break;case"select":i=a.value,i!=null&&zf(e,!!a.multiple,i,!1)}};dG=Zk;uG=Ah;var wue={usingClientEntryPoint:!1,Events:[eE,Cf,Db,cG,lG,Zk]},T_={findFiberByHostInstance:ch,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Rue={bundleType:T_.bundleType,version:T_.version,rendererPackageName:T_.rendererPackageName,rendererConfig:T_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ll.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fG(e),e===null?null:e.stateNode},findFiberByHostInstance:T_.findFiberByHostInstance||bue,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var RS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!RS.isDisabled&&RS.supportsFiber)try{Ob=RS.inject(Rue),Ic=RS}catch{}}Ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wue;Ms.createPortal=function(e,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sD(i))throw Error(Ke(200));return Tue(e,i,null,a)};Ms.createRoot=function(e,i){if(!sD(e))throw Error(Ke(299));var a=!1,l="",u=KH;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(l=i.identifierPrefix),i.onRecoverableError!==void 0&&(u=i.onRecoverableError)),i=rD(e,1,!1,null,null,a,!1,l,u),e[Nl]=i.current,yv(e.nodeType===8?e.parentNode:e),new oD(i)};Ms.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(Ke(188)):(e=Object.keys(e).join(","),Error(Ke(268,e)));return e=fG(i),e=e===null?null:e.stateNode,e};Ms.flushSync=function(e){return Ah(e)};Ms.hydrate=function(e,i,a){if(!Wb(i))throw Error(Ke(200));return zb(null,e,i,!0,a)};Ms.hydrateRoot=function(e,i,a){if(!sD(e))throw Error(Ke(405));var l=a!=null&&a.hydratedSources||null,u=!1,p="",m=KH;if(a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onRecoverableError!==void 0&&(m=a.onRecoverableError)),i=$H(i,null,e,1,a??null,u,!1,p,m),e[Nl]=i.current,yv(e),l)for(e=0;e<l.length;e++)a=l[e],u=a._getVersion,u=u(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,u]:i.mutableSourceEagerHydrationData.push(a,u);return new Bb(i)};Ms.render=function(e,i,a){if(!Wb(i))throw Error(Ke(200));return zb(null,e,i,!1,a)};Ms.unmountComponentAtNode=function(e){if(!Wb(e))throw Error(Ke(40));return e._reactRootContainer?(Ah(function(){zb(null,null,e,!1,function(){e._reactRootContainer=null,e[Nl]=null})}),!0):!1};Ms.unstable_batchedUpdates=Zk;Ms.unstable_renderSubtreeIntoContainer=function(e,i,a,l){if(!Wb(a))throw Error(Ke(200));if(e==null||e._reactInternals===void 0)throw Error(Ke(38));return zb(e,i,a,!1,l)};Ms.version="18.2.0-next-9e3b772b8-20220608";function YH(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(YH)}catch(e){console.error(e)}}YH(),$z.exports=Ms;var aD=$z.exports,s6=aD;mN.createRoot=s6.createRoot,mN.hydrateRoot=s6.hydrateRoot;function Iue(e){if(e.sheet)return e.sheet;for(var i=0;i<document.styleSheets.length;i++)if(document.styleSheets[i].ownerNode===e)return document.styleSheets[i]}function Aue(e){var i=document.createElement("style");return i.setAttribute("data-emotion",e.key),e.nonce!==void 0&&i.setAttribute("nonce",e.nonce),i.appendChild(document.createTextNode("")),i.setAttribute("data-s",""),i}var Oue=function(){function e(a){var l=this;this._insertTag=function(u){var p;l.tags.length===0?l.insertionPoint?p=l.insertionPoint.nextSibling:l.prepend?p=l.container.firstChild:p=l.before:p=l.tags[l.tags.length-1].nextSibling,l.container.insertBefore(u,p),l.tags.push(u)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var i=e.prototype;return i.hydrate=function(l){l.forEach(this._insertTag)},i.insert=function(l){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Aue(this));var u=this.tags[this.tags.length-1];if(this.isSpeedy){var p=Iue(u);try{p.insertRule(l,p.cssRules.length)}catch{}}else u.appendChild(document.createTextNode(l));this.ctr++},i.flush=function(){this.tags.forEach(function(l){return l.parentNode&&l.parentNode.removeChild(l)}),this.tags=[],this.ctr=0},e}(),co="-ms-",ib="-moz-",xn="-webkit-",qH="comm",cD="rule",lD="decl",Nue="@import",JH="@keyframes",Pue="@layer",kue=Math.abs,Gb=String.fromCharCode,Due=Object.assign;function xue(e,i){return $i(e,0)^45?(((i<<2^$i(e,0))<<2^$i(e,1))<<2^$i(e,2))<<2^$i(e,3):0}function XH(e){return e.trim()}function Lue(e,i){return(e=i.exec(e))?e[0]:e}function Ln(e,i,a){return e.replace(i,a)}function cP(e,i){return e.indexOf(i)}function $i(e,i){return e.charCodeAt(i)|0}function Ov(e,i,a){return e.slice(i,a)}function yc(e){return e.length}function dD(e){return e.length}function IS(e,i){return i.push(e),e}function Mue(e,i){return e.map(i).join("")}var Hb=1,_m=1,QH=0,ls=0,_i=0,Pm="";function $b(e,i,a,l,u,p,m){return{value:e,root:i,parent:a,type:l,props:u,children:p,line:Hb,column:_m,length:m,return:""}}function b_(e,i){return Due($b("",null,null,"",null,null,0),e,{length:-e.length},i)}function Uue(){return _i}function jue(){return _i=ls>0?$i(Pm,--ls):0,_m--,_i===10&&(_m=1,Hb--),_i}function Ps(){return _i=ls<QH?$i(Pm,ls++):0,_m++,_i===10&&(_m=1,Hb++),_i}function Oc(){return $i(Pm,ls)}function sT(){return ls}function nE(e,i){return Ov(Pm,e,i)}function Nv(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ZH(e){return Hb=_m=1,QH=yc(Pm=e),ls=0,[]}function e9(e){return Pm="",e}function aT(e){return XH(nE(ls-1,lP(e===91?e+2:e===40?e+1:e)))}function Fue(e){for(;(_i=Oc())&&_i<33;)Ps();return Nv(e)>2||Nv(_i)>3?"":" "}function Vue(e,i){for(;--i&&Ps()&&!(_i<48||_i>102||_i>57&&_i<65||_i>70&&_i<97););return nE(e,sT()+(i<6&&Oc()==32&&Ps()==32))}function lP(e){for(;Ps();)switch(_i){case e:return ls;case 34:case 39:e!==34&&e!==39&&lP(_i);break;case 40:e===41&&lP(e);break;case 92:Ps();break}return ls}function Bue(e,i){for(;Ps()&&e+_i!==57;)if(e+_i===84&&Oc()===47)break;return"/*"+nE(i,ls-1)+"*"+Gb(e===47?e:Ps())}function Wue(e){for(;!Nv(Oc());)Ps();return nE(e,ls)}function zue(e){return e9(cT("",null,null,null,[""],e=ZH(e),0,[0],e))}function cT(e,i,a,l,u,p,m,v,y){for(var S=0,C=0,R=m,N=0,x=0,U=0,M=1,z=1,V=1,W=0,H="",q=u,ee=p,oe=l,se=H;z;)switch(U=W,W=Ps()){case 40:if(U!=108&&$i(se,R-1)==58){cP(se+=Ln(aT(W),"&","&\f"),"&\f")!=-1&&(V=-1);break}case 34:case 39:case 91:se+=aT(W);break;case 9:case 10:case 13:case 32:se+=Fue(U);break;case 92:se+=Vue(sT()-1,7);continue;case 47:switch(Oc()){case 42:case 47:IS(Gue(Bue(Ps(),sT()),i,a),y);break;default:se+="/"}break;case 123*M:v[S++]=yc(se)*V;case 125*M:case 59:case 0:switch(W){case 0:case 125:z=0;case 59+C:V==-1&&(se=Ln(se,/\f/g,"")),x>0&&yc(se)-R&&IS(x>32?c6(se+";",l,a,R-1):c6(Ln(se," ","")+";",l,a,R-2),y);break;case 59:se+=";";default:if(IS(oe=a6(se,i,a,S,C,u,v,H,q=[],ee=[],R),p),W===123)if(C===0)cT(se,i,oe,oe,q,p,R,v,ee);else switch(N===99&&$i(se,3)===110?100:N){case 100:case 108:case 109:case 115:cT(e,oe,oe,l&&IS(a6(e,oe,oe,0,0,u,v,H,u,q=[],R),ee),u,ee,R,v,l?q:ee);break;default:cT(se,oe,oe,oe,[""],ee,0,v,ee)}}S=C=x=0,M=V=1,H=se="",R=m;break;case 58:R=1+yc(se),x=U;default:if(M<1){if(W==123)--M;else if(W==125&&M++==0&&jue()==125)continue}switch(se+=Gb(W),W*M){case 38:V=C>0?1:(se+="\f",-1);break;case 44:v[S++]=(yc(se)-1)*V,V=1;break;case 64:Oc()===45&&(se+=aT(Ps())),N=Oc(),C=R=yc(H=se+=Wue(sT())),W++;break;case 45:U===45&&yc(se)==2&&(M=0)}}return p}function a6(e,i,a,l,u,p,m,v,y,S,C){for(var R=u-1,N=u===0?p:[""],x=dD(N),U=0,M=0,z=0;U<l;++U)for(var V=0,W=Ov(e,R+1,R=kue(M=m[U])),H=e;V<x;++V)(H=XH(M>0?N[V]+" "+W:Ln(W,/&\f/g,N[V])))&&(y[z++]=H);return $b(e,i,a,u===0?cD:v,y,S,C)}function Gue(e,i,a){return $b(e,i,a,qH,Gb(Uue()),Ov(e,2,-2),0)}function c6(e,i,a,l){return $b(e,i,a,lD,Ov(e,0,l),Ov(e,l+1,-1),l)}function qf(e,i){for(var a="",l=dD(e),u=0;u<l;u++)a+=i(e[u],u,e,i)||"";return a}function Hue(e,i,a,l){switch(e.type){case Pue:if(e.children.length)break;case Nue:case lD:return e.return=e.return||e.value;case qH:return"";case JH:return e.return=e.value+"{"+qf(e.children,l)+"}";case cD:e.value=e.props.join(",")}return yc(a=qf(e.children,l))?e.return=e.value+"{"+a+"}":""}function $ue(e){var i=dD(e);return function(a,l,u,p){for(var m="",v=0;v<i;v++)m+=e[v](a,l,u,p)||"";return m}}function Kue(e){return function(i){i.root||(i=i.return)&&e(i)}}var l6=function(i){var a=new WeakMap;return function(l){if(a.has(l))return a.get(l);var u=i(l);return a.set(l,u),u}};function t9(e){var i=Object.create(null);return function(a){return i[a]===void 0&&(i[a]=e(a)),i[a]}}var Yue=function(i,a,l){for(var u=0,p=0;u=p,p=Oc(),u===38&&p===12&&(a[l]=1),!Nv(p);)Ps();return nE(i,ls)},que=function(i,a){var l=-1,u=44;do switch(Nv(u)){case 0:u===38&&Oc()===12&&(a[l]=1),i[l]+=Yue(ls-1,a,l);break;case 2:i[l]+=aT(u);break;case 4:if(u===44){i[++l]=Oc()===58?"&\f":"",a[l]=i[l].length;break}default:i[l]+=Gb(u)}while(u=Ps());return i},Jue=function(i,a){return e9(que(ZH(i),a))},d6=new WeakMap,Xue=function(i){if(!(i.type!=="rule"||!i.parent||i.length<1)){for(var a=i.value,l=i.parent,u=i.column===l.column&&i.line===l.line;l.type!=="rule";)if(l=l.parent,!l)return;if(!(i.props.length===1&&a.charCodeAt(0)!==58&&!d6.get(l))&&!u){d6.set(i,!0);for(var p=[],m=Jue(a,p),v=l.props,y=0,S=0;y<m.length;y++)for(var C=0;C<v.length;C++,S++)i.props[S]=p[y]?m[y].replace(/&\f/g,v[C]):v[C]+" "+m[y]}}},Que=function(i){if(i.type==="decl"){var a=i.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(i.return="",i.value="")}};function n9(e,i){switch(xue(e,i)){case 5103:return xn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return xn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return xn+e+ib+e+co+e+e;case 6828:case 4268:return xn+e+co+e+e;case 6165:return xn+e+co+"flex-"+e+e;case 5187:return xn+e+Ln(e,/(\w+).+(:[^]+)/,xn+"box-$1$2"+co+"flex-$1$2")+e;case 5443:return xn+e+co+"flex-item-"+Ln(e,/flex-|-self/,"")+e;case 4675:return xn+e+co+"flex-line-pack"+Ln(e,/align-content|flex-|-self/,"")+e;case 5548:return xn+e+co+Ln(e,"shrink","negative")+e;case 5292:return xn+e+co+Ln(e,"basis","preferred-size")+e;case 6060:return xn+"box-"+Ln(e,"-grow","")+xn+e+co+Ln(e,"grow","positive")+e;case 4554:return xn+Ln(e,/([^-])(transform)/g,"$1"+xn+"$2")+e;case 6187:return Ln(Ln(Ln(e,/(zoom-|grab)/,xn+"$1"),/(image-set)/,xn+"$1"),e,"")+e;case 5495:case 3959:return Ln(e,/(image-set\([^]*)/,xn+"$1$`$1");case 4968:return Ln(Ln(e,/(.+:)(flex-)?(.*)/,xn+"box-pack:$3"+co+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+xn+e+e;case 4095:case 3583:case 4068:case 2532:return Ln(e,/(.+)-inline(.+)/,xn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(yc(e)-1-i>6)switch($i(e,i+1)){case 109:if($i(e,i+4)!==45)break;case 102:return Ln(e,/(.+:)(.+)-([^]+)/,"$1"+xn+"$2-$3$1"+ib+($i(e,i+3)==108?"$3":"$2-$3"))+e;case 115:return~cP(e,"stretch")?n9(Ln(e,"stretch","fill-available"),i)+e:e}break;case 4949:if($i(e,i+1)!==115)break;case 6444:switch($i(e,yc(e)-3-(~cP(e,"!important")&&10))){case 107:return Ln(e,":",":"+xn)+e;case 101:return Ln(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+xn+($i(e,14)===45?"inline-":"")+"box$3$1"+xn+"$2$3$1"+co+"$2box$3")+e}break;case 5936:switch($i(e,i+11)){case 114:return xn+e+co+Ln(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return xn+e+co+Ln(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return xn+e+co+Ln(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return xn+e+co+e+e}return e}var Zue=function(i,a,l,u){if(i.length>-1&&!i.return)switch(i.type){case lD:i.return=n9(i.value,i.length);break;case JH:return qf([b_(i,{value:Ln(i.value,"@","@"+xn)})],u);case cD:if(i.length)return Mue(i.props,function(p){switch(Lue(p,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return qf([b_(i,{props:[Ln(p,/:(read-\w+)/,":"+ib+"$1")]})],u);case"::placeholder":return qf([b_(i,{props:[Ln(p,/:(plac\w+)/,":"+xn+"input-$1")]}),b_(i,{props:[Ln(p,/:(plac\w+)/,":"+ib+"$1")]}),b_(i,{props:[Ln(p,/:(plac\w+)/,co+"input-$1")]})],u)}return""})}},ehe=[Zue],the=function(i){var a=i.key;if(a==="css"){var l=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(l,function(M){var z=M.getAttribute("data-emotion");z.indexOf(" ")!==-1&&(document.head.appendChild(M),M.setAttribute("data-s",""))})}var u=i.stylisPlugins||ehe,p={},m,v=[];m=i.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(M){for(var z=M.getAttribute("data-emotion").split(" "),V=1;V<z.length;V++)p[z[V]]=!0;v.push(M)});var y,S=[Xue,Que];{var C,R=[Hue,Kue(function(M){C.insert(M)})],N=$ue(S.concat(u,R)),x=function(z){return qf(zue(z),N)};y=function(z,V,W,H){C=W,x(z?z+"{"+V.styles+"}":V.styles),H&&(U.inserted[V.name]=!0)}}var U={key:a,sheet:new Oue({key:a,container:m,nonce:i.nonce,speedy:i.speedy,prepend:i.prepend,insertionPoint:i.insertionPoint}),nonce:i.nonce,inserted:p,registered:{},insert:y};return U.sheet.hydrate(v),U};function Oh(){return Oh=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},Oh.apply(this,arguments)}var r9={exports:{}},Xn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ui=typeof Symbol=="function"&&Symbol.for,uD=Ui?Symbol.for("react.element"):60103,hD=Ui?Symbol.for("react.portal"):60106,Kb=Ui?Symbol.for("react.fragment"):60107,Yb=Ui?Symbol.for("react.strict_mode"):60108,qb=Ui?Symbol.for("react.profiler"):60114,Jb=Ui?Symbol.for("react.provider"):60109,Xb=Ui?Symbol.for("react.context"):60110,pD=Ui?Symbol.for("react.async_mode"):60111,Qb=Ui?Symbol.for("react.concurrent_mode"):60111,Zb=Ui?Symbol.for("react.forward_ref"):60112,eC=Ui?Symbol.for("react.suspense"):60113,nhe=Ui?Symbol.for("react.suspense_list"):60120,tC=Ui?Symbol.for("react.memo"):60115,nC=Ui?Symbol.for("react.lazy"):60116,rhe=Ui?Symbol.for("react.block"):60121,ihe=Ui?Symbol.for("react.fundamental"):60117,ohe=Ui?Symbol.for("react.responder"):60118,she=Ui?Symbol.for("react.scope"):60119;function js(e){if(typeof e=="object"&&e!==null){var i=e.$$typeof;switch(i){case uD:switch(e=e.type,e){case pD:case Qb:case Kb:case qb:case Yb:case eC:return e;default:switch(e=e&&e.$$typeof,e){case Xb:case Zb:case nC:case tC:case Jb:return e;default:return i}}case hD:return i}}}function i9(e){return js(e)===Qb}Xn.AsyncMode=pD;Xn.ConcurrentMode=Qb;Xn.ContextConsumer=Xb;Xn.ContextProvider=Jb;Xn.Element=uD;Xn.ForwardRef=Zb;Xn.Fragment=Kb;Xn.Lazy=nC;Xn.Memo=tC;Xn.Portal=hD;Xn.Profiler=qb;Xn.StrictMode=Yb;Xn.Suspense=eC;Xn.isAsyncMode=function(e){return i9(e)||js(e)===pD};Xn.isConcurrentMode=i9;Xn.isContextConsumer=function(e){return js(e)===Xb};Xn.isContextProvider=function(e){return js(e)===Jb};Xn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===uD};Xn.isForwardRef=function(e){return js(e)===Zb};Xn.isFragment=function(e){return js(e)===Kb};Xn.isLazy=function(e){return js(e)===nC};Xn.isMemo=function(e){return js(e)===tC};Xn.isPortal=function(e){return js(e)===hD};Xn.isProfiler=function(e){return js(e)===qb};Xn.isStrictMode=function(e){return js(e)===Yb};Xn.isSuspense=function(e){return js(e)===eC};Xn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Kb||e===Qb||e===qb||e===Yb||e===eC||e===nhe||typeof e=="object"&&e!==null&&(e.$$typeof===nC||e.$$typeof===tC||e.$$typeof===Jb||e.$$typeof===Xb||e.$$typeof===Zb||e.$$typeof===ihe||e.$$typeof===ohe||e.$$typeof===she||e.$$typeof===rhe)};Xn.typeOf=js;r9.exports=Xn;var ahe=r9.exports,o9=ahe,che={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},lhe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s9={};s9[o9.ForwardRef]=che;s9[o9.Memo]=lhe;var dhe=!0;function uhe(e,i,a){var l="";return a.split(" ").forEach(function(u){e[u]!==void 0?i.push(e[u]+";"):l+=u+" "}),l}var a9=function(i,a,l){var u=i.key+"-"+a.name;(l===!1||dhe===!1)&&i.registered[u]===void 0&&(i.registered[u]=a.styles)},c9=function(i,a,l){a9(i,a,l);var u=i.key+"-"+a.name;if(i.inserted[a.name]===void 0){var p=a;do i.insert(a===p?"."+u:"",p,i.sheet,!0),p=p.next;while(p!==void 0)}};function hhe(e){for(var i=0,a,l=0,u=e.length;u>=4;++l,u-=4)a=e.charCodeAt(l)&255|(e.charCodeAt(++l)&255)<<8|(e.charCodeAt(++l)&255)<<16|(e.charCodeAt(++l)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,i=(a&65535)*1540483477+((a>>>16)*59797<<16)^(i&65535)*1540483477+((i>>>16)*59797<<16);switch(u){case 3:i^=(e.charCodeAt(l+2)&255)<<16;case 2:i^=(e.charCodeAt(l+1)&255)<<8;case 1:i^=e.charCodeAt(l)&255,i=(i&65535)*1540483477+((i>>>16)*59797<<16)}return i^=i>>>13,i=(i&65535)*1540483477+((i>>>16)*59797<<16),((i^i>>>15)>>>0).toString(36)}var phe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},fhe=/[A-Z]|^ms/g,mhe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,l9=function(i){return i.charCodeAt(1)===45},u6=function(i){return i!=null&&typeof i!="boolean"},cO=t9(function(e){return l9(e)?e:e.replace(fhe,"-$&").toLowerCase()}),h6=function(i,a){switch(i){case"animation":case"animationName":if(typeof a=="string")return a.replace(mhe,function(l,u,p){return Sc={name:u,styles:p,next:Sc},u})}return phe[i]!==1&&!l9(i)&&typeof a=="number"&&a!==0?a+"px":a};function Pv(e,i,a){if(a==null)return"";if(a.__emotion_styles!==void 0)return a;switch(typeof a){case"boolean":return"";case"object":{if(a.anim===1)return Sc={name:a.name,styles:a.styles,next:Sc},a.name;if(a.styles!==void 0){var l=a.next;if(l!==void 0)for(;l!==void 0;)Sc={name:l.name,styles:l.styles,next:Sc},l=l.next;var u=a.styles+";";return u}return ghe(e,i,a)}case"function":{if(e!==void 0){var p=Sc,m=a(e);return Sc=p,Pv(e,i,m)}break}}if(i==null)return a;var v=i[a];return v!==void 0?v:a}function ghe(e,i,a){var l="";if(Array.isArray(a))for(var u=0;u<a.length;u++)l+=Pv(e,i,a[u])+";";else for(var p in a){var m=a[p];if(typeof m!="object")i!=null&&i[m]!==void 0?l+=p+"{"+i[m]+"}":u6(m)&&(l+=cO(p)+":"+h6(p,m)+";");else if(Array.isArray(m)&&typeof m[0]=="string"&&(i==null||i[m[0]]===void 0))for(var v=0;v<m.length;v++)u6(m[v])&&(l+=cO(p)+":"+h6(p,m[v])+";");else{var y=Pv(e,i,m);switch(p){case"animation":case"animationName":{l+=cO(p)+":"+y+";";break}default:l+=p+"{"+y+"}"}}}return l}var p6=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Sc,fD=function(i,a,l){if(i.length===1&&typeof i[0]=="object"&&i[0]!==null&&i[0].styles!==void 0)return i[0];var u=!0,p="";Sc=void 0;var m=i[0];m==null||m.raw===void 0?(u=!1,p+=Pv(l,a,m)):p+=m[0];for(var v=1;v<i.length;v++)p+=Pv(l,a,i[v]),u&&(p+=m[v]);p6.lastIndex=0;for(var y="",S;(S=p6.exec(p))!==null;)y+="-"+S[1];var C=hhe(p)+y;return{name:C,styles:p,next:Sc}},_he=function(i){return i()},d9=fN.useInsertionEffect?fN.useInsertionEffect:!1,vhe=d9||_he,f6=d9||F.useLayoutEffect,u9=F.createContext(typeof HTMLElement<"u"?the({key:"css"}):null);u9.Provider;var h9=function(i){return F.forwardRef(function(a,l){var u=F.useContext(u9);return i(a,u,l)})},kv=F.createContext({}),Ehe=function(i,a){if(typeof a=="function"){var l=a(i);return l}return Oh({},i,a)},yhe=l6(function(e){return l6(function(i){return Ehe(e,i)})}),She=function(i){var a=F.useContext(kv);return i.theme!==a&&(a=yhe(a)(i.theme)),F.createElement(kv.Provider,{value:a},i.children)},rC=h9(function(e,i){var a=e.styles,l=fD([a],void 0,F.useContext(kv)),u=F.useRef();return f6(function(){var p=i.key+"-global",m=new i.sheet.constructor({key:p,nonce:i.sheet.nonce,container:i.sheet.container,speedy:i.sheet.isSpeedy}),v=!1,y=document.querySelector('style[data-emotion="'+p+" "+l.name+'"]');return i.sheet.tags.length&&(m.before=i.sheet.tags[0]),y!==null&&(v=!0,y.setAttribute("data-emotion",p),m.hydrate([y])),u.current=[m,v],function(){m.flush()}},[i]),f6(function(){var p=u.current,m=p[0],v=p[1];if(v){p[1]=!1;return}if(l.next!==void 0&&c9(i,l.next,!0),m.tags.length){var y=m.tags[m.tags.length-1].nextElementSibling;m.before=y,m.flush()}i.insert("",l,m,!1)},[i,l.name]),null});function The(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return fD(i)}var iC=function(){var i=The.apply(void 0,arguments),a="animation-"+i.name;return{name:a,styles:"@keyframes "+a+"{"+i.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},p9=String.raw,f9=p9`
  :root,
  :host {
    --chakra-vh: 100vh;
  }

  @supports (height: -webkit-fill-available) {
    :root,
    :host {
      --chakra-vh: -webkit-fill-available;
    }
  }

  @supports (height: -moz-fill-available) {
    :root,
    :host {
      --chakra-vh: -moz-fill-available;
    }
  }

  @supports (height: 100dvh) {
    :root,
    :host {
      --chakra-vh: 100dvh;
    }
  }
`,bhe=()=>b.jsx(rC,{styles:f9}),Che=({scope:e=""})=>b.jsx(rC,{styles:p9`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        -moz-osx-font-smoothing: grayscale;
        touch-action: manipulation;
      }

      body {
        position: relative;
        min-height: 100%;
        margin: 0;
        font-feature-settings: "kern";
      }

      ${e} :where(*, *::before, *::after) {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
        word-wrap: break-word;
      }

      main {
        display: block;
      }

      ${e} hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      ${e} :where(pre, code, kbd,samp) {
        font-family: SFMono-Regular, Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      ${e} a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      ${e} abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      ${e} :where(b, strong) {
        font-weight: bold;
      }

      ${e} small {
        font-size: 80%;
      }

      ${e} :where(sub,sup) {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      ${e} sub {
        bottom: -0.25em;
      }

      ${e} sup {
        top: -0.5em;
      }

      ${e} img {
        border-style: none;
      }

      ${e} :where(button, input, optgroup, select, textarea) {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      ${e} :where(button, input) {
        overflow: visible;
      }

      ${e} :where(button, select) {
        text-transform: none;
      }

      ${e} :where(
          button::-moz-focus-inner,
          [type="button"]::-moz-focus-inner,
          [type="reset"]::-moz-focus-inner,
          [type="submit"]::-moz-focus-inner
        ) {
        border-style: none;
        padding: 0;
      }

      ${e} fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      ${e} legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      ${e} progress {
        vertical-align: baseline;
      }

      ${e} textarea {
        overflow: auto;
      }

      ${e} :where([type="checkbox"], [type="radio"]) {
        box-sizing: border-box;
        padding: 0;
      }

      ${e} input[type="number"]::-webkit-inner-spin-button,
      ${e} input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      ${e} input[type="number"] {
        -moz-appearance: textfield;
      }

      ${e} input[type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      ${e} input[type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ${e} ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      ${e} details {
        display: block;
      }

      ${e} summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      ${e} :where(
          blockquote,
          dl,
          dd,
          h1,
          h2,
          h3,
          h4,
          h5,
          h6,
          hr,
          figure,
          p,
          pre
        ) {
        margin: 0;
      }

      ${e} button {
        background: transparent;
        padding: 0;
      }

      ${e} fieldset {
        margin: 0;
        padding: 0;
      }

      ${e} :where(ol, ul) {
        margin: 0;
        padding: 0;
      }

      ${e} textarea {
        resize: vertical;
      }

      ${e} :where(button, [role="button"]) {
        cursor: pointer;
      }

      ${e} button::-moz-focus-inner {
        border: 0 !important;
      }

      ${e} table {
        border-collapse: collapse;
      }

      ${e} :where(h1, h2, h3, h4, h5, h6) {
        font-size: inherit;
        font-weight: inherit;
      }

      ${e} :where(button, input, optgroup, select, textarea) {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      ${e} :where(img, svg, video, canvas, audio, iframe, embed, object) {
        display: block;
      }

      ${e} :where(img, video) {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible]
        :focus:not([data-focus-visible-added]):not(
          [data-focus-visible-disabled]
        ) {
        outline: none;
        box-shadow: none;
      }

      ${e} select::-ms-expand {
        display: none;
      }

      ${f9}
    `});function whe(e,i){return`${e} returned \`undefined\`. Seems you forgot to wrap component within ${i}`}function zn(e={}){const{name:i,strict:a=!0,hookName:l="useContext",providerName:u="Provider",errorMessage:p,defaultValue:m}=e,v=F.createContext(m);v.displayName=i;function y(){var S;const C=F.useContext(v);if(!C&&a){const R=new Error(p??whe(l,u));throw R.name="ContextError",(S=Error.captureStackTrace)==null||S.call(Error,R,y),R}return C}return[v.Provider,y,v]}var[Rhe,Ihe]=zn({strict:!1,name:"PortalManagerContext"});function m9(e){const{children:i,zIndex:a}=e;return b.jsx(Rhe,{value:{zIndex:a},children:i})}m9.displayName="PortalManager";var bl=globalThis!=null&&globalThis.document?F.useLayoutEffect:F.useEffect,[g9,Ahe]=zn({strict:!1,name:"PortalContext"}),mD="chakra-portal",Ohe=".chakra-portal",Nhe=e=>b.jsx("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:e.zIndex,top:0,left:0,right:0},children:e.children}),Phe=e=>{const{appendToParentPortal:i,children:a}=e,[l,u]=F.useState(null),p=F.useRef(null),[,m]=F.useState({});F.useEffect(()=>m({}),[]);const v=Ahe(),y=Ihe();bl(()=>{if(!l)return;const C=l.ownerDocument,R=i?v??C.body:C.body;if(!R)return;p.current=C.createElement("div"),p.current.className=mD,R.appendChild(p.current),m({});const N=p.current;return()=>{R.contains(N)&&R.removeChild(N)}},[l]);const S=y!=null&&y.zIndex?b.jsx(Nhe,{zIndex:y==null?void 0:y.zIndex,children:a}):a;return p.current?aD.createPortal(b.jsx(g9,{value:p.current,children:S}),p.current):b.jsx("span",{ref:C=>{C&&u(C)}})},khe=e=>{const{children:i,containerRef:a,appendToParentPortal:l}=e,u=a.current,p=u??(typeof window<"u"?document.body:void 0),m=F.useMemo(()=>{const y=u==null?void 0:u.ownerDocument.createElement("div");return y&&(y.className=mD),y},[u]),[,v]=F.useState({});return bl(()=>v({}),[]),bl(()=>{if(!(!m||!p))return p.appendChild(m),()=>{p.removeChild(m)}},[m,p]),p&&m?aD.createPortal(b.jsx(g9,{value:l?m:null,children:i}),m):null};function Vh(e){const i={appendToParentPortal:!0,...e},{containerRef:a,...l}=i;return a?b.jsx(khe,{containerRef:a,...l}):b.jsx(Phe,{...l})}Vh.className=mD;Vh.selector=Ohe;Vh.displayName="Portal";function Bh(){const e=F.useContext(kv);if(!e)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return e}var gD=F.createContext({});gD.displayName="ColorModeContext";function _D(){const e=F.useContext(gD);if(e===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return e}var AS={light:"chakra-ui-light",dark:"chakra-ui-dark"};function Dhe(e={}){const{preventTransition:i=!0}=e,a={setDataset:l=>{const u=i?a.preventTransition():void 0;document.documentElement.dataset.theme=l,document.documentElement.style.colorScheme=l,u==null||u()},setClassName(l){document.body.classList.add(l?AS.dark:AS.light),document.body.classList.remove(l?AS.light:AS.dark)},query(){return window.matchMedia("(prefers-color-scheme: dark)")},getSystemTheme(l){var u;return((u=a.query().matches)!=null?u:l==="dark")?"dark":"light"},addListener(l){const u=a.query(),p=m=>{l(m.matches?"dark":"light")};return typeof u.addListener=="function"?u.addListener(p):u.addEventListener("change",p),()=>{typeof u.removeListener=="function"?u.removeListener(p):u.removeEventListener("change",p)}},preventTransition(){const l=document.createElement("style");return l.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(l),()=>{window.getComputedStyle(document.body),requestAnimationFrame(()=>{requestAnimationFrame(()=>{document.head.removeChild(l)})})}}};return a}var xhe="chakra-ui-color-mode";function Lhe(e){return{ssr:!1,type:"localStorage",get(i){if(!(globalThis!=null&&globalThis.document))return i;let a;try{a=localStorage.getItem(e)||i}catch{}return a||i},set(i){try{localStorage.setItem(e,i)}catch{}}}}var Mhe=Lhe(xhe),m6=()=>{};function g6(e,i){return e.type==="cookie"&&e.ssr?e.get(i):i}function _9(e){const{value:i,children:a,options:{useSystemColorMode:l,initialColorMode:u,disableTransitionOnChange:p}={},colorModeManager:m=Mhe}=e,v=u==="dark"?"dark":"light",[y,S]=F.useState(()=>g6(m,v)),[C,R]=F.useState(()=>g6(m)),{getSystemTheme:N,setClassName:x,setDataset:U,addListener:M}=F.useMemo(()=>Dhe({preventTransition:p}),[p]),z=u==="system"&&!y?C:y,V=F.useCallback(q=>{const ee=q==="system"?N():q;S(ee),x(ee==="dark"),U(ee),m.set(ee)},[m,N,x,U]);bl(()=>{u==="system"&&R(N())},[]),F.useEffect(()=>{const q=m.get();if(q){V(q);return}if(u==="system"){V("system");return}V(v)},[m,v,u,V]);const W=F.useCallback(()=>{V(z==="dark"?"light":"dark")},[z,V]);F.useEffect(()=>{if(l)return M(V)},[l,M,V]);const H=F.useMemo(()=>({colorMode:i??z,toggleColorMode:i?m6:W,setColorMode:i?m6:V,forced:i!==void 0}),[z,W,V,i]);return b.jsx(gD.Provider,{value:H,children:a})}_9.displayName="ColorModeProvider";function v9(){const e=_D(),i=Bh();return{...e,theme:i}}function Uhe(e,i,a){var l,u;if(i==null)return i;const p=m=>{var v,y;return(y=(v=e.__cssMap)==null?void 0:v[m])==null?void 0:y.value};return(u=(l=p(i))!=null?l:p(a))!=null?u:a}function jhe(e,i,a){const l=Array.isArray(i)?i:[i],u=Array.isArray(a)?a:[a];return p=>{const m=u.filter(Boolean),v=l.map((y,S)=>{var C;const R=`${e}.${y}`;return Uhe(p,R,(C=m[S])!=null?C:y)});return Array.isArray(i)?v:v[0]}}var ot=(...e)=>e.filter(Boolean).join(" ");function Fhe(){return!1}function go(e){const i=typeof e;return e!=null&&(i==="object"||i==="function")&&!Array.isArray(e)}var rE=e=>{const{condition:i,message:a}=e;i&&Fhe()&&console.warn(a)};function ts(e,...i){return Vhe(e)?e(...i):e}var Vhe=e=>typeof e=="function",Tt=e=>e?"":void 0,Jf=e=>e?!0:void 0;function $t(...e){return function(a){e.some(l=>(l==null||l(a),a==null?void 0:a.defaultPrevented))}}function vD(...e){return function(a){e.forEach(l=>{l==null||l(a)})}}var ob={exports:{}};ob.exports;(function(e,i){var a=200,l="__lodash_hash_undefined__",u=800,p=16,m=9007199254740991,v="[object Arguments]",y="[object Array]",S="[object AsyncFunction]",C="[object Boolean]",R="[object Date]",N="[object Error]",x="[object Function]",U="[object GeneratorFunction]",M="[object Map]",z="[object Number]",V="[object Null]",W="[object Object]",H="[object Proxy]",q="[object RegExp]",ee="[object Set]",oe="[object String]",se="[object Undefined]",re="[object WeakMap]",me="[object ArrayBuffer]",pe="[object DataView]",Re="[object Float32Array]",Ze="[object Float64Array]",Qe="[object Int8Array]",Oe="[object Int16Array]",Ie="[object Int32Array]",Te="[object Uint8Array]",de="[object Uint8ClampedArray]",ue="[object Uint16Array]",be="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,rt=/^(?:0|[1-9]\d*)$/,Ye={};Ye[Re]=Ye[Ze]=Ye[Qe]=Ye[Oe]=Ye[Ie]=Ye[Te]=Ye[de]=Ye[ue]=Ye[be]=!0,Ye[v]=Ye[y]=Ye[me]=Ye[C]=Ye[pe]=Ye[R]=Ye[N]=Ye[x]=Ye[M]=Ye[z]=Ye[W]=Ye[q]=Ye[ee]=Ye[oe]=Ye[re]=!1;var Ge=typeof rn=="object"&&rn&&rn.Object===Object&&rn,_t=typeof self=="object"&&self&&self.Object===Object&&self,kt=Ge||_t||Function("return this")(),sn=i&&!i.nodeType&&i,cn=sn&&!0&&e&&!e.nodeType&&e,Gn=cn&&cn.exports===sn,vn=Gn&&Ge.process,St=function(){try{var ne=cn&&cn.require&&cn.require("util").types;return ne||vn&&vn.binding&&vn.binding("util")}catch{}}(),bt=St&&St.isTypedArray;function Qn(ne,ge,Ce){switch(Ce.length){case 0:return ne.call(ge);case 1:return ne.call(ge,Ce[0]);case 2:return ne.call(ge,Ce[0],Ce[1]);case 3:return ne.call(ge,Ce[0],Ce[1],Ce[2])}return ne.apply(ge,Ce)}function Hn(ne,ge){for(var Ce=-1,lt=Array(ne);++Ce<ne;)lt[Ce]=ge(Ce);return lt}function Ct(ne){return function(ge){return ne(ge)}}function Cn(ne,ge){return ne==null?void 0:ne[ge]}function $n(ne,ge){return function(Ce){return ne(ge(Ce))}}var on=Array.prototype,ji=Function.prototype,ai=Object.prototype,br=kt["__core-js_shared__"],Jr=ji.toString,Oi=ai.hasOwnProperty,us=function(){var ne=/[^.]+$/.exec(br&&br.keys&&br.keys.IE_PROTO||"");return ne?"Symbol(src)_1."+ne:""}(),Fc=ai.toString,Vc=Jr.call(Object),$r=RegExp("^"+Jr.call(Oi).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fi=Gn?kt.Buffer:void 0,_u=kt.Symbol,jl=kt.Uint8Array;Fi&&Fi.allocUnsafe;var vu=$n(Object.getPrototypeOf,Object),Eu=Object.create,qh=ai.propertyIsEnumerable,Um=on.splice,et=_u?_u.toStringTag:void 0,At=function(){try{var ne=Gm(Object,"defineProperty");return ne({},"",{}),ne}catch{}}(),Zt=Fi?Fi.isBuffer:void 0,Kt=Math.max,Zn=Date.now,Xi=Gm(kt,"Map"),Si=Gm(Object,"create"),ba=function(){function ne(){}return function(ge){if(!Wc(ge))return{};if(Eu)return Eu(ge);ne.prototype=ge;var Ce=new ne;return ne.prototype=void 0,Ce}}();function hs(ne){var ge=-1,Ce=ne==null?0:ne.length;for(this.clear();++ge<Ce;){var lt=ne[ge];this.set(lt[0],lt[1])}}function BC(){this.__data__=Si?Si(null):{},this.size=0}function yu(ne){var ge=this.has(ne)&&delete this.__data__[ne];return this.size-=ge?1:0,ge}function WC(ne){var ge=this.__data__;if(Si){var Ce=ge[ne];return Ce===l?void 0:Ce}return Oi.call(ge,ne)?ge[ne]:void 0}function Fl(ne){var ge=this.__data__;return Si?ge[ne]!==void 0:Oi.call(ge,ne)}function zC(ne,ge){var Ce=this.__data__;return this.size+=this.has(ne)?0:1,Ce[ne]=Si&&ge===void 0?l:ge,this}hs.prototype.clear=BC,hs.prototype.delete=yu,hs.prototype.get=WC,hs.prototype.has=Fl,hs.prototype.set=zC;function Ca(ne){var ge=-1,Ce=ne==null?0:ne.length;for(this.clear();++ge<Ce;){var lt=ne[ge];this.set(lt[0],lt[1])}}function GC(){this.__data__=[],this.size=0}function Mo(ne){var ge=this.__data__,Ce=Jh(ge,ne);if(Ce<0)return!1;var lt=ge.length-1;return Ce==lt?ge.pop():Um.call(ge,Ce,1),--this.size,!0}function HC(ne){var ge=this.__data__,Ce=Jh(ge,ne);return Ce<0?void 0:ge[Ce][1]}function $C(ne){return Jh(this.__data__,ne)>-1}function jm(ne,ge){var Ce=this.__data__,lt=Jh(Ce,ne);return lt<0?(++this.size,Ce.push([ne,ge])):Ce[lt][1]=ge,this}Ca.prototype.clear=GC,Ca.prototype.delete=Mo,Ca.prototype.get=HC,Ca.prototype.has=$C,Ca.prototype.set=jm;function Bc(ne){var ge=-1,Ce=ne==null?0:ne.length;for(this.clear();++ge<Ce;){var lt=ne[ge];this.set(lt[0],lt[1])}}function PE(){this.size=0,this.__data__={hash:new hs,map:new(Xi||Ca),string:new hs}}function kE(ne){var ge=Su(this,ne).delete(ne);return this.size-=ge?1:0,ge}function KC(ne){return Su(this,ne).get(ne)}function DE(ne){return Su(this,ne).has(ne)}function xE(ne,ge){var Ce=Su(this,ne),lt=Ce.size;return Ce.set(ne,ge),this.size+=Ce.size==lt?0:1,this}Bc.prototype.clear=PE,Bc.prototype.delete=kE,Bc.prototype.get=KC,Bc.prototype.has=DE,Bc.prototype.set=xE;function Vl(ne){var ge=this.__data__=new Ca(ne);this.size=ge.size}function YC(){this.__data__=new Ca,this.size=0}function LE(ne){var ge=this.__data__,Ce=ge.delete(ne);return this.size=ge.size,Ce}function Fm(ne){return this.__data__.get(ne)}function ME(ne){return this.__data__.has(ne)}function Bl(ne,ge){var Ce=this.__data__;if(Ce instanceof Ca){var lt=Ce.__data__;if(!Xi||lt.length<a-1)return lt.push([ne,ge]),this.size=++Ce.size,this;Ce=this.__data__=new Bc(lt)}return Ce.set(ne,ge),this.size=Ce.size,this}Vl.prototype.clear=YC,Vl.prototype.delete=LE,Vl.prototype.get=Fm,Vl.prototype.has=ME,Vl.prototype.set=Bl;function qC(ne,ge){var Ce=Jm(ne),lt=!Ce&&qm(ne),ln=!Ce&&!lt&&zE(ne),Kn=!Ce&&!lt&&!ln&&HE(ne),hr=Ce||lt||ln||Kn,Bt=hr?Hn(ne.length,String):[],pr=Bt.length;for(var ps in ne)hr&&(ps=="length"||ln&&(ps=="offset"||ps=="parent")||Kn&&(ps=="buffer"||ps=="byteLength"||ps=="byteOffset")||BE(ps,pr))||Bt.push(ps);return Bt}function Vm(ne,ge,Ce){(Ce!==void 0&&!Zh(ne[ge],Ce)||Ce===void 0&&!(ge in ne))&&Bm(ne,ge,Ce)}function Vs(ne,ge,Ce){var lt=ne[ge];(!(Oi.call(ne,ge)&&Zh(lt,Ce))||Ce===void 0&&!(ge in ne))&&Bm(ne,ge,Ce)}function Jh(ne,ge){for(var Ce=ne.length;Ce--;)if(Zh(ne[Ce][0],ge))return Ce;return-1}function Bm(ne,ge,Ce){ge=="__proto__"&&At?At(ne,ge,{configurable:!0,enumerable:!0,value:Ce,writable:!0}):ne[ge]=Ce}var ci=VE();function Xh(ne){return ne==null?ne===void 0?se:V:et&&et in Object(ne)?rw(ne):aw(ne)}function UE(ne){return Tu(ne)&&Xh(ne)==v}function JC(ne){if(!Wc(ne)||Qh(ne))return!1;var ge=ep(ne)?$r:He;return ge.test(lw(ne))}function XC(ne){return Tu(ne)&&GE(ne.length)&&!!Ye[Xh(ne)]}function Wm(ne){if(!Wc(ne))return $m(ne);var ge=Hm(ne),Ce=[];for(var lt in ne)lt=="constructor"&&(ge||!Oi.call(ne,lt))||Ce.push(lt);return Ce}function jE(ne,ge,Ce,lt,ln){ne!==ge&&ci(ge,function(Kn,hr){if(ln||(ln=new Vl),Wc(Kn))FE(ne,ge,hr,Ce,jE,lt,ln);else{var Bt=lt?lt(Ym(ne,hr),Kn,hr+"",ne,ge,ln):void 0;Bt===void 0&&(Bt=Kn),Vm(ne,hr,Bt)}},$E)}function FE(ne,ge,Ce,lt,ln,Kn,hr){var Bt=Ym(ne,Ce),pr=Ym(ge,Ce),ps=hr.get(pr);if(ps){Vm(ne,Ce,ps);return}var Eo=Kn?Kn(Bt,pr,Ce+"",ne,ge,hr):void 0,Ya=Eo===void 0;if(Ya){var tp=Jm(pr),Qm=!tp&&zE(pr),np=!tp&&!Qm&&HE(pr);Eo=pr,tp||Qm||np?Jm(Bt)?Eo=Bt:dw(Bt)?Eo=tw(Bt):Qm?(Ya=!1,Eo=ew(pr)):np?(Ya=!1,Eo=zm(pr)):Eo=[]:bu(pr)||qm(pr)?(Eo=Bt,qm(Bt)?Eo=uw(Bt):(!Wc(Bt)||ep(Bt))&&(Eo=iw(pr))):Ya=!1}Ya&&(hr.set(pr,Eo),ln(Eo,pr,lt,Kn,hr),hr.delete(pr)),Vm(ne,Ce,Eo)}function QC(ne,ge){return WE(Km(ne,ge,YE),ne+"")}var ZC=At?function(ne,ge){return At(ne,"toString",{configurable:!0,enumerable:!1,value:KE(ge),writable:!0})}:YE;function ew(ne,ge){return ne.slice()}function Wl(ne){var ge=new ne.constructor(ne.byteLength);return new jl(ge).set(new jl(ne)),ge}function zm(ne,ge){var Ce=Wl(ne.buffer);return new ne.constructor(Ce,ne.byteOffset,ne.length)}function tw(ne,ge){var Ce=-1,lt=ne.length;for(ge||(ge=Array(lt));++Ce<lt;)ge[Ce]=ne[Ce];return ge}function er(ne,ge,Ce,lt){var ln=!Ce;Ce||(Ce={});for(var Kn=-1,hr=ge.length;++Kn<hr;){var Bt=ge[Kn],pr=void 0;pr===void 0&&(pr=ne[Bt]),ln?Bm(Ce,Bt,pr):Vs(Ce,Bt,pr)}return Ce}function nw(ne){return QC(function(ge,Ce){var lt=-1,ln=Ce.length,Kn=ln>1?Ce[ln-1]:void 0,hr=ln>2?Ce[2]:void 0;for(Kn=ne.length>3&&typeof Kn=="function"?(ln--,Kn):void 0,hr&&ow(Ce[0],Ce[1],hr)&&(Kn=ln<3?void 0:Kn,ln=1),ge=Object(ge);++lt<ln;){var Bt=Ce[lt];Bt&&ne(ge,Bt,lt,Kn)}return ge})}function VE(ne){return function(ge,Ce,lt){for(var ln=-1,Kn=Object(ge),hr=lt(ge),Bt=hr.length;Bt--;){var pr=hr[++ln];if(Ce(Kn[pr],pr,Kn)===!1)break}return ge}}function Su(ne,ge){var Ce=ne.__data__;return sw(ge)?Ce[typeof ge=="string"?"string":"hash"]:Ce.map}function Gm(ne,ge){var Ce=Cn(ne,ge);return JC(Ce)?Ce:void 0}function rw(ne){var ge=Oi.call(ne,et),Ce=ne[et];try{ne[et]=void 0;var lt=!0}catch{}var ln=Fc.call(ne);return lt&&(ge?ne[et]=Ce:delete ne[et]),ln}function iw(ne){return typeof ne.constructor=="function"&&!Hm(ne)?ba(vu(ne)):{}}function BE(ne,ge){var Ce=typeof ne;return ge=ge??m,!!ge&&(Ce=="number"||Ce!="symbol"&&rt.test(ne))&&ne>-1&&ne%1==0&&ne<ge}function ow(ne,ge,Ce){if(!Wc(Ce))return!1;var lt=typeof ge;return(lt=="number"?Xm(Ce)&&BE(ge,Ce.length):lt=="string"&&ge in Ce)?Zh(Ce[ge],ne):!1}function sw(ne){var ge=typeof ne;return ge=="string"||ge=="number"||ge=="symbol"||ge=="boolean"?ne!=="__proto__":ne===null}function Qh(ne){return!!us&&us in ne}function Hm(ne){var ge=ne&&ne.constructor,Ce=typeof ge=="function"&&ge.prototype||ai;return ne===Ce}function $m(ne){var ge=[];if(ne!=null)for(var Ce in Object(ne))ge.push(Ce);return ge}function aw(ne){return Fc.call(ne)}function Km(ne,ge,Ce){return ge=Kt(ge===void 0?ne.length-1:ge,0),function(){for(var lt=arguments,ln=-1,Kn=Kt(lt.length-ge,0),hr=Array(Kn);++ln<Kn;)hr[ln]=lt[ge+ln];ln=-1;for(var Bt=Array(ge+1);++ln<ge;)Bt[ln]=lt[ln];return Bt[ge]=Ce(hr),Qn(ne,this,Bt)}}function Ym(ne,ge){if(!(ge==="constructor"&&typeof ne[ge]=="function")&&ge!="__proto__")return ne[ge]}var WE=cw(ZC);function cw(ne){var ge=0,Ce=0;return function(){var lt=Zn(),ln=p-(lt-Ce);if(Ce=lt,ln>0){if(++ge>=u)return arguments[0]}else ge=0;return ne.apply(void 0,arguments)}}function lw(ne){if(ne!=null){try{return Jr.call(ne)}catch{}try{return ne+""}catch{}}return""}function Zh(ne,ge){return ne===ge||ne!==ne&&ge!==ge}var qm=UE(function(){return arguments}())?UE:function(ne){return Tu(ne)&&Oi.call(ne,"callee")&&!qh.call(ne,"callee")},Jm=Array.isArray;function Xm(ne){return ne!=null&&GE(ne.length)&&!ep(ne)}function dw(ne){return Tu(ne)&&Xm(ne)}var zE=Zt||pw;function ep(ne){if(!Wc(ne))return!1;var ge=Xh(ne);return ge==x||ge==U||ge==S||ge==H}function GE(ne){return typeof ne=="number"&&ne>-1&&ne%1==0&&ne<=m}function Wc(ne){var ge=typeof ne;return ne!=null&&(ge=="object"||ge=="function")}function Tu(ne){return ne!=null&&typeof ne=="object"}function bu(ne){if(!Tu(ne)||Xh(ne)!=W)return!1;var ge=vu(ne);if(ge===null)return!0;var Ce=Oi.call(ge,"constructor")&&ge.constructor;return typeof Ce=="function"&&Ce instanceof Ce&&Jr.call(Ce)==Vc}var HE=bt?Ct(bt):XC;function uw(ne){return er(ne,$E(ne))}function $E(ne){return Xm(ne)?qC(ne):Wm(ne)}var hw=nw(function(ne,ge,Ce,lt){jE(ne,ge,Ce,lt)});function KE(ne){return function(){return ne}}function YE(ne){return ne}function pw(){return!1}e.exports=hw})(ob,ob.exports);var Bhe=ob.exports;const fa=Uh(Bhe);var Whe=e=>/!(important)?$/.test(e),_6=e=>typeof e=="string"?e.replace(/!(important)?$/,"").trim():e,zhe=(e,i)=>a=>{const l=String(i),u=Whe(l),p=_6(l),m=e?`${e}.${p}`:p;let v=go(a.__cssMap)&&m in a.__cssMap?a.__cssMap[m].varRef:i;return v=_6(v),u?`${v} !important`:v};function ED(e){const{scale:i,transform:a,compose:l}=e;return(p,m)=>{var v;const y=zhe(i,p)(m);let S=(v=a==null?void 0:a(y,m))!=null?v:y;return l&&(S=l(S,m)),S}}var OS=(...e)=>i=>e.reduce((a,l)=>l(a),i);function aa(e,i){return a=>{const l={property:a,scale:e};return l.transform=ED({scale:e,transform:i}),l}}var Ghe=({rtl:e,ltr:i})=>a=>a.direction==="rtl"?e:i;function Hhe(e){const{property:i,scale:a,transform:l}=e;return{scale:a,property:Ghe(i),transform:a?ED({scale:a,compose:l}):l}}var E9=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function $he(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...E9].join(" ")}function Khe(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...E9].join(" ")}var Yhe={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},qhe={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function Jhe(e){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":e,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}var Xhe={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},dP={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},Qhe=new Set(Object.values(dP)),uP=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),Zhe=e=>e.trim();function epe(e,i){if(e==null||uP.has(e))return e;if(!(hP(e)||uP.has(e)))return`url('${e}')`;const u=/(^[a-z-A-Z]+)\((.*)\)/g.exec(e),p=u==null?void 0:u[1],m=u==null?void 0:u[2];if(!p||!m)return e;const v=p.includes("-gradient")?p:`${p}-gradient`,[y,...S]=m.split(",").map(Zhe).filter(Boolean);if((S==null?void 0:S.length)===0)return e;const C=y in dP?dP[y]:y;S.unshift(C);const R=S.map(N=>{if(Qhe.has(N))return N;const x=N.indexOf(" "),[U,M]=x!==-1?[N.substr(0,x),N.substr(x+1)]:[N],z=hP(M)?M:M&&M.split(" "),V=`colors.${U}`,W=V in i.__cssMap?i.__cssMap[V].varRef:U;return z?[W,...Array.isArray(z)?z:[z]].join(" "):W});return`${v}(${R.join(", ")})`}var hP=e=>typeof e=="string"&&e.includes("(")&&e.includes(")"),tpe=(e,i)=>epe(e,i??{});function npe(e){return/^var\(--.+\)$/.test(e)}var rpe=e=>{const i=parseFloat(e.toString()),a=e.toString().replace(String(i),"");return{unitless:!a,value:i,unit:a}},_c=e=>i=>`${e}(${i})`,_n={filter(e){return e!=="auto"?e:Yhe},backdropFilter(e){return e!=="auto"?e:qhe},ring(e){return Jhe(_n.px(e))},bgClip(e){return e==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e}},transform(e){return e==="auto"?$he():e==="auto-gpu"?Khe():e},vh(e){return e==="$100vh"?"var(--chakra-vh)":e},px(e){if(e==null)return e;const{unitless:i}=rpe(e);return i||typeof e=="number"?`${e}px`:e},fraction(e){return typeof e!="number"||e>1?e:`${e*100}%`},float(e,i){const a={left:"right",right:"left"};return i.direction==="rtl"?a[e]:e},degree(e){if(npe(e)||e==null)return e;const i=typeof e=="string"&&!e.endsWith("deg");return typeof e=="number"||i?`${e}deg`:e},gradient:tpe,blur:_c("blur"),opacity:_c("opacity"),brightness:_c("brightness"),contrast:_c("contrast"),dropShadow:_c("drop-shadow"),grayscale:_c("grayscale"),hueRotate:e=>_c("hue-rotate")(_n.degree(e)),invert:_c("invert"),saturate:_c("saturate"),sepia:_c("sepia"),bgImage(e){return e==null||hP(e)||uP.has(e)?e:`url(${e})`},outline(e){const i=String(e)==="0"||String(e)==="none";return e!==null&&i?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:e}},flexDirection(e){var i;const{space:a,divide:l}=(i=Xhe[e])!=null?i:{},u={flexDirection:e};return a&&(u[a]=1),l&&(u[l]=1),u}},_e={borderWidths:aa("borderWidths"),borderStyles:aa("borderStyles"),colors:aa("colors"),borders:aa("borders"),gradients:aa("gradients",_n.gradient),radii:aa("radii",_n.px),space:aa("space",OS(_n.vh,_n.px)),spaceT:aa("space",OS(_n.vh,_n.px)),degreeT(e){return{property:e,transform:_n.degree}},prop(e,i,a){return{property:e,scale:i,...i&&{transform:ED({scale:i,transform:a})}}},propT(e,i){return{property:e,transform:i}},sizes:aa("sizes",OS(_n.vh,_n.px)),sizesT:aa("sizes",OS(_n.vh,_n.fraction)),shadows:aa("shadows"),logical:Hhe,blur:aa("blur",_n.blur)},lT={background:_e.colors("background"),backgroundColor:_e.colors("backgroundColor"),backgroundImage:_e.gradients("backgroundImage"),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:_n.bgClip},bgSize:_e.prop("backgroundSize"),bgPosition:_e.prop("backgroundPosition"),bg:_e.colors("background"),bgColor:_e.colors("backgroundColor"),bgPos:_e.prop("backgroundPosition"),bgRepeat:_e.prop("backgroundRepeat"),bgAttachment:_e.prop("backgroundAttachment"),bgGradient:_e.gradients("backgroundImage"),bgClip:{transform:_n.bgClip}};Object.assign(lT,{bgImage:lT.backgroundImage,bgImg:lT.backgroundImage});var Dn={border:_e.borders("border"),borderWidth:_e.borderWidths("borderWidth"),borderStyle:_e.borderStyles("borderStyle"),borderColor:_e.colors("borderColor"),borderRadius:_e.radii("borderRadius"),borderTop:_e.borders("borderTop"),borderBlockStart:_e.borders("borderBlockStart"),borderTopLeftRadius:_e.radii("borderTopLeftRadius"),borderStartStartRadius:_e.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:_e.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:_e.radii("borderTopRightRadius"),borderStartEndRadius:_e.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:_e.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:_e.borders("borderRight"),borderInlineEnd:_e.borders("borderInlineEnd"),borderBottom:_e.borders("borderBottom"),borderBlockEnd:_e.borders("borderBlockEnd"),borderBottomLeftRadius:_e.radii("borderBottomLeftRadius"),borderBottomRightRadius:_e.radii("borderBottomRightRadius"),borderLeft:_e.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:_e.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:_e.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:_e.borders(["borderLeft","borderRight"]),borderInline:_e.borders("borderInline"),borderY:_e.borders(["borderTop","borderBottom"]),borderBlock:_e.borders("borderBlock"),borderTopWidth:_e.borderWidths("borderTopWidth"),borderBlockStartWidth:_e.borderWidths("borderBlockStartWidth"),borderTopColor:_e.colors("borderTopColor"),borderBlockStartColor:_e.colors("borderBlockStartColor"),borderTopStyle:_e.borderStyles("borderTopStyle"),borderBlockStartStyle:_e.borderStyles("borderBlockStartStyle"),borderBottomWidth:_e.borderWidths("borderBottomWidth"),borderBlockEndWidth:_e.borderWidths("borderBlockEndWidth"),borderBottomColor:_e.colors("borderBottomColor"),borderBlockEndColor:_e.colors("borderBlockEndColor"),borderBottomStyle:_e.borderStyles("borderBottomStyle"),borderBlockEndStyle:_e.borderStyles("borderBlockEndStyle"),borderLeftWidth:_e.borderWidths("borderLeftWidth"),borderInlineStartWidth:_e.borderWidths("borderInlineStartWidth"),borderLeftColor:_e.colors("borderLeftColor"),borderInlineStartColor:_e.colors("borderInlineStartColor"),borderLeftStyle:_e.borderStyles("borderLeftStyle"),borderInlineStartStyle:_e.borderStyles("borderInlineStartStyle"),borderRightWidth:_e.borderWidths("borderRightWidth"),borderInlineEndWidth:_e.borderWidths("borderInlineEndWidth"),borderRightColor:_e.colors("borderRightColor"),borderInlineEndColor:_e.colors("borderInlineEndColor"),borderRightStyle:_e.borderStyles("borderRightStyle"),borderInlineEndStyle:_e.borderStyles("borderInlineEndStyle"),borderTopRadius:_e.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:_e.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:_e.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:_e.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(Dn,{rounded:Dn.borderRadius,roundedTop:Dn.borderTopRadius,roundedTopLeft:Dn.borderTopLeftRadius,roundedTopRight:Dn.borderTopRightRadius,roundedTopStart:Dn.borderStartStartRadius,roundedTopEnd:Dn.borderStartEndRadius,roundedBottom:Dn.borderBottomRadius,roundedBottomLeft:Dn.borderBottomLeftRadius,roundedBottomRight:Dn.borderBottomRightRadius,roundedBottomStart:Dn.borderEndStartRadius,roundedBottomEnd:Dn.borderEndEndRadius,roundedLeft:Dn.borderLeftRadius,roundedRight:Dn.borderRightRadius,roundedStart:Dn.borderInlineStartRadius,roundedEnd:Dn.borderInlineEndRadius,borderStart:Dn.borderInlineStart,borderEnd:Dn.borderInlineEnd,borderTopStartRadius:Dn.borderStartStartRadius,borderTopEndRadius:Dn.borderStartEndRadius,borderBottomStartRadius:Dn.borderEndStartRadius,borderBottomEndRadius:Dn.borderEndEndRadius,borderStartRadius:Dn.borderInlineStartRadius,borderEndRadius:Dn.borderInlineEndRadius,borderStartWidth:Dn.borderInlineStartWidth,borderEndWidth:Dn.borderInlineEndWidth,borderStartColor:Dn.borderInlineStartColor,borderEndColor:Dn.borderInlineEndColor,borderStartStyle:Dn.borderInlineStartStyle,borderEndStyle:Dn.borderInlineEndStyle});var ipe={color:_e.colors("color"),textColor:_e.colors("color"),fill:_e.colors("fill"),stroke:_e.colors("stroke")},pP={boxShadow:_e.shadows("boxShadow"),mixBlendMode:!0,blendMode:_e.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:_e.prop("backgroundBlendMode"),opacity:!0};Object.assign(pP,{shadow:pP.boxShadow});var ope={filter:{transform:_n.filter},blur:_e.blur("--chakra-blur"),brightness:_e.propT("--chakra-brightness",_n.brightness),contrast:_e.propT("--chakra-contrast",_n.contrast),hueRotate:_e.propT("--chakra-hue-rotate",_n.hueRotate),invert:_e.propT("--chakra-invert",_n.invert),saturate:_e.propT("--chakra-saturate",_n.saturate),dropShadow:_e.propT("--chakra-drop-shadow",_n.dropShadow),backdropFilter:{transform:_n.backdropFilter},backdropBlur:_e.blur("--chakra-backdrop-blur"),backdropBrightness:_e.propT("--chakra-backdrop-brightness",_n.brightness),backdropContrast:_e.propT("--chakra-backdrop-contrast",_n.contrast),backdropHueRotate:_e.propT("--chakra-backdrop-hue-rotate",_n.hueRotate),backdropInvert:_e.propT("--chakra-backdrop-invert",_n.invert),backdropSaturate:_e.propT("--chakra-backdrop-saturate",_n.saturate)},sb={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:_n.flexDirection},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:_e.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0,gap:_e.space("gap"),rowGap:_e.space("rowGap"),columnGap:_e.space("columnGap")};Object.assign(sb,{flexDir:sb.flexDirection});var y9={gridGap:_e.space("gridGap"),gridColumnGap:_e.space("gridColumnGap"),gridRowGap:_e.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},spe={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:_n.outline},outlineOffset:!0,outlineColor:_e.colors("outlineColor")},la={width:_e.sizesT("width"),inlineSize:_e.sizesT("inlineSize"),height:_e.sizes("height"),blockSize:_e.sizes("blockSize"),boxSize:_e.sizes(["width","height"]),minWidth:_e.sizes("minWidth"),minInlineSize:_e.sizes("minInlineSize"),minHeight:_e.sizes("minHeight"),minBlockSize:_e.sizes("minBlockSize"),maxWidth:_e.sizes("maxWidth"),maxInlineSize:_e.sizes("maxInlineSize"),maxHeight:_e.sizes("maxHeight"),maxBlockSize:_e.sizes("maxBlockSize"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,aspectRatio:!0,hideFrom:{scale:"breakpoints",transform:(e,i)=>{var a,l,u;return{[`@media screen and (min-width: ${(u=(l=(a=i.__breakpoints)==null?void 0:a.get(e))==null?void 0:l.minW)!=null?u:e})`]:{display:"none"}}}},hideBelow:{scale:"breakpoints",transform:(e,i)=>{var a,l,u;return{[`@media screen and (max-width: ${(u=(l=(a=i.__breakpoints)==null?void 0:a.get(e))==null?void 0:l._minW)!=null?u:e})`]:{display:"none"}}}},verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:_e.propT("float",_n.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(la,{w:la.width,h:la.height,minW:la.minWidth,maxW:la.maxWidth,minH:la.minHeight,maxH:la.maxHeight,overscroll:la.overscrollBehavior,overscrollX:la.overscrollBehaviorX,overscrollY:la.overscrollBehaviorY});var ape={listStyleType:!0,listStylePosition:!0,listStylePos:_e.prop("listStylePosition"),listStyleImage:!0,listStyleImg:_e.prop("listStyleImage")};function cpe(e,i,a,l){const u=typeof i=="string"?i.split("."):[i];for(l=0;l<u.length&&e;l+=1)e=e[u[l]];return e===void 0?a:e}var lpe=e=>{const i=new WeakMap;return(l,u,p,m)=>{if(typeof l>"u")return e(l,u,p);i.has(l)||i.set(l,new Map);const v=i.get(l);if(v.has(u))return v.get(u);const y=e(l,u,p,m);return v.set(u,y),y}},dpe=lpe(cpe),upe={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},hpe={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},lO=(e,i,a)=>{const l={},u=dpe(e,i,{});for(const p in u)p in a&&a[p]!=null||(l[p]=u[p]);return l},ppe={srOnly:{transform(e){return e===!0?upe:e==="focusable"?hpe:{}}},layerStyle:{processResult:!0,transform:(e,i,a)=>lO(i,`layerStyles.${e}`,a)},textStyle:{processResult:!0,transform:(e,i,a)=>lO(i,`textStyles.${e}`,a)},apply:{processResult:!0,transform:(e,i,a)=>lO(i,e,a)}},ev={position:!0,pos:_e.prop("position"),zIndex:_e.prop("zIndex","zIndices"),inset:_e.spaceT("inset"),insetX:_e.spaceT(["left","right"]),insetInline:_e.spaceT("insetInline"),insetY:_e.spaceT(["top","bottom"]),insetBlock:_e.spaceT("insetBlock"),top:_e.spaceT("top"),insetBlockStart:_e.spaceT("insetBlockStart"),bottom:_e.spaceT("bottom"),insetBlockEnd:_e.spaceT("insetBlockEnd"),left:_e.spaceT("left"),insetInlineStart:_e.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:_e.spaceT("right"),insetInlineEnd:_e.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(ev,{insetStart:ev.insetInlineStart,insetEnd:ev.insetInlineEnd});var fpe={ring:{transform:_n.ring},ringColor:_e.colors("--chakra-ring-color"),ringOffset:_e.prop("--chakra-ring-offset-width"),ringOffsetColor:_e.colors("--chakra-ring-offset-color"),ringInset:_e.prop("--chakra-ring-inset")},Ir={margin:_e.spaceT("margin"),marginTop:_e.spaceT("marginTop"),marginBlockStart:_e.spaceT("marginBlockStart"),marginRight:_e.spaceT("marginRight"),marginInlineEnd:_e.spaceT("marginInlineEnd"),marginBottom:_e.spaceT("marginBottom"),marginBlockEnd:_e.spaceT("marginBlockEnd"),marginLeft:_e.spaceT("marginLeft"),marginInlineStart:_e.spaceT("marginInlineStart"),marginX:_e.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:_e.spaceT("marginInline"),marginY:_e.spaceT(["marginTop","marginBottom"]),marginBlock:_e.spaceT("marginBlock"),padding:_e.space("padding"),paddingTop:_e.space("paddingTop"),paddingBlockStart:_e.space("paddingBlockStart"),paddingRight:_e.space("paddingRight"),paddingBottom:_e.space("paddingBottom"),paddingBlockEnd:_e.space("paddingBlockEnd"),paddingLeft:_e.space("paddingLeft"),paddingInlineStart:_e.space("paddingInlineStart"),paddingInlineEnd:_e.space("paddingInlineEnd"),paddingX:_e.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:_e.space("paddingInline"),paddingY:_e.space(["paddingTop","paddingBottom"]),paddingBlock:_e.space("paddingBlock")};Object.assign(Ir,{m:Ir.margin,mt:Ir.marginTop,mr:Ir.marginRight,me:Ir.marginInlineEnd,marginEnd:Ir.marginInlineEnd,mb:Ir.marginBottom,ml:Ir.marginLeft,ms:Ir.marginInlineStart,marginStart:Ir.marginInlineStart,mx:Ir.marginX,my:Ir.marginY,p:Ir.padding,pt:Ir.paddingTop,py:Ir.paddingY,px:Ir.paddingX,pb:Ir.paddingBottom,pl:Ir.paddingLeft,ps:Ir.paddingInlineStart,paddingStart:Ir.paddingInlineStart,pr:Ir.paddingRight,pe:Ir.paddingInlineEnd,paddingEnd:Ir.paddingInlineEnd});var mpe={textDecorationColor:_e.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:_e.shadows("textShadow")},gpe={clipPath:!0,transform:_e.propT("transform",_n.transform),transformOrigin:!0,translateX:_e.spaceT("--chakra-translate-x"),translateY:_e.spaceT("--chakra-translate-y"),skewX:_e.degreeT("--chakra-skew-x"),skewY:_e.degreeT("--chakra-skew-y"),scaleX:_e.prop("--chakra-scale-x"),scaleY:_e.prop("--chakra-scale-y"),scale:_e.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:_e.degreeT("--chakra-rotate")},_pe={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:_e.prop("transitionDuration","transition.duration"),transitionProperty:_e.prop("transitionProperty","transition.property"),transitionTimingFunction:_e.prop("transitionTimingFunction","transition.easing")},vpe={fontFamily:_e.prop("fontFamily","fonts"),fontSize:_e.prop("fontSize","fontSizes",_n.px),fontWeight:_e.prop("fontWeight","fontWeights"),lineHeight:_e.prop("lineHeight","lineHeights"),letterSpacing:_e.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,textIndent:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,isTruncated:{transform(e){if(e===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}},noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"}},Epe={scrollBehavior:!0,scrollSnapAlign:!0,scrollSnapStop:!0,scrollSnapType:!0,scrollMargin:_e.spaceT("scrollMargin"),scrollMarginTop:_e.spaceT("scrollMarginTop"),scrollMarginBottom:_e.spaceT("scrollMarginBottom"),scrollMarginLeft:_e.spaceT("scrollMarginLeft"),scrollMarginRight:_e.spaceT("scrollMarginRight"),scrollMarginX:_e.spaceT(["scrollMarginLeft","scrollMarginRight"]),scrollMarginY:_e.spaceT(["scrollMarginTop","scrollMarginBottom"]),scrollPadding:_e.spaceT("scrollPadding"),scrollPaddingTop:_e.spaceT("scrollPaddingTop"),scrollPaddingBottom:_e.spaceT("scrollPaddingBottom"),scrollPaddingLeft:_e.spaceT("scrollPaddingLeft"),scrollPaddingRight:_e.spaceT("scrollPaddingRight"),scrollPaddingX:_e.spaceT(["scrollPaddingLeft","scrollPaddingRight"]),scrollPaddingY:_e.spaceT(["scrollPaddingTop","scrollPaddingBottom"])};function S9(e){return go(e)&&e.reference?e.reference:String(e)}var oC=(e,...i)=>i.map(S9).join(` ${e} `).replace(/calc/g,""),v6=(...e)=>`calc(${oC("+",...e)})`,E6=(...e)=>`calc(${oC("-",...e)})`,fP=(...e)=>`calc(${oC("*",...e)})`,y6=(...e)=>`calc(${oC("/",...e)})`,S6=e=>{const i=S9(e);return i!=null&&!Number.isNaN(parseFloat(i))?String(i).startsWith("-")?String(i).slice(1):`-${i}`:fP(i,-1)},sh=Object.assign(e=>({add:(...i)=>sh(v6(e,...i)),subtract:(...i)=>sh(E6(e,...i)),multiply:(...i)=>sh(fP(e,...i)),divide:(...i)=>sh(y6(e,...i)),negate:()=>sh(S6(e)),toString:()=>e.toString()}),{add:v6,subtract:E6,multiply:fP,divide:y6,negate:S6});function ype(e,i="-"){return e.replace(/\s+/g,i)}function Spe(e){const i=ype(e.toString());return bpe(Tpe(i))}function Tpe(e){return e.includes("\\.")?e:!Number.isInteger(parseFloat(e.toString()))?e.replace(".","\\."):e}function bpe(e){return e.replace(/[!-,/:-@[-^`{-~]/g,"\\$&")}function Cpe(e,i=""){return[i,e].filter(Boolean).join("-")}function wpe(e,i){return`var(${e}${i?`, ${i}`:""})`}function Rpe(e,i=""){return Spe(`--${Cpe(e,i)}`)}function It(e,i,a){const l=Rpe(e,a);return{variable:l,reference:wpe(l,i)}}function Ipe(e,i){const a={};for(const l of i){if(Array.isArray(l)){const[u,p]=l;a[u]=It(`${e}-${u}`,p);continue}a[l]=It(`${e}-${l}`)}return a}function Ape(e){const i=e==null?0:e.length;return i?e[i-1]:void 0}function Ope(e){const i=parseFloat(e.toString()),a=e.toString().replace(String(i),"");return{unitless:!a,value:i,unit:a}}function mP(e){if(e==null)return e;const{unitless:i}=Ope(e);return i||typeof e=="number"?`${e}px`:e}var T9=(e,i)=>parseInt(e[1],10)>parseInt(i[1],10)?1:-1,yD=e=>Object.fromEntries(Object.entries(e).sort(T9));function T6(e){const i=yD(e);return Object.assign(Object.values(i),i)}function Npe(e){const i=Object.keys(yD(e));return new Set(i)}function b6(e){var i;if(!e)return e;e=(i=mP(e))!=null?i:e;const a=-.02;return typeof e=="number"?`${e+a}`:e.replace(/(\d+\.?\d*)/u,l=>`${parseFloat(l)+a}`)}function M_(e,i){const a=["@media screen"];return e&&a.push("and",`(min-width: ${mP(e)})`),i&&a.push("and",`(max-width: ${mP(i)})`),a.join(" ")}function Ppe(e){var i;if(!e)return null;e.base=(i=e.base)!=null?i:"0px";const a=T6(e),l=Object.entries(e).sort(T9).map(([m,v],y,S)=>{var C;let[,R]=(C=S[y+1])!=null?C:[];return R=parseFloat(R)>0?b6(R):void 0,{_minW:b6(v),breakpoint:m,minW:v,maxW:R,maxWQuery:M_(null,R),minWQuery:M_(v),minMaxQuery:M_(v,R)}}),u=Npe(e),p=Array.from(u.values());return{keys:u,normalized:a,isResponsive(m){const v=Object.keys(m);return v.length>0&&v.every(y=>u.has(y))},asObject:yD(e),asArray:T6(e),details:l,get(m){return l.find(v=>v.breakpoint===m)},media:[null,...a.map(m=>M_(m)).slice(1)],toArrayValue(m){if(!go(m))throw new Error("toArrayValue: value must be an object");const v=p.map(y=>{var S;return(S=m[y])!=null?S:null});for(;Ape(v)===null;)v.pop();return v},toObjectValue(m){if(!Array.isArray(m))throw new Error("toObjectValue: value must be an array");return m.reduce((v,y,S)=>{const C=p[S];return C!=null&&y!=null&&(v[C]=y),v},{})}}}var zi={hover:(e,i)=>`${e}:hover ${i}, ${e}[data-hover] ${i}`,focus:(e,i)=>`${e}:focus ${i}, ${e}[data-focus] ${i}`,focusVisible:(e,i)=>`${e}:focus-visible ${i}`,focusWithin:(e,i)=>`${e}:focus-within ${i}`,active:(e,i)=>`${e}:active ${i}, ${e}[data-active] ${i}`,disabled:(e,i)=>`${e}:disabled ${i}, ${e}[data-disabled] ${i}`,invalid:(e,i)=>`${e}:invalid ${i}, ${e}[data-invalid] ${i}`,checked:(e,i)=>`${e}:checked ${i}, ${e}[data-checked] ${i}`,indeterminate:(e,i)=>`${e}:indeterminate ${i}, ${e}[aria-checked=mixed] ${i}, ${e}[data-indeterminate] ${i}`,readOnly:(e,i)=>`${e}:read-only ${i}, ${e}[readonly] ${i}, ${e}[data-read-only] ${i}`,expanded:(e,i)=>`${e}:read-only ${i}, ${e}[aria-expanded=true] ${i}, ${e}[data-expanded] ${i}`,placeholderShown:(e,i)=>`${e}:placeholder-shown ${i}`},Dd=e=>b9(i=>e(i,"&"),"[role=group]","[data-group]",".group"),ul=e=>b9(i=>e(i,"~ &"),"[data-peer]",".peer"),b9=(e,...i)=>i.map(e).join(", "),sC={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within",_focusVisible:"&:focus-visible, &[data-focus-visible]",_disabled:"&:disabled, &[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty",_expanded:"&[aria-expanded=true], &[data-expanded]",_checked:"&[aria-checked=true], &[data-checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_firstLetter:"&::first-letter",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate]",_groupHover:Dd(zi.hover),_peerHover:ul(zi.hover),_groupFocus:Dd(zi.focus),_peerFocus:ul(zi.focus),_groupFocusVisible:Dd(zi.focusVisible),_peerFocusVisible:ul(zi.focusVisible),_groupActive:Dd(zi.active),_peerActive:ul(zi.active),_groupDisabled:Dd(zi.disabled),_peerDisabled:ul(zi.disabled),_groupInvalid:Dd(zi.invalid),_peerInvalid:ul(zi.invalid),_groupChecked:Dd(zi.checked),_peerChecked:ul(zi.checked),_groupFocusWithin:Dd(zi.focusWithin),_peerFocusWithin:ul(zi.focusWithin),_peerPlaceholderShown:ul(zi.placeholderShown),_placeholder:"&::placeholder",_placeholderShown:"&:placeholder-shown",_fullScreen:"&:fullscreen",_selection:"&::selection",_rtl:"[dir=rtl] &, &[dir=rtl]",_ltr:"[dir=ltr] &, &[dir=ltr]",_mediaDark:"@media (prefers-color-scheme: dark)",_mediaReduceMotion:"@media (prefers-reduced-motion: reduce)",_dark:".chakra-ui-dark &:not([data-theme]),[data-theme=dark] &:not([data-theme]),&[data-theme=dark]",_light:".chakra-ui-light &:not([data-theme]),[data-theme=light] &:not([data-theme]),&[data-theme=light]",_horizontal:"&[data-orientation=horizontal]",_vertical:"&[data-orientation=vertical]"},C9=Object.keys(sC);function C6(e,i){return It(String(e).replace(/\./g,"-"),void 0,i)}function kpe(e,i){let a={};const l={};for(const[u,p]of Object.entries(e)){const{isSemantic:m,value:v}=p,{variable:y,reference:S}=C6(u,i==null?void 0:i.cssVarPrefix);if(!m){if(u.startsWith("space")){const N=u.split("."),[x,...U]=N,M=`${x}.-${U.join(".")}`,z=sh.negate(v),V=sh.negate(S);l[M]={value:z,var:y,varRef:V}}a[y]=v,l[u]={value:v,var:y,varRef:S};continue}const C=N=>{const U=[String(u).split(".")[0],N].join(".");if(!e[U])return N;const{reference:z}=C6(U,i==null?void 0:i.cssVarPrefix);return z},R=go(v)?v:{default:v};a=fa(a,Object.entries(R).reduce((N,[x,U])=>{var M,z;if(!U)return N;const V=C(`${U}`);if(x==="default")return N[y]=V,N;const W=(z=(M=sC)==null?void 0:M[x])!=null?z:x;return N[W]={[y]:V},N},{})),l[u]={value:S,var:y,varRef:S}}return{cssVars:a,cssMap:l}}function Dpe(e,i=[]){const a=Object.assign({},e);for(const l of i)l in a&&delete a[l];return a}function xpe(e,i){const a={};for(const l of i)l in e&&(a[l]=e[l]);return a}function Lpe(e){return typeof e=="object"&&e!=null&&!Array.isArray(e)}function w6(e,i,a={}){const{stop:l,getKey:u}=a;function p(m,v=[]){var y;if(Lpe(m)||Array.isArray(m)){const S={};for(const[C,R]of Object.entries(m)){const N=(y=u==null?void 0:u(C))!=null?y:C,x=[...v,N];if(l!=null&&l(m,x))return i(m,v);S[N]=p(R,x)}return S}return i(m,v)}return p(e)}var Mpe=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","gradients","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur","breakpoints"];function Upe(e){return xpe(e,Mpe)}function jpe(e){return e.semanticTokens}function Fpe(e){const{__cssMap:i,__cssVars:a,__breakpoints:l,...u}=e;return u}var Vpe=e=>C9.includes(e)||e==="default";function Bpe({tokens:e,semanticTokens:i}){const a={};return w6(e,(l,u)=>{l!=null&&(a[u.join(".")]={isSemantic:!1,value:l})}),w6(i,(l,u)=>{l!=null&&(a[u.join(".")]={isSemantic:!0,value:l})},{stop:l=>Object.keys(l).every(Vpe)}),a}function Wpe(e){var i;const a=Fpe(e),l=Upe(a),u=jpe(a),p=Bpe({tokens:l,semanticTokens:u}),m=(i=a.config)==null?void 0:i.cssVarPrefix,{cssMap:v,cssVars:y}=kpe(p,{cssVarPrefix:m});return Object.assign(a,{__cssVars:{...{"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"},...y},__cssMap:v,__breakpoints:Ppe(a.breakpoints)}),a}var SD=fa({},lT,Dn,ipe,sb,la,ope,fpe,spe,y9,ppe,ev,pP,Ir,Epe,vpe,mpe,gpe,ape,_pe),zpe=Object.assign({},Ir,la,sb,y9,ev),w9=Object.keys(zpe),Gpe=[...Object.keys(SD),...C9],Hpe={...SD,...sC},$pe=e=>e in Hpe,Kpe=e=>i=>{if(!i.__breakpoints)return e;const{isResponsive:a,toArrayValue:l,media:u}=i.__breakpoints,p={};for(const m in e){let v=ts(e[m],i);if(v==null)continue;if(v=go(v)&&a(v)?l(v):v,!Array.isArray(v)){p[m]=v;continue}const y=v.slice(0,u.length).length;for(let S=0;S<y;S+=1){const C=u==null?void 0:u[S];if(!C){p[m]=v[S];continue}p[C]=p[C]||{},v[S]!=null&&(p[C][m]=v[S])}}return p};function Ype(e){const i=[];let a="",l=!1;for(let u=0;u<e.length;u++){const p=e[u];p==="("?(l=!0,a+=p):p===")"?(l=!1,a+=p):p===","&&!l?(i.push(a),a=""):a+=p}return a=a.trim(),a&&i.push(a),i}function qpe(e){return/^var\(--.+\)$/.test(e)}var Jpe=(e,i)=>e.startsWith("--")&&typeof i=="string"&&!qpe(i),Xpe=(e,i)=>{var a,l;if(i==null)return i;const u=y=>{var S,C;return(C=(S=e.__cssMap)==null?void 0:S[y])==null?void 0:C.varRef},p=y=>{var S;return(S=u(y))!=null?S:y},[m,v]=Ype(i);return i=(l=(a=u(m))!=null?a:p(v))!=null?l:p(i),i};function Qpe(e){const{configs:i={},pseudos:a={},theme:l}=e,u=(p,m=!1)=>{var v,y,S;const C=ts(p,l),R=Kpe(C)(l);let N={};for(let x in R){const U=R[x];let M=ts(U,l);x in a&&(x=a[x]),Jpe(x,M)&&(M=Xpe(l,M));let z=i[x];if(z===!0&&(z={property:x}),go(M)){N[x]=(v=N[x])!=null?v:{},N[x]=fa({},N[x],u(M,!0));continue}let V=(S=(y=z==null?void 0:z.transform)==null?void 0:y.call(z,M,l,C))!=null?S:M;V=z!=null&&z.processResult?u(V,!0):V;const W=ts(z==null?void 0:z.property,l);if(!m&&(z!=null&&z.static)){const H=ts(z.static,l);N=fa({},N,H)}if(W&&Array.isArray(W)){for(const H of W)N[H]=V;continue}if(W){W==="&"&&go(V)?N=fa({},N,V):N[W]=V;continue}if(go(V)){N=fa({},N,V);continue}N[x]=V}return N};return u}var R9=e=>i=>Qpe({theme:i,pseudos:sC,configs:SD})(e);function Tr(e){return{definePartsStyle(i){return i},defineMultiStyleConfig(i){return{parts:e,...i}}}}function Zpe(e,i){if(Array.isArray(e))return e;if(go(e))return i(e);if(e!=null)return[e]}function efe(e,i){for(let a=i+1;a<e.length;a++)if(e[a]!=null)return a;return-1}function tfe(e){const i=e.__breakpoints;return function(l,u,p,m){var v,y;if(!i)return;const S={},C=Zpe(p,i.toArrayValue);if(!C)return S;const R=C.length,N=R===1,x=!!l.parts;for(let U=0;U<R;U++){const M=i.details[U],z=i.details[efe(C,U)],V=M_(M.minW,z==null?void 0:z._minW),W=ts((v=l[u])==null?void 0:v[C[U]],m);if(W){if(x){(y=l.parts)==null||y.forEach(H=>{fa(S,{[H]:N?W[H]:{[V]:W[H]}})});continue}if(!x){N?fa(S,W):S[V]=W;continue}S[V]=W}}return S}}function nfe(e){return i=>{var a;const{variant:l,size:u,theme:p}=i,m=tfe(p);return fa({},ts((a=e.baseStyle)!=null?a:{},i),m(e,"sizes",u,i),m(e,"variants",l,i))}}function rfe(e,i,a){var l,u,p;return(p=(u=(l=e.__cssMap)==null?void 0:l[`${i}.${a}`])==null?void 0:u.varRef)!=null?p:a}function ar(e){return Dpe(e,["styleConfig","size","variant","colorScheme"])}var ife=["borders","breakpoints","colors","components","config","direction","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","shadows","sizes","space","styles","transition","zIndices"];function ofe(e){return go(e)?ife.every(i=>Object.prototype.hasOwnProperty.call(e,i)):!1}var sfe={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},afe={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},cfe={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},lfe={property:sfe,easing:afe,duration:cfe},dfe=lfe,ufe={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},hfe=ufe,pfe={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},ffe=pfe,mfe={base:"0em",sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"},gfe=mfe,_fe={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"},linkedin:{50:"#E8F4F9",100:"#CFEDFB",200:"#9BDAF3",300:"#68C7EC",400:"#34B3E4",500:"#00A0DC",600:"#008CC9",700:"#0077B5",800:"#005E93",900:"#004471"},facebook:{50:"#E8F4F9",100:"#D9DEE9",200:"#B7C2DA",300:"#6482C0",400:"#4267B2",500:"#385898",600:"#314E89",700:"#29487D",800:"#223B67",900:"#1E355B"},messenger:{50:"#D0E6FF",100:"#B9DAFF",200:"#A2CDFF",300:"#7AB8FF",400:"#2E90FF",500:"#0078FF",600:"#0063D1",700:"#0052AC",800:"#003C7E",900:"#002C5C"},whatsapp:{50:"#dffeec",100:"#b9f5d0",200:"#90edb3",300:"#65e495",400:"#3cdd78",500:"#22c35e",600:"#179848",700:"#0c6c33",800:"#01421c",900:"#001803"},twitter:{50:"#E5F4FD",100:"#C8E9FB",200:"#A8DCFA",300:"#83CDF7",400:"#57BBF5",500:"#1DA1F2",600:"#1A94DA",700:"#1681BF",800:"#136B9E",900:"#0D4D71"},telegram:{50:"#E3F2F9",100:"#C5E4F3",200:"#A2D4EC",300:"#7AC1E4",400:"#47A9DA",500:"#0088CC",600:"#007AB8",700:"#006BA1",800:"#005885",900:"#003F5E"}},vfe=_fe,Efe={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},yfe=Efe,Sfe={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},Tfe=Sfe,bfe={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},Cfe=bfe,wfe={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2",3:".75rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{"3xs":"0.45rem","2xs":"0.625rem",xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},I9=wfe,A9={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"},Rfe={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem",prose:"60ch"},Ife={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},Afe={...A9,...Rfe,container:Ife},O9=Afe,Ofe={breakpoints:gfe,zIndices:hfe,radii:yfe,blur:Cfe,colors:vfe,...I9,sizes:O9,shadows:Tfe,space:A9,borders:ffe,transition:dfe},{defineMultiStyleConfig:Nfe,definePartsStyle:U_}=Tr(["stepper","step","title","description","indicator","separator","icon","number"]),fl=It("stepper-indicator-size"),Pf=It("stepper-icon-size"),kf=It("stepper-title-font-size"),j_=It("stepper-description-font-size"),C_=It("stepper-accent-color"),Pfe=U_(({colorScheme:e})=>({stepper:{display:"flex",justifyContent:"space-between",gap:"4","&[data-orientation=vertical]":{flexDirection:"column",alignItems:"flex-start"},"&[data-orientation=horizontal]":{flexDirection:"row",alignItems:"center"},[C_.variable]:`colors.${e}.500`,_dark:{[C_.variable]:`colors.${e}.200`}},title:{fontSize:kf.reference,fontWeight:"medium"},description:{fontSize:j_.reference,color:"chakra-subtle-text"},number:{fontSize:kf.reference},step:{flexShrink:0,position:"relative",display:"flex",gap:"2","&[data-orientation=horizontal]":{alignItems:"center"},flex:"1","&:last-of-type:not([data-stretch])":{flex:"initial"}},icon:{flexShrink:0,width:Pf.reference,height:Pf.reference},indicator:{flexShrink:0,borderRadius:"full",width:fl.reference,height:fl.reference,display:"flex",justifyContent:"center",alignItems:"center","&[data-status=active]":{borderWidth:"2px",borderColor:C_.reference},"&[data-status=complete]":{bg:C_.reference,color:"chakra-inverse-text"},"&[data-status=incomplete]":{borderWidth:"2px"}},separator:{bg:"chakra-border-color",flex:"1","&[data-status=complete]":{bg:C_.reference},"&[data-orientation=horizontal]":{width:"100%",height:"2px",marginStart:"2"},"&[data-orientation=vertical]":{width:"2px",position:"absolute",height:"100%",maxHeight:`calc(100% - ${fl.reference} - 8px)`,top:`calc(${fl.reference} + 4px)`,insetStart:`calc(${fl.reference} / 2 - 1px)`}}})),kfe=Nfe({baseStyle:Pfe,sizes:{xs:U_({stepper:{[fl.variable]:"sizes.4",[Pf.variable]:"sizes.3",[kf.variable]:"fontSizes.xs",[j_.variable]:"fontSizes.xs"}}),sm:U_({stepper:{[fl.variable]:"sizes.6",[Pf.variable]:"sizes.4",[kf.variable]:"fontSizes.sm",[j_.variable]:"fontSizes.xs"}}),md:U_({stepper:{[fl.variable]:"sizes.8",[Pf.variable]:"sizes.5",[kf.variable]:"fontSizes.md",[j_.variable]:"fontSizes.sm"}}),lg:U_({stepper:{[fl.variable]:"sizes.10",[Pf.variable]:"sizes.6",[kf.variable]:"fontSizes.lg",[j_.variable]:"fontSizes.md"}})},defaultProps:{size:"md",colorScheme:"blue"}});function Un(e,i={}){let a=!1;function l(){if(!a){a=!0;return}throw new Error("[anatomy] .part(...) should only be called once. Did you mean to use .extend(...) ?")}function u(...C){l();for(const R of C)i[R]=y(R);return Un(e,i)}function p(...C){for(const R of C)R in i||(i[R]=y(R));return Un(e,i)}function m(){return Object.fromEntries(Object.entries(i).map(([R,N])=>[R,N.selector]))}function v(){return Object.fromEntries(Object.entries(i).map(([R,N])=>[R,N.className]))}function y(C){const x=`chakra-${(["container","root"].includes(C??"")?[e]:[e,C]).filter(Boolean).join("__")}`;return{className:x,selector:`.${x}`,toString:()=>C}}return{parts:u,toPart:y,extend:p,selectors:m,classnames:v,get keys(){return Object.keys(i)},__type:{}}}var Dfe=Un("accordion").parts("root","container","button","panel").extend("icon"),xfe=Un("alert").parts("title","description","container").extend("icon","spinner"),Lfe=Un("avatar").parts("label","badge","container").extend("excessLabel","group"),Mfe=Un("breadcrumb").parts("link","item","container").extend("separator");Un("button").parts();var Ufe=Un("checkbox").parts("control","icon","container").extend("label");Un("progress").parts("track","filledTrack").extend("label");var jfe=Un("drawer").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),Ffe=Un("editable").parts("preview","input","textarea"),Vfe=Un("form").parts("container","requiredIndicator","helperText"),Bfe=Un("formError").parts("text","icon"),Wfe=Un("input").parts("addon","field","element","group"),zfe=Un("list").parts("container","item","icon"),Gfe=Un("menu").parts("button","list","item").extend("groupTitle","icon","command","divider"),Hfe=Un("modal").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer"),$fe=Un("numberinput").parts("root","field","stepperGroup","stepper");Un("pininput").parts("field");var Kfe=Un("popover").parts("content","header","body","footer").extend("popper","arrow","closeButton"),Yfe=Un("progress").parts("label","filledTrack","track"),qfe=Un("radio").parts("container","control","label"),Jfe=Un("select").parts("field","icon"),Xfe=Un("slider").parts("container","track","thumb","filledTrack","mark"),Qfe=Un("stat").parts("container","label","helpText","number","icon"),Zfe=Un("switch").parts("container","track","thumb","label"),eme=Un("table").parts("table","thead","tbody","tr","th","td","tfoot","caption"),tme=Un("tabs").parts("root","tab","tablist","tabpanel","tabpanels","indicator"),nme=Un("tag").parts("container","label","closeButton"),rme=Un("card").parts("container","header","body","footer");Un("stepper").parts("stepper","step","title","description","indicator","separator","icon","number");function uh(e,i,a){return Math.min(Math.max(e,a),i)}class ime extends Error{constructor(i){super(`Failed to parse color: "${i}"`)}}var F_=ime;function TD(e){if(typeof e!="string")throw new F_(e);if(e.trim().toLowerCase()==="transparent")return[0,0,0,0];let i=e.trim();i=hme.test(e)?ame(e):e;const a=cme.exec(i);if(a){const m=Array.from(a).slice(1);return[...m.slice(0,3).map(v=>parseInt(Dv(v,2),16)),parseInt(Dv(m[3]||"f",2),16)/255]}const l=lme.exec(i);if(l){const m=Array.from(l).slice(1);return[...m.slice(0,3).map(v=>parseInt(v,16)),parseInt(m[3]||"ff",16)/255]}const u=dme.exec(i);if(u){const m=Array.from(u).slice(1);return[...m.slice(0,3).map(v=>parseInt(v,10)),parseFloat(m[3]||"1")]}const p=ume.exec(i);if(p){const[m,v,y,S]=Array.from(p).slice(1).map(parseFloat);if(uh(0,100,v)!==v)throw new F_(e);if(uh(0,100,y)!==y)throw new F_(e);return[...pme(m,v,y),Number.isNaN(S)?1:S]}throw new F_(e)}function ome(e){let i=5381,a=e.length;for(;a;)i=i*33^e.charCodeAt(--a);return(i>>>0)%2341}const R6=e=>parseInt(e.replace(/_/g,""),36),sme="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((e,i)=>{const a=R6(i.substring(0,3)),l=R6(i.substring(3)).toString(16);let u="";for(let p=0;p<6-l.length;p++)u+="0";return e[a]=`${u}${l}`,e},{});function ame(e){const i=e.toLowerCase().trim(),a=sme[ome(i)];if(!a)throw new F_(e);return`#${a}`}const Dv=(e,i)=>Array.from(Array(i)).map(()=>e).join(""),cme=new RegExp(`^#${Dv("([a-f0-9])",3)}([a-f0-9])?$`,"i"),lme=new RegExp(`^#${Dv("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),dme=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${Dv(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),ume=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,hme=/^[a-z]+$/i,I6=e=>Math.round(e*255),pme=(e,i,a)=>{let l=a/100;if(i===0)return[l,l,l].map(I6);const u=(e%360+360)%360/60,p=(1-Math.abs(2*l-1))*(i/100),m=p*(1-Math.abs(u%2-1));let v=0,y=0,S=0;u>=0&&u<1?(v=p,y=m):u>=1&&u<2?(v=m,y=p):u>=2&&u<3?(y=p,S=m):u>=3&&u<4?(y=m,S=p):u>=4&&u<5?(v=m,S=p):u>=5&&u<6&&(v=p,S=m);const C=l-p/2,R=v+C,N=y+C,x=S+C;return[R,N,x].map(I6)};function fme(e,i,a,l){return`rgba(${uh(0,255,e).toFixed()}, ${uh(0,255,i).toFixed()}, ${uh(0,255,a).toFixed()}, ${parseFloat(uh(0,1,l).toFixed(3))})`}function mme(e,i){const[a,l,u,p]=TD(e);return fme(a,l,u,p-i)}function gme(e){const[i,a,l,u]=TD(e);let p=m=>{const v=uh(0,255,m).toString(16);return v.length===1?`0${v}`:v};return`#${p(i)}${p(a)}${p(l)}${u<1?p(Math.round(u*255)):""}`}function _me(e,i,a,l,u){for(i=i.split?i.split("."):i,l=0;l<i.length;l++)e=e?e[i[l]]:u;return e===u?a:e}var vme=e=>Object.keys(e).length===0,No=(e,i,a)=>{const l=_me(e,`colors.${i}`,i);try{return gme(l),l}catch{return"#000000"}},Eme=e=>{const[i,a,l]=TD(e);return(i*299+a*587+l*114)/1e3},yme=e=>i=>{const a=No(i,e);return Eme(a)<128?"dark":"light"},Sme=e=>i=>yme(e)(i)==="dark",vm=(e,i)=>a=>{const l=No(a,e);return mme(l,1-i)};function A6(e="1rem",i="rgba(255, 255, 255, 0.15)"){return{backgroundImage:`linear-gradient(
    45deg,
    ${i} 25%,
    transparent 25%,
    transparent 50%,
    ${i} 50%,
    ${i} 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:`${e} ${e}`}}var Tme=()=>`#${Math.floor(Math.random()*16777215).toString(16).padEnd(6,"0")}`;function bme(e){const i=Tme();return!e||vme(e)?i:e.string&&e.colors?wme(e.string,e.colors):e.string&&!e.colors?Cme(e.string):e.colors&&!e.string?Rme(e.colors):i}function Cme(e){let i=0;if(e.length===0)return i.toString();for(let l=0;l<e.length;l+=1)i=e.charCodeAt(l)+((i<<5)-i),i=i&i;let a="#";for(let l=0;l<3;l+=1){const u=i>>l*8&255;a+=`00${u.toString(16)}`.substr(-2)}return a}function wme(e,i){let a=0;if(e.length===0)return i[0];for(let l=0;l<e.length;l+=1)a=e.charCodeAt(l)+((a<<5)-a),a=a&a;return a=(a%i.length+i.length)%i.length,i[a]}function Rme(e){return e[Math.floor(Math.random()*e.length)]}function Rt(e,i){return a=>a.colorMode==="dark"?i:e}function bD(e){const{orientation:i,vertical:a,horizontal:l}=e;return i?i==="vertical"?a:l:{}}function N9(e){return go(e)&&e.reference?e.reference:String(e)}var aC=(e,...i)=>i.map(N9).join(` ${e} `).replace(/calc/g,""),O6=(...e)=>`calc(${aC("+",...e)})`,N6=(...e)=>`calc(${aC("-",...e)})`,gP=(...e)=>`calc(${aC("*",...e)})`,P6=(...e)=>`calc(${aC("/",...e)})`,k6=e=>{const i=N9(e);return i!=null&&!Number.isNaN(parseFloat(i))?String(i).startsWith("-")?String(i).slice(1):`-${i}`:gP(i,-1)},ml=Object.assign(e=>({add:(...i)=>ml(O6(e,...i)),subtract:(...i)=>ml(N6(e,...i)),multiply:(...i)=>ml(gP(e,...i)),divide:(...i)=>ml(P6(e,...i)),negate:()=>ml(k6(e)),toString:()=>e.toString()}),{add:O6,subtract:N6,multiply:gP,divide:P6,negate:k6});function Ime(e){return!Number.isInteger(parseFloat(e.toString()))}function Ame(e,i="-"){return e.replace(/\s+/g,i)}function P9(e){const i=Ame(e.toString());return i.includes("\\.")?e:Ime(e)?i.replace(".","\\."):e}function Ome(e,i=""){return[i,P9(e)].filter(Boolean).join("-")}function Nme(e,i){return`var(${P9(e)}${i?`, ${i}`:""})`}function Pme(e,i=""){return`--${Ome(e,i)}`}function Ii(e,i){const a=Pme(e,void 0);return{variable:a,reference:Nme(a,void 0)}}var{defineMultiStyleConfig:kme,definePartsStyle:dT}=Tr(Zfe.keys),tv=Ii("switch-track-width"),mh=Ii("switch-track-height"),dO=Ii("switch-track-diff"),Dme=ml.subtract(tv,mh),_P=Ii("switch-thumb-x"),w_=Ii("switch-bg"),xme=e=>{const{colorScheme:i}=e;return{borderRadius:"full",p:"0.5",width:[tv.reference],height:[mh.reference],transitionProperty:"common",transitionDuration:"fast",[w_.variable]:"colors.gray.300",_dark:{[w_.variable]:"colors.whiteAlpha.400"},_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{[w_.variable]:`colors.${i}.500`,_dark:{[w_.variable]:`colors.${i}.200`}},bg:w_.reference}},Lme={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:[mh.reference],height:[mh.reference],_checked:{transform:`translateX(${_P.reference})`}},Mme=dT(e=>({container:{[dO.variable]:Dme,[_P.variable]:dO.reference,_rtl:{[_P.variable]:ml(dO).negate().toString()}},track:xme(e),thumb:Lme})),Ume={sm:dT({container:{[tv.variable]:"1.375rem",[mh.variable]:"sizes.3"}}),md:dT({container:{[tv.variable]:"1.875rem",[mh.variable]:"sizes.4"}}),lg:dT({container:{[tv.variable]:"2.875rem",[mh.variable]:"sizes.6"}})},jme=kme({baseStyle:Mme,sizes:Ume,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:Fme,definePartsStyle:Xf}=Tr(eme.keys),Vme=Xf({table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}}),ab={"&[data-is-numeric=true]":{textAlign:"end"}},Bme=Xf(e=>{const{colorScheme:i}=e;return{th:{color:Rt("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Rt(`${i}.100`,`${i}.700`)(e),...ab},td:{borderBottom:"1px",borderColor:Rt(`${i}.100`,`${i}.700`)(e),...ab},caption:{color:Rt("gray.600","gray.100")(e)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),Wme=Xf(e=>{const{colorScheme:i}=e;return{th:{color:Rt("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Rt(`${i}.100`,`${i}.700`)(e),...ab},td:{borderBottom:"1px",borderColor:Rt(`${i}.100`,`${i}.700`)(e),...ab},caption:{color:Rt("gray.600","gray.100")(e)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:Rt(`${i}.100`,`${i}.700`)(e)},td:{background:Rt(`${i}.100`,`${i}.700`)(e)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),zme={simple:Bme,striped:Wme,unstyled:{}},Gme={sm:Xf({th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}}),md:Xf({th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}}),lg:Xf({th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}})},Hme=Fme({baseStyle:Vme,variants:zme,sizes:Gme,defaultProps:{variant:"simple",size:"md",colorScheme:"gray"}}),Zo=It("tabs-color"),za=It("tabs-bg"),NS=It("tabs-border-color"),{defineMultiStyleConfig:$me,definePartsStyle:Nc}=Tr(tme.keys),Kme=e=>{const{orientation:i}=e;return{display:i==="vertical"?"flex":"block"}},Yme=e=>{const{isFitted:i}=e;return{flex:i?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focusVisible:{zIndex:1,boxShadow:"outline"},_disabled:{cursor:"not-allowed",opacity:.4}}},qme=e=>{const{align:i="start",orientation:a}=e;return{justifyContent:{end:"flex-end",center:"center",start:"flex-start"}[i],flexDirection:a==="vertical"?"column":"row"}},Jme={p:4},Xme=Nc(e=>({root:Kme(e),tab:Yme(e),tablist:qme(e),tabpanel:Jme})),Qme={sm:Nc({tab:{py:1,px:4,fontSize:"sm"}}),md:Nc({tab:{fontSize:"md",py:2,px:4}}),lg:Nc({tab:{fontSize:"lg",py:3,px:4}})},Zme=Nc(e=>{const{colorScheme:i,orientation:a}=e,l=a==="vertical",u=l?"borderStart":"borderBottom",p=l?"marginStart":"marginBottom";return{tablist:{[u]:"2px solid",borderColor:"inherit"},tab:{[u]:"2px solid",borderColor:"transparent",[p]:"-2px",_selected:{[Zo.variable]:`colors.${i}.600`,_dark:{[Zo.variable]:`colors.${i}.300`},borderColor:"currentColor"},_active:{[za.variable]:"colors.gray.200",_dark:{[za.variable]:"colors.whiteAlpha.300"}},_disabled:{_active:{bg:"none"}},color:Zo.reference,bg:za.reference}}}),ege=Nc(e=>{const{colorScheme:i}=e;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",[NS.variable]:"transparent",_selected:{[Zo.variable]:`colors.${i}.600`,[NS.variable]:"colors.white",_dark:{[Zo.variable]:`colors.${i}.300`,[NS.variable]:"colors.gray.800"},borderColor:"inherit",borderBottomColor:NS.reference},color:Zo.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),tge=Nc(e=>{const{colorScheme:i}=e;return{tab:{border:"1px solid",borderColor:"inherit",[za.variable]:"colors.gray.50",_dark:{[za.variable]:"colors.whiteAlpha.50"},mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{[za.variable]:"colors.white",[Zo.variable]:`colors.${i}.600`,_dark:{[za.variable]:"colors.gray.800",[Zo.variable]:`colors.${i}.300`},borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"},color:Zo.reference,bg:za.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),nge=Nc(e=>{const{colorScheme:i,theme:a}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:No(a,`${i}.700`),bg:No(a,`${i}.100`)}}}}),rge=Nc(e=>{const{colorScheme:i}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",[Zo.variable]:"colors.gray.600",_dark:{[Zo.variable]:"inherit"},_selected:{[Zo.variable]:"colors.white",[za.variable]:`colors.${i}.600`,_dark:{[Zo.variable]:"colors.gray.800",[za.variable]:`colors.${i}.300`}},color:Zo.reference,bg:za.reference}}}),ige=Nc({}),oge={line:Zme,enclosed:ege,"enclosed-colored":tge,"soft-rounded":nge,"solid-rounded":rge,unstyled:ige},sge=$me({baseStyle:Xme,sizes:Qme,variants:oge,defaultProps:{size:"md",variant:"line",colorScheme:"blue"}}),si=Ipe("badge",["bg","color","shadow"]),age={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold",bg:si.bg.reference,color:si.color.reference,boxShadow:si.shadow.reference},cge=e=>{const{colorScheme:i,theme:a}=e,l=vm(`${i}.500`,.6)(a);return{[si.bg.variable]:`colors.${i}.500`,[si.color.variable]:"colors.white",_dark:{[si.bg.variable]:l,[si.color.variable]:"colors.whiteAlpha.800"}}},lge=e=>{const{colorScheme:i,theme:a}=e,l=vm(`${i}.200`,.16)(a);return{[si.bg.variable]:`colors.${i}.100`,[si.color.variable]:`colors.${i}.800`,_dark:{[si.bg.variable]:l,[si.color.variable]:`colors.${i}.200`}}},dge=e=>{const{colorScheme:i,theme:a}=e,l=vm(`${i}.200`,.8)(a);return{[si.color.variable]:`colors.${i}.500`,_dark:{[si.color.variable]:l},[si.shadow.variable]:`inset 0 0 0px 1px ${si.color.reference}`}},uge={solid:cge,subtle:lge,outline:dge},nv={baseStyle:age,variants:uge,defaultProps:{variant:"subtle",colorScheme:"gray"}},{defineMultiStyleConfig:hge,definePartsStyle:gh}=Tr(nme.keys),D6=It("tag-bg"),x6=It("tag-color"),uO=It("tag-shadow"),uT=It("tag-min-height"),hT=It("tag-min-width"),pT=It("tag-font-size"),fT=It("tag-padding-inline"),pge={fontWeight:"medium",lineHeight:1.2,outline:0,[x6.variable]:si.color.reference,[D6.variable]:si.bg.reference,[uO.variable]:si.shadow.reference,color:x6.reference,bg:D6.reference,boxShadow:uO.reference,borderRadius:"md",minH:uT.reference,minW:hT.reference,fontSize:pT.reference,px:fT.reference,_focusVisible:{[uO.variable]:"shadows.outline"}},fge={lineHeight:1.2,overflow:"visible"},mge={fontSize:"lg",w:"5",h:"5",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"1.5",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focusVisible:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},gge=gh({container:pge,label:fge,closeButton:mge}),_ge={sm:gh({container:{[uT.variable]:"sizes.5",[hT.variable]:"sizes.5",[pT.variable]:"fontSizes.xs",[fT.variable]:"space.2"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}}),md:gh({container:{[uT.variable]:"sizes.6",[hT.variable]:"sizes.6",[pT.variable]:"fontSizes.sm",[fT.variable]:"space.2"}}),lg:gh({container:{[uT.variable]:"sizes.8",[hT.variable]:"sizes.8",[pT.variable]:"fontSizes.md",[fT.variable]:"space.3"}})},vge={subtle:gh(e=>{var i;return{container:(i=nv.variants)==null?void 0:i.subtle(e)}}),solid:gh(e=>{var i;return{container:(i=nv.variants)==null?void 0:i.solid(e)}}),outline:gh(e=>{var i;return{container:(i=nv.variants)==null?void 0:i.outline(e)}})},Ege=hge({variants:vge,baseStyle:gge,sizes:_ge,defaultProps:{size:"md",variant:"subtle",colorScheme:"gray"}}),{definePartsStyle:El,defineMultiStyleConfig:yge}=Tr(Wfe.keys),Df=It("input-height"),xf=It("input-font-size"),Lf=It("input-padding"),Mf=It("input-border-radius"),Sge=El({addon:{height:Df.reference,fontSize:xf.reference,px:Lf.reference,borderRadius:Mf.reference},field:{width:"100%",height:Df.reference,fontSize:xf.reference,px:Lf.reference,borderRadius:Mf.reference,minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed"}}}),xd={lg:{[xf.variable]:"fontSizes.lg",[Lf.variable]:"space.4",[Mf.variable]:"radii.md",[Df.variable]:"sizes.12"},md:{[xf.variable]:"fontSizes.md",[Lf.variable]:"space.4",[Mf.variable]:"radii.md",[Df.variable]:"sizes.10"},sm:{[xf.variable]:"fontSizes.sm",[Lf.variable]:"space.3",[Mf.variable]:"radii.sm",[Df.variable]:"sizes.8"},xs:{[xf.variable]:"fontSizes.xs",[Lf.variable]:"space.2",[Mf.variable]:"radii.sm",[Df.variable]:"sizes.6"}},Tge={lg:El({field:xd.lg,group:xd.lg}),md:El({field:xd.md,group:xd.md}),sm:El({field:xd.sm,group:xd.sm}),xs:El({field:xd.xs,group:xd.xs})};function CD(e){const{focusBorderColor:i,errorBorderColor:a}=e;return{focusBorderColor:i||Rt("blue.500","blue.300")(e),errorBorderColor:a||Rt("red.500","red.300")(e)}}var bge=El(e=>{const{theme:i}=e,{focusBorderColor:a,errorBorderColor:l}=CD(e);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:Rt("gray.300","whiteAlpha.400")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:No(i,l),boxShadow:`0 0 0 1px ${No(i,l)}`},_focusVisible:{zIndex:1,borderColor:No(i,a),boxShadow:`0 0 0 1px ${No(i,a)}`}},addon:{border:"1px solid",borderColor:Rt("inherit","whiteAlpha.50")(e),bg:Rt("gray.100","whiteAlpha.300")(e)}}}),Cge=El(e=>{const{theme:i}=e,{focusBorderColor:a,errorBorderColor:l}=CD(e);return{field:{border:"2px solid",borderColor:"transparent",bg:Rt("gray.100","whiteAlpha.50")(e),_hover:{bg:Rt("gray.200","whiteAlpha.100")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:No(i,l)},_focusVisible:{bg:"transparent",borderColor:No(i,a)}},addon:{border:"2px solid",borderColor:"transparent",bg:Rt("gray.100","whiteAlpha.50")(e)}}}),wge=El(e=>{const{theme:i}=e,{focusBorderColor:a,errorBorderColor:l}=CD(e);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:No(i,l),boxShadow:`0px 1px 0px 0px ${No(i,l)}`},_focusVisible:{borderColor:No(i,a),boxShadow:`0px 1px 0px 0px ${No(i,a)}`}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent"}}}),Rge=El({field:{bg:"transparent",px:"0",height:"auto"},addon:{bg:"transparent",px:"0",height:"auto"}}),Ige={outline:bge,filled:Cge,flushed:wge,unstyled:Rge},Mn=yge({baseStyle:Sge,sizes:Tge,variants:Ige,defaultProps:{size:"md",variant:"outline"}}),L6,Age={...(L6=Mn.baseStyle)==null?void 0:L6.field,paddingY:"2",minHeight:"20",lineHeight:"short",verticalAlign:"top"},M6,U6,Oge={outline:e=>{var i,a;return(a=(i=Mn.variants)==null?void 0:i.outline(e).field)!=null?a:{}},flushed:e=>{var i,a;return(a=(i=Mn.variants)==null?void 0:i.flushed(e).field)!=null?a:{}},filled:e=>{var i,a;return(a=(i=Mn.variants)==null?void 0:i.filled(e).field)!=null?a:{}},unstyled:(U6=(M6=Mn.variants)==null?void 0:M6.unstyled.field)!=null?U6:{}},j6,F6,V6,B6,W6,z6,G6,H6,Nge={xs:(F6=(j6=Mn.sizes)==null?void 0:j6.xs.field)!=null?F6:{},sm:(B6=(V6=Mn.sizes)==null?void 0:V6.sm.field)!=null?B6:{},md:(z6=(W6=Mn.sizes)==null?void 0:W6.md.field)!=null?z6:{},lg:(H6=(G6=Mn.sizes)==null?void 0:G6.lg.field)!=null?H6:{}},Pge={baseStyle:Age,sizes:Nge,variants:Oge,defaultProps:{size:"md",variant:"outline"}},PS=Ii("tooltip-bg"),hO=Ii("tooltip-fg"),kge=Ii("popper-arrow-bg"),Dge={bg:PS.reference,color:hO.reference,[PS.variable]:"colors.gray.700",[hO.variable]:"colors.whiteAlpha.900",_dark:{[PS.variable]:"colors.gray.300",[hO.variable]:"colors.gray.900"},[kge.variable]:PS.reference,px:"2",py:"0.5",borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"xs",zIndex:"tooltip"},xge={baseStyle:Dge},{defineMultiStyleConfig:Lge,definePartsStyle:V_}=Tr(Yfe.keys),Mge=e=>{const{colorScheme:i,theme:a,isIndeterminate:l,hasStripe:u}=e,p=Rt(A6(),A6("1rem","rgba(0,0,0,0.1)"))(e),m=Rt(`${i}.500`,`${i}.200`)(e),v=`linear-gradient(
    to right,
    transparent 0%,
    ${No(a,m)} 50%,
    transparent 100%
  )`;return{...!l&&u&&p,...l?{bgImage:v}:{bgColor:m}}},Uge={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"},jge=e=>({bg:Rt("gray.100","whiteAlpha.300")(e)}),Fge=e=>({transitionProperty:"common",transitionDuration:"slow",...Mge(e)}),Vge=V_(e=>({label:Uge,filledTrack:Fge(e),track:jge(e)})),Bge={xs:V_({track:{h:"1"}}),sm:V_({track:{h:"2"}}),md:V_({track:{h:"3"}}),lg:V_({track:{h:"4"}})},Wge=Lge({sizes:Bge,baseStyle:Vge,defaultProps:{size:"md",colorScheme:"blue"}}),zge=e=>typeof e=="function";function ko(e,...i){return zge(e)?e(...i):e}var{definePartsStyle:mT,defineMultiStyleConfig:Gge}=Tr(Ufe.keys),rv=It("checkbox-size"),Hge=e=>{const{colorScheme:i}=e;return{w:rv.reference,h:rv.reference,transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:Rt(`${i}.500`,`${i}.200`)(e),borderColor:Rt(`${i}.500`,`${i}.200`)(e),color:Rt("white","gray.900")(e),_hover:{bg:Rt(`${i}.600`,`${i}.300`)(e),borderColor:Rt(`${i}.600`,`${i}.300`)(e)},_disabled:{borderColor:Rt("gray.200","transparent")(e),bg:Rt("gray.200","whiteAlpha.300")(e),color:Rt("gray.500","whiteAlpha.500")(e)}},_indeterminate:{bg:Rt(`${i}.500`,`${i}.200`)(e),borderColor:Rt(`${i}.500`,`${i}.200`)(e),color:Rt("white","gray.900")(e)},_disabled:{bg:Rt("gray.100","whiteAlpha.100")(e),borderColor:Rt("gray.100","transparent")(e)},_focusVisible:{boxShadow:"outline"},_invalid:{borderColor:Rt("red.500","red.300")(e)}}},$ge={_disabled:{cursor:"not-allowed"}},Kge={userSelect:"none",_disabled:{opacity:.4}},Yge={transitionProperty:"transform",transitionDuration:"normal"},qge=mT(e=>({icon:Yge,container:$ge,control:ko(Hge,e),label:Kge})),Jge={sm:mT({control:{[rv.variable]:"sizes.3"},label:{fontSize:"sm"},icon:{fontSize:"3xs"}}),md:mT({control:{[rv.variable]:"sizes.4"},label:{fontSize:"md"},icon:{fontSize:"2xs"}}),lg:mT({control:{[rv.variable]:"sizes.5"},label:{fontSize:"lg"},icon:{fontSize:"2xs"}})},cb=Gge({baseStyle:qge,sizes:Jge,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:Xge,definePartsStyle:gT}=Tr(qfe.keys),Qge=e=>{var i;const a=(i=ko(cb.baseStyle,e))==null?void 0:i.control;return{...a,borderRadius:"full",_checked:{...a==null?void 0:a._checked,_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}}}},Zge=gT(e=>{var i,a,l,u;return{label:(a=(i=cb).baseStyle)==null?void 0:a.call(i,e).label,container:(u=(l=cb).baseStyle)==null?void 0:u.call(l,e).container,control:Qge(e)}}),e_e={md:gT({control:{w:"4",h:"4"},label:{fontSize:"md"}}),lg:gT({control:{w:"5",h:"5"},label:{fontSize:"lg"}}),sm:gT({control:{width:"3",height:"3"},label:{fontSize:"sm"}})},t_e=Xge({baseStyle:Zge,sizes:e_e,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:n_e,definePartsStyle:r_e}=Tr(Jfe.keys),kS=It("select-bg"),$6,i_e={...($6=Mn.baseStyle)==null?void 0:$6.field,appearance:"none",paddingBottom:"1px",lineHeight:"normal",bg:kS.reference,[kS.variable]:"colors.white",_dark:{[kS.variable]:"colors.gray.700"},"> option, > optgroup":{bg:kS.reference}},o_e={width:"6",height:"100%",insetEnd:"2",position:"relative",color:"currentColor",fontSize:"xl",_disabled:{opacity:.5}},s_e=r_e({field:i_e,icon:o_e}),DS={paddingInlineEnd:"8"},K6,Y6,q6,J6,X6,Q6,Z6,e8,a_e={lg:{...(K6=Mn.sizes)==null?void 0:K6.lg,field:{...(Y6=Mn.sizes)==null?void 0:Y6.lg.field,...DS}},md:{...(q6=Mn.sizes)==null?void 0:q6.md,field:{...(J6=Mn.sizes)==null?void 0:J6.md.field,...DS}},sm:{...(X6=Mn.sizes)==null?void 0:X6.sm,field:{...(Q6=Mn.sizes)==null?void 0:Q6.sm.field,...DS}},xs:{...(Z6=Mn.sizes)==null?void 0:Z6.xs,field:{...(e8=Mn.sizes)==null?void 0:e8.xs.field,...DS},icon:{insetEnd:"1"}}},c_e=n_e({baseStyle:s_e,sizes:a_e,variants:Mn.variants,defaultProps:Mn.defaultProps}),pO=It("skeleton-start-color"),fO=It("skeleton-end-color"),l_e={[pO.variable]:"colors.gray.100",[fO.variable]:"colors.gray.400",_dark:{[pO.variable]:"colors.gray.800",[fO.variable]:"colors.gray.600"},background:pO.reference,borderColor:fO.reference,opacity:.7,borderRadius:"sm"},d_e={baseStyle:l_e},mO=It("skip-link-bg"),u_e={borderRadius:"md",fontWeight:"semibold",_focusVisible:{boxShadow:"outline",padding:"4",position:"fixed",top:"6",insetStart:"6",[mO.variable]:"colors.white",_dark:{[mO.variable]:"colors.gray.700"},bg:mO.reference}},h_e={baseStyle:u_e},{defineMultiStyleConfig:p_e,definePartsStyle:cC}=Tr(Xfe.keys),xv=It("slider-thumb-size"),Lv=It("slider-track-size"),zd=It("slider-bg"),f_e=e=>{const{orientation:i}=e;return{display:"inline-block",position:"relative",cursor:"pointer",_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"},...bD({orientation:i,vertical:{h:"100%"},horizontal:{w:"100%"}})}},m_e=e=>({...bD({orientation:e.orientation,horizontal:{h:Lv.reference},vertical:{w:Lv.reference}}),overflow:"hidden",borderRadius:"sm",[zd.variable]:"colors.gray.200",_dark:{[zd.variable]:"colors.whiteAlpha.200"},_disabled:{[zd.variable]:"colors.gray.300",_dark:{[zd.variable]:"colors.whiteAlpha.300"}},bg:zd.reference}),g_e=e=>{const{orientation:i}=e;return{...bD({orientation:i,vertical:{left:"50%",transform:"translateX(-50%)",_active:{transform:"translateX(-50%) scale(1.15)"}},horizontal:{top:"50%",transform:"translateY(-50%)",_active:{transform:"translateY(-50%) scale(1.15)"}}}),w:xv.reference,h:xv.reference,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",outline:0,zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{bg:"gray.300"}}},__e=e=>{const{colorScheme:i}=e;return{width:"inherit",height:"inherit",[zd.variable]:`colors.${i}.500`,_dark:{[zd.variable]:`colors.${i}.200`},bg:zd.reference}},v_e=cC(e=>({container:f_e(e),track:m_e(e),thumb:g_e(e),filledTrack:__e(e)})),E_e=cC({container:{[xv.variable]:"sizes.4",[Lv.variable]:"sizes.1"}}),y_e=cC({container:{[xv.variable]:"sizes.3.5",[Lv.variable]:"sizes.1"}}),S_e=cC({container:{[xv.variable]:"sizes.2.5",[Lv.variable]:"sizes.0.5"}}),T_e={lg:E_e,md:y_e,sm:S_e},b_e=p_e({baseStyle:v_e,sizes:T_e,defaultProps:{size:"md",colorScheme:"blue"}}),ah=Ii("spinner-size"),C_e={width:[ah.reference],height:[ah.reference]},w_e={xs:{[ah.variable]:"sizes.3"},sm:{[ah.variable]:"sizes.4"},md:{[ah.variable]:"sizes.6"},lg:{[ah.variable]:"sizes.8"},xl:{[ah.variable]:"sizes.12"}},R_e={baseStyle:C_e,sizes:w_e,defaultProps:{size:"md"}},{defineMultiStyleConfig:I_e,definePartsStyle:k9}=Tr(Qfe.keys),A_e={fontWeight:"medium"},O_e={opacity:.8,marginBottom:"2"},N_e={verticalAlign:"baseline",fontWeight:"semibold"},P_e={marginEnd:1,w:"3.5",h:"3.5",verticalAlign:"middle"},k_e=k9({container:{},label:A_e,helpText:O_e,number:N_e,icon:P_e}),D_e={md:k9({label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}})},x_e=I_e({baseStyle:k_e,sizes:D_e,defaultProps:{size:"md"}}),gO=It("kbd-bg"),L_e={[gO.variable]:"colors.gray.100",_dark:{[gO.variable]:"colors.whiteAlpha.100"},bg:gO.reference,borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"},M_e={baseStyle:L_e},U_e={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focusVisible:{boxShadow:"outline"}},j_e={baseStyle:U_e},{defineMultiStyleConfig:F_e,definePartsStyle:V_e}=Tr(zfe.keys),B_e={marginEnd:"2",display:"inline",verticalAlign:"text-bottom"},W_e=V_e({icon:B_e}),z_e=F_e({baseStyle:W_e}),{defineMultiStyleConfig:G_e,definePartsStyle:H_e}=Tr(Gfe.keys),Ec=It("menu-bg"),_O=It("menu-shadow"),$_e={[Ec.variable]:"#fff",[_O.variable]:"shadows.sm",_dark:{[Ec.variable]:"colors.gray.700",[_O.variable]:"shadows.dark-lg"},color:"inherit",minW:"3xs",py:"2",zIndex:1,borderRadius:"md",borderWidth:"1px",bg:Ec.reference,boxShadow:_O.reference},K_e={py:"1.5",px:"3",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{[Ec.variable]:"colors.gray.100",_dark:{[Ec.variable]:"colors.whiteAlpha.100"}},_active:{[Ec.variable]:"colors.gray.200",_dark:{[Ec.variable]:"colors.whiteAlpha.200"}},_expanded:{[Ec.variable]:"colors.gray.100",_dark:{[Ec.variable]:"colors.whiteAlpha.100"}},_disabled:{opacity:.4,cursor:"not-allowed"},bg:Ec.reference},Y_e={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},q_e={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0},J_e={opacity:.6},X_e={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"2",opacity:.6},Q_e={transitionProperty:"common",transitionDuration:"normal"},Z_e=H_e({button:Q_e,list:$_e,item:K_e,groupTitle:Y_e,icon:q_e,command:J_e,divider:X_e}),eve=G_e({baseStyle:Z_e}),{defineMultiStyleConfig:tve,definePartsStyle:vP}=Tr(Hfe.keys),vO=It("modal-bg"),EO=It("modal-shadow"),nve={bg:"blackAlpha.600",zIndex:"modal"},rve=e=>{const{isCentered:i,scrollBehavior:a}=e;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:i?"center":"flex-start",overflow:a==="inside"?"hidden":"auto",overscrollBehaviorY:"none"}},ive=e=>{const{isCentered:i,scrollBehavior:a}=e;return{borderRadius:"md",color:"inherit",my:i?"auto":"16",mx:i?"auto":void 0,zIndex:"modal",maxH:a==="inside"?"calc(100% - 7.5rem)":void 0,[vO.variable]:"colors.white",[EO.variable]:"shadows.lg",_dark:{[vO.variable]:"colors.gray.700",[EO.variable]:"shadows.dark-lg"},bg:vO.reference,boxShadow:EO.reference}},ove={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},sve={position:"absolute",top:"2",insetEnd:"3"},ave=e=>{const{scrollBehavior:i}=e;return{px:"6",py:"2",flex:"1",overflow:i==="inside"?"auto":void 0}},cve={px:"6",py:"4"},lve=vP(e=>({overlay:nve,dialogContainer:ko(rve,e),dialog:ko(ive,e),header:ove,closeButton:sve,body:ko(ave,e),footer:cve}));function ja(e){return vP(e==="full"?{dialog:{maxW:"100vw",minH:"$100vh",my:"0",borderRadius:"0"}}:{dialog:{maxW:e}})}var dve={xs:ja("xs"),sm:ja("sm"),md:ja("md"),lg:ja("lg"),xl:ja("xl"),"2xl":ja("2xl"),"3xl":ja("3xl"),"4xl":ja("4xl"),"5xl":ja("5xl"),"6xl":ja("6xl"),full:ja("full")},uve=tve({baseStyle:lve,sizes:dve,defaultProps:{size:"md"}}),{defineMultiStyleConfig:hve,definePartsStyle:D9}=Tr($fe.keys),wD=Ii("number-input-stepper-width"),x9=Ii("number-input-input-padding"),pve=ml(wD).add("0.5rem").toString(),yO=Ii("number-input-bg"),SO=Ii("number-input-color"),TO=Ii("number-input-border-color"),fve={[wD.variable]:"sizes.6",[x9.variable]:pve},mve=e=>{var i,a;return(a=(i=ko(Mn.baseStyle,e))==null?void 0:i.field)!=null?a:{}},gve={width:wD.reference},_ve={borderStart:"1px solid",borderStartColor:TO.reference,color:SO.reference,bg:yO.reference,[SO.variable]:"colors.chakra-body-text",[TO.variable]:"colors.chakra-border-color",_dark:{[SO.variable]:"colors.whiteAlpha.800",[TO.variable]:"colors.whiteAlpha.300"},_active:{[yO.variable]:"colors.gray.200",_dark:{[yO.variable]:"colors.whiteAlpha.300"}},_disabled:{opacity:.4,cursor:"not-allowed"}},vve=D9(e=>{var i;return{root:fve,field:(i=ko(mve,e))!=null?i:{},stepperGroup:gve,stepper:_ve}});function xS(e){var i,a,l;const u=(i=Mn.sizes)==null?void 0:i[e],p={lg:"md",md:"md",sm:"sm",xs:"sm"},m=(l=(a=u.field)==null?void 0:a.fontSize)!=null?l:"md",v=I9.fontSizes[m];return D9({field:{...u.field,paddingInlineEnd:x9.reference,verticalAlign:"top"},stepper:{fontSize:ml(v).multiply(.75).toString(),_first:{borderTopEndRadius:p[e]},_last:{borderBottomEndRadius:p[e],mt:"-1px",borderTopWidth:1}}})}var Eve={xs:xS("xs"),sm:xS("sm"),md:xS("md"),lg:xS("lg")},yve=hve({baseStyle:vve,sizes:Eve,variants:Mn.variants,defaultProps:Mn.defaultProps}),t8,Sve={...(t8=Mn.baseStyle)==null?void 0:t8.field,textAlign:"center"},Tve={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}},n8,r8,bve={outline:e=>{var i,a,l;return(l=(a=ko((i=Mn.variants)==null?void 0:i.outline,e))==null?void 0:a.field)!=null?l:{}},flushed:e=>{var i,a,l;return(l=(a=ko((i=Mn.variants)==null?void 0:i.flushed,e))==null?void 0:a.field)!=null?l:{}},filled:e=>{var i,a,l;return(l=(a=ko((i=Mn.variants)==null?void 0:i.filled,e))==null?void 0:a.field)!=null?l:{}},unstyled:(r8=(n8=Mn.variants)==null?void 0:n8.unstyled.field)!=null?r8:{}},Cve={baseStyle:Sve,sizes:Tve,variants:bve,defaultProps:Mn.defaultProps},{defineMultiStyleConfig:wve,definePartsStyle:Rve}=Tr(Kfe.keys),LS=Ii("popper-bg"),Ive=Ii("popper-arrow-bg"),i8=Ii("popper-arrow-shadow-color"),Ave={zIndex:10},Ove={[LS.variable]:"colors.white",bg:LS.reference,[Ive.variable]:LS.reference,[i8.variable]:"colors.gray.200",_dark:{[LS.variable]:"colors.gray.700",[i8.variable]:"colors.whiteAlpha.300"},width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focusVisible:{outline:0,boxShadow:"outline"}},Nve={px:3,py:2,borderBottomWidth:"1px"},Pve={px:3,py:2},kve={px:3,py:2,borderTopWidth:"1px"},Dve={position:"absolute",borderRadius:"md",top:1,insetEnd:2,padding:2},xve=Rve({popper:Ave,content:Ove,header:Nve,body:Pve,footer:kve,closeButton:Dve}),Lve=wve({baseStyle:xve}),{definePartsStyle:EP,defineMultiStyleConfig:Mve}=Tr(jfe.keys),bO=It("drawer-bg"),CO=It("drawer-box-shadow");function lf(e){return EP(e==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:e}})}var Uve={bg:"blackAlpha.600",zIndex:"modal"},jve={display:"flex",zIndex:"modal",justifyContent:"center"},Fve=e=>{const{isFullHeight:i}=e;return{...i&&{height:"100vh"},zIndex:"modal",maxH:"100vh",color:"inherit",[bO.variable]:"colors.white",[CO.variable]:"shadows.lg",_dark:{[bO.variable]:"colors.gray.700",[CO.variable]:"shadows.dark-lg"},bg:bO.reference,boxShadow:CO.reference}},Vve={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},Bve={position:"absolute",top:"2",insetEnd:"3"},Wve={px:"6",py:"2",flex:"1",overflow:"auto"},zve={px:"6",py:"4"},Gve=EP(e=>({overlay:Uve,dialogContainer:jve,dialog:ko(Fve,e),header:Vve,closeButton:Bve,body:Wve,footer:zve})),Hve={xs:lf("xs"),sm:lf("md"),md:lf("lg"),lg:lf("2xl"),xl:lf("4xl"),full:lf("full")},$ve=Mve({baseStyle:Gve,sizes:Hve,defaultProps:{size:"xs"}}),{definePartsStyle:Kve,defineMultiStyleConfig:Yve}=Tr(Ffe.keys),qve={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal"},Jve={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},Xve={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},Qve=Kve({preview:qve,input:Jve,textarea:Xve}),Zve=Yve({baseStyle:Qve}),{definePartsStyle:eEe,defineMultiStyleConfig:tEe}=Tr(Vfe.keys),Qf=It("form-control-color"),nEe={marginStart:"1",[Qf.variable]:"colors.red.500",_dark:{[Qf.variable]:"colors.red.300"},color:Qf.reference},rEe={mt:"2",[Qf.variable]:"colors.gray.600",_dark:{[Qf.variable]:"colors.whiteAlpha.600"},color:Qf.reference,lineHeight:"normal",fontSize:"sm"},iEe=eEe({container:{width:"100%",position:"relative"},requiredIndicator:nEe,helperText:rEe}),oEe=tEe({baseStyle:iEe}),{definePartsStyle:sEe,defineMultiStyleConfig:aEe}=Tr(Bfe.keys),Zf=It("form-error-color"),cEe={[Zf.variable]:"colors.red.500",_dark:{[Zf.variable]:"colors.red.300"},color:Zf.reference,mt:"2",fontSize:"sm",lineHeight:"normal"},lEe={marginEnd:"0.5em",[Zf.variable]:"colors.red.500",_dark:{[Zf.variable]:"colors.red.300"},color:Zf.reference},dEe=sEe({text:cEe,icon:lEe}),uEe=aEe({baseStyle:dEe}),hEe={fontSize:"md",marginEnd:"3",mb:"2",fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},pEe={baseStyle:hEe},fEe={fontFamily:"heading",fontWeight:"bold"},mEe={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},gEe={baseStyle:fEe,sizes:mEe,defaultProps:{size:"xl"}},{defineMultiStyleConfig:_Ee,definePartsStyle:vEe}=Tr(Mfe.keys),wO=It("breadcrumb-link-decor"),EEe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",outline:"none",color:"inherit",textDecoration:wO.reference,[wO.variable]:"none","&:not([aria-current=page])":{cursor:"pointer",_hover:{[wO.variable]:"underline"},_focusVisible:{boxShadow:"outline"}}},yEe=vEe({link:EEe}),SEe=_Ee({baseStyle:yEe}),TEe={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}},L9=e=>{const{colorScheme:i,theme:a}=e;if(i==="gray")return{color:Rt("gray.800","whiteAlpha.900")(e),_hover:{bg:Rt("gray.100","whiteAlpha.200")(e)},_active:{bg:Rt("gray.200","whiteAlpha.300")(e)}};const l=vm(`${i}.200`,.12)(a),u=vm(`${i}.200`,.24)(a);return{color:Rt(`${i}.600`,`${i}.200`)(e),bg:"transparent",_hover:{bg:Rt(`${i}.50`,l)(e)},_active:{bg:Rt(`${i}.100`,u)(e)}}},bEe=e=>{const{colorScheme:i}=e,a=Rt("gray.200","whiteAlpha.300")(e);return{border:"1px solid",borderColor:i==="gray"?a:"currentColor",".chakra-button__group[data-attached][data-orientation=horizontal] > &:not(:last-of-type)":{marginEnd:"-1px"},".chakra-button__group[data-attached][data-orientation=vertical] > &:not(:last-of-type)":{marginBottom:"-1px"},...ko(L9,e)}},CEe={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}},wEe=e=>{var i;const{colorScheme:a}=e;if(a==="gray"){const y=Rt("gray.100","whiteAlpha.200")(e);return{bg:y,color:Rt("gray.800","whiteAlpha.900")(e),_hover:{bg:Rt("gray.200","whiteAlpha.300")(e),_disabled:{bg:y}},_active:{bg:Rt("gray.300","whiteAlpha.400")(e)}}}const{bg:l=`${a}.500`,color:u="white",hoverBg:p=`${a}.600`,activeBg:m=`${a}.700`}=(i=CEe[a])!=null?i:{},v=Rt(l,`${a}.200`)(e);return{bg:v,color:Rt(u,"gray.800")(e),_hover:{bg:Rt(p,`${a}.300`)(e),_disabled:{bg:v}},_active:{bg:Rt(m,`${a}.400`)(e)}}},REe=e=>{const{colorScheme:i}=e;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:Rt(`${i}.500`,`${i}.200`)(e),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:Rt(`${i}.700`,`${i}.500`)(e)}}},IEe={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:"0",p:"0"},AEe={ghost:L9,outline:bEe,solid:wEe,link:REe,unstyled:IEe},OEe={lg:{h:"12",minW:"12",fontSize:"lg",px:"6"},md:{h:"10",minW:"10",fontSize:"md",px:"4"},sm:{h:"8",minW:"8",fontSize:"sm",px:"3"},xs:{h:"6",minW:"6",fontSize:"xs",px:"2"}},NEe={baseStyle:TEe,variants:AEe,sizes:OEe,defaultProps:{variant:"solid",size:"md",colorScheme:"gray"}},{definePartsStyle:_h,defineMultiStyleConfig:PEe}=Tr(rme.keys),lb=It("card-bg"),Cl=It("card-padding"),M9=It("card-shadow"),_T=It("card-radius"),U9=It("card-border-width","0"),j9=It("card-border-color"),kEe=_h({container:{[lb.variable]:"colors.chakra-body-bg",backgroundColor:lb.reference,boxShadow:M9.reference,borderRadius:_T.reference,color:"chakra-body-text",borderWidth:U9.reference,borderColor:j9.reference},body:{padding:Cl.reference,flex:"1 1 0%"},header:{padding:Cl.reference},footer:{padding:Cl.reference}}),DEe={sm:_h({container:{[_T.variable]:"radii.base",[Cl.variable]:"space.3"}}),md:_h({container:{[_T.variable]:"radii.md",[Cl.variable]:"space.5"}}),lg:_h({container:{[_T.variable]:"radii.xl",[Cl.variable]:"space.7"}})},xEe={elevated:_h({container:{[M9.variable]:"shadows.base",_dark:{[lb.variable]:"colors.gray.700"}}}),outline:_h({container:{[U9.variable]:"1px",[j9.variable]:"colors.chakra-border-color"}}),filled:_h({container:{[lb.variable]:"colors.chakra-subtle-bg"}}),unstyled:{body:{[Cl.variable]:0},header:{[Cl.variable]:0},footer:{[Cl.variable]:0}}},LEe=PEe({baseStyle:kEe,variants:xEe,sizes:DEe,defaultProps:{variant:"elevated",size:"md"}}),iv=Ii("close-button-size"),R_=Ii("close-button-bg"),MEe={w:[iv.reference],h:[iv.reference],borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{[R_.variable]:"colors.blackAlpha.100",_dark:{[R_.variable]:"colors.whiteAlpha.100"}},_active:{[R_.variable]:"colors.blackAlpha.200",_dark:{[R_.variable]:"colors.whiteAlpha.200"}},_focusVisible:{boxShadow:"outline"},bg:R_.reference},UEe={lg:{[iv.variable]:"sizes.10",fontSize:"md"},md:{[iv.variable]:"sizes.8",fontSize:"xs"},sm:{[iv.variable]:"sizes.6",fontSize:"2xs"}},jEe={baseStyle:MEe,sizes:UEe,defaultProps:{size:"md"}},{variants:FEe,defaultProps:VEe}=nv,BEe={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm",bg:si.bg.reference,color:si.color.reference,boxShadow:si.shadow.reference},WEe={baseStyle:BEe,variants:FEe,defaultProps:VEe},zEe={w:"100%",mx:"auto",maxW:"prose",px:"4"},GEe={baseStyle:zEe},HEe={opacity:.6,borderColor:"inherit"},$Ee={borderStyle:"solid"},KEe={borderStyle:"dashed"},YEe={solid:$Ee,dashed:KEe},qEe={baseStyle:HEe,variants:YEe,defaultProps:{variant:"solid"}},{definePartsStyle:JEe,defineMultiStyleConfig:XEe}=Tr(Dfe.keys),QEe={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},ZEe={transitionProperty:"common",transitionDuration:"normal",fontSize:"md",_focusVisible:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:"4",py:"2"},eye={pt:"2",px:"4",pb:"5"},tye={fontSize:"1.25em"},nye=JEe({container:QEe,button:ZEe,panel:eye,icon:tye}),rye=XEe({baseStyle:nye}),{definePartsStyle:iE,defineMultiStyleConfig:iye}=Tr(xfe.keys),ks=It("alert-fg"),Dl=It("alert-bg"),oye=iE({container:{bg:Dl.reference,px:"4",py:"3"},title:{fontWeight:"bold",lineHeight:"6",marginEnd:"2"},description:{lineHeight:"6"},icon:{color:ks.reference,flexShrink:0,marginEnd:"3",w:"5",h:"6"},spinner:{color:ks.reference,flexShrink:0,marginEnd:"3",w:"5",h:"5"}});function RD(e){const{theme:i,colorScheme:a}=e,l=vm(`${a}.200`,.16)(i);return{light:`colors.${a}.100`,dark:l}}var sye=iE(e=>{const{colorScheme:i}=e,a=RD(e);return{container:{[ks.variable]:`colors.${i}.600`,[Dl.variable]:a.light,_dark:{[ks.variable]:`colors.${i}.200`,[Dl.variable]:a.dark}}}}),aye=iE(e=>{const{colorScheme:i}=e,a=RD(e);return{container:{[ks.variable]:`colors.${i}.600`,[Dl.variable]:a.light,_dark:{[ks.variable]:`colors.${i}.200`,[Dl.variable]:a.dark},paddingStart:"3",borderStartWidth:"4px",borderStartColor:ks.reference}}}),cye=iE(e=>{const{colorScheme:i}=e,a=RD(e);return{container:{[ks.variable]:`colors.${i}.600`,[Dl.variable]:a.light,_dark:{[ks.variable]:`colors.${i}.200`,[Dl.variable]:a.dark},pt:"2",borderTopWidth:"4px",borderTopColor:ks.reference}}}),lye=iE(e=>{const{colorScheme:i}=e;return{container:{[ks.variable]:"colors.white",[Dl.variable]:`colors.${i}.600`,_dark:{[ks.variable]:"colors.gray.900",[Dl.variable]:`colors.${i}.200`},color:ks.reference}}}),dye={subtle:sye,"left-accent":aye,"top-accent":cye,solid:lye},uye=iye({baseStyle:oye,variants:dye,defaultProps:{variant:"subtle",colorScheme:"blue"}}),{definePartsStyle:F9,defineMultiStyleConfig:hye}=Tr(Lfe.keys),em=It("avatar-border-color"),ov=It("avatar-bg"),Mv=It("avatar-font-size"),Em=It("avatar-size"),pye={borderRadius:"full",border:"0.2em solid",borderColor:em.reference,[em.variable]:"white",_dark:{[em.variable]:"colors.gray.800"}},fye={bg:ov.reference,fontSize:Mv.reference,width:Em.reference,height:Em.reference,lineHeight:"1",[ov.variable]:"colors.gray.200",_dark:{[ov.variable]:"colors.whiteAlpha.400"}},mye=e=>{const{name:i,theme:a}=e,l=i?bme({string:i}):"colors.gray.400",u=Sme(l)(a);let p="white";return u||(p="gray.800"),{bg:ov.reference,fontSize:Mv.reference,color:p,borderColor:em.reference,verticalAlign:"top",width:Em.reference,height:Em.reference,"&:not([data-loaded])":{[ov.variable]:l},[em.variable]:"colors.white",_dark:{[em.variable]:"colors.gray.800"}}},gye={fontSize:Mv.reference,lineHeight:"1"},_ye=F9(e=>({badge:ko(pye,e),excessLabel:ko(fye,e),container:ko(mye,e),label:gye}));function Ld(e){const i=e!=="100%"?O9[e]:void 0;return F9({container:{[Em.variable]:i??e,[Mv.variable]:`calc(${i??e} / 2.5)`},excessLabel:{[Em.variable]:i??e,[Mv.variable]:`calc(${i??e} / 2.5)`}})}var vye={"2xs":Ld(4),xs:Ld(6),sm:Ld(8),md:Ld(12),lg:Ld(16),xl:Ld(24),"2xl":Ld(32),full:Ld("100%")},Eye=hye({baseStyle:_ye,sizes:vye,defaultProps:{size:"md"}}),yye={Accordion:rye,Alert:uye,Avatar:Eye,Badge:nv,Breadcrumb:SEe,Button:NEe,Checkbox:cb,CloseButton:jEe,Code:WEe,Container:GEe,Divider:qEe,Drawer:$ve,Editable:Zve,Form:oEe,FormError:uEe,FormLabel:pEe,Heading:gEe,Input:Mn,Kbd:M_e,Link:j_e,List:z_e,Menu:eve,Modal:uve,NumberInput:yve,PinInput:Cve,Popover:Lve,Progress:Wge,Radio:t_e,Select:c_e,Skeleton:d_e,SkipLink:h_e,Slider:b_e,Spinner:R_e,Stat:x_e,Switch:jme,Table:Hme,Tabs:sge,Tag:Ege,Textarea:Pge,Tooltip:xge,Card:LEe,Stepper:kfe},Sye={colors:{"chakra-body-text":{_light:"gray.800",_dark:"whiteAlpha.900"},"chakra-body-bg":{_light:"white",_dark:"gray.800"},"chakra-border-color":{_light:"gray.200",_dark:"whiteAlpha.300"},"chakra-inverse-text":{_light:"white",_dark:"gray.800"},"chakra-subtle-bg":{_light:"gray.100",_dark:"gray.700"},"chakra-subtle-text":{_light:"gray.600",_dark:"gray.400"},"chakra-placeholder-color":{_light:"gray.500",_dark:"whiteAlpha.400"}}},Tye={global:{body:{fontFamily:"body",color:"chakra-body-text",bg:"chakra-body-bg",transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:"chakra-placeholder-color"},"*, *::before, &::after":{borderColor:"chakra-border-color"}}},bye="ltr",Cye={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},V9={semanticTokens:Sye,direction:bye,...Ofe,components:yye,styles:Tye,config:Cye};function B_(e){return typeof e=="function"}function wye(...e){return i=>e.reduce((a,l)=>l(a),i)}var Rye=e=>function(...a){let l=[...a],u=a[a.length-1];return ofe(u)&&l.length>1?l=l.slice(0,l.length-1):u=e,wye(...l.map(p=>m=>B_(p)?p(m):Aye(m,p)))(u)},Iye=Rye(V9);function Aye(...e){return fa({},...e,B9)}function B9(e,i,a,l){if((B_(e)||B_(i))&&Object.prototype.hasOwnProperty.call(l,a))return(...u)=>{const p=B_(e)?e(...u):e,m=B_(i)?i(...u):i;return fa({},p,m,B9)}}function Oye(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Nye=Oye();function Pye(e,i){const a={};return Object.keys(e).forEach(l=>{i.includes(l)||(a[l]=e[l])}),a}function kye(e,i,a,l){const u=typeof i=="string"?i.split("."):[i];for(l=0;l<u.length&&e;l+=1)e=e[u[l]];return e===void 0?a:e}var Dye=e=>{const i=new WeakMap;return(l,u,p,m)=>{if(typeof l>"u")return e(l,u,p);i.has(l)||i.set(l,new Map);const v=i.get(l);if(v.has(u))return v.get(u);const y=e(l,u,p,m);return v.set(u,y),y}},W9=Dye(kye);function z9(e,i){const a={};return Object.keys(e).forEach(l=>{const u=e[l];i(u,l,e)&&(a[l]=u)}),a}var G9=e=>z9(e,i=>i!=null);function xye(e){return typeof e=="function"}function H9(e,...i){return xye(e)?e(...i):e}function Lye(...e){return function(a){e.some(l=>(l==null||l(a),a==null?void 0:a.defaultPrevented))}}const $9=1/60*1e3,Mye=typeof performance<"u"?()=>performance.now():()=>Date.now(),K9=typeof window<"u"?e=>window.requestAnimationFrame(e):e=>setTimeout(()=>e(Mye()),$9);function Uye(e){let i=[],a=[],l=0,u=!1,p=!1;const m=new WeakSet,v={schedule:(y,S=!1,C=!1)=>{const R=C&&u,N=R?i:a;return S&&m.add(y),N.indexOf(y)===-1&&(N.push(y),R&&u&&(l=i.length)),y},cancel:y=>{const S=a.indexOf(y);S!==-1&&a.splice(S,1),m.delete(y)},process:y=>{if(u){p=!0;return}if(u=!0,[i,a]=[a,i],a.length=0,l=i.length,l)for(let S=0;S<l;S++){const C=i[S];C(y),m.has(C)&&(v.schedule(C),e())}u=!1,p&&(p=!1,v.process(y))}};return v}const jye=40;let yP=!0,Uv=!1,SP=!1;const tm={delta:0,timestamp:0},oE=["read","update","preRender","render","postRender"],lC=oE.reduce((e,i)=>(e[i]=Uye(()=>Uv=!0),e),{}),Fye=oE.reduce((e,i)=>{const a=lC[i];return e[i]=(l,u=!1,p=!1)=>(Uv||Wye(),a.schedule(l,u,p)),e},{}),Vye=oE.reduce((e,i)=>(e[i]=lC[i].cancel,e),{});oE.reduce((e,i)=>(e[i]=()=>lC[i].process(tm),e),{});const Bye=e=>lC[e].process(tm),Y9=e=>{Uv=!1,tm.delta=yP?$9:Math.max(Math.min(e-tm.timestamp,jye),1),tm.timestamp=e,SP=!0,oE.forEach(Bye),SP=!1,Uv&&(yP=!1,K9(Y9))},Wye=()=>{Uv=!0,yP=!0,SP||K9(Y9)},o8=()=>tm;var zye=typeof Element<"u",Gye=typeof Map=="function",Hye=typeof Set=="function",$ye=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function vT(e,i){if(e===i)return!0;if(e&&i&&typeof e=="object"&&typeof i=="object"){if(e.constructor!==i.constructor)return!1;var a,l,u;if(Array.isArray(e)){if(a=e.length,a!=i.length)return!1;for(l=a;l--!==0;)if(!vT(e[l],i[l]))return!1;return!0}var p;if(Gye&&e instanceof Map&&i instanceof Map){if(e.size!==i.size)return!1;for(p=e.entries();!(l=p.next()).done;)if(!i.has(l.value[0]))return!1;for(p=e.entries();!(l=p.next()).done;)if(!vT(l.value[1],i.get(l.value[0])))return!1;return!0}if(Hye&&e instanceof Set&&i instanceof Set){if(e.size!==i.size)return!1;for(p=e.entries();!(l=p.next()).done;)if(!i.has(l.value[0]))return!1;return!0}if($ye&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(i)){if(a=e.length,a!=i.length)return!1;for(l=a;l--!==0;)if(e[l]!==i[l])return!1;return!0}if(e.constructor===RegExp)return e.source===i.source&&e.flags===i.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof i.valueOf=="function")return e.valueOf()===i.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof i.toString=="function")return e.toString()===i.toString();if(u=Object.keys(e),a=u.length,a!==Object.keys(i).length)return!1;for(l=a;l--!==0;)if(!Object.prototype.hasOwnProperty.call(i,u[l]))return!1;if(zye&&e instanceof Element)return!1;for(l=a;l--!==0;)if(!((u[l]==="_owner"||u[l]==="__v"||u[l]==="__o")&&e.$$typeof)&&!vT(e[u[l]],i[u[l]]))return!1;return!0}return e!==e&&i!==i}var Kye=function(i,a){try{return vT(i,a)}catch(l){if((l.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw l}};const Yye=Uh(Kye);function q9(e,i={}){var a;const{styleConfig:l,...u}=i,{theme:p,colorMode:m}=v9(),v=e?W9(p,`components.${e}`):void 0,y=l||v,S=fa({theme:p,colorMode:m},(a=y==null?void 0:y.defaultProps)!=null?a:{},G9(Pye(u,["children"]))),C=F.useRef({});if(y){const N=nfe(y)(S);Yye(C.current,N)||(C.current=N)}return C.current}function Ka(e,i={}){return q9(e,i)}function Ai(e,i={}){return q9(e,i)}var qye=new Set([...Gpe,"textStyle","layerStyle","apply","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),Jye=new Set(["htmlWidth","htmlHeight","htmlSize","htmlTranslate"]);function Xye(e){return Jye.has(e)||!qye.has(e)}function Qye(e,...i){if(e==null)throw new TypeError("Cannot convert undefined or null to object");const a={...e};for(const l of i)if(l!=null)for(const u in l)Object.prototype.hasOwnProperty.call(l,u)&&(u in a&&delete a[u],a[u]=l[u]);return a}function ID(e){const i=Object.assign({},e);for(let a in i)i[a]===void 0&&delete i[a];return i}var Zye=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,e0e=t9(function(e){return Zye.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),t0e=e0e,n0e=function(i){return i!=="theme"},s8=function(i){return typeof i=="string"&&i.charCodeAt(0)>96?t0e:n0e},a8=function(i,a,l){var u;if(a){var p=a.shouldForwardProp;u=i.__emotion_forwardProp&&p?function(m){return i.__emotion_forwardProp(m)&&p(m)}:p}return typeof u!="function"&&l&&(u=i.__emotion_forwardProp),u},r0e=function(i){var a=i.cache,l=i.serialized,u=i.isStringTag;return a9(a,l,u),vhe(function(){return c9(a,l,u)}),null},i0e=function e(i,a){var l=i.__emotion_real===i,u=l&&i.__emotion_base||i,p,m;a!==void 0&&(p=a.label,m=a.target);var v=a8(i,a,l),y=v||s8(u),S=!y("as");return function(){var C=arguments,R=l&&i.__emotion_styles!==void 0?i.__emotion_styles.slice(0):[];if(p!==void 0&&R.push("label:"+p+";"),C[0]==null||C[0].raw===void 0)R.push.apply(R,C);else{R.push(C[0][0]);for(var N=C.length,x=1;x<N;x++)R.push(C[x],C[0][x])}var U=h9(function(M,z,V){var W=S&&M.as||u,H="",q=[],ee=M;if(M.theme==null){ee={};for(var oe in M)ee[oe]=M[oe];ee.theme=F.useContext(kv)}typeof M.className=="string"?H=uhe(z.registered,q,M.className):M.className!=null&&(H=M.className+" ");var se=fD(R.concat(q),z.registered,ee);H+=z.key+"-"+se.name,m!==void 0&&(H+=" "+m);var re=S&&v===void 0?s8(W):y,me={};for(var pe in M)S&&pe==="as"||re(pe)&&(me[pe]=M[pe]);return me.className=H,me.ref=V,F.createElement(F.Fragment,null,F.createElement(r0e,{cache:z,serialized:se,isStringTag:typeof W=="string"}),F.createElement(W,me))});return U.displayName=p!==void 0?p:"Styled("+(typeof u=="string"?u:u.displayName||u.name||"Component")+")",U.defaultProps=i.defaultProps,U.__emotion_real=U,U.__emotion_base=u,U.__emotion_styles=R,U.__emotion_forwardProp=v,Object.defineProperty(U,"toString",{value:function(){return"."+m}}),U.withComponent=function(M,z){return e(M,Oh({},a,z,{shouldForwardProp:a8(U,z,!0)})).apply(void 0,R)},U}},o0e=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],db=i0e.bind();o0e.forEach(function(e){db[e]=db(e)});var c8,s0e=(c8=db.default)!=null?c8:db,a0e=({baseStyle:e})=>i=>{const{theme:a,css:l,__css:u,sx:p,...m}=i,v=z9(m,(R,N)=>$pe(N)),y=H9(e,i),S=Qye({},u,y,G9(v),p),C=R9(S)(i.theme);return l?[C,l]:C};function RO(e,i){const{baseStyle:a,...l}=i??{};l.shouldForwardProp||(l.shouldForwardProp=Xye);const u=a0e({baseStyle:a}),p=s0e(e,l)(u);return ns.forwardRef(function(y,S){const{colorMode:C,forced:R}=_D();return ns.createElement(p,{ref:S,"data-theme":R?C:void 0,...y})})}function c0e(){const e=new Map;return new Proxy(RO,{apply(i,a,l){return RO(...l)},get(i,a){return e.has(a)||e.set(a,RO(a)),e.get(a)}})}var je=c0e();function $e(e){return F.forwardRef(e)}function J9(e={}){const{strict:i=!0,errorMessage:a="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:l}=e,u=F.createContext(void 0);u.displayName=l;function p(){var m;const v=F.useContext(u);if(!v&&i){const y=new Error(a);throw y.name="ContextError",(m=Error.captureStackTrace)==null||m.call(Error,y,p),y}return v}return[u.Provider,p,u]}function l0e(e){const{cssVarsRoot:i,theme:a,children:l}=e,u=F.useMemo(()=>Wpe(a),[a]);return b.jsxs(She,{theme:u,children:[b.jsx(d0e,{root:i}),l]})}function d0e({root:e=":host, :root"}){const i=[e,"[data-theme]"].join(",");return b.jsx(rC,{styles:a=>({[i]:a.__cssVars})})}J9({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "});function X9(e){return J9({name:`${e}StylesContext`,errorMessage:`useStyles: "styles" is undefined. Seems you forgot to wrap the components in "<${e} />" `})}function u0e(){const{colorMode:e}=_D();return b.jsx(rC,{styles:i=>{const a=W9(i,"styles.global"),l=H9(a,{theme:i,colorMode:e});return l?R9(l)(i):void 0}})}var AD=F.createContext({getDocument(){return document},getWindow(){return window}});AD.displayName="EnvironmentContext";function h0e({defer:e}={}){const[,i]=F.useReducer(a=>a+1,0);return bl(()=>{e&&i()},[e]),F.useContext(AD)}function Q9(e){const{children:i,environment:a,disabled:l}=e,u=F.useRef(null),p=F.useMemo(()=>a||{getDocument:()=>{var v,y;return(y=(v=u.current)==null?void 0:v.ownerDocument)!=null?y:document},getWindow:()=>{var v,y;return(y=(v=u.current)==null?void 0:v.ownerDocument.defaultView)!=null?y:window}},[a]),m=!l||!a;return b.jsxs(AD.Provider,{value:p,children:[i,m&&b.jsx("span",{id:"__chakra_env",hidden:!0,ref:u})]})}Q9.displayName="EnvironmentProvider";var p0e=e=>{const{children:i,colorModeManager:a,portalZIndex:l,resetScope:u,resetCSS:p=!0,theme:m={},environment:v,cssVarsRoot:y,disableEnvironment:S,disableGlobalStyle:C}=e,R=b.jsx(Q9,{environment:v,disabled:S,children:i});return b.jsx(l0e,{theme:m,cssVarsRoot:y,children:b.jsxs(_9,{colorModeManager:a,options:m.config,children:[p?b.jsx(Che,{scope:u}):b.jsx(bhe,{}),!C&&b.jsx(u0e,{}),l?b.jsx(m9,{zIndex:l,children:R}):R]})})},f0e=(e,i)=>e.find(a=>a.id===i);function l8(e,i){const a=Z9(e,i),l=a?e[a].findIndex(u=>u.id===i):-1;return{position:a,index:l}}function Z9(e,i){for(const[a,l]of Object.entries(e))if(f0e(l,i))return a}function m0e(e){const i=e.includes("right"),a=e.includes("left");let l="center";return i&&(l="flex-end"),a&&(l="flex-start"),{display:"flex",flexDirection:"column",alignItems:l}}function g0e(e){const a=e==="top"||e==="bottom"?"0 auto":void 0,l=e.includes("top")?"env(safe-area-inset-top, 0px)":void 0,u=e.includes("bottom")?"env(safe-area-inset-bottom, 0px)":void 0,p=e.includes("left")?void 0:"env(safe-area-inset-right, 0px)",m=e.includes("right")?void 0:"env(safe-area-inset-left, 0px)";return{position:"fixed",zIndex:"var(--toast-z-index, 5500)",pointerEvents:"none",display:"flex",flexDirection:"column",margin:a,top:l,bottom:u,right:p,left:m}}function ss(e,i=[]){const a=F.useRef(e);return F.useEffect(()=>{a.current=e}),F.useCallback((...l)=>{var u;return(u=a.current)==null?void 0:u.call(a,...l)},i)}function _0e(e,i){const a=ss(e);F.useEffect(()=>{if(i==null)return;let l=null;return l=window.setTimeout(()=>{a()},i),()=>{l&&window.clearTimeout(l)}},[i,a])}function Nh(e,i){const a=F.useRef(!1),l=F.useRef(!1);F.useEffect(()=>{if(a.current&&l.current)return e();l.current=!0},i),F.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[])}const OD=F.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),dC=F.createContext({}),sE=F.createContext(null),ND=typeof document<"u",PD=ND?F.useLayoutEffect:F.useEffect,e7=F.createContext({strict:!1}),kD=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),v0e="framerAppearId",t7="data-"+kD(v0e),E0e={skipAnimations:!1,useManualTiming:!1};class d8{constructor(){this.order=[],this.scheduled=new Set}add(i){if(!this.scheduled.has(i))return this.scheduled.add(i),this.order.push(i),!0}remove(i){const a=this.order.indexOf(i);a!==-1&&(this.order.splice(a,1),this.scheduled.delete(i))}clear(){this.order.length=0,this.scheduled.clear()}}function y0e(e){let i=new d8,a=new d8,l=0,u=!1,p=!1;const m=new WeakSet,v={schedule:(y,S=!1,C=!1)=>{const R=C&&u,N=R?i:a;return S&&m.add(y),N.add(y)&&R&&u&&(l=i.order.length),y},cancel:y=>{a.remove(y),m.delete(y)},process:y=>{if(u){p=!0;return}if(u=!0,[i,a]=[a,i],a.clear(),l=i.order.length,l)for(let S=0;S<l;S++){const C=i.order[S];m.has(C)&&(v.schedule(C),e()),C(y)}u=!1,p&&(p=!1,v.process(y))}};return v}const MS=["read","resolveKeyframes","update","preRender","render","postRender"],S0e=40;function n7(e,i){let a=!1,l=!0;const u={delta:0,timestamp:0,isProcessing:!1},p=MS.reduce((R,N)=>(R[N]=y0e(()=>a=!0),R),{}),m=R=>{p[R].process(u)},v=()=>{const R=performance.now();a=!1,u.delta=l?1e3/60:Math.max(Math.min(R-u.timestamp,S0e),1),u.timestamp=R,u.isProcessing=!0,MS.forEach(m),u.isProcessing=!1,a&&i&&(l=!1,e(v))},y=()=>{a=!0,l=!0,u.isProcessing||e(v)};return{schedule:MS.reduce((R,N)=>{const x=p[N];return R[N]=(U,M=!1,z=!1)=>(a||y(),x.schedule(U,M,z)),R},{}),cancel:R=>MS.forEach(N=>p[N].cancel(R)),state:u,steps:p}}const{schedule:DD,cancel:ULe}=n7(queueMicrotask,!1);function T0e(e,i,a,l){const{visualElement:u}=F.useContext(dC),p=F.useContext(e7),m=F.useContext(sE),v=F.useContext(OD).reducedMotion,y=F.useRef();l=l||p.renderer,!y.current&&l&&(y.current=l(e,{visualState:i,parent:u,props:a,presenceContext:m,blockInitialAnimation:m?m.initial===!1:!1,reducedMotionConfig:v}));const S=y.current;F.useInsertionEffect(()=>{S&&S.update(a,m)});const C=F.useRef(!!(a[t7]&&!window.HandoffComplete));return PD(()=>{S&&(DD.postRender(S.render),C.current&&S.animationState&&S.animationState.animateChanges())}),F.useEffect(()=>{S&&(S.updateFeatures(),!C.current&&S.animationState&&S.animationState.animateChanges(),C.current&&(C.current=!1,window.HandoffComplete=!0))}),S}function Uf(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function b0e(e,i,a){return F.useCallback(l=>{l&&e.mount&&e.mount(l),i&&(l?i.mount(l):i.unmount()),a&&(typeof a=="function"?a(l):Uf(a)&&(a.current=l))},[i])}function jv(e){return typeof e=="string"||Array.isArray(e)}function uC(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const xD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],LD=["initial",...xD];function hC(e){return uC(e.animate)||LD.some(i=>jv(e[i]))}function r7(e){return!!(hC(e)||e.variants)}function C0e(e,i){if(hC(e)){const{initial:a,animate:l}=e;return{initial:a===!1||jv(a)?a:void 0,animate:jv(l)?l:void 0}}return e.inherit!==!1?i:{}}function w0e(e){const{initial:i,animate:a}=C0e(e,F.useContext(dC));return F.useMemo(()=>({initial:i,animate:a}),[u8(i),u8(a)])}function u8(e){return Array.isArray(e)?e.join(" "):e}const h8={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Fv={};for(const e in h8)Fv[e]={isEnabled:i=>h8[e].some(a=>!!i[a])};function R0e(e){for(const i in e)Fv[i]={...Fv[i],...e[i]}}const MD=F.createContext({}),i7=F.createContext({}),I0e=Symbol.for("motionComponentSymbol");function A0e({preloadedFeatures:e,createVisualElement:i,useRender:a,useVisualState:l,Component:u}){e&&R0e(e);function p(v,y){let S;const C={...F.useContext(OD),...v,layoutId:O0e(v)},{isStatic:R}=C,N=w0e(v),x=l(v,R);if(!R&&ND){N.visualElement=T0e(u,x,C,i);const U=F.useContext(i7),M=F.useContext(e7).strict;N.visualElement&&(S=N.visualElement.loadFeatures(C,M,e,U))}return b.jsxs(dC.Provider,{value:N,children:[S&&N.visualElement?b.jsx(S,{visualElement:N.visualElement,...C}):null,a(u,v,b0e(x,N.visualElement,y),x,R,N.visualElement)]})}const m=F.forwardRef(p);return m[I0e]=u,m}function O0e({layoutId:e}){const i=F.useContext(MD).id;return i&&e!==void 0?i+"-"+e:e}function N0e(e){function i(l,u={}){return A0e(e(l,u))}if(typeof Proxy>"u")return i;const a=new Map;return new Proxy(i,{get:(l,u)=>(a.has(u)||a.set(u,i(u)),a.get(u))})}const P0e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function UD(e){return typeof e!="string"||e.includes("-")?!1:!!(P0e.indexOf(e)>-1||/[A-Z]/u.test(e))}const ub={};function k0e(e){Object.assign(ub,e)}const aE=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Wh=new Set(aE);function o7(e,{layout:i,layoutId:a}){return Wh.has(e)||e.startsWith("origin")||(i||a!==void 0)&&(!!ub[e]||e==="opacity")}const po=e=>!!(e&&e.getVelocity),D0e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},x0e=aE.length;function L0e(e,{enableHardwareAcceleration:i=!0,allowTransformNone:a=!0},l,u){let p="";for(let m=0;m<x0e;m++){const v=aE[m];if(e[v]!==void 0){const y=D0e[v]||v;p+=`${y}(${e[v]}) `}}return i&&!e.z&&(p+="translateZ(0)"),p=p.trim(),u?p=u(e,l?"":p):a&&l&&(p="none"),p}const s7=e=>i=>typeof i=="string"&&i.startsWith(e),a7=s7("--"),M0e=s7("var(--"),jD=e=>M0e(e)?U0e.test(e.split("/*")[0].trim()):!1,U0e=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,j0e=(e,i)=>i&&typeof e=="number"?i.transform(e):e,au=(e,i,a)=>a>i?i:a<e?e:a,km={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},sv={...km,transform:e=>au(0,1,e)},US={...km,default:1},av=e=>Math.round(e*1e5)/1e5,FD=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,F0e=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,V0e=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;function cE(e){return typeof e=="string"}const lE=e=>({test:i=>cE(i)&&i.endsWith(e)&&i.split(" ").length===1,parse:parseFloat,transform:i=>`${i}${e}`}),Ud=lE("deg"),Pc=lE("%"),Nt=lE("px"),B0e=lE("vh"),W0e=lE("vw"),p8={...Pc,parse:e=>Pc.parse(e)/100,transform:e=>Pc.transform(e*100)},f8={...km,transform:Math.round},c7={borderWidth:Nt,borderTopWidth:Nt,borderRightWidth:Nt,borderBottomWidth:Nt,borderLeftWidth:Nt,borderRadius:Nt,radius:Nt,borderTopLeftRadius:Nt,borderTopRightRadius:Nt,borderBottomRightRadius:Nt,borderBottomLeftRadius:Nt,width:Nt,maxWidth:Nt,height:Nt,maxHeight:Nt,size:Nt,top:Nt,right:Nt,bottom:Nt,left:Nt,padding:Nt,paddingTop:Nt,paddingRight:Nt,paddingBottom:Nt,paddingLeft:Nt,margin:Nt,marginTop:Nt,marginRight:Nt,marginBottom:Nt,marginLeft:Nt,rotate:Ud,rotateX:Ud,rotateY:Ud,rotateZ:Ud,scale:US,scaleX:US,scaleY:US,scaleZ:US,skew:Ud,skewX:Ud,skewY:Ud,distance:Nt,translateX:Nt,translateY:Nt,translateZ:Nt,x:Nt,y:Nt,z:Nt,perspective:Nt,transformPerspective:Nt,opacity:sv,originX:p8,originY:p8,originZ:Nt,zIndex:f8,backgroundPositionX:Nt,backgroundPositionY:Nt,fillOpacity:sv,strokeOpacity:sv,numOctaves:f8};function VD(e,i,a,l){const{style:u,vars:p,transform:m,transformOrigin:v}=e;let y=!1,S=!1,C=!0;for(const R in i){const N=i[R];if(a7(R)){p[R]=N;continue}const x=c7[R],U=j0e(N,x);if(Wh.has(R)){if(y=!0,m[R]=U,!C)continue;N!==(x.default||0)&&(C=!1)}else R.startsWith("origin")?(S=!0,v[R]=U):u[R]=U}if(i.transform||(y||l?u.transform=L0e(e.transform,a,C,l):u.transform&&(u.transform="none")),S){const{originX:R="50%",originY:N="50%",originZ:x=0}=v;u.transformOrigin=`${R} ${N} ${x}`}}const BD=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function l7(e,i,a){for(const l in i)!po(i[l])&&!o7(l,a)&&(e[l]=i[l])}function z0e({transformTemplate:e},i,a){return F.useMemo(()=>{const l=BD();return VD(l,i,{enableHardwareAcceleration:!a},e),Object.assign({},l.vars,l.style)},[i])}function G0e(e,i,a){const l=e.style||{},u={};return l7(u,l,e),Object.assign(u,z0e(e,i,a)),u}function H0e(e,i,a){const l={},u=G0e(e,i,a);return e.drag&&e.dragListener!==!1&&(l.draggable=!1,u.userSelect=u.WebkitUserSelect=u.WebkitTouchCallout="none",u.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(l.tabIndex=0),l.style=u,l}const $0e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function hb(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||$0e.has(e)}let d7=e=>!hb(e);function K0e(e){e&&(d7=i=>i.startsWith("on")?!hb(i):e(i))}try{K0e(require("@emotion/is-prop-valid").default)}catch{}function Y0e(e,i,a){const l={};for(const u in e)u==="values"&&typeof e.values=="object"||(d7(u)||a===!0&&hb(u)||!i&&!hb(u)||e.draggable&&u.startsWith("onDrag"))&&(l[u]=e[u]);return l}function m8(e,i,a){return typeof e=="string"?e:Nt.transform(i+a*e)}function q0e(e,i,a){const l=m8(i,e.x,e.width),u=m8(a,e.y,e.height);return`${l} ${u}`}const J0e={offset:"stroke-dashoffset",array:"stroke-dasharray"},X0e={offset:"strokeDashoffset",array:"strokeDasharray"};function Q0e(e,i,a=1,l=0,u=!0){e.pathLength=1;const p=u?J0e:X0e;e[p.offset]=Nt.transform(-l);const m=Nt.transform(i),v=Nt.transform(a);e[p.array]=`${m} ${v}`}function WD(e,{attrX:i,attrY:a,attrScale:l,originX:u,originY:p,pathLength:m,pathSpacing:v=1,pathOffset:y=0,...S},C,R,N){if(VD(e,S,C,N),R){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:x,style:U,dimensions:M}=e;x.transform&&(M&&(U.transform=x.transform),delete x.transform),M&&(u!==void 0||p!==void 0||U.transform)&&(U.transformOrigin=q0e(M,u!==void 0?u:.5,p!==void 0?p:.5)),i!==void 0&&(x.x=i),a!==void 0&&(x.y=a),l!==void 0&&(x.scale=l),m!==void 0&&Q0e(x,m,v,y,!1)}const u7=()=>({...BD(),attrs:{}}),zD=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Z0e(e,i,a,l){const u=F.useMemo(()=>{const p=u7();return WD(p,i,{enableHardwareAcceleration:!1},zD(l),e.transformTemplate),{...p.attrs,style:{...p.style}}},[i]);if(e.style){const p={};l7(p,e.style,e),u.style={...p,...u.style}}return u}function eSe(e=!1){return(a,l,u,{latestValues:p},m)=>{const y=(UD(a)?Z0e:H0e)(l,p,m,a),S=Y0e(l,typeof a=="string",e),C=a!==F.Fragment?{...S,...y,ref:u}:{},{children:R}=l,N=F.useMemo(()=>po(R)?R.get():R,[R]);return F.createElement(a,{...C,children:N})}}function h7(e,{style:i,vars:a},l,u){Object.assign(e.style,i,u&&u.getProjectionStyles(l));for(const p in a)e.style.setProperty(p,a[p])}const p7=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function f7(e,i,a,l){h7(e,i,void 0,l);for(const u in i.attrs)e.setAttribute(p7.has(u)?u:kD(u),i.attrs[u])}function GD(e,i,a){var l;const{style:u}=e,p={};for(const m in u)(po(u[m])||i.style&&po(i.style[m])||o7(m,e)||((l=a==null?void 0:a.getValue(m))===null||l===void 0?void 0:l.liveStyle)!==void 0)&&(p[m]=u[m]);return p}function m7(e,i,a){const l=GD(e,i,a);for(const u in e)if(po(e[u])||po(i[u])){const p=aE.indexOf(u)!==-1?"attr"+u.charAt(0).toUpperCase()+u.substring(1):u;l[p]=e[u]}return l}function HD(e,i,a,l={},u={}){return typeof i=="function"&&(i=i(a!==void 0?a:e.custom,l,u)),typeof i=="string"&&(i=e.variants&&e.variants[i]),typeof i=="function"&&(i=i(a!==void 0?a:e.custom,l,u)),i}function g7(e){const i=F.useRef(null);return i.current===null&&(i.current=e()),i.current}const TP=e=>Array.isArray(e),tSe=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),nSe=e=>TP(e)?e[e.length-1]||0:e;function ET(e){const i=po(e)?e.get():e;return tSe(i)?i.toValue():i}function rSe({scrapeMotionValuesFromProps:e,createRenderState:i,onMount:a},l,u,p){const m={latestValues:iSe(l,u,p,e),renderState:i()};return a&&(m.mount=v=>a(l,v,m)),m}const _7=e=>(i,a)=>{const l=F.useContext(dC),u=F.useContext(sE),p=()=>rSe(e,i,l,u);return a?p():g7(p)};function iSe(e,i,a,l){const u={},p=l(e,{});for(const N in p)u[N]=ET(p[N]);let{initial:m,animate:v}=e;const y=hC(e),S=r7(e);i&&S&&!y&&e.inherit!==!1&&(m===void 0&&(m=i.initial),v===void 0&&(v=i.animate));let C=a?a.initial===!1:!1;C=C||m===!1;const R=C?v:m;return R&&typeof R!="boolean"&&!uC(R)&&(Array.isArray(R)?R:[R]).forEach(x=>{const U=HD(e,x);if(!U)return;const{transitionEnd:M,transition:z,...V}=U;for(const W in V){let H=V[W];if(Array.isArray(H)){const q=C?H.length-1:0;H=H[q]}H!==null&&(u[W]=H)}for(const W in M)u[W]=M[W]}),u}const _o=e=>e,{schedule:Mi,cancel:cu,state:Hi,steps:IO}=n7(typeof requestAnimationFrame<"u"?requestAnimationFrame:_o,!0),oSe={useVisualState:_7({scrapeMotionValuesFromProps:m7,createRenderState:u7,onMount:(e,i,{renderState:a,latestValues:l})=>{Mi.read(()=>{try{a.dimensions=typeof i.getBBox=="function"?i.getBBox():i.getBoundingClientRect()}catch{a.dimensions={x:0,y:0,width:0,height:0}}}),Mi.render(()=>{WD(a,l,{enableHardwareAcceleration:!1},zD(i.tagName),e.transformTemplate),f7(i,a)})}})},sSe={useVisualState:_7({scrapeMotionValuesFromProps:GD,createRenderState:BD})};function aSe(e,{forwardMotionProps:i=!1},a,l){return{...UD(e)?oSe:sSe,preloadedFeatures:a,useRender:eSe(i),createVisualElement:l,Component:e}}function yl(e,i,a,l={passive:!0}){return e.addEventListener(i,a,l),()=>e.removeEventListener(i,a)}const v7=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function pC(e,i="page"){return{point:{x:e[`${i}X`],y:e[`${i}Y`]}}}const cSe=e=>i=>v7(i)&&e(i,pC(i));function wl(e,i,a,l){return yl(e,i,cSe(a),l)}const lSe=(e,i)=>a=>i(e(a)),Rl=(...e)=>e.reduce(lSe);function E7(e){let i=null;return()=>{const a=()=>{i=null};return i===null?(i=e,a):!1}}const g8=E7("dragHorizontal"),_8=E7("dragVertical");function y7(e){let i=!1;if(e==="y")i=_8();else if(e==="x")i=g8();else{const a=g8(),l=_8();a&&l?i=()=>{a(),l()}:(a&&a(),l&&l())}return i}function S7(){const e=y7(!0);return e?(e(),!1):!0}class fu{constructor(i){this.isMounted=!1,this.node=i}update(){}}function v8(e,i){const a=i?"pointerenter":"pointerleave",l=i?"onHoverStart":"onHoverEnd",u=(p,m)=>{if(p.pointerType==="touch"||S7())return;const v=e.getProps();e.animationState&&v.whileHover&&e.animationState.setActive("whileHover",i);const y=v[l];y&&y(p,m)};return wl(e.current,a,u,{passive:!e.getProps()[l]})}class dSe extends fu{mount(){this.unmount=Rl(v8(this.node,!0),v8(this.node,!1))}unmount(){}}class uSe extends fu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let i=!1;try{i=this.node.current.matches(":focus-visible")}catch{i=!0}!i||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Rl(yl(this.node.current,"focus",()=>this.onFocus()),yl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const T7=(e,i)=>i?e===i?!0:T7(e,i.parentElement):!1;function AO(e,i){if(!i)return;const a=new PointerEvent("pointer"+e);i(a,pC(a))}class hSe extends fu{constructor(){super(...arguments),this.removeStartListeners=_o,this.removeEndListeners=_o,this.removeAccessibleListeners=_o,this.startPointerPress=(i,a)=>{if(this.isPressing)return;this.removeEndListeners();const l=this.node.getProps(),p=wl(window,"pointerup",(v,y)=>{if(!this.checkPressEnd())return;const{onTap:S,onTapCancel:C,globalTapTarget:R}=this.node.getProps();!R&&!T7(this.node.current,v.target)?C&&C(v,y):S&&S(v,y)},{passive:!(l.onTap||l.onPointerUp)}),m=wl(window,"pointercancel",(v,y)=>this.cancelPress(v,y),{passive:!(l.onTapCancel||l.onPointerCancel)});this.removeEndListeners=Rl(p,m),this.startPress(i,a)},this.startAccessiblePress=()=>{const i=p=>{if(p.key!=="Enter"||this.isPressing)return;const m=v=>{v.key!=="Enter"||!this.checkPressEnd()||AO("up",(y,S)=>{const{onTap:C}=this.node.getProps();C&&C(y,S)})};this.removeEndListeners(),this.removeEndListeners=yl(this.node.current,"keyup",m),AO("down",(v,y)=>{this.startPress(v,y)})},a=yl(this.node.current,"keydown",i),l=()=>{this.isPressing&&AO("cancel",(p,m)=>this.cancelPress(p,m))},u=yl(this.node.current,"blur",l);this.removeAccessibleListeners=Rl(a,u)}}startPress(i,a){this.isPressing=!0;const{onTapStart:l,whileTap:u}=this.node.getProps();u&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),l&&l(i,a)}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!S7()}cancelPress(i,a){if(!this.checkPressEnd())return;const{onTapCancel:l}=this.node.getProps();l&&l(i,a)}mount(){const i=this.node.getProps(),a=wl(i.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(i.onTapStart||i.onPointerStart)}),l=yl(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Rl(a,l)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const bP=new WeakMap,OO=new WeakMap,pSe=e=>{const i=bP.get(e.target);i&&i(e)},fSe=e=>{e.forEach(pSe)};function mSe({root:e,...i}){const a=e||document;OO.has(a)||OO.set(a,{});const l=OO.get(a),u=JSON.stringify(i);return l[u]||(l[u]=new IntersectionObserver(fSe,{root:e,...i})),l[u]}function gSe(e,i,a){const l=mSe(i);return bP.set(e,a),l.observe(e),()=>{bP.delete(e),l.unobserve(e)}}const _Se={some:0,all:1};class vSe extends fu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:i={}}=this.node.getProps(),{root:a,margin:l,amount:u="some",once:p}=i,m={root:a?a.current:void 0,rootMargin:l,threshold:typeof u=="number"?u:_Se[u]},v=y=>{const{isIntersecting:S}=y;if(this.isInView===S||(this.isInView=S,p&&!S&&this.hasEnteredView))return;S&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",S);const{onViewportEnter:C,onViewportLeave:R}=this.node.getProps(),N=S?C:R;N&&N(y)};return gSe(this.node.current,m,v)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:i,prevProps:a}=this.node;["amount","margin","root"].some(ESe(i,a))&&this.startObserver()}unmount(){}}function ESe({viewport:e={}},{viewport:i={}}={}){return a=>e[a]!==i[a]}const ySe={inView:{Feature:vSe},tap:{Feature:hSe},focus:{Feature:uSe},hover:{Feature:dSe}};function b7(e,i){if(!Array.isArray(i))return!1;const a=i.length;if(a!==e.length)return!1;for(let l=0;l<a;l++)if(i[l]!==e[l])return!1;return!0}function SSe(e){const i={};return e.values.forEach((a,l)=>i[l]=a.get()),i}function TSe(e){const i={};return e.values.forEach((a,l)=>i[l]=a.getVelocity()),i}function fC(e,i,a){const l=e.getProps();return HD(l,i,a!==void 0?a:l.custom,SSe(e),TSe(e))}const tu=e=>e*1e3,Il=e=>e/1e3,bSe={type:"spring",stiffness:500,damping:25,restSpeed:10},CSe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),wSe={type:"keyframes",duration:.8},RSe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ISe=(e,{keyframes:i})=>i.length>2?wSe:Wh.has(e)?e.startsWith("scale")?CSe(i[1]):bSe:RSe;function ASe({when:e,delay:i,delayChildren:a,staggerChildren:l,staggerDirection:u,repeat:p,repeatType:m,repeatDelay:v,from:y,elapsed:S,...C}){return!!Object.keys(C).length}function $D(e,i){return e[i]||e.default||e}const OSe=e=>e!==null;function mC(e,{repeat:i,repeatType:a="loop"},l){const u=e.filter(OSe),p=i&&a!=="loop"&&i%2===1?0:u.length-1;return!p||l===void 0?u[p]:l}let yT;function NSe(){yT=void 0}const nu={now:()=>(yT===void 0&&nu.set(Hi.isProcessing||E0e.useManualTiming?Hi.timestamp:performance.now()),yT),set:e=>{yT=e,queueMicrotask(NSe)}},C7=e=>/^0[^.\s]+$/u.test(e);function PSe(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||C7(e):!0}let CP=_o;const w7=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),kSe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function DSe(e){const i=kSe.exec(e);if(!i)return[,];const[,a,l,u]=i;return[`--${a??l}`,u]}function R7(e,i,a=1){const[l,u]=DSe(e);if(!l)return;const p=window.getComputedStyle(i).getPropertyValue(l);if(p){const m=p.trim();return w7(m)?parseFloat(m):m}return jD(u)?R7(u,i,a+1):u}const xSe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),E8=e=>e===km||e===Nt,y8=(e,i)=>parseFloat(e.split(", ")[i]),S8=(e,i)=>(a,{transform:l})=>{if(l==="none"||!l)return 0;const u=l.match(/^matrix3d\((.+)\)$/u);if(u)return y8(u[1],i);{const p=l.match(/^matrix\((.+)\)$/u);return p?y8(p[1],e):0}},LSe=new Set(["x","y","z"]),MSe=aE.filter(e=>!LSe.has(e));function USe(e){const i=[];return MSe.forEach(a=>{const l=e.getValue(a);l!==void 0&&(i.push([a,l.get()]),l.set(a.startsWith("scale")?1:0))}),i}const ym={width:({x:e},{paddingLeft:i="0",paddingRight:a="0"})=>e.max-e.min-parseFloat(i)-parseFloat(a),height:({y:e},{paddingTop:i="0",paddingBottom:a="0"})=>e.max-e.min-parseFloat(i)-parseFloat(a),top:(e,{top:i})=>parseFloat(i),left:(e,{left:i})=>parseFloat(i),bottom:({y:e},{top:i})=>parseFloat(i)+(e.max-e.min),right:({x:e},{left:i})=>parseFloat(i)+(e.max-e.min),x:S8(4,13),y:S8(5,14)};ym.translateX=ym.x;ym.translateY=ym.y;const I7=e=>i=>i.test(e),jSe={test:e=>e==="auto",parse:e=>e},A7=[km,Nt,Pc,Ud,W0e,B0e,jSe],T8=e=>A7.find(I7(e)),vh=new Set;let wP=!1,RP=!1;function O7(){if(RP){const e=Array.from(vh).filter(l=>l.needsMeasurement),i=new Set(e.map(l=>l.element)),a=new Map;i.forEach(l=>{const u=USe(l);u.length&&(a.set(l,u),l.render())}),e.forEach(l=>l.measureInitialState()),i.forEach(l=>{l.render();const u=a.get(l);u&&u.forEach(([p,m])=>{var v;(v=l.getValue(p))===null||v===void 0||v.set(m)})}),e.forEach(l=>l.measureEndState()),e.forEach(l=>{l.suspendedScrollY!==void 0&&window.scrollTo(0,l.suspendedScrollY)})}RP=!1,wP=!1,vh.forEach(e=>e.complete()),vh.clear()}function N7(){vh.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(RP=!0)})}function FSe(){N7(),O7()}class KD{constructor(i,a,l,u,p,m=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...i],this.onComplete=a,this.name=l,this.motionValue=u,this.element=p,this.isAsync=m}scheduleResolve(){this.isScheduled=!0,this.isAsync?(vh.add(this),wP||(wP=!0,Mi.read(N7),Mi.resolveKeyframes(O7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:i,name:a,element:l,motionValue:u}=this;for(let p=0;p<i.length;p++)if(i[p]===null)if(p===0){const m=u==null?void 0:u.get(),v=i[i.length-1];if(m!==void 0)i[0]=m;else if(l&&a){const y=l.readValue(a,v);y!=null&&(i[0]=y)}i[0]===void 0&&(i[0]=v),u&&m===void 0&&u.set(i[0])}else i[p]=i[p-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),vh.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,vh.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const YD=(e,i)=>a=>!!(cE(a)&&V0e.test(a)&&a.startsWith(e)||i&&Object.prototype.hasOwnProperty.call(a,i)),P7=(e,i,a)=>l=>{if(!cE(l))return l;const[u,p,m,v]=l.match(FD);return{[e]:parseFloat(u),[i]:parseFloat(p),[a]:parseFloat(m),alpha:v!==void 0?parseFloat(v):1}},VSe=e=>au(0,255,e),NO={...km,transform:e=>Math.round(VSe(e))},hh={test:YD("rgb","red"),parse:P7("red","green","blue"),transform:({red:e,green:i,blue:a,alpha:l=1})=>"rgba("+NO.transform(e)+", "+NO.transform(i)+", "+NO.transform(a)+", "+av(sv.transform(l))+")"};function BSe(e){let i="",a="",l="",u="";return e.length>5?(i=e.substring(1,3),a=e.substring(3,5),l=e.substring(5,7),u=e.substring(7,9)):(i=e.substring(1,2),a=e.substring(2,3),l=e.substring(3,4),u=e.substring(4,5),i+=i,a+=a,l+=l,u+=u),{red:parseInt(i,16),green:parseInt(a,16),blue:parseInt(l,16),alpha:u?parseInt(u,16)/255:1}}const IP={test:YD("#"),parse:BSe,transform:hh.transform},jf={test:YD("hsl","hue"),parse:P7("hue","saturation","lightness"),transform:({hue:e,saturation:i,lightness:a,alpha:l=1})=>"hsla("+Math.round(e)+", "+Pc.transform(av(i))+", "+Pc.transform(av(a))+", "+av(sv.transform(l))+")"},uo={test:e=>hh.test(e)||IP.test(e)||jf.test(e),parse:e=>hh.test(e)?hh.parse(e):jf.test(e)?jf.parse(e):IP.parse(e),transform:e=>cE(e)?e:e.hasOwnProperty("red")?hh.transform(e):jf.transform(e)};function WSe(e){var i,a;return isNaN(e)&&cE(e)&&(((i=e.match(FD))===null||i===void 0?void 0:i.length)||0)+(((a=e.match(F0e))===null||a===void 0?void 0:a.length)||0)>0}const k7="number",D7="color",zSe="var",GSe="var(",b8="${}",HSe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function pb(e){const i=e.toString(),a=[],l={color:[],number:[],var:[]},u=[];let p=0;const v=i.replace(HSe,y=>(uo.test(y)?(l.color.push(p),u.push(D7),a.push(uo.parse(y))):y.startsWith(GSe)?(l.var.push(p),u.push(zSe),a.push(y)):(l.number.push(p),u.push(k7),a.push(parseFloat(y))),++p,b8)).split(b8);return{values:a,split:v,indexes:l,types:u}}function x7(e){return pb(e).values}function L7(e){const{split:i,types:a}=pb(e),l=i.length;return u=>{let p="";for(let m=0;m<l;m++)if(p+=i[m],u[m]!==void 0){const v=a[m];v===k7?p+=av(u[m]):v===D7?p+=uo.transform(u[m]):p+=u[m]}return p}}const $Se=e=>typeof e=="number"?0:e;function KSe(e){const i=x7(e);return L7(e)(i.map($Se))}const lu={test:WSe,parse:x7,createTransformer:L7,getAnimatableNone:KSe},YSe=new Set(["brightness","contrast","saturate","opacity"]);function qSe(e){const[i,a]=e.slice(0,-1).split("(");if(i==="drop-shadow")return e;const[l]=a.match(FD)||[];if(!l)return e;const u=a.replace(l,"");let p=YSe.has(i)?1:0;return l!==a&&(p*=100),i+"("+p+u+")"}const JSe=/\b([a-z-]*)\(.*?\)/gu,AP={...lu,getAnimatableNone:e=>{const i=e.match(JSe);return i?i.map(qSe).join(" "):e}},XSe={...c7,color:uo,backgroundColor:uo,outlineColor:uo,fill:uo,stroke:uo,borderColor:uo,borderTopColor:uo,borderRightColor:uo,borderBottomColor:uo,borderLeftColor:uo,filter:AP,WebkitFilter:AP},qD=e=>XSe[e];function M7(e,i){let a=qD(e);return a!==AP&&(a=lu),a.getAnimatableNone?a.getAnimatableNone(i):void 0}function QSe(e,i,a){let l=0,u;for(;l<e.length&&!u;)typeof e[l]=="string"&&e[l]!=="none"&&e[l]!=="0"&&(u=e[l]),l++;if(u&&a)for(const p of i)e[p]=M7(a,u)}class U7 extends KD{constructor(i,a,l,u){super(i,a,l,u,u==null?void 0:u.owner,!0)}readKeyframes(){const{unresolvedKeyframes:i,element:a,name:l}=this;if(!a.current)return;super.readKeyframes();for(let y=0;y<i.length;y++){const S=i[y];if(typeof S=="string"&&jD(S)){const C=R7(S,a.current);C!==void 0&&(i[y]=C),y===i.length-1&&(this.finalKeyframe=S)}}if(!xSe.has(l)||i.length!==2)return this.resolveNoneKeyframes();const[u,p]=i,m=T8(u),v=T8(p);if(m!==v)if(E8(m)&&E8(v))for(let y=0;y<i.length;y++){const S=i[y];typeof S=="string"&&(i[y]=parseFloat(S))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:i,name:a}=this,l=[];for(let u=0;u<i.length;u++)PSe(i[u])&&l.push(u);l.length&&QSe(i,l,a)}measureInitialState(){const{element:i,unresolvedKeyframes:a,name:l}=this;if(!i.current)return;l==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ym[l](i.measureViewportBox(),window.getComputedStyle(i.current)),a[0]=this.measuredOrigin;const u=a[a.length-1];u!==void 0&&i.getValue(l,u).jump(u,!1)}measureEndState(){var i;const{element:a,name:l,unresolvedKeyframes:u}=this;if(!a.current)return;const p=a.getValue(l);p&&p.jump(this.measuredOrigin,!1);const m=u.length-1,v=u[m];u[m]=ym[l](a.measureViewportBox(),window.getComputedStyle(a.current)),v!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=v),!((i=this.removedTransforms)===null||i===void 0)&&i.length&&this.removedTransforms.forEach(([y,S])=>{a.getValue(y).set(S)}),this.resolveNoneKeyframes()}}function ZSe(e){let i;return()=>(i===void 0&&(i=e()),i)}const C8=(e,i)=>i==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(lu.test(e)||e==="0")&&!e.startsWith("url("));function eTe(e){const i=e[0];if(e.length===1)return!0;for(let a=0;a<e.length;a++)if(e[a]!==i)return!0}function tTe(e,i,a,l){const u=e[0];if(u===null)return!1;const p=e[e.length-1],m=C8(u,i),v=C8(p,i);return!m||!v?!1:eTe(e)||a==="spring"&&l}class j7{constructor({autoplay:i=!0,delay:a=0,type:l="keyframes",repeat:u=0,repeatDelay:p=0,repeatType:m="loop",...v}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.options={autoplay:i,delay:a,type:l,repeat:u,repeatDelay:p,repeatType:m,...v},this.updateFinishedPromise()}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&FSe(),this._resolved}onKeyframesResolved(i,a){this.hasAttemptedResolve=!0;const{name:l,type:u,velocity:p,delay:m,onComplete:v,onUpdate:y,isGenerator:S}=this.options;if(!S&&!tTe(i,l,u,p))if(m)this.options.duration=0;else{y==null||y(mC(i,this.options,a)),v==null||v(),this.resolveFinishedPromise();return}const C=this.initPlayback(i,a);C!==!1&&(this._resolved={keyframes:i,finalKeyframe:a,...C},this.onPostResolved())}onPostResolved(){}then(i,a){return this.currentFinishedPromise.then(i,a)}updateFinishedPromise(){this.currentFinishedPromise=new Promise(i=>{this.resolveFinishedPromise=i})}}function F7(e,i){return i?e*(1e3/i):0}const nTe=5;function V7(e,i,a){const l=Math.max(i-nTe,0);return F7(a-e(l),i-l)}const PO=.001,rTe=.01,iTe=10,oTe=.05,sTe=1;function aTe({duration:e=800,bounce:i=.25,velocity:a=0,mass:l=1}){let u,p,m=1-i;m=au(oTe,sTe,m),e=au(rTe,iTe,Il(e)),m<1?(u=S=>{const C=S*m,R=C*e,N=C-a,x=OP(S,m),U=Math.exp(-R);return PO-N/x*U},p=S=>{const R=S*m*e,N=R*a+a,x=Math.pow(m,2)*Math.pow(S,2)*e,U=Math.exp(-R),M=OP(Math.pow(S,2),m);return(-u(S)+PO>0?-1:1)*((N-x)*U)/M}):(u=S=>{const C=Math.exp(-S*e),R=(S-a)*e+1;return-PO+C*R},p=S=>{const C=Math.exp(-S*e),R=(a-S)*(e*e);return C*R});const v=5/e,y=lTe(u,p,v);if(e=tu(e),isNaN(y))return{stiffness:100,damping:10,duration:e};{const S=Math.pow(y,2)*l;return{stiffness:S,damping:m*2*Math.sqrt(l*S),duration:e}}}const cTe=12;function lTe(e,i,a){let l=a;for(let u=1;u<cTe;u++)l=l-e(l)/i(l);return l}function OP(e,i){return e*Math.sqrt(1-i*i)}const dTe=["duration","bounce"],uTe=["stiffness","damping","mass"];function w8(e,i){return i.some(a=>e[a]!==void 0)}function hTe(e){let i={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!w8(e,uTe)&&w8(e,dTe)){const a=aTe(e);i={...i,...a,mass:1},i.isResolvedFromDuration=!0}return i}function B7({keyframes:e,restDelta:i,restSpeed:a,...l}){const u=e[0],p=e[e.length-1],m={done:!1,value:u},{stiffness:v,damping:y,mass:S,duration:C,velocity:R,isResolvedFromDuration:N}=hTe({...l,velocity:-Il(l.velocity||0)}),x=R||0,U=y/(2*Math.sqrt(v*S)),M=p-u,z=Il(Math.sqrt(v/S)),V=Math.abs(M)<5;a||(a=V?.01:2),i||(i=V?.005:.5);let W;if(U<1){const H=OP(z,U);W=q=>{const ee=Math.exp(-U*z*q);return p-ee*((x+U*z*M)/H*Math.sin(H*q)+M*Math.cos(H*q))}}else if(U===1)W=H=>p-Math.exp(-z*H)*(M+(x+z*M)*H);else{const H=z*Math.sqrt(U*U-1);W=q=>{const ee=Math.exp(-U*z*q),oe=Math.min(H*q,300);return p-ee*((x+U*z*M)*Math.sinh(oe)+H*M*Math.cosh(oe))/H}}return{calculatedDuration:N&&C||null,next:H=>{const q=W(H);if(N)m.done=H>=C;else{let ee=x;H!==0&&(U<1?ee=V7(W,H,q):ee=0);const oe=Math.abs(ee)<=a,se=Math.abs(p-q)<=i;m.done=oe&&se}return m.value=m.done?p:q,m}}}function R8({keyframes:e,velocity:i=0,power:a=.8,timeConstant:l=325,bounceDamping:u=10,bounceStiffness:p=500,modifyTarget:m,min:v,max:y,restDelta:S=.5,restSpeed:C}){const R=e[0],N={done:!1,value:R},x=re=>v!==void 0&&re<v||y!==void 0&&re>y,U=re=>v===void 0?y:y===void 0||Math.abs(v-re)<Math.abs(y-re)?v:y;let M=a*i;const z=R+M,V=m===void 0?z:m(z);V!==z&&(M=V-R);const W=re=>-M*Math.exp(-re/l),H=re=>V+W(re),q=re=>{const me=W(re),pe=H(re);N.done=Math.abs(me)<=S,N.value=N.done?V:pe};let ee,oe;const se=re=>{x(N.value)&&(ee=re,oe=B7({keyframes:[N.value,U(N.value)],velocity:V7(H,re,N.value),damping:u,stiffness:p,restDelta:S,restSpeed:C}))};return se(0),{calculatedDuration:null,next:re=>{let me=!1;return!oe&&ee===void 0&&(me=!0,q(re),se(re)),ee!==void 0&&re>=ee?oe.next(re-ee):(!me&&q(re),N)}}}const W7=(e,i,a)=>(((1-3*a+3*i)*e+(3*a-6*i))*e+3*i)*e,pTe=1e-7,fTe=12;function mTe(e,i,a,l,u){let p,m,v=0;do m=i+(a-i)/2,p=W7(m,l,u)-e,p>0?a=m:i=m;while(Math.abs(p)>pTe&&++v<fTe);return m}function dE(e,i,a,l){if(e===i&&a===l)return _o;const u=p=>mTe(p,0,1,e,a);return p=>p===0||p===1?p:W7(u(p),i,l)}const gTe=dE(.42,0,1,1),_Te=dE(0,0,.58,1),z7=dE(.42,0,.58,1),vTe=e=>Array.isArray(e)&&typeof e[0]!="number",G7=e=>i=>i<=.5?e(2*i)/2:(2-e(2*(1-i)))/2,H7=e=>i=>1-e(1-i),JD=e=>1-Math.sin(Math.acos(e)),$7=H7(JD),ETe=G7(JD),K7=dE(.33,1.53,.69,.99),XD=H7(K7),yTe=G7(XD),STe=e=>(e*=2)<1?.5*XD(e):.5*(2-Math.pow(2,-10*(e-1))),I8={linear:_o,easeIn:gTe,easeInOut:z7,easeOut:_Te,circIn:JD,circInOut:ETe,circOut:$7,backIn:XD,backInOut:yTe,backOut:K7,anticipate:STe},A8=e=>{if(Array.isArray(e)){CP(e.length===4);const[i,a,l,u]=e;return dE(i,a,l,u)}else if(typeof e=="string")return CP(I8[e]!==void 0),I8[e];return e},Vv=(e,i,a)=>{const l=i-e;return l===0?1:(a-e)/l},zr=(e,i,a)=>e+(i-e)*a;function kO(e,i,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(i-e)*6*a:a<1/2?i:a<2/3?e+(i-e)*(2/3-a)*6:e}function TTe({hue:e,saturation:i,lightness:a,alpha:l}){e/=360,i/=100,a/=100;let u=0,p=0,m=0;if(!i)u=p=m=a;else{const v=a<.5?a*(1+i):a+i-a*i,y=2*a-v;u=kO(y,v,e+1/3),p=kO(y,v,e),m=kO(y,v,e-1/3)}return{red:Math.round(u*255),green:Math.round(p*255),blue:Math.round(m*255),alpha:l}}const DO=(e,i,a)=>{const l=e*e,u=a*(i*i-l)+l;return u<0?0:Math.sqrt(u)},bTe=[IP,hh,jf],CTe=e=>bTe.find(i=>i.test(e));function O8(e){const i=CTe(e);let a=i.parse(e);return i===jf&&(a=TTe(a)),a}const N8=(e,i)=>{const a=O8(e),l=O8(i),u={...a};return p=>(u.red=DO(a.red,l.red,p),u.green=DO(a.green,l.green,p),u.blue=DO(a.blue,l.blue,p),u.alpha=zr(a.alpha,l.alpha,p),hh.transform(u))};function NP(e,i){return a=>a>0?i:e}function wTe(e,i){return a=>zr(e,i,a)}function QD(e){return typeof e=="number"?wTe:typeof e=="string"?jD(e)?NP:uo.test(e)?N8:ATe:Array.isArray(e)?Y7:typeof e=="object"?uo.test(e)?N8:RTe:NP}function Y7(e,i){const a=[...e],l=a.length,u=e.map((p,m)=>QD(p)(p,i[m]));return p=>{for(let m=0;m<l;m++)a[m]=u[m](p);return a}}function RTe(e,i){const a={...e,...i},l={};for(const u in a)e[u]!==void 0&&i[u]!==void 0&&(l[u]=QD(e[u])(e[u],i[u]));return u=>{for(const p in l)a[p]=l[p](u);return a}}function ITe(e,i){var a;const l=[],u={color:0,var:0,number:0};for(let p=0;p<i.values.length;p++){const m=i.types[p],v=e.indexes[m][u[m]],y=(a=e.values[v])!==null&&a!==void 0?a:0;l[p]=y,u[m]++}return l}const ATe=(e,i)=>{const a=lu.createTransformer(i),l=pb(e),u=pb(i);return l.indexes.var.length===u.indexes.var.length&&l.indexes.color.length===u.indexes.color.length&&l.indexes.number.length>=u.indexes.number.length?Rl(Y7(ITe(l,u),u.values),a):NP(e,i)};function q7(e,i,a){return typeof e=="number"&&typeof i=="number"&&typeof a=="number"?zr(e,i,a):QD(e)(e,i)}function OTe(e,i,a){const l=[],u=a||q7,p=e.length-1;for(let m=0;m<p;m++){let v=u(e[m],e[m+1]);if(i){const y=Array.isArray(i)?i[m]||_o:i;v=Rl(y,v)}l.push(v)}return l}function NTe(e,i,{clamp:a=!0,ease:l,mixer:u}={}){const p=e.length;if(CP(p===i.length),p===1)return()=>i[0];if(p===2&&e[0]===e[1])return()=>i[1];e[0]>e[p-1]&&(e=[...e].reverse(),i=[...i].reverse());const m=OTe(i,l,u),v=m.length,y=S=>{let C=0;if(v>1)for(;C<e.length-2&&!(S<e[C+1]);C++);const R=Vv(e[C],e[C+1],S);return m[C](R)};return a?S=>y(au(e[0],e[p-1],S)):y}function PTe(e,i){const a=e[e.length-1];for(let l=1;l<=i;l++){const u=Vv(0,i,l);e.push(zr(a,1,u))}}function kTe(e){const i=[0];return PTe(i,e.length-1),i}function DTe(e,i){return e.map(a=>a*i)}function xTe(e,i){return e.map(()=>i||z7).splice(0,e.length-1)}function fb({duration:e=300,keyframes:i,times:a,ease:l="easeInOut"}){const u=vTe(l)?l.map(A8):A8(l),p={done:!1,value:i[0]},m=DTe(a&&a.length===i.length?a:kTe(i),e),v=NTe(m,i,{ease:Array.isArray(u)?u:xTe(i,u)});return{calculatedDuration:e,next:y=>(p.value=v(y),p.done=y>=e,p)}}const P8=2e4;function LTe(e){let i=0;const a=50;let l=e.next(i);for(;!l.done&&i<P8;)i+=a,l=e.next(i);return i>=P8?1/0:i}const MTe=e=>{const i=({timestamp:a})=>e(a);return{start:()=>Mi.update(i,!0),stop:()=>cu(i),now:()=>Hi.isProcessing?Hi.timestamp:nu.now()}},UTe={decay:R8,inertia:R8,tween:fb,keyframes:fb,spring:B7},jTe=e=>e/100;class ZD extends j7{constructor({KeyframeResolver:i=KD,...a}){super(a),this.holdTime=null,this.startTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:v}=this.options;v&&v()};const{name:l,motionValue:u,keyframes:p}=this.options,m=(v,y)=>this.onKeyframesResolved(v,y);l&&u&&u.owner?this.resolver=u.owner.resolveKeyframes(p,m,l,u):this.resolver=new i(p,m,l,u),this.resolver.scheduleResolve()}initPlayback(i){const{type:a="keyframes",repeat:l=0,repeatDelay:u=0,repeatType:p,velocity:m=0}=this.options,v=UTe[a]||fb;let y,S;v!==fb&&typeof i[0]!="number"&&(y=Rl(jTe,q7(i[0],i[1])),i=[0,100]);const C=v({...this.options,keyframes:i});p==="mirror"&&(S=v({...this.options,keyframes:[...i].reverse(),velocity:-m})),C.calculatedDuration===null&&(C.calculatedDuration=LTe(C));const{calculatedDuration:R}=C,N=R+u,x=N*(l+1)-u;return{generator:C,mirroredGenerator:S,mapPercentToKeyframes:y,calculatedDuration:R,resolvedDuration:N,totalDuration:x}}onPostResolved(){const{autoplay:i=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!i?this.pause():this.state=this.pendingPlayState}tick(i,a=!1){const{resolved:l}=this;if(!l){const{keyframes:re}=this.options;return{done:!0,value:re[re.length-1]}}const{finalKeyframe:u,generator:p,mirroredGenerator:m,mapPercentToKeyframes:v,keyframes:y,calculatedDuration:S,totalDuration:C,resolvedDuration:R}=l;if(this.startTime===null)return p.next(0);const{delay:N,repeat:x,repeatType:U,repeatDelay:M,onUpdate:z}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,i):this.speed<0&&(this.startTime=Math.min(i-C/this.speed,this.startTime)),a?this.currentTime=i:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(i-this.startTime)*this.speed;const V=this.currentTime-N*(this.speed>=0?1:-1),W=this.speed>=0?V<0:V>C;this.currentTime=Math.max(V,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=C);let H=this.currentTime,q=p;if(x){const re=Math.min(this.currentTime,C)/R;let me=Math.floor(re),pe=re%1;!pe&&re>=1&&(pe=1),pe===1&&me--,me=Math.min(me,x+1),!!(me%2)&&(U==="reverse"?(pe=1-pe,M&&(pe-=M/R)):U==="mirror"&&(q=m)),H=au(0,1,pe)*R}const ee=W?{done:!1,value:y[0]}:q.next(H);v&&(ee.value=v(ee.value));let{done:oe}=ee;!W&&S!==null&&(oe=this.speed>=0?this.currentTime>=C:this.currentTime<=0);const se=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&oe);return se&&u!==void 0&&(ee.value=mC(y,this.options,u)),z&&z(ee.value),se&&this.finish(),ee}get duration(){const{resolved:i}=this;return i?Il(i.calculatedDuration):0}get time(){return Il(this.currentTime)}set time(i){i=tu(i),this.currentTime=i,this.holdTime!==null||this.speed===0?this.holdTime=i:this.driver&&(this.startTime=this.driver.now()-i/this.speed)}get speed(){return this.playbackSpeed}set speed(i){const a=this.playbackSpeed!==i;this.playbackSpeed=i,a&&(this.time=Il(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:i=MTe,onPlay:a}=this.options;this.driver||(this.driver=i(u=>this.tick(u))),a&&a();const l=this.driver.now();this.holdTime!==null?this.startTime=l-this.holdTime:(!this.startTime||this.state==="finished")&&(this.startTime=l),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var i;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(i=this.currentTime)!==null&&i!==void 0?i:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:i}=this.options;i&&i()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(i){return this.startTime=0,this.tick(i,!0)}}const J7=e=>Array.isArray(e)&&typeof e[0]=="number";function X7(e){return!!(!e||typeof e=="string"&&e in ex||J7(e)||Array.isArray(e)&&e.every(X7))}const W_=([e,i,a,l])=>`cubic-bezier(${e}, ${i}, ${a}, ${l})`,ex={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:W_([0,.65,.55,1]),circOut:W_([.55,0,1,.45]),backIn:W_([.31,.01,.66,-.59]),backOut:W_([.33,1.53,.69,.99])};function FTe(e){return Q7(e)||ex.easeOut}function Q7(e){if(e)return J7(e)?W_(e):Array.isArray(e)?e.map(FTe):ex[e]}function VTe(e,i,a,{delay:l=0,duration:u=300,repeat:p=0,repeatType:m="loop",ease:v,times:y}={}){const S={[i]:a};y&&(S.offset=y);const C=Q7(v);return Array.isArray(C)&&(S.easing=C),e.animate(S,{delay:l,duration:u,easing:Array.isArray(C)?"linear":C,fill:"both",iterations:p+1,direction:m==="reverse"?"alternate":"normal"})}const BTe=ZSe(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),WTe=new Set(["opacity","clipPath","filter","transform"]),mb=10,zTe=2e4;function GTe(e){return e.type==="spring"||e.name==="backgroundColor"||!X7(e.ease)}function HTe(e,i){const a=new ZD({...i,keyframes:e,repeat:0,delay:0,isGenerator:!0});let l={done:!1,value:e[0]};const u=[];let p=0;for(;!l.done&&p<zTe;)l=a.sample(p),u.push(l.value),p+=mb;return{times:void 0,keyframes:u,duration:p-mb,ease:"linear"}}class k8 extends j7{constructor(i){super(i);const{name:a,motionValue:l,keyframes:u}=this.options;this.resolver=new U7(u,(p,m)=>this.onKeyframesResolved(p,m),a,l),this.resolver.scheduleResolve()}initPlayback(i,a){var l;let{duration:u=300,times:p,ease:m,type:v,motionValue:y,name:S}=this.options;if(!(!((l=y.owner)===null||l===void 0)&&l.current))return!1;if(GTe(this.options)){const{onComplete:R,onUpdate:N,motionValue:x,...U}=this.options,M=HTe(i,U);i=M.keyframes,i.length===1&&(i[1]=i[0]),u=M.duration,p=M.times,m=M.ease,v="keyframes"}const C=VTe(y.owner.current,S,i,{...this.options,duration:u,times:p,ease:m});return C.startTime=nu.now(),this.pendingTimeline?(C.timeline=this.pendingTimeline,this.pendingTimeline=void 0):C.onfinish=()=>{const{onComplete:R}=this.options;y.set(mC(i,this.options,a)),R&&R(),this.cancel(),this.resolveFinishedPromise()},{animation:C,duration:u,times:p,type:v,ease:m,keyframes:i}}get duration(){const{resolved:i}=this;if(!i)return 0;const{duration:a}=i;return Il(a)}get time(){const{resolved:i}=this;if(!i)return 0;const{animation:a}=i;return Il(a.currentTime||0)}set time(i){const{resolved:a}=this;if(!a)return;const{animation:l}=a;l.currentTime=tu(i)}get speed(){const{resolved:i}=this;if(!i)return 1;const{animation:a}=i;return a.playbackRate}set speed(i){const{resolved:a}=this;if(!a)return;const{animation:l}=a;l.playbackRate=i}get state(){const{resolved:i}=this;if(!i)return"idle";const{animation:a}=i;return a.playState}attachTimeline(i){if(!this._resolved)this.pendingTimeline=i;else{const{resolved:a}=this;if(!a)return _o;const{animation:l}=a;l.timeline=i,l.onfinish=null}return _o}play(){if(this.isStopped)return;const{resolved:i}=this;if(!i)return;const{animation:a}=i;a.playState==="finished"&&this.updateFinishedPromise(),a.play()}pause(){const{resolved:i}=this;if(!i)return;const{animation:a}=i;a.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;const{resolved:i}=this;if(!i)return;const{animation:a,keyframes:l,duration:u,type:p,ease:m,times:v}=i;if(!(a.playState==="idle"||a.playState==="finished")){if(this.time){const{motionValue:y,onUpdate:S,onComplete:C,...R}=this.options,N=new ZD({...R,keyframes:l,duration:u,type:p,ease:m,times:v,isGenerator:!0}),x=tu(this.time);y.setWithVelocity(N.sample(x-mb).value,N.sample(x).value,mb)}this.cancel()}}complete(){const{resolved:i}=this;i&&i.animation.finish()}cancel(){const{resolved:i}=this;i&&i.animation.cancel()}static supports(i){const{motionValue:a,name:l,repeatDelay:u,repeatType:p,damping:m,type:v}=i;return BTe()&&l&&WTe.has(l)&&a&&a.owner&&a.owner.current instanceof HTMLElement&&!a.owner.getProps().onUpdate&&!u&&p!=="mirror"&&m!==0&&v!=="inertia"}}const tx=(e,i,a,l={},u,p)=>m=>{const v=$D(l,e)||{},y=v.delay||l.delay||0;let{elapsed:S=0}=l;S=S-tu(y);let C={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:i.getVelocity(),...v,delay:-S,onUpdate:N=>{i.set(N),v.onUpdate&&v.onUpdate(N)},onComplete:()=>{m(),v.onComplete&&v.onComplete()},name:e,motionValue:i,element:p?void 0:u};ASe(v)||(C={...C,...ISe(e,C)}),C.duration&&(C.duration=tu(C.duration)),C.repeatDelay&&(C.repeatDelay=tu(C.repeatDelay)),C.from!==void 0&&(C.keyframes[0]=C.from);let R=!1;if((C.type===!1||C.duration===0&&!C.repeatDelay)&&(C.duration=0,C.delay===0&&(R=!0)),R&&!p&&i.get()!==void 0){const N=mC(C.keyframes,v);if(N!==void 0){Mi.update(()=>{C.onUpdate(N),C.onComplete()});return}}return!p&&k8.supports(C)?new k8(C):new ZD(C)};function gb(e){return!!(po(e)&&e.add)}function nx(e,i){e.indexOf(i)===-1&&e.push(i)}function rx(e,i){const a=e.indexOf(i);a>-1&&e.splice(a,1)}class ix{constructor(){this.subscriptions=[]}add(i){return nx(this.subscriptions,i),()=>rx(this.subscriptions,i)}notify(i,a,l){const u=this.subscriptions.length;if(u)if(u===1)this.subscriptions[0](i,a,l);else for(let p=0;p<u;p++){const m=this.subscriptions[p];m&&m(i,a,l)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const D8=30,$Te=e=>!isNaN(parseFloat(e));class KTe{constructor(i,a={}){this.version="11.1.7",this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(l,u=!0)=>{const p=nu.now();this.updatedAt!==p&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(l),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),u&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(i),this.canTrackVelocity=$Te(this.current),this.owner=a.owner}setCurrent(i){this.current=i,this.updatedAt=nu.now()}setPrevFrameValue(i=this.current){this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt}onChange(i){return this.on("change",i)}on(i,a){this.events[i]||(this.events[i]=new ix);const l=this.events[i].add(a);return i==="change"?()=>{l(),Mi.read(()=>{this.events.change.getSize()||this.stop()})}:l}clearListeners(){for(const i in this.events)this.events[i].clear()}attach(i,a){this.passiveEffect=i,this.stopPassiveEffect=a}set(i,a=!0){!a||!this.passiveEffect?this.updateAndNotify(i,a):this.passiveEffect(i,this.updateAndNotify)}setWithVelocity(i,a,l){this.set(a),this.prev=void 0,this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt-l}jump(i,a=!0){this.updateAndNotify(i),this.prev=i,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const i=nu.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||i-this.updatedAt>D8)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,D8);return F7(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(i){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=i(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Bv(e,i){return new KTe(e,i)}function YTe(e,i,a){e.hasValue(i)?e.getValue(i).set(a):e.addValue(i,Bv(a))}function qTe(e,i){const a=fC(e,i);let{transitionEnd:l={},transition:u={},...p}=a||{};p={...p,...l};for(const m in p){const v=nSe(p[m]);YTe(e,m,v)}}function JTe({protectedKeys:e,needsAnimating:i},a){const l=e.hasOwnProperty(a)&&i[a]!==!0;return i[a]=!1,l}function Z7(e,i,{delay:a=0,transitionOverride:l,type:u}={}){var p;let{transition:m=e.getDefaultTransition(),transitionEnd:v,...y}=i;const S=e.getValue("willChange");l&&(m=l);const C=[],R=u&&e.animationState&&e.animationState.getState()[u];for(const N in y){const x=e.getValue(N,(p=e.latestValues[N])!==null&&p!==void 0?p:null),U=y[N];if(U===void 0||R&&JTe(R,N))continue;const M={delay:a,elapsed:0,...$D(m||{},N)};let z=!1;if(window.HandoffAppearAnimations){const H=e.getProps()[t7];if(H){const q=window.HandoffAppearAnimations(H,N);q!==null&&(M.elapsed=q,z=!0)}}x.start(tx(N,x,U,e.shouldReduceMotion&&Wh.has(N)?{type:!1}:M,e,z));const V=x.animation;V&&(gb(S)&&(S.add(N),V.then(()=>S.remove(N))),C.push(V))}return v&&Promise.all(C).then(()=>{Mi.update(()=>{v&&qTe(e,v)})}),C}function PP(e,i,a={}){var l;const u=fC(e,i,a.type==="exit"?(l=e.presenceContext)===null||l===void 0?void 0:l.custom:void 0);let{transition:p=e.getDefaultTransition()||{}}=u||{};a.transitionOverride&&(p=a.transitionOverride);const m=u?()=>Promise.all(Z7(e,u,a)):()=>Promise.resolve(),v=e.variantChildren&&e.variantChildren.size?(S=0)=>{const{delayChildren:C=0,staggerChildren:R,staggerDirection:N}=p;return XTe(e,i,C+S,R,N,a)}:()=>Promise.resolve(),{when:y}=p;if(y){const[S,C]=y==="beforeChildren"?[m,v]:[v,m];return S().then(()=>C())}else return Promise.all([m(),v(a.delay)])}function XTe(e,i,a=0,l=0,u=1,p){const m=[],v=(e.variantChildren.size-1)*l,y=u===1?(S=0)=>S*l:(S=0)=>v-S*l;return Array.from(e.variantChildren).sort(QTe).forEach((S,C)=>{S.notify("AnimationStart",i),m.push(PP(S,i,{...p,delay:a+y(C)}).then(()=>S.notify("AnimationComplete",i)))}),Promise.all(m)}function QTe(e,i){return e.sortNodePosition(i)}function ZTe(e,i,a={}){e.notify("AnimationStart",i);let l;if(Array.isArray(i)){const u=i.map(p=>PP(e,p,a));l=Promise.all(u)}else if(typeof i=="string")l=PP(e,i,a);else{const u=typeof i=="function"?fC(e,i,a.custom):i;l=Promise.all(Z7(e,u,a))}return l.then(()=>{Mi.postRender(()=>{e.notify("AnimationComplete",i)})})}const ebe=[...xD].reverse(),tbe=xD.length;function nbe(e){return i=>Promise.all(i.map(({animation:a,options:l})=>ZTe(e,a,l)))}function rbe(e){let i=nbe(e);const a=obe();let l=!0;const u=y=>(S,C)=>{var R;const N=fC(e,C,y==="exit"?(R=e.presenceContext)===null||R===void 0?void 0:R.custom:void 0);if(N){const{transition:x,transitionEnd:U,...M}=N;S={...S,...M,...U}}return S};function p(y){i=y(e)}function m(y){const S=e.getProps(),C=e.getVariantContext(!0)||{},R=[],N=new Set;let x={},U=1/0;for(let z=0;z<tbe;z++){const V=ebe[z],W=a[V],H=S[V]!==void 0?S[V]:C[V],q=jv(H),ee=V===y?W.isActive:null;ee===!1&&(U=z);let oe=H===C[V]&&H!==S[V]&&q;if(oe&&l&&e.manuallyAnimateOnMount&&(oe=!1),W.protectedKeys={...x},!W.isActive&&ee===null||!H&&!W.prevProp||uC(H)||typeof H=="boolean")continue;let re=ibe(W.prevProp,H)||V===y&&W.isActive&&!oe&&q||z>U&&q,me=!1;const pe=Array.isArray(H)?H:[H];let Re=pe.reduce(u(V),{});ee===!1&&(Re={});const{prevResolvedValues:Ze={}}=W,Qe={...Ze,...Re},Oe=Ie=>{re=!0,N.has(Ie)&&(me=!0,N.delete(Ie)),W.needsAnimating[Ie]=!0;const Te=e.getValue(Ie);Te&&(Te.liveStyle=!1)};for(const Ie in Qe){const Te=Re[Ie],de=Ze[Ie];if(x.hasOwnProperty(Ie))continue;let ue=!1;TP(Te)&&TP(de)?ue=!b7(Te,de):ue=Te!==de,ue?Te!=null?Oe(Ie):N.add(Ie):Te!==void 0&&N.has(Ie)?Oe(Ie):W.protectedKeys[Ie]=!0}W.prevProp=H,W.prevResolvedValues=Re,W.isActive&&(x={...x,...Re}),l&&e.blockInitialAnimation&&(re=!1),re&&(!oe||me)&&R.push(...pe.map(Ie=>({animation:Ie,options:{type:V}})))}if(N.size){const z={};N.forEach(V=>{const W=e.getBaseTarget(V),H=e.getValue(V);H&&(H.liveStyle=!0),z[V]=W??null}),R.push({animation:z})}let M=!!R.length;return l&&(S.initial===!1||S.initial===S.animate)&&!e.manuallyAnimateOnMount&&(M=!1),l=!1,M?i(R):Promise.resolve()}function v(y,S){var C;if(a[y].isActive===S)return Promise.resolve();(C=e.variantChildren)===null||C===void 0||C.forEach(N=>{var x;return(x=N.animationState)===null||x===void 0?void 0:x.setActive(y,S)}),a[y].isActive=S;const R=m(y);for(const N in a)a[N].protectedKeys={};return R}return{animateChanges:m,setActive:v,setAnimateFunction:p,getState:()=>a}}function ibe(e,i){return typeof i=="string"?i!==e:Array.isArray(i)?!b7(i,e):!1}function eh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function obe(){return{animate:eh(!0),whileInView:eh(),whileHover:eh(),whileTap:eh(),whileDrag:eh(),whileFocus:eh(),exit:eh()}}class sbe extends fu{constructor(i){super(i),i.animationState||(i.animationState=rbe(i))}updateAnimationControlsSubscription(){const{animate:i}=this.node.getProps();this.unmount(),uC(i)&&(this.unmount=i.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:i}=this.node.getProps(),{animate:a}=this.node.prevProps||{};i!==a&&this.updateAnimationControlsSubscription()}unmount(){}}let abe=0;class cbe extends fu{constructor(){super(...arguments),this.id=abe++}update(){if(!this.node.presenceContext)return;const{isPresent:i,onExitComplete:a}=this.node.presenceContext,{isPresent:l}=this.node.prevPresenceContext||{};if(!this.node.animationState||i===l)return;const u=this.node.animationState.setActive("exit",!i);a&&!i&&u.then(()=>a(this.id))}mount(){const{register:i}=this.node.presenceContext||{};i&&(this.unmount=i(this.id))}unmount(){}}const lbe={animation:{Feature:sbe},exit:{Feature:cbe}},x8=(e,i)=>Math.abs(e-i);function dbe(e,i){const a=x8(e.x,i.x),l=x8(e.y,i.y);return Math.sqrt(a**2+l**2)}class e${constructor(i,a,{transformPagePoint:l,contextWindow:u,dragSnapToOrigin:p=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const R=LO(this.lastMoveEventInfo,this.history),N=this.startEvent!==null,x=dbe(R.offset,{x:0,y:0})>=3;if(!N&&!x)return;const{point:U}=R,{timestamp:M}=Hi;this.history.push({...U,timestamp:M});const{onStart:z,onMove:V}=this.handlers;N||(z&&z(this.lastMoveEvent,R),this.startEvent=this.lastMoveEvent),V&&V(this.lastMoveEvent,R)},this.handlePointerMove=(R,N)=>{this.lastMoveEvent=R,this.lastMoveEventInfo=xO(N,this.transformPagePoint),Mi.update(this.updatePoint,!0)},this.handlePointerUp=(R,N)=>{this.end();const{onEnd:x,onSessionEnd:U,resumeAnimation:M}=this.handlers;if(this.dragSnapToOrigin&&M&&M(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const z=LO(R.type==="pointercancel"?this.lastMoveEventInfo:xO(N,this.transformPagePoint),this.history);this.startEvent&&x&&x(R,z),U&&U(R,z)},!v7(i))return;this.dragSnapToOrigin=p,this.handlers=a,this.transformPagePoint=l,this.contextWindow=u||window;const m=pC(i),v=xO(m,this.transformPagePoint),{point:y}=v,{timestamp:S}=Hi;this.history=[{...y,timestamp:S}];const{onSessionStart:C}=a;C&&C(i,LO(v,this.history)),this.removeListeners=Rl(wl(this.contextWindow,"pointermove",this.handlePointerMove),wl(this.contextWindow,"pointerup",this.handlePointerUp),wl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(i){this.handlers=i}end(){this.removeListeners&&this.removeListeners(),cu(this.updatePoint)}}function xO(e,i){return i?{point:i(e.point)}:e}function L8(e,i){return{x:e.x-i.x,y:e.y-i.y}}function LO({point:e},i){return{point:e,delta:L8(e,t$(i)),offset:L8(e,ube(i)),velocity:hbe(i,.1)}}function ube(e){return e[0]}function t$(e){return e[e.length-1]}function hbe(e,i){if(e.length<2)return{x:0,y:0};let a=e.length-1,l=null;const u=t$(e);for(;a>=0&&(l=e[a],!(u.timestamp-l.timestamp>tu(i)));)a--;if(!l)return{x:0,y:0};const p=Il(u.timestamp-l.timestamp);if(p===0)return{x:0,y:0};const m={x:(u.x-l.x)/p,y:(u.y-l.y)/p};return m.x===1/0&&(m.x=0),m.y===1/0&&(m.y=0),m}function xs(e){return e.max-e.min}function kP(e,i=0,a=.01){return Math.abs(e-i)<=a}function M8(e,i,a,l=.5){e.origin=l,e.originPoint=zr(i.min,i.max,e.origin),e.scale=xs(a)/xs(i),(kP(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=zr(a.min,a.max,e.origin)-e.originPoint,(kP(e.translate)||isNaN(e.translate))&&(e.translate=0)}function cv(e,i,a,l){M8(e.x,i.x,a.x,l?l.originX:void 0),M8(e.y,i.y,a.y,l?l.originY:void 0)}function U8(e,i,a){e.min=a.min+i.min,e.max=e.min+xs(i)}function pbe(e,i,a){U8(e.x,i.x,a.x),U8(e.y,i.y,a.y)}function j8(e,i,a){e.min=i.min-a.min,e.max=e.min+xs(i)}function lv(e,i,a){j8(e.x,i.x,a.x),j8(e.y,i.y,a.y)}function fbe(e,{min:i,max:a},l){return i!==void 0&&e<i?e=l?zr(i,e,l.min):Math.max(e,i):a!==void 0&&e>a&&(e=l?zr(a,e,l.max):Math.min(e,a)),e}function F8(e,i,a){return{min:i!==void 0?e.min+i:void 0,max:a!==void 0?e.max+a-(e.max-e.min):void 0}}function mbe(e,{top:i,left:a,bottom:l,right:u}){return{x:F8(e.x,a,u),y:F8(e.y,i,l)}}function V8(e,i){let a=i.min-e.min,l=i.max-e.max;return i.max-i.min<e.max-e.min&&([a,l]=[l,a]),{min:a,max:l}}function gbe(e,i){return{x:V8(e.x,i.x),y:V8(e.y,i.y)}}function _be(e,i){let a=.5;const l=xs(e),u=xs(i);return u>l?a=Vv(i.min,i.max-l,e.min):l>u&&(a=Vv(e.min,e.max-u,i.min)),au(0,1,a)}function vbe(e,i){const a={};return i.min!==void 0&&(a.min=i.min-e.min),i.max!==void 0&&(a.max=i.max-e.min),a}const DP=.35;function Ebe(e=DP){return e===!1?e=0:e===!0&&(e=DP),{x:B8(e,"left","right"),y:B8(e,"top","bottom")}}function B8(e,i,a){return{min:W8(e,i),max:W8(e,a)}}function W8(e,i){return typeof e=="number"?e:e[i]||0}const z8=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ff=()=>({x:z8(),y:z8()}),G8=()=>({min:0,max:0}),ii=()=>({x:G8(),y:G8()});function da(e){return[e("x"),e("y")]}function n$({top:e,left:i,right:a,bottom:l}){return{x:{min:i,max:a},y:{min:e,max:l}}}function ybe({x:e,y:i}){return{top:i.min,right:e.max,bottom:i.max,left:e.min}}function Sbe(e,i){if(!i)return e;const a=i({x:e.left,y:e.top}),l=i({x:e.right,y:e.bottom});return{top:a.y,left:a.x,bottom:l.y,right:l.x}}function MO(e){return e===void 0||e===1}function xP({scale:e,scaleX:i,scaleY:a}){return!MO(e)||!MO(i)||!MO(a)}function rh(e){return xP(e)||r$(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function r$(e){return H8(e.x)||H8(e.y)}function H8(e){return e&&e!=="0%"}function _b(e,i,a){const l=e-a,u=i*l;return a+u}function $8(e,i,a,l,u){return u!==void 0&&(e=_b(e,u,l)),_b(e,a,l)+i}function LP(e,i=0,a=1,l,u){e.min=$8(e.min,i,a,l,u),e.max=$8(e.max,i,a,l,u)}function i$(e,{x:i,y:a}){LP(e.x,i.translate,i.scale,i.originPoint),LP(e.y,a.translate,a.scale,a.originPoint)}function Tbe(e,i,a,l=!1){const u=a.length;if(!u)return;i.x=i.y=1;let p,m;for(let v=0;v<u;v++){p=a[v],m=p.projectionDelta;const y=p.instance;y&&y.style&&y.style.display==="contents"||(l&&p.options.layoutScroll&&p.scroll&&p!==p.root&&Vf(e,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),m&&(i.x*=m.x.scale,i.y*=m.y.scale,i$(e,m)),l&&rh(p.latestValues)&&Vf(e,p.latestValues))}i.x=K8(i.x),i.y=K8(i.y)}function K8(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Vd(e,i){e.min=e.min+i,e.max=e.max+i}function Y8(e,i,[a,l,u]){const p=i[u]!==void 0?i[u]:.5,m=zr(e.min,e.max,p);LP(e,i[a],i[l],m,i.scale)}const bbe=["x","scaleX","originX"],Cbe=["y","scaleY","originY"];function Vf(e,i){Y8(e.x,i,bbe),Y8(e.y,i,Cbe)}function o$(e,i){return n$(Sbe(e.getBoundingClientRect(),i))}function wbe(e,i,a){const l=o$(e,a),{scroll:u}=i;return u&&(Vd(l.x,u.offset.x),Vd(l.y,u.offset.y)),l}const s$=({current:e})=>e?e.ownerDocument.defaultView:null,Rbe=new WeakMap;class Ibe{constructor(i){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ii(),this.visualElement=i}start(i,{snapToCursor:a=!1}={}){const{presenceContext:l}=this.visualElement;if(l&&l.isPresent===!1)return;const u=C=>{const{dragSnapToOrigin:R}=this.getProps();R?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(pC(C,"page").point)},p=(C,R)=>{const{drag:N,dragPropagation:x,onDragStart:U}=this.getProps();if(N&&!x&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=y7(N),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),da(z=>{let V=this.getAxisMotionValue(z).get()||0;if(Pc.test(V)){const{projection:W}=this.visualElement;if(W&&W.layout){const H=W.layout.layoutBox[z];H&&(V=xs(H)*(parseFloat(V)/100))}}this.originPoint[z]=V}),U&&U(C,R);const{animationState:M}=this.visualElement;M&&M.setActive("whileDrag",!0)},m=(C,R)=>{const{dragPropagation:N,dragDirectionLock:x,onDirectionLock:U,onDrag:M}=this.getProps();if(!N&&!this.openGlobalLock)return;const{offset:z}=R;if(x&&this.currentDirection===null){this.currentDirection=Abe(z),this.currentDirection!==null&&U&&U(this.currentDirection);return}this.updateAxis("x",R.point,z),this.updateAxis("y",R.point,z),this.visualElement.render(),M&&M(C,R)},v=(C,R)=>this.stop(C,R),y=()=>da(C=>{var R;return this.getAnimationState(C)==="paused"&&((R=this.getAxisMotionValue(C).animation)===null||R===void 0?void 0:R.play())}),{dragSnapToOrigin:S}=this.getProps();this.panSession=new e$(i,{onSessionStart:u,onStart:p,onMove:m,onSessionEnd:v,resumeAnimation:y},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:S,contextWindow:s$(this.visualElement)})}stop(i,a){const l=this.isDragging;if(this.cancel(),!l)return;const{velocity:u}=a;this.startAnimation(u);const{onDragEnd:p}=this.getProps();p&&p(i,a)}cancel(){this.isDragging=!1;const{projection:i,animationState:a}=this.visualElement;i&&(i.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:l}=this.getProps();!l&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(i,a,l){const{drag:u}=this.getProps();if(!l||!jS(i,u,this.currentDirection))return;const p=this.getAxisMotionValue(i);let m=this.originPoint[i]+l[i];this.constraints&&this.constraints[i]&&(m=fbe(m,this.constraints[i],this.elastic[i])),p.set(m)}resolveConstraints(){var i;const{dragConstraints:a,dragElastic:l}=this.getProps(),u=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)===null||i===void 0?void 0:i.layout,p=this.constraints;a&&Uf(a)?this.constraints||(this.constraints=this.resolveRefConstraints()):a&&u?this.constraints=mbe(u.layoutBox,a):this.constraints=!1,this.elastic=Ebe(l),p!==this.constraints&&u&&this.constraints&&!this.hasMutatedConstraints&&da(m=>{this.constraints!==!1&&this.getAxisMotionValue(m)&&(this.constraints[m]=vbe(u.layoutBox[m],this.constraints[m]))})}resolveRefConstraints(){const{dragConstraints:i,onMeasureDragConstraints:a}=this.getProps();if(!i||!Uf(i))return!1;const l=i.current,{projection:u}=this.visualElement;if(!u||!u.layout)return!1;const p=wbe(l,u.root,this.visualElement.getTransformPagePoint());let m=gbe(u.layout.layoutBox,p);if(a){const v=a(ybe(m));this.hasMutatedConstraints=!!v,v&&(m=n$(v))}return m}startAnimation(i){const{drag:a,dragMomentum:l,dragElastic:u,dragTransition:p,dragSnapToOrigin:m,onDragTransitionEnd:v}=this.getProps(),y=this.constraints||{},S=da(C=>{if(!jS(C,a,this.currentDirection))return;let R=y&&y[C]||{};m&&(R={min:0,max:0});const N=u?200:1e6,x=u?40:1e7,U={type:"inertia",velocity:l?i[C]:0,bounceStiffness:N,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...p,...R};return this.startAxisValueAnimation(C,U)});return Promise.all(S).then(v)}startAxisValueAnimation(i,a){const l=this.getAxisMotionValue(i);return l.start(tx(i,l,0,a,this.visualElement))}stopAnimation(){da(i=>this.getAxisMotionValue(i).stop())}pauseAnimation(){da(i=>{var a;return(a=this.getAxisMotionValue(i).animation)===null||a===void 0?void 0:a.pause()})}getAnimationState(i){var a;return(a=this.getAxisMotionValue(i).animation)===null||a===void 0?void 0:a.state}getAxisMotionValue(i){const a=`_drag${i.toUpperCase()}`,l=this.visualElement.getProps(),u=l[a];return u||this.visualElement.getValue(i,(l.initial?l.initial[i]:void 0)||0)}snapToCursor(i){da(a=>{const{drag:l}=this.getProps();if(!jS(a,l,this.currentDirection))return;const{projection:u}=this.visualElement,p=this.getAxisMotionValue(a);if(u&&u.layout){const{min:m,max:v}=u.layout.layoutBox[a];p.set(i[a]-zr(m,v,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:i,dragConstraints:a}=this.getProps(),{projection:l}=this.visualElement;if(!Uf(a)||!l||!this.constraints)return;this.stopAnimation();const u={x:0,y:0};da(m=>{const v=this.getAxisMotionValue(m);if(v&&this.constraints!==!1){const y=v.get();u[m]=_be({min:y,max:y},this.constraints[m])}});const{transformTemplate:p}=this.visualElement.getProps();this.visualElement.current.style.transform=p?p({},""):"none",l.root&&l.root.updateScroll(),l.updateLayout(),this.resolveConstraints(),da(m=>{if(!jS(m,i,null))return;const v=this.getAxisMotionValue(m),{min:y,max:S}=this.constraints[m];v.set(zr(y,S,u[m]))})}addListeners(){if(!this.visualElement.current)return;Rbe.set(this.visualElement,this);const i=this.visualElement.current,a=wl(i,"pointerdown",y=>{const{drag:S,dragListener:C=!0}=this.getProps();S&&C&&this.start(y)}),l=()=>{const{dragConstraints:y}=this.getProps();Uf(y)&&(this.constraints=this.resolveRefConstraints())},{projection:u}=this.visualElement,p=u.addEventListener("measure",l);u&&!u.layout&&(u.root&&u.root.updateScroll(),u.updateLayout()),l();const m=yl(window,"resize",()=>this.scalePositionWithinConstraints()),v=u.addEventListener("didUpdate",({delta:y,hasLayoutChanged:S})=>{this.isDragging&&S&&(da(C=>{const R=this.getAxisMotionValue(C);R&&(this.originPoint[C]+=y[C].translate,R.set(R.get()+y[C].translate))}),this.visualElement.render())});return()=>{m(),a(),p(),v&&v()}}getProps(){const i=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:l=!1,dragPropagation:u=!1,dragConstraints:p=!1,dragElastic:m=DP,dragMomentum:v=!0}=i;return{...i,drag:a,dragDirectionLock:l,dragPropagation:u,dragConstraints:p,dragElastic:m,dragMomentum:v}}}function jS(e,i,a){return(i===!0||i===e)&&(a===null||a===e)}function Abe(e,i=10){let a=null;return Math.abs(e.y)>i?a="y":Math.abs(e.x)>i&&(a="x"),a}class Obe extends fu{constructor(i){super(i),this.removeGroupControls=_o,this.removeListeners=_o,this.controls=new Ibe(i)}mount(){const{dragControls:i}=this.node.getProps();i&&(this.removeGroupControls=i.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||_o}unmount(){this.removeGroupControls(),this.removeListeners()}}const q8=e=>(i,a)=>{e&&e(i,a)};class Nbe extends fu{constructor(){super(...arguments),this.removePointerDownListener=_o}onPointerDown(i){this.session=new e$(i,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:s$(this.node)})}createPanHandlers(){const{onPanSessionStart:i,onPanStart:a,onPan:l,onPanEnd:u}=this.node.getProps();return{onSessionStart:q8(i),onStart:q8(a),onMove:l,onEnd:(p,m)=>{delete this.session,u&&u(p,m)}}}mount(){this.removePointerDownListener=wl(this.node.current,"pointerdown",i=>this.onPointerDown(i))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function a$(){const e=F.useContext(sE);if(e===null)return[!0,null];const{isPresent:i,onExitComplete:a,register:l}=e,u=F.useId();return F.useEffect(()=>l(u),[]),!i&&a?[!1,()=>a&&a(u)]:[!0]}function Pbe(){return kbe(F.useContext(sE))}function kbe(e){return e===null?!0:e.isPresent}const ST={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function J8(e,i){return i.max===i.min?0:e/(i.max-i.min)*100}const I_={correct:(e,i)=>{if(!i.target)return e;if(typeof e=="string")if(Nt.test(e))e=parseFloat(e);else return e;const a=J8(e,i.target.x),l=J8(e,i.target.y);return`${a}% ${l}%`}},Dbe={correct:(e,{treeScale:i,projectionDelta:a})=>{const l=e,u=lu.parse(e);if(u.length>5)return l;const p=lu.createTransformer(e),m=typeof u[0]!="number"?1:0,v=a.x.scale*i.x,y=a.y.scale*i.y;u[0+m]/=v,u[1+m]/=y;const S=zr(v,y,.5);return typeof u[2+m]=="number"&&(u[2+m]/=S),typeof u[3+m]=="number"&&(u[3+m]/=S),p(u)}};class xbe extends F.Component{componentDidMount(){const{visualElement:i,layoutGroup:a,switchLayoutGroup:l,layoutId:u}=this.props,{projection:p}=i;k0e(Lbe),p&&(a.group&&a.group.add(p),l&&l.register&&u&&l.register(p),p.root.didUpdate(),p.addEventListener("animationComplete",()=>{this.safeToRemove()}),p.setOptions({...p.options,onExitComplete:()=>this.safeToRemove()})),ST.hasEverUpdated=!0}getSnapshotBeforeUpdate(i){const{layoutDependency:a,visualElement:l,drag:u,isPresent:p}=this.props,m=l.projection;return m&&(m.isPresent=p,u||i.layoutDependency!==a||a===void 0?m.willUpdate():this.safeToRemove(),i.isPresent!==p&&(p?m.promote():m.relegate()||Mi.postRender(()=>{const v=m.getStack();(!v||!v.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:i}=this.props.visualElement;i&&(i.root.didUpdate(),DD.postRender(()=>{!i.currentAnimation&&i.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:i,layoutGroup:a,switchLayoutGroup:l}=this.props,{projection:u}=i;u&&(u.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(u),l&&l.deregister&&l.deregister(u))}safeToRemove(){const{safeToRemove:i}=this.props;i&&i()}render(){return null}}function c$(e){const[i,a]=a$(),l=F.useContext(MD);return b.jsx(xbe,{...e,layoutGroup:l,switchLayoutGroup:F.useContext(i7),isPresent:i,safeToRemove:a})}const Lbe={borderRadius:{...I_,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:I_,borderTopRightRadius:I_,borderBottomLeftRadius:I_,borderBottomRightRadius:I_,boxShadow:Dbe},l$=["TopLeft","TopRight","BottomLeft","BottomRight"],Mbe=l$.length,X8=e=>typeof e=="string"?parseFloat(e):e,Q8=e=>typeof e=="number"||Nt.test(e);function Ube(e,i,a,l,u,p){u?(e.opacity=zr(0,a.opacity!==void 0?a.opacity:1,jbe(l)),e.opacityExit=zr(i.opacity!==void 0?i.opacity:1,0,Fbe(l))):p&&(e.opacity=zr(i.opacity!==void 0?i.opacity:1,a.opacity!==void 0?a.opacity:1,l));for(let m=0;m<Mbe;m++){const v=`border${l$[m]}Radius`;let y=Z8(i,v),S=Z8(a,v);if(y===void 0&&S===void 0)continue;y||(y=0),S||(S=0),y===0||S===0||Q8(y)===Q8(S)?(e[v]=Math.max(zr(X8(y),X8(S),l),0),(Pc.test(S)||Pc.test(y))&&(e[v]+="%")):e[v]=S}(i.rotate||a.rotate)&&(e.rotate=zr(i.rotate||0,a.rotate||0,l))}function Z8(e,i){return e[i]!==void 0?e[i]:e.borderRadius}const jbe=d$(0,.5,$7),Fbe=d$(.5,.95,_o);function d$(e,i,a){return l=>l<e?0:l>i?1:a(Vv(e,i,l))}function eW(e,i){e.min=i.min,e.max=i.max}function ca(e,i){eW(e.x,i.x),eW(e.y,i.y)}function tW(e,i,a,l,u){return e-=i,e=_b(e,1/a,l),u!==void 0&&(e=_b(e,1/u,l)),e}function Vbe(e,i=0,a=1,l=.5,u,p=e,m=e){if(Pc.test(i)&&(i=parseFloat(i),i=zr(m.min,m.max,i/100)-m.min),typeof i!="number")return;let v=zr(p.min,p.max,l);e===p&&(v-=i),e.min=tW(e.min,i,a,v,u),e.max=tW(e.max,i,a,v,u)}function nW(e,i,[a,l,u],p,m){Vbe(e,i[a],i[l],i[u],i.scale,p,m)}const Bbe=["x","scaleX","originX"],Wbe=["y","scaleY","originY"];function rW(e,i,a,l){nW(e.x,i,Bbe,a?a.x:void 0,l?l.x:void 0),nW(e.y,i,Wbe,a?a.y:void 0,l?l.y:void 0)}function iW(e){return e.translate===0&&e.scale===1}function u$(e){return iW(e.x)&&iW(e.y)}function zbe(e,i){return e.x.min===i.x.min&&e.x.max===i.x.max&&e.y.min===i.y.min&&e.y.max===i.y.max}function h$(e,i){return Math.round(e.x.min)===Math.round(i.x.min)&&Math.round(e.x.max)===Math.round(i.x.max)&&Math.round(e.y.min)===Math.round(i.y.min)&&Math.round(e.y.max)===Math.round(i.y.max)}function oW(e){return xs(e.x)/xs(e.y)}class Gbe{constructor(){this.members=[]}add(i){nx(this.members,i),i.scheduleRender()}remove(i){if(rx(this.members,i),i===this.prevLead&&(this.prevLead=void 0),i===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(i){const a=this.members.findIndex(u=>i===u);if(a===0)return!1;let l;for(let u=a;u>=0;u--){const p=this.members[u];if(p.isPresent!==!1){l=p;break}}return l?(this.promote(l),!0):!1}promote(i,a){const l=this.lead;if(i!==l&&(this.prevLead=l,this.lead=i,i.show(),l)){l.instance&&l.scheduleRender(),i.scheduleRender(),i.resumeFrom=l,a&&(i.resumeFrom.preserveOpacity=!0),l.snapshot&&(i.snapshot=l.snapshot,i.snapshot.latestValues=l.animationValues||l.latestValues),i.root&&i.root.isUpdating&&(i.isLayoutDirty=!0);const{crossfade:u}=i.options;u===!1&&l.hide()}}exitAnimationComplete(){this.members.forEach(i=>{const{options:a,resumingFrom:l}=i;a.onExitComplete&&a.onExitComplete(),l&&l.options.onExitComplete&&l.options.onExitComplete()})}scheduleRender(){this.members.forEach(i=>{i.instance&&i.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function sW(e,i,a){let l="";const u=e.x.translate/i.x,p=e.y.translate/i.y,m=(a==null?void 0:a.z)||0;if((u||p||m)&&(l=`translate3d(${u}px, ${p}px, ${m}px) `),(i.x!==1||i.y!==1)&&(l+=`scale(${1/i.x}, ${1/i.y}) `),a){const{transformPerspective:S,rotate:C,rotateX:R,rotateY:N,skewX:x,skewY:U}=a;S&&(l=`perspective(${S}px) ${l}`),C&&(l+=`rotate(${C}deg) `),R&&(l+=`rotateX(${R}deg) `),N&&(l+=`rotateY(${N}deg) `),x&&(l+=`skewX(${x}deg) `),U&&(l+=`skewY(${U}deg) `)}const v=e.x.scale*i.x,y=e.y.scale*i.y;return(v!==1||y!==1)&&(l+=`scale(${v}, ${y})`),l||"none"}const Hbe=(e,i)=>e.depth-i.depth;class $be{constructor(){this.children=[],this.isDirty=!1}add(i){nx(this.children,i),this.isDirty=!0}remove(i){rx(this.children,i),this.isDirty=!0}forEach(i){this.isDirty&&this.children.sort(Hbe),this.isDirty=!1,this.children.forEach(i)}}function Kbe(e,i){const a=nu.now(),l=({timestamp:u})=>{const p=u-a;p>=i&&(cu(l),e(p-i))};return Mi.read(l,!0),()=>cu(l)}function Ybe(e){window.MotionDebug&&window.MotionDebug.record(e)}function qbe(e){return e instanceof SVGElement&&e.tagName!=="svg"}function Jbe(e,i,a){const l=po(e)?e:Bv(e);return l.start(tx("",l,i,a)),l.animation}const UO=["","X","Y","Z"],Xbe={visibility:"hidden"},aW=1e3;let Qbe=0;const ih={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function jO(e,i,a,l){const{latestValues:u}=i;u[e]&&(a[e]=u[e],i.setStaticValue(e,0),l&&(l[e]=0))}function p$({attachResizeListener:e,defaultParent:i,measureScroll:a,checkIsScrollRoot:l,resetTransform:u}){return class{constructor(m={},v=i==null?void 0:i()){this.id=Qbe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ih.totalNodes=ih.resolvedTargetDeltas=ih.recalculatedProjection=0,this.nodes.forEach(tCe),this.nodes.forEach(sCe),this.nodes.forEach(aCe),this.nodes.forEach(nCe),Ybe(ih)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=m,this.root=v?v.root||v:this,this.path=v?[...v.path,v]:[],this.parent=v,this.depth=v?v.depth+1:0;for(let y=0;y<this.path.length;y++)this.path[y].shouldResetTransform=!0;this.root===this&&(this.nodes=new $be)}addEventListener(m,v){return this.eventHandlers.has(m)||this.eventHandlers.set(m,new ix),this.eventHandlers.get(m).add(v)}notifyListeners(m,...v){const y=this.eventHandlers.get(m);y&&y.notify(...v)}hasListeners(m){return this.eventHandlers.has(m)}mount(m,v=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=qbe(m),this.instance=m;const{layoutId:y,layout:S,visualElement:C}=this.options;if(C&&!C.current&&C.mount(m),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),v&&(S||y)&&(this.isLayoutDirty=!0),e){let R;const N=()=>this.root.updateBlockedByResize=!1;e(m,()=>{this.root.updateBlockedByResize=!0,R&&R(),R=Kbe(N,250),ST.hasAnimatedSinceResize&&(ST.hasAnimatedSinceResize=!1,this.nodes.forEach(lW))})}y&&this.root.registerSharedNode(y,this),this.options.animate!==!1&&C&&(y||S)&&this.addEventListener("didUpdate",({delta:R,hasLayoutChanged:N,hasRelativeTargetChanged:x,layout:U})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const M=this.options.transition||C.getDefaultTransition()||hCe,{onLayoutAnimationStart:z,onLayoutAnimationComplete:V}=C.getProps(),W=!this.targetLayout||!h$(this.targetLayout,U)||x,H=!N&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||H||N&&(W||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(R,H);const q={...$D(M,"layout"),onPlay:z,onComplete:V};(C.shouldReduceMotion||this.options.layoutRoot)&&(q.delay=0,q.type=!1),this.startAnimation(q)}else N||lW(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=U})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const m=this.getStack();m&&m.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,cu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(cCe),this.animationId++)}getTransformTemplate(){const{visualElement:m}=this.options;return m&&m.getProps().transformTemplate}willUpdate(m=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let C=0;C<this.path.length;C++){const R=this.path[C];R.shouldResetTransform=!0,R.updateScroll("snapshot"),R.options.layoutRoot&&R.willUpdate(!1)}const{layoutId:v,layout:y}=this.options;if(v===void 0&&!y)return;const S=this.getTransformTemplate();this.prevTransformTemplateValue=S?S(this.latestValues,""):void 0,this.updateSnapshot(),m&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(cW);return}this.isUpdating||this.nodes.forEach(iCe),this.isUpdating=!1,window.HandoffCancelAllAnimations&&window.HandoffCancelAllAnimations(),this.nodes.forEach(oCe),this.nodes.forEach(Zbe),this.nodes.forEach(eCe),this.clearAllSnapshots();const v=nu.now();Hi.delta=au(0,1e3/60,v-Hi.timestamp),Hi.timestamp=v,Hi.isProcessing=!0,IO.update.process(Hi),IO.preRender.process(Hi),IO.render.process(Hi),Hi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,DD.read(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(rCe),this.sharedNodes.forEach(lCe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Mi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Mi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let y=0;y<this.path.length;y++)this.path[y].updateScroll();const m=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ii(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:v}=this.options;v&&v.notify("LayoutMeasure",this.layout.layoutBox,m?m.layoutBox:void 0)}updateScroll(m="measure"){let v=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===m&&(v=!1),v&&(this.scroll={animationId:this.root.animationId,phase:m,isRoot:l(this.instance),offset:a(this.instance)})}resetTransform(){if(!u)return;const m=this.isLayoutDirty||this.shouldResetTransform,v=this.projectionDelta&&!u$(this.projectionDelta),y=this.getTransformTemplate(),S=y?y(this.latestValues,""):void 0,C=S!==this.prevTransformTemplateValue;m&&(v||rh(this.latestValues)||C)&&(u(this.instance,S),this.shouldResetTransform=!1,this.scheduleRender())}measure(m=!0){const v=this.measurePageBox();let y=this.removeElementScroll(v);return m&&(y=this.removeTransform(y)),pCe(y),{animationId:this.root.animationId,measuredBox:v,layoutBox:y,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:m}=this.options;if(!m)return ii();const v=m.measureViewportBox(),{scroll:y}=this.root;return y&&(Vd(v.x,y.offset.x),Vd(v.y,y.offset.y)),v}removeElementScroll(m){const v=ii();ca(v,m);for(let y=0;y<this.path.length;y++){const S=this.path[y],{scroll:C,options:R}=S;if(S!==this.root&&C&&R.layoutScroll){if(C.isRoot){ca(v,m);const{scroll:N}=this.root;N&&(Vd(v.x,-N.offset.x),Vd(v.y,-N.offset.y))}Vd(v.x,C.offset.x),Vd(v.y,C.offset.y)}}return v}applyTransform(m,v=!1){const y=ii();ca(y,m);for(let S=0;S<this.path.length;S++){const C=this.path[S];!v&&C.options.layoutScroll&&C.scroll&&C!==C.root&&Vf(y,{x:-C.scroll.offset.x,y:-C.scroll.offset.y}),rh(C.latestValues)&&Vf(y,C.latestValues)}return rh(this.latestValues)&&Vf(y,this.latestValues),y}removeTransform(m){const v=ii();ca(v,m);for(let y=0;y<this.path.length;y++){const S=this.path[y];if(!S.instance||!rh(S.latestValues))continue;xP(S.latestValues)&&S.updateSnapshot();const C=ii(),R=S.measurePageBox();ca(C,R),rW(v,S.latestValues,S.snapshot?S.snapshot.layoutBox:void 0,C)}return rh(this.latestValues)&&rW(v,this.latestValues),v}setTargetDelta(m){this.targetDelta=m,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(m){this.options={...this.options,...m,crossfade:m.crossfade!==void 0?m.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Hi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(m=!1){var v;const y=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=y.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=y.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=y.isSharedProjectionDirty);const S=!!this.resumingFrom||this!==y;if(!(m||S&&this.isSharedProjectionDirty||this.isProjectionDirty||!((v=this.parent)===null||v===void 0)&&v.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:R,layoutId:N}=this.options;if(!(!this.layout||!(R||N))){if(this.resolvedRelativeTargetAt=Hi.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ii(),this.relativeTargetOrigin=ii(),lv(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),ca(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ii(),this.targetWithTransforms=ii()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),pbe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ca(this.target,this.layout.layoutBox),i$(this.target,this.targetDelta)):ca(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ii(),this.relativeTargetOrigin=ii(),lv(this.relativeTargetOrigin,this.target,x.target),ca(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ih.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||xP(this.parent.latestValues)||r$(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var m;const v=this.getLead(),y=!!this.resumingFrom||this!==v;let S=!0;if((this.isProjectionDirty||!((m=this.parent)===null||m===void 0)&&m.isProjectionDirty)&&(S=!1),y&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(S=!1),this.resolvedRelativeTargetAt===Hi.timestamp&&(S=!1),S)return;const{layout:C,layoutId:R}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(C||R))return;ca(this.layoutCorrected,this.layout.layoutBox);const N=this.treeScale.x,x=this.treeScale.y;Tbe(this.layoutCorrected,this.treeScale,this.path,y),v.layout&&!v.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(v.target=v.layout.layoutBox,v.targetWithTransforms=ii());const{target:U}=v;if(!U){this.projectionTransform&&(this.projectionDelta=Ff(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Ff(),this.projectionDeltaWithTransform=Ff());const M=this.projectionTransform;cv(this.projectionDelta,this.layoutCorrected,U,this.latestValues),this.projectionTransform=sW(this.projectionDelta,this.treeScale),(this.projectionTransform!==M||this.treeScale.x!==N||this.treeScale.y!==x)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",U)),ih.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(m=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),m){const v=this.getStack();v&&v.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(m,v=!1){const y=this.snapshot,S=y?y.latestValues:{},C={...this.latestValues},R=Ff();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!v;const N=ii(),x=y?y.source:void 0,U=this.layout?this.layout.source:void 0,M=x!==U,z=this.getStack(),V=!z||z.members.length<=1,W=!!(M&&!V&&this.options.crossfade===!0&&!this.path.some(uCe));this.animationProgress=0;let H;this.mixTargetDelta=q=>{const ee=q/1e3;dW(R.x,m.x,ee),dW(R.y,m.y,ee),this.setTargetDelta(R),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(lv(N,this.layout.layoutBox,this.relativeParent.layout.layoutBox),dCe(this.relativeTarget,this.relativeTargetOrigin,N,ee),H&&zbe(this.relativeTarget,H)&&(this.isProjectionDirty=!1),H||(H=ii()),ca(H,this.relativeTarget)),M&&(this.animationValues=C,Ube(C,S,this.latestValues,ee,W,V)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ee},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(m){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(cu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Mi.update(()=>{ST.hasAnimatedSinceResize=!0,this.currentAnimation=Jbe(0,aW,{...m,onUpdate:v=>{this.mixTargetDelta(v),m.onUpdate&&m.onUpdate(v)},onComplete:()=>{m.onComplete&&m.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const m=this.getStack();m&&m.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(aW),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const m=this.getLead();let{targetWithTransforms:v,target:y,layout:S,latestValues:C}=m;if(!(!v||!y||!S)){if(this!==m&&this.layout&&S&&f$(this.options.animationType,this.layout.layoutBox,S.layoutBox)){y=this.target||ii();const R=xs(this.layout.layoutBox.x);y.x.min=m.target.x.min,y.x.max=y.x.min+R;const N=xs(this.layout.layoutBox.y);y.y.min=m.target.y.min,y.y.max=y.y.min+N}ca(v,y),Vf(v,C),cv(this.projectionDeltaWithTransform,this.layoutCorrected,v,C)}}registerSharedNode(m,v){this.sharedNodes.has(m)||this.sharedNodes.set(m,new Gbe),this.sharedNodes.get(m).add(v);const S=v.options.initialPromotionConfig;v.promote({transition:S?S.transition:void 0,preserveFollowOpacity:S&&S.shouldPreserveFollowOpacity?S.shouldPreserveFollowOpacity(v):void 0})}isLead(){const m=this.getStack();return m?m.lead===this:!0}getLead(){var m;const{layoutId:v}=this.options;return v?((m=this.getStack())===null||m===void 0?void 0:m.lead)||this:this}getPrevLead(){var m;const{layoutId:v}=this.options;return v?(m=this.getStack())===null||m===void 0?void 0:m.prevLead:void 0}getStack(){const{layoutId:m}=this.options;if(m)return this.root.sharedNodes.get(m)}promote({needsReset:m,transition:v,preserveFollowOpacity:y}={}){const S=this.getStack();S&&S.promote(this,y),m&&(this.projectionDelta=void 0,this.needsReset=!0),v&&this.setOptions({transition:v})}relegate(){const m=this.getStack();return m?m.relegate(this):!1}resetSkewAndRotation(){const{visualElement:m}=this.options;if(!m)return;let v=!1;const{latestValues:y}=m;if((y.z||y.rotate||y.rotateX||y.rotateY||y.rotateZ||y.skewX||y.skewY)&&(v=!0),!v)return;const S={};y.z&&jO("z",m,S,this.animationValues);for(let C=0;C<UO.length;C++)jO(`rotate${UO[C]}`,m,S,this.animationValues),jO(`skew${UO[C]}`,m,S,this.animationValues);m.render();for(const C in S)m.setStaticValue(C,S[C]),this.animationValues&&(this.animationValues[C]=S[C]);m.scheduleRender()}getProjectionStyles(m){var v,y;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Xbe;const S={visibility:""},C=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,S.opacity="",S.pointerEvents=ET(m==null?void 0:m.pointerEvents)||"",S.transform=C?C(this.latestValues,""):"none",S;const R=this.getLead();if(!this.projectionDelta||!this.layout||!R.target){const M={};return this.options.layoutId&&(M.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,M.pointerEvents=ET(m==null?void 0:m.pointerEvents)||""),this.hasProjected&&!rh(this.latestValues)&&(M.transform=C?C({},""):"none",this.hasProjected=!1),M}const N=R.animationValues||R.latestValues;this.applyTransformsToTarget(),S.transform=sW(this.projectionDeltaWithTransform,this.treeScale,N),C&&(S.transform=C(N,S.transform));const{x,y:U}=this.projectionDelta;S.transformOrigin=`${x.origin*100}% ${U.origin*100}% 0`,R.animationValues?S.opacity=R===this?(y=(v=N.opacity)!==null&&v!==void 0?v:this.latestValues.opacity)!==null&&y!==void 0?y:1:this.preserveOpacity?this.latestValues.opacity:N.opacityExit:S.opacity=R===this?N.opacity!==void 0?N.opacity:"":N.opacityExit!==void 0?N.opacityExit:0;for(const M in ub){if(N[M]===void 0)continue;const{correct:z,applyTo:V}=ub[M],W=S.transform==="none"?N[M]:z(N[M],R);if(V){const H=V.length;for(let q=0;q<H;q++)S[V[q]]=W}else S[M]=W}return this.options.layoutId&&(S.pointerEvents=R===this?ET(m==null?void 0:m.pointerEvents)||"":"none"),S}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(m=>{var v;return(v=m.currentAnimation)===null||v===void 0?void 0:v.stop()}),this.root.nodes.forEach(cW),this.root.sharedNodes.clear()}}}function Zbe(e){e.updateLayout()}function eCe(e){var i;const a=((i=e.resumeFrom)===null||i===void 0?void 0:i.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&a&&e.hasListeners("didUpdate")){const{layoutBox:l,measuredBox:u}=e.layout,{animationType:p}=e.options,m=a.source!==e.layout.source;p==="size"?da(R=>{const N=m?a.measuredBox[R]:a.layoutBox[R],x=xs(N);N.min=l[R].min,N.max=N.min+x}):f$(p,a.layoutBox,l)&&da(R=>{const N=m?a.measuredBox[R]:a.layoutBox[R],x=xs(l[R]);N.max=N.min+x,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[R].max=e.relativeTarget[R].min+x)});const v=Ff();cv(v,l,a.layoutBox);const y=Ff();m?cv(y,e.applyTransform(u,!0),a.measuredBox):cv(y,l,a.layoutBox);const S=!u$(v);let C=!1;if(!e.resumeFrom){const R=e.getClosestProjectingParent();if(R&&!R.resumeFrom){const{snapshot:N,layout:x}=R;if(N&&x){const U=ii();lv(U,a.layoutBox,N.layoutBox);const M=ii();lv(M,l,x.layoutBox),h$(U,M)||(C=!0),R.options.layoutRoot&&(e.relativeTarget=M,e.relativeTargetOrigin=U,e.relativeParent=R)}}}e.notifyListeners("didUpdate",{layout:l,snapshot:a,delta:y,layoutDelta:v,hasLayoutChanged:S,hasRelativeTargetChanged:C})}else if(e.isLead()){const{onExitComplete:l}=e.options;l&&l()}e.options.transition=void 0}function tCe(e){ih.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function nCe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function rCe(e){e.clearSnapshot()}function cW(e){e.clearMeasurements()}function iCe(e){e.isLayoutDirty=!1}function oCe(e){const{visualElement:i}=e.options;i&&i.getProps().onBeforeLayoutMeasure&&i.notify("BeforeLayoutMeasure"),e.resetTransform()}function lW(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function sCe(e){e.resolveTargetDelta()}function aCe(e){e.calcProjection()}function cCe(e){e.resetSkewAndRotation()}function lCe(e){e.removeLeadSnapshot()}function dW(e,i,a){e.translate=zr(i.translate,0,a),e.scale=zr(i.scale,1,a),e.origin=i.origin,e.originPoint=i.originPoint}function uW(e,i,a,l){e.min=zr(i.min,a.min,l),e.max=zr(i.max,a.max,l)}function dCe(e,i,a,l){uW(e.x,i.x,a.x,l),uW(e.y,i.y,a.y,l)}function uCe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const hCe={duration:.45,ease:[.4,0,.1,1]},hW=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),pW=hW("applewebkit/")&&!hW("chrome/")?Math.round:_o;function fW(e){e.min=pW(e.min),e.max=pW(e.max)}function pCe(e){fW(e.x),fW(e.y)}function f$(e,i,a){return e==="position"||e==="preserve-aspect"&&!kP(oW(i),oW(a),.2)}const fCe=p$({attachResizeListener:(e,i)=>yl(e,"resize",i),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),FO={current:void 0},m$=p$({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!FO.current){const e=new fCe({});e.mount(window),e.setOptions({layoutScroll:!0}),FO.current=e}return FO.current},resetTransform:(e,i)=>{e.style.transform=i!==void 0?i:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),mCe={pan:{Feature:Nbe},drag:{Feature:Obe,ProjectionNode:m$,MeasureLayout:c$}},MP={current:null},g$={current:!1};function gCe(){if(g$.current=!0,!!ND)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),i=()=>MP.current=e.matches;e.addListener(i),i()}else MP.current=!1}function _Ce(e,i,a){const{willChange:l}=i;for(const u in i){const p=i[u],m=a[u];if(po(p))e.addValue(u,p),gb(l)&&l.add(u);else if(po(m))e.addValue(u,Bv(p,{owner:e})),gb(l)&&l.remove(u);else if(m!==p)if(e.hasValue(u)){const v=e.getValue(u);v.liveStyle===!0?v.jump(p):v.hasAnimated||v.set(p)}else{const v=e.getStaticValue(u);e.addValue(u,Bv(v!==void 0?v:p,{owner:e}))}}for(const u in a)i[u]===void 0&&e.removeValue(u);return i}const mW=new WeakMap,vCe=[...A7,uo,lu],ECe=e=>vCe.find(I7(e)),_$=Object.keys(Fv),yCe=_$.length,gW=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],SCe=LD.length;function v$(e){if(e)return e.options.allowProjection!==!1?e.projection:v$(e.parent)}class TCe{scrapeMotionValuesFromProps(i,a,l){return{}}constructor({parent:i,props:a,presenceContext:l,reducedMotionConfig:u,blockInitialAnimation:p,visualState:m},v={}){this.resolveKeyframes=(N,x,U,M)=>new this.KeyframeResolver(N,x,U,M,this),this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KD,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Mi.render(this.render,!1,!0);const{latestValues:y,renderState:S}=m;this.latestValues=y,this.baseTarget={...y},this.initialValues=a.initial?{...y}:{},this.renderState=S,this.parent=i,this.props=a,this.presenceContext=l,this.depth=i?i.depth+1:0,this.reducedMotionConfig=u,this.options=v,this.blockInitialAnimation=!!p,this.isControllingVariants=hC(a),this.isVariantNode=r7(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(i&&i.current);const{willChange:C,...R}=this.scrapeMotionValuesFromProps(a,{},this);for(const N in R){const x=R[N];y[N]!==void 0&&po(x)&&(x.set(y[N],!1),gb(C)&&C.add(N))}}mount(i){this.current=i,mW.set(i,this),this.projection&&!this.projection.instance&&this.projection.mount(i),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,l)=>this.bindToMotionValue(l,a)),g$.current||gCe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:MP.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){var i;mW.delete(this.current),this.projection&&this.projection.unmount(),cu(this.notifyUpdate),cu(this.render),this.valueSubscriptions.forEach(a=>a()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const a in this.events)this.events[a].clear();for(const a in this.features)(i=this.features[a])===null||i===void 0||i.unmount();this.current=null}bindToMotionValue(i,a){const l=Wh.has(i),u=a.on("change",m=>{this.latestValues[i]=m,this.props.onUpdate&&Mi.preRender(this.notifyUpdate),l&&this.projection&&(this.projection.isTransformDirty=!0)}),p=a.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(i,()=>{u(),p(),a.owner&&a.stop()})}sortNodePosition(i){return!this.current||!this.sortInstanceNodePosition||this.type!==i.type?0:this.sortInstanceNodePosition(this.current,i.current)}loadFeatures({children:i,...a},l,u,p){let m,v;for(let y=0;y<yCe;y++){const S=_$[y],{isEnabled:C,Feature:R,ProjectionNode:N,MeasureLayout:x}=Fv[S];N&&(m=N),C(a)&&(!this.features[S]&&R&&(this.features[S]=new R(this)),x&&(v=x))}if((this.type==="html"||this.type==="svg")&&!this.projection&&m){this.projection=new m(this.latestValues,v$(this.parent));const{layoutId:y,layout:S,drag:C,dragConstraints:R,layoutScroll:N,layoutRoot:x}=a;this.projection.setOptions({layoutId:y,layout:S,alwaysMeasureLayout:!!C||R&&Uf(R),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof S=="string"?S:"both",initialPromotionConfig:p,layoutScroll:N,layoutRoot:x})}return v}updateFeatures(){for(const i in this.features){const a=this.features[i];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ii()}getStaticValue(i){return this.latestValues[i]}setStaticValue(i,a){this.latestValues[i]=a}update(i,a){(i.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=i,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let l=0;l<gW.length;l++){const u=gW[l];this.propEventSubscriptions[u]&&(this.propEventSubscriptions[u](),delete this.propEventSubscriptions[u]);const p="on"+u,m=i[p];m&&(this.propEventSubscriptions[u]=this.on(u,m))}this.prevMotionValues=_Ce(this,this.scrapeMotionValuesFromProps(i,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(i){return this.props.variants?this.props.variants[i]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(i=!1){if(i)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const l=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(l.initial=this.props.initial),l}const a={};for(let l=0;l<SCe;l++){const u=LD[l],p=this.props[u];(jv(p)||p===!1)&&(a[u]=p)}return a}addVariantChild(i){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(i),()=>a.variantChildren.delete(i)}addValue(i,a){const l=this.values.get(i);a!==l&&(l&&this.removeValue(i),this.bindToMotionValue(i,a),this.values.set(i,a),this.latestValues[i]=a.get())}removeValue(i){this.values.delete(i);const a=this.valueSubscriptions.get(i);a&&(a(),this.valueSubscriptions.delete(i)),delete this.latestValues[i],this.removeValueFromRenderState(i,this.renderState)}hasValue(i){return this.values.has(i)}getValue(i,a){if(this.props.values&&this.props.values[i])return this.props.values[i];let l=this.values.get(i);return l===void 0&&a!==void 0&&(l=Bv(a===null?void 0:a,{owner:this}),this.addValue(i,l)),l}readValue(i,a){var l;let u=this.latestValues[i]!==void 0||!this.current?this.latestValues[i]:(l=this.getBaseTargetFromProps(this.props,i))!==null&&l!==void 0?l:this.readValueFromInstance(this.current,i,this.options);return u!=null&&(typeof u=="string"&&(w7(u)||C7(u))?u=parseFloat(u):!ECe(u)&&lu.test(a)&&(u=M7(i,a)),this.setBaseTarget(i,po(u)?u.get():u)),po(u)?u.get():u}setBaseTarget(i,a){this.baseTarget[i]=a}getBaseTarget(i){var a;const{initial:l}=this.props;let u;if(typeof l=="string"||typeof l=="object"){const m=HD(this.props,l,(a=this.presenceContext)===null||a===void 0?void 0:a.custom);m&&(u=m[i])}if(l&&u!==void 0)return u;const p=this.getBaseTargetFromProps(this.props,i);return p!==void 0&&!po(p)?p:this.initialValues[i]!==void 0&&u===void 0?void 0:this.baseTarget[i]}on(i,a){return this.events[i]||(this.events[i]=new ix),this.events[i].add(a)}notify(i,...a){this.events[i]&&this.events[i].notify(...a)}}class E$ extends TCe{constructor(){super(...arguments),this.KeyframeResolver=U7}sortInstanceNodePosition(i,a){return i.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(i,a){return i.style?i.style[a]:void 0}removeValueFromRenderState(i,{vars:a,style:l}){delete a[i],delete l[i]}}function bCe(e){return window.getComputedStyle(e)}class CCe extends E${constructor(){super(...arguments),this.type="html"}readValueFromInstance(i,a){if(Wh.has(a)){const l=qD(a);return l&&l.default||0}else{const l=bCe(i),u=(a7(a)?l.getPropertyValue(a):l[a])||0;return typeof u=="string"?u.trim():u}}measureInstanceViewportBox(i,{transformPagePoint:a}){return o$(i,a)}build(i,a,l,u){VD(i,a,l,u.transformTemplate)}scrapeMotionValuesFromProps(i,a,l){return GD(i,a,l)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:i}=this.props;po(i)&&(this.childSubscription=i.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}renderInstance(i,a,l,u){h7(i,a,l,u)}}class wCe extends E${constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(i,a){return i[a]}readValueFromInstance(i,a){if(Wh.has(a)){const l=qD(a);return l&&l.default||0}return a=p7.has(a)?a:kD(a),i.getAttribute(a)}measureInstanceViewportBox(){return ii()}scrapeMotionValuesFromProps(i,a,l){return m7(i,a,l)}build(i,a,l,u){WD(i,a,l,this.isSVGTag,u.transformTemplate)}renderInstance(i,a,l,u){f7(i,a,l,u)}mount(i){this.isSVGTag=zD(i.tagName),super.mount(i)}}const RCe=(e,i)=>UD(e)?new wCe(i,{enableHardwareAcceleration:!1}):new CCe(i,{allowProjection:e!==F.Fragment,enableHardwareAcceleration:!0}),ICe={layout:{ProjectionNode:m$,MeasureLayout:c$}},ACe={...lbe,...ySe,...mCe,...ICe},Ml=N0e((e,i)=>aSe(e,i,ACe,RCe));function y$(){const e=F.useRef(!1);return PD(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function OCe(){const e=y$(),[i,a]=F.useState(0),l=F.useCallback(()=>{e.current&&a(i+1)},[i]);return[F.useCallback(()=>Mi.postRender(l),[l]),i]}class NCe extends F.Component{getSnapshotBeforeUpdate(i){const a=this.props.childRef.current;if(a&&i.isPresent&&!this.props.isPresent){const l=this.props.sizeRef.current;l.height=a.offsetHeight||0,l.width=a.offsetWidth||0,l.top=a.offsetTop,l.left=a.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function PCe({children:e,isPresent:i}){const a=F.useId(),l=F.useRef(null),u=F.useRef({width:0,height:0,top:0,left:0}),{nonce:p}=F.useContext(OD);return F.useInsertionEffect(()=>{const{width:m,height:v,top:y,left:S}=u.current;if(i||!l.current||!m||!v)return;l.current.dataset.motionPopId=a;const C=document.createElement("style");return p&&(C.nonce=p),document.head.appendChild(C),C.sheet&&C.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${v}px !important;
            top: ${y}px !important;
            left: ${S}px !important;
          }
        `),()=>{document.head.removeChild(C)}},[i]),b.jsx(NCe,{isPresent:i,childRef:l,sizeRef:u,children:F.cloneElement(e,{ref:l})})}const VO=({children:e,initial:i,isPresent:a,onExitComplete:l,custom:u,presenceAffectsLayout:p,mode:m})=>{const v=g7(kCe),y=F.useId(),S=F.useMemo(()=>({id:y,initial:i,isPresent:a,custom:u,onExitComplete:C=>{v.set(C,!0);for(const R of v.values())if(!R)return;l&&l()},register:C=>(v.set(C,!1),()=>v.delete(C))}),p?[Math.random()]:[a]);return F.useMemo(()=>{v.forEach((C,R)=>v.set(R,!1))},[a]),F.useEffect(()=>{!a&&!v.size&&l&&l()},[a]),m==="popLayout"&&(e=b.jsx(PCe,{isPresent:a,children:e})),b.jsx(sE.Provider,{value:S,children:e})};function kCe(){return new Map}function DCe(e){return F.useEffect(()=>()=>e(),[])}const oh=e=>e.key||"";function xCe(e,i){e.forEach(a=>{const l=oh(a);i.set(l,a)})}function LCe(e){const i=[];return F.Children.forEach(e,a=>{F.isValidElement(a)&&i.push(a)}),i}const zh=({children:e,custom:i,initial:a=!0,onExitComplete:l,exitBeforeEnter:u,presenceAffectsLayout:p=!0,mode:m="sync"})=>{const v=F.useContext(MD).forceRender||OCe()[0],y=y$(),S=LCe(e);let C=S;const R=F.useRef(new Map).current,N=F.useRef(C),x=F.useRef(new Map).current,U=F.useRef(!0);if(PD(()=>{U.current=!1,xCe(S,x),N.current=C}),DCe(()=>{U.current=!0,x.clear(),R.clear()}),U.current)return b.jsx(b.Fragment,{children:C.map(W=>b.jsx(VO,{isPresent:!0,initial:a?void 0:!1,presenceAffectsLayout:p,mode:m,children:W},oh(W)))});C=[...C];const M=N.current.map(oh),z=S.map(oh),V=M.length;for(let W=0;W<V;W++){const H=M[W];z.indexOf(H)===-1&&!R.has(H)&&R.set(H,void 0)}return m==="wait"&&R.size&&(C=[]),R.forEach((W,H)=>{if(z.indexOf(H)!==-1)return;const q=x.get(H);if(!q)return;const ee=M.indexOf(H);let oe=W;if(!oe){const se=()=>{R.delete(H);const re=Array.from(x.keys()).filter(me=>!z.includes(me));if(re.forEach(me=>x.delete(me)),N.current=S.filter(me=>{const pe=oh(me);return pe===H||re.includes(pe)}),!R.size){if(y.current===!1)return;v(),l&&l()}};oe=b.jsx(VO,{isPresent:!1,onExitComplete:se,custom:i,presenceAffectsLayout:p,mode:m,children:q},oh(q)),R.set(H,oe)}C.splice(ee,0,oe)}),C=C.map(W=>{const H=W.key;return R.has(H)?W:b.jsx(VO,{isPresent:!0,presenceAffectsLayout:p,mode:m,children:W},oh(W))}),b.jsx(b.Fragment,{children:R.size?C:C.map(W=>F.cloneElement(W))})};var MCe={initial:e=>{const{position:i}=e,a=["top","bottom"].includes(i)?"y":"x";let l=["top-right","bottom-right"].includes(i)?1:-1;return i==="bottom"&&(l=1),{opacity:0,[a]:l*24}},animate:{opacity:1,y:0,x:0,scale:1,transition:{duration:.4,ease:[.4,0,.2,1]}},exit:{opacity:0,scale:.85,transition:{duration:.2,ease:[.4,0,1,1]}}},S$=F.memo(e=>{const{id:i,message:a,onCloseComplete:l,onRequestRemove:u,requestClose:p=!1,position:m="bottom",duration:v=5e3,containerStyle:y,motionVariants:S=MCe,toastSpacing:C="0.5rem"}=e,[R,N]=F.useState(v),x=Pbe();Nh(()=>{x||l==null||l()},[x]),Nh(()=>{N(v)},[v]);const U=()=>N(null),M=()=>N(v),z=()=>{x&&u()};F.useEffect(()=>{x&&p&&u()},[x,p,u]),_0e(z,R);const V=F.useMemo(()=>({pointerEvents:"auto",maxWidth:560,minWidth:300,margin:C,...y}),[y,C]),W=F.useMemo(()=>m0e(m),[m]);return b.jsx(Ml.div,{layout:!0,className:"chakra-toast",variants:S,initial:"initial",animate:"animate",exit:"exit",onHoverStart:U,onHoverEnd:M,custom:{position:m},style:W,children:b.jsx(je.div,{role:"status","aria-atomic":"true",className:"chakra-toast__inner",__css:V,children:ts(a,{id:i,onClose:z})})})});S$.displayName="ToastComponent";function UCe(e,i){var a;const l=e??"bottom",p={"top-start":{ltr:"top-left",rtl:"top-right"},"top-end":{ltr:"top-right",rtl:"top-left"},"bottom-start":{ltr:"bottom-left",rtl:"bottom-right"},"bottom-end":{ltr:"bottom-right",rtl:"bottom-left"}}[l];return(a=p==null?void 0:p[i])!=null?a:l}var _W={path:b.jsxs("g",{stroke:"currentColor",strokeWidth:"1.5",children:[b.jsx("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),b.jsx("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),b.jsx("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})]}),viewBox:"0 0 24 24"},jr=$e((e,i)=>{const{as:a,viewBox:l,color:u="currentColor",focusable:p=!1,children:m,className:v,__css:y,...S}=e,C=ot("chakra-icon",v),R=Ka("Icon",e),N={w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:u,...y,...R},x={ref:i,focusable:p,className:C,__css:N},U=l??_W.viewBox;if(a&&typeof a!="string")return b.jsx(je.svg,{as:a,...x,...S});const M=m??_W.path;return b.jsx(je.svg,{verticalAlign:"middle",viewBox:U,...x,...S,children:M})});jr.displayName="Icon";function Gh(e){const{viewBox:i="0 0 24 24",d:a,displayName:l,defaultProps:u={}}=e,p=F.Children.toArray(e.path),m=$e((v,y)=>b.jsx(jr,{ref:y,viewBox:i,...u,...v,children:p.length?p:b.jsx("path",{fill:"currentColor",d:a})}));return m.displayName=l,m}function jCe(e){return b.jsx(jr,{viewBox:"0 0 24 24",...e,children:b.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})})}function FCe(e){return b.jsx(jr,{viewBox:"0 0 24 24",...e,children:b.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})})}function vW(e){return b.jsx(jr,{viewBox:"0 0 24 24",...e,children:b.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})}var VCe=iC({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),gC=$e((e,i)=>{const a=Ka("Spinner",e),{label:l="Loading...",thickness:u="2px",speed:p="0.45s",emptyColor:m="transparent",className:v,...y}=ar(e),S=ot("chakra-spinner",v),C={display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:u,borderBottomColor:m,borderLeftColor:m,animation:`${VCe} ${p} linear infinite`,...a};return b.jsx(je.div,{ref:i,__css:C,className:S,...y,children:l&&b.jsx(je.span,{srOnly:!0,children:l})})});gC.displayName="Spinner";var[BCe,ox]=zn({name:"AlertContext",hookName:"useAlertContext",providerName:"<Alert />"}),[WCe,sx]=zn({name:"AlertStylesContext",hookName:"useAlertStyles",providerName:"<Alert />"}),T$={info:{icon:FCe,colorScheme:"blue"},warning:{icon:vW,colorScheme:"orange"},success:{icon:jCe,colorScheme:"green"},error:{icon:vW,colorScheme:"red"},loading:{icon:gC,colorScheme:"blue"}};function zCe(e){return T$[e].colorScheme}function GCe(e){return T$[e].icon}var b$=$e(function(i,a){const l=sx(),{status:u}=ox(),p={display:"inline",...l.description};return b.jsx(je.div,{ref:a,"data-status":u,...i,className:ot("chakra-alert__desc",i.className),__css:p})});b$.displayName="AlertDescription";function ax(e){const{status:i}=ox(),a=GCe(i),l=sx(),u=i==="loading"?l.spinner:l.icon;return b.jsx(je.span,{display:"inherit","data-status":i,...e,className:ot("chakra-alert__icon",e.className),__css:u,children:e.children||b.jsx(a,{h:"100%",w:"100%"})})}ax.displayName="AlertIcon";var C$=$e(function(i,a){const l=sx(),{status:u}=ox();return b.jsx(je.div,{ref:a,"data-status":u,...i,className:ot("chakra-alert__title",i.className),__css:l.title})});C$.displayName="AlertTitle";var cx=$e(function(i,a){var l;const{status:u="info",addRole:p=!0,...m}=ar(i),v=(l=i.colorScheme)!=null?l:zCe(u),y=Ai("Alert",{...i,colorScheme:v}),S={width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",...y.container};return b.jsx(BCe,{value:{status:u},children:b.jsx(WCe,{value:y,children:b.jsx(je.div,{"data-status":u,role:p?"alert":void 0,ref:a,...m,className:ot("chakra-alert",i.className),__css:S})})})});cx.displayName="Alert";function HCe(e){return b.jsx(jr,{focusable:"false","aria-hidden":!0,...e,children:b.jsx("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})})}var _C=$e(function(i,a){const l=Ka("CloseButton",i),{children:u,isDisabled:p,__css:m,...v}=ar(i),y={outline:0,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0};return b.jsx(je.button,{type:"button","aria-label":"Close",ref:a,disabled:p,__css:{...y,...l,...m},...v,children:u||b.jsx(HCe,{width:"1em",height:"1em"})})});_C.displayName="CloseButton";var $Ce={top:[],"top-left":[],"top-right":[],"bottom-left":[],bottom:[],"bottom-right":[]},bc=KCe($Ce);function KCe(e){let i=e;const a=new Set,l=u=>{i=u(i),a.forEach(p=>p())};return{getState:()=>i,subscribe:u=>(a.add(u),()=>{l(()=>e),a.delete(u)}),removeToast:(u,p)=>{l(m=>({...m,[p]:m[p].filter(v=>v.id!=u)}))},notify:(u,p)=>{const m=YCe(u,p),{position:v,id:y}=m;return l(S=>{var C,R;const x=v.includes("top")?[m,...(C=S[v])!=null?C:[]]:[...(R=S[v])!=null?R:[],m];return{...S,[v]:x}}),y},update:(u,p)=>{u&&l(m=>{const v={...m},{position:y,index:S}=l8(v,u);return y&&S!==-1&&(v[y][S]={...v[y][S],...p,message:w$(p)}),v})},closeAll:({positions:u}={})=>{l(p=>(u??["bottom","bottom-right","bottom-left","top","top-left","top-right"]).reduce((y,S)=>(y[S]=p[S].map(C=>({...C,requestClose:!0})),y),{...p}))},close:u=>{l(p=>{const m=Z9(p,u);return m?{...p,[m]:p[m].map(v=>v.id==u?{...v,requestClose:!0}:v)}:p})},isActive:u=>!!l8(bc.getState(),u).position}}var EW=0;function YCe(e,i={}){var a,l;EW+=1;const u=(a=i.id)!=null?a:EW,p=(l=i.position)!=null?l:"bottom";return{id:u,message:e,position:p,duration:i.duration,onCloseComplete:i.onCloseComplete,onRequestRemove:()=>bc.removeToast(String(u),p),status:i.status,requestClose:!1,containerStyle:i.containerStyle}}var qCe=e=>{const{status:i,variant:a="solid",id:l,title:u,isClosable:p,onClose:m,description:v,colorScheme:y,icon:S}=e,C=l?{root:`toast-${l}`,title:`toast-${l}-title`,description:`toast-${l}-description`}:void 0;return b.jsxs(cx,{addRole:!1,status:i,variant:a,id:C==null?void 0:C.root,alignItems:"start",borderRadius:"md",boxShadow:"lg",paddingEnd:8,textAlign:"start",width:"auto",colorScheme:y,children:[b.jsx(ax,{children:S}),b.jsxs(je.div,{flex:"1",maxWidth:"100%",children:[u&&b.jsx(C$,{id:C==null?void 0:C.title,children:u}),v&&b.jsx(b$,{id:C==null?void 0:C.description,display:"block",children:v})]}),p&&b.jsx(_C,{size:"sm",onClick:m,position:"absolute",insetEnd:1,top:1})]})};function w$(e={}){const{render:i,toastComponent:a=qCe}=e;return u=>typeof i=="function"?i({...u,...e}):b.jsx(a,{...u,...e})}function JCe(e,i){const a=u=>{var p;return{...i,...u,position:UCe((p=u==null?void 0:u.position)!=null?p:i==null?void 0:i.position,e)}},l=u=>{const p=a(u),m=w$(p);return bc.notify(m,p)};return l.update=(u,p)=>{bc.update(u,a(p))},l.promise=(u,p)=>{const m=l({...p.loading,status:"loading",duration:null});u.then(v=>l.update(m,{status:"success",duration:5e3,...ts(p.success,v)})).catch(v=>l.update(m,{status:"error",duration:5e3,...ts(p.error,v)}))},l.closeAll=bc.closeAll,l.close=bc.close,l.isActive=bc.isActive,l}var[XCe,QCe]=zn({name:"ToastOptionsContext",strict:!1}),ZCe=e=>{const i=F.useSyncExternalStore(bc.subscribe,bc.getState,bc.getState),{motionVariants:a,component:l=S$,portalProps:u}=e,m=Object.keys(i).map(v=>{const y=i[v];return b.jsx("div",{role:"region","aria-live":"polite","aria-label":`Notifications-${v}`,id:`chakra-toast-manager-${v}`,style:g0e(v),children:b.jsx(zh,{initial:!1,children:y.map(S=>b.jsx(l,{motionVariants:a,...S},S.id))})},v)});return b.jsx(Vh,{...u,children:m})};function vC(e){const{theme:i}=v9(),a=QCe();return F.useMemo(()=>JCe(i.direction,{...a,...e}),[e,i.direction,a])}var ewe=e=>function({children:a,theme:l=e,toastOptions:u,...p}){return b.jsxs(p0e,{theme:l,...p,children:[b.jsx(XCe,{value:u==null?void 0:u.defaultOptions,children:a}),b.jsx(ZCe,{...u})]})},twe=ewe(V9),nwe=Object.defineProperty,rwe=(e,i,a)=>i in e?nwe(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,Yr=(e,i,a)=>(rwe(e,typeof i!="symbol"?i+"":i,a),a);function yW(e){return e.sort((i,a)=>{const l=i.compareDocumentPosition(a);if(l&Node.DOCUMENT_POSITION_FOLLOWING||l&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(l&Node.DOCUMENT_POSITION_PRECEDING||l&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(l&Node.DOCUMENT_POSITION_DISCONNECTED||l&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var iwe=e=>typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE;function SW(e,i,a){let l=e+1;return a&&l>=i&&(l=0),l}function TW(e,i,a){let l=e-1;return a&&l<0&&(l=i),l}var UP=typeof window<"u"?F.useLayoutEffect:F.useEffect,vb=e=>e,owe=class{constructor(){Yr(this,"descendants",new Map),Yr(this,"register",e=>{if(e!=null)return iwe(e)?this.registerNode(e):i=>{this.registerNode(i,e)}}),Yr(this,"unregister",e=>{this.descendants.delete(e);const i=yW(Array.from(this.descendants.keys()));this.assignIndex(i)}),Yr(this,"destroy",()=>{this.descendants.clear()}),Yr(this,"assignIndex",e=>{this.descendants.forEach(i=>{const a=e.indexOf(i.node);i.index=a,i.node.dataset.index=i.index.toString()})}),Yr(this,"count",()=>this.descendants.size),Yr(this,"enabledCount",()=>this.enabledValues().length),Yr(this,"values",()=>Array.from(this.descendants.values()).sort((i,a)=>i.index-a.index)),Yr(this,"enabledValues",()=>this.values().filter(e=>!e.disabled)),Yr(this,"item",e=>{if(this.count()!==0)return this.values()[e]}),Yr(this,"enabledItem",e=>{if(this.enabledCount()!==0)return this.enabledValues()[e]}),Yr(this,"first",()=>this.item(0)),Yr(this,"firstEnabled",()=>this.enabledItem(0)),Yr(this,"last",()=>this.item(this.descendants.size-1)),Yr(this,"lastEnabled",()=>{const e=this.enabledValues().length-1;return this.enabledItem(e)}),Yr(this,"indexOf",e=>{var i,a;return e&&(a=(i=this.descendants.get(e))==null?void 0:i.index)!=null?a:-1}),Yr(this,"enabledIndexOf",e=>e==null?-1:this.enabledValues().findIndex(i=>i.node.isSameNode(e))),Yr(this,"next",(e,i=!0)=>{const a=SW(e,this.count(),i);return this.item(a)}),Yr(this,"nextEnabled",(e,i=!0)=>{const a=this.item(e);if(!a)return;const l=this.enabledIndexOf(a.node),u=SW(l,this.enabledCount(),i);return this.enabledItem(u)}),Yr(this,"prev",(e,i=!0)=>{const a=TW(e,this.count()-1,i);return this.item(a)}),Yr(this,"prevEnabled",(e,i=!0)=>{const a=this.item(e);if(!a)return;const l=this.enabledIndexOf(a.node),u=TW(l,this.enabledCount()-1,i);return this.enabledItem(u)}),Yr(this,"registerNode",(e,i)=>{if(!e||this.descendants.has(e))return;const a=Array.from(this.descendants.keys()).concat(e),l=yW(a);i!=null&&i.disabled&&(i.disabled=!!i.disabled);const u={node:e,index:-1,...i};this.descendants.set(e,u),this.assignIndex(l)})}};function swe(e,i){if(e!=null){if(typeof e=="function"){e(i);return}try{e.current=i}catch{throw new Error(`Cannot assign value '${i}' to ref '${e}'`)}}}function yi(...e){return i=>{e.forEach(a=>{swe(a,i)})}}function awe(...e){return F.useMemo(()=>yi(...e),e)}function cwe(){const e=F.useRef(new owe);return UP(()=>()=>e.current.destroy()),e.current}var[lwe,R$]=zn({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function dwe(e){const i=R$(),[a,l]=F.useState(-1),u=F.useRef(null);UP(()=>()=>{u.current&&i.unregister(u.current)},[]),UP(()=>{if(!u.current)return;const m=Number(u.current.dataset.index);a!=m&&!Number.isNaN(m)&&l(m)});const p=vb(e?i.register(e):i.register);return{descendants:i,index:a,enabledIndex:i.enabledIndexOf(u.current),register:yi(p,u)}}function lx(){return[vb(lwe),()=>vb(R$()),()=>cwe(),u=>dwe(u)]}var[uwe,EC]=zn({name:"AccordionStylesContext",hookName:"useAccordionStyles",providerName:"<Accordion />"}),[hwe,dx]=zn({name:"AccordionItemContext",hookName:"useAccordionItemContext",providerName:"<AccordionItem />"}),[pwe,FLe,fwe,mwe]=lx(),I$=$e(function(i,a){const{getButtonProps:l}=dx(),u=l(i,a),m={display:"flex",alignItems:"center",width:"100%",outline:0,...EC().button};return b.jsx(je.button,{...u,className:ot("chakra-accordion__button",i.className),__css:m})});I$.displayName="AccordionButton";function ux(e){const{value:i,defaultValue:a,onChange:l,shouldUpdate:u=(N,x)=>N!==x}=e,p=ss(l),m=ss(u),[v,y]=F.useState(a),S=i!==void 0,C=S?i:v,R=ss(N=>{const U=typeof N=="function"?N(C):N;m(C,U)&&(S||y(U),p(U))},[S,p,C,m]);return[C,R]}function gwe(e){const{onChange:i,defaultIndex:a,index:l,allowMultiple:u,allowToggle:p,...m}=e;Ewe(e),ywe(e);const v=fwe(),[y,S]=F.useState(-1);F.useEffect(()=>()=>{S(-1)},[]);const[C,R]=ux({value:l,defaultValue(){return u?a??[]:a??-1},onChange:i});return{index:C,setIndex:R,htmlProps:m,getAccordionItemProps:x=>{let U=!1;return x!==null&&(U=Array.isArray(C)?C.includes(x):C===x),{isOpen:U,onChange:z=>{if(x!==null)if(u&&Array.isArray(C)){const V=z?C.concat(x):C.filter(W=>W!==x);R(V)}else z?R(x):p&&R(-1)}}},focusedIndex:y,setFocusedIndex:S,descendants:v}}var[_we,hx]=zn({name:"AccordionContext",hookName:"useAccordionContext",providerName:"Accordion"});function vwe(e){const{isDisabled:i,isFocusable:a,id:l,...u}=e,{getAccordionItemProps:p,setFocusedIndex:m}=hx(),v=F.useRef(null),y=F.useId(),S=l??y,C=`accordion-button-${S}`,R=`accordion-panel-${S}`;Swe(e);const{register:N,index:x,descendants:U}=mwe({disabled:i&&!a}),{isOpen:M,onChange:z}=p(x===-1?null:x);Twe({isOpen:M,isDisabled:i});const V=()=>{z==null||z(!0)},W=()=>{z==null||z(!1)},H=F.useCallback(()=>{z==null||z(!M),m(x)},[x,m,M,z]),q=F.useCallback(re=>{const pe={ArrowDown:()=>{const Re=U.nextEnabled(x);Re==null||Re.node.focus()},ArrowUp:()=>{const Re=U.prevEnabled(x);Re==null||Re.node.focus()},Home:()=>{const Re=U.firstEnabled();Re==null||Re.node.focus()},End:()=>{const Re=U.lastEnabled();Re==null||Re.node.focus()}}[re.key];pe&&(re.preventDefault(),pe(re))},[U,x]),ee=F.useCallback(()=>{m(x)},[m,x]),oe=F.useCallback(function(me={},pe=null){return{...me,type:"button",ref:yi(N,v,pe),id:C,disabled:!!i,"aria-expanded":!!M,"aria-controls":R,onClick:$t(me.onClick,H),onFocus:$t(me.onFocus,ee),onKeyDown:$t(me.onKeyDown,q)}},[C,i,M,H,ee,q,R,N]),se=F.useCallback(function(me={},pe=null){return{...me,ref:pe,role:"region",id:R,"aria-labelledby":C,hidden:!M}},[C,M,R]);return{isOpen:M,isDisabled:i,isFocusable:a,onOpen:V,onClose:W,getButtonProps:oe,getPanelProps:se,htmlProps:u}}function Ewe(e){const i=e.index||e.defaultIndex,a=i!=null&&!Array.isArray(i)&&e.allowMultiple;rE({condition:!!a,message:`If 'allowMultiple' is passed, then 'index' or 'defaultIndex' must be an array. You passed: ${typeof i},`})}function ywe(e){rE({condition:!!(e.allowMultiple&&e.allowToggle),message:"If 'allowMultiple' is passed, 'allowToggle' will be ignored. Either remove 'allowToggle' or 'allowMultiple' depending on whether you want multiple accordions visible or not"})}function Swe(e){rE({condition:!!(e.isFocusable&&!e.isDisabled),message:`Using only 'isFocusable', this prop is reserved for situations where you pass 'isDisabled' but you still want the element to receive focus (A11y). Either remove it or pass 'isDisabled' as well.
    `})}function Twe(e){rE({condition:e.isOpen&&!!e.isDisabled,message:"Cannot open a disabled accordion item"})}function A$(e){const{isOpen:i,isDisabled:a}=dx(),{reduceMotion:l}=hx(),u=ot("chakra-accordion__icon",e.className),p=EC(),m={opacity:a?.4:1,transform:i?"rotate(-180deg)":void 0,transition:l?void 0:"transform 0.2s",transformOrigin:"center",...p.icon};return b.jsx(jr,{viewBox:"0 0 24 24","aria-hidden":!0,className:u,__css:m,...e,children:b.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})})}A$.displayName="AccordionIcon";var O$=$e(function(i,a){const{children:l,className:u}=i,{htmlProps:p,...m}=vwe(i),y={...EC().container,overflowAnchor:"none"},S=F.useMemo(()=>m,[m]);return b.jsx(hwe,{value:S,children:b.jsx(je.div,{ref:a,...p,className:ot("chakra-accordion__item",u),__css:y,children:typeof l=="function"?l({isExpanded:!!m.isOpen,isDisabled:!!m.isDisabled}):l})})});O$.displayName="AccordionItem";var Bf={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},Eh={enter:{duration:.2,ease:Bf.easeOut},exit:{duration:.1,ease:Bf.easeIn}},Al={enter:(e,i)=>({...e,delay:typeof i=="number"?i:i==null?void 0:i.enter}),exit:(e,i)=>({...e,delay:typeof i=="number"?i:i==null?void 0:i.exit})},bwe=e=>e!=null&&parseInt(e.toString(),10)>0,bW={exit:{height:{duration:.2,ease:Bf.ease},opacity:{duration:.3,ease:Bf.ease}},enter:{height:{duration:.3,ease:Bf.ease},opacity:{duration:.4,ease:Bf.ease}}},Cwe={exit:({animateOpacity:e,startingHeight:i,transition:a,transitionEnd:l,delay:u})=>{var p;return{...e&&{opacity:bwe(i)?1:0},height:i,transitionEnd:l==null?void 0:l.exit,transition:(p=a==null?void 0:a.exit)!=null?p:Al.exit(bW.exit,u)}},enter:({animateOpacity:e,endingHeight:i,transition:a,transitionEnd:l,delay:u})=>{var p;return{...e&&{opacity:1},height:i,transitionEnd:l==null?void 0:l.enter,transition:(p=a==null?void 0:a.enter)!=null?p:Al.enter(bW.enter,u)}}},px=F.forwardRef((e,i)=>{const{in:a,unmountOnExit:l,animateOpacity:u=!0,startingHeight:p=0,endingHeight:m="auto",style:v,className:y,transition:S,transitionEnd:C,...R}=e,[N,x]=F.useState(!1);F.useEffect(()=>{const W=setTimeout(()=>{x(!0)});return()=>clearTimeout(W)},[]),rE({condition:Number(p)>0&&!!l,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const U=parseFloat(p.toString())>0,M={startingHeight:p,endingHeight:m,animateOpacity:u,transition:N?S:{enter:{duration:0}},transitionEnd:{enter:C==null?void 0:C.enter,exit:l?C==null?void 0:C.exit:{...C==null?void 0:C.exit,display:U?"block":"none"}}},z=l?a:!0,V=a||l?"enter":"exit";return b.jsx(zh,{initial:!1,custom:M,children:z&&b.jsx(Ml.div,{ref:i,...R,className:ot("chakra-collapse",y),style:{overflow:"hidden",display:"block",...v},custom:M,variants:Cwe,initial:l?"exit":!1,animate:V,exit:"exit"})})});px.displayName="Collapse";var wwe={enter:({transition:e,transitionEnd:i,delay:a}={})=>{var l;return{opacity:1,transition:(l=e==null?void 0:e.enter)!=null?l:Al.enter(Eh.enter,a),transitionEnd:i==null?void 0:i.enter}},exit:({transition:e,transitionEnd:i,delay:a}={})=>{var l;return{opacity:0,transition:(l=e==null?void 0:e.exit)!=null?l:Al.exit(Eh.exit,a),transitionEnd:i==null?void 0:i.exit}}},N$={initial:"exit",animate:"enter",exit:"exit",variants:wwe},Rwe=F.forwardRef(function(i,a){const{unmountOnExit:l,in:u,className:p,transition:m,transitionEnd:v,delay:y,...S}=i,C=u||l?"enter":"exit",R=l?u&&l:!0,N={transition:m,transitionEnd:v,delay:y};return b.jsx(zh,{custom:N,children:R&&b.jsx(Ml.div,{ref:a,className:ot("chakra-fade",p),custom:N,...N$,animate:C,...S})})});Rwe.displayName="Fade";var Iwe={exit:({reverse:e,initialScale:i,transition:a,transitionEnd:l,delay:u})=>{var p;return{opacity:0,...e?{scale:i,transitionEnd:l==null?void 0:l.exit}:{transitionEnd:{scale:i,...l==null?void 0:l.exit}},transition:(p=a==null?void 0:a.exit)!=null?p:Al.exit(Eh.exit,u)}},enter:({transitionEnd:e,transition:i,delay:a})=>{var l;return{opacity:1,scale:1,transition:(l=i==null?void 0:i.enter)!=null?l:Al.enter(Eh.enter,a),transitionEnd:e==null?void 0:e.enter}}},P$={initial:"exit",animate:"enter",exit:"exit",variants:Iwe},Awe=F.forwardRef(function(i,a){const{unmountOnExit:l,in:u,reverse:p=!0,initialScale:m=.95,className:v,transition:y,transitionEnd:S,delay:C,...R}=i,N=l?u&&l:!0,x=u||l?"enter":"exit",U={initialScale:m,reverse:p,transition:y,transitionEnd:S,delay:C};return b.jsx(zh,{custom:U,children:N&&b.jsx(Ml.div,{ref:a,className:ot("chakra-offset-slide",v),...P$,animate:x,custom:U,...R})})});Awe.displayName="ScaleFade";var Owe={initial:({offsetX:e,offsetY:i,transition:a,transitionEnd:l,delay:u})=>{var p;return{opacity:0,x:e,y:i,transition:(p=a==null?void 0:a.exit)!=null?p:Al.exit(Eh.exit,u),transitionEnd:l==null?void 0:l.exit}},enter:({transition:e,transitionEnd:i,delay:a})=>{var l;return{opacity:1,x:0,y:0,transition:(l=e==null?void 0:e.enter)!=null?l:Al.enter(Eh.enter,a),transitionEnd:i==null?void 0:i.enter}},exit:({offsetY:e,offsetX:i,transition:a,transitionEnd:l,reverse:u,delay:p})=>{var m;const v={x:i,y:e};return{opacity:0,transition:(m=a==null?void 0:a.exit)!=null?m:Al.exit(Eh.exit,p),...u?{...v,transitionEnd:l==null?void 0:l.exit}:{transitionEnd:{...v,...l==null?void 0:l.exit}}}}},z_={initial:"initial",animate:"enter",exit:"exit",variants:Owe},Nwe=F.forwardRef(function(i,a){const{unmountOnExit:l,in:u,reverse:p=!0,className:m,offsetX:v=0,offsetY:y=8,transition:S,transitionEnd:C,delay:R,...N}=i,x=l?u&&l:!0,U=u||l?"enter":"exit",M={offsetX:v,offsetY:y,reverse:p,transition:S,transitionEnd:C,delay:R};return b.jsx(zh,{custom:M,children:x&&b.jsx(Ml.div,{ref:a,className:ot("chakra-offset-slide",m),custom:M,...z_,animate:U,...N})})});Nwe.displayName="SlideFade";var k$=$e(function(i,a){const{className:l,motionProps:u,...p}=i,{reduceMotion:m}=hx(),{getPanelProps:v,isOpen:y}=dx(),S=v(p,a),C=ot("chakra-accordion__panel",l),R=EC();m||delete S.hidden;const N=b.jsx(je.div,{...S,__css:R.panel,className:C});return m?N:b.jsx(px,{in:y,...u,children:N})});k$.displayName="AccordionPanel";var D$=$e(function({children:i,reduceMotion:a,...l},u){const p=Ai("Accordion",l),m=ar(l),{htmlProps:v,descendants:y,...S}=gwe(m),C=F.useMemo(()=>({...S,reduceMotion:!!a}),[S,a]);return b.jsx(pwe,{value:y,children:b.jsx(_we,{value:C,children:b.jsx(uwe,{value:p,children:b.jsx(je.div,{ref:u,...v,className:ot("chakra-accordion",l.className),__css:p.root,children:i})})})})});D$.displayName="Accordion";var[Pwe,kwe]=zn({name:"AvatarStylesContext",hookName:"useAvatarStyles",providerName:"<Avatar/>"});function Dwe(e){var i;const a=e.split(" "),l=(i=a[0])!=null?i:"",u=a.length>1?a[a.length-1]:"";return l&&u?`${l.charAt(0)}${u.charAt(0)}`:l.charAt(0)}function x$(e){const{name:i,getInitials:a,...l}=e,u=kwe();return b.jsx(je.div,{role:"img","aria-label":i,...l,__css:u.label,children:i?a==null?void 0:a(i):null})}x$.displayName="AvatarName";var L$=e=>b.jsxs(je.svg,{viewBox:"0 0 128 128",color:"#fff",width:"100%",height:"100%",className:"chakra-avatar__svg",...e,children:[b.jsx("path",{fill:"currentColor",d:"M103,102.1388 C93.094,111.92 79.3504,118 64.1638,118 C48.8056,118 34.9294,111.768 25,101.7892 L25,95.2 C25,86.8096 31.981,80 40.6,80 L87.4,80 C96.019,80 103,86.8096 103,95.2 L103,102.1388 Z"}),b.jsx("path",{fill:"currentColor",d:"M63.9961647,24 C51.2938136,24 41,34.2938136 41,46.9961647 C41,59.7061864 51.2938136,70 63.9961647,70 C76.6985159,70 87,59.7061864 87,46.9961647 C87,34.2938136 76.6985159,24 63.9961647,24"})]}),jP=$e(function(i,a){const{htmlWidth:l,htmlHeight:u,alt:p,...m}=i;return b.jsx("img",{width:l,height:u,ref:a,alt:p,...m})});jP.displayName="NativeImage";function M$(e){const{loading:i,src:a,srcSet:l,onLoad:u,onError:p,crossOrigin:m,sizes:v,ignoreFallback:y}=e,[S,C]=F.useState("pending");F.useEffect(()=>{C(a?"loading":"pending")},[a]);const R=F.useRef(),N=F.useCallback(()=>{if(!a)return;x();const U=new Image;U.src=a,m&&(U.crossOrigin=m),l&&(U.srcset=l),v&&(U.sizes=v),i&&(U.loading=i),U.onload=M=>{x(),C("loaded"),u==null||u(M)},U.onerror=M=>{x(),C("failed"),p==null||p(M)},R.current=U},[a,m,l,v,u,p,i]),x=()=>{R.current&&(R.current.onload=null,R.current.onerror=null,R.current=null)};return bl(()=>{if(!y)return S==="loading"&&N(),()=>{x()}},[S,N,y]),y?"loaded":S}var xwe=(e,i)=>e!=="loaded"&&i==="beforeLoadOrError"||e==="failed"&&i==="onError";function Lwe(e,i=[]){const a=Object.assign({},e);for(const l of i)l in a&&delete a[l];return a}var Nn=$e(function(i,a){const{fallbackSrc:l,fallback:u,src:p,srcSet:m,align:v,fit:y,loading:S,ignoreFallback:C,crossOrigin:R,fallbackStrategy:N="beforeLoadOrError",referrerPolicy:x,...U}=i,M=l!==void 0||u!==void 0,z=S!=null||C||!M,V=M$({...i,crossOrigin:R,ignoreFallback:z}),W=xwe(V,N),H={ref:a,objectFit:y,objectPosition:v,...z?U:Lwe(U,["onError","onLoad"])};return W?u||b.jsx(je.img,{as:jP,className:"chakra-image__placeholder",src:l,...H}):b.jsx(je.img,{as:jP,src:p,srcSet:m,crossOrigin:R,loading:S,referrerPolicy:x,className:"chakra-image",...H})});Nn.displayName="Image";function U$(e){const{src:i,srcSet:a,onError:l,onLoad:u,getInitials:p,name:m,borderRadius:v,loading:y,iconLabel:S,icon:C=b.jsx(L$,{}),ignoreFallback:R,referrerPolicy:N,crossOrigin:x}=e,M=M$({src:i,onError:l,crossOrigin:x,ignoreFallback:R})==="loaded";return!i||!M?m?b.jsx(x$,{className:"chakra-avatar__initials",getInitials:p,name:m}):F.cloneElement(C,{role:"img","aria-label":S}):b.jsx(je.img,{src:i,srcSet:a,alt:m,onLoad:u,referrerPolicy:N,crossOrigin:x??void 0,className:"chakra-avatar__img",loading:y,__css:{width:"100%",height:"100%",objectFit:"cover",borderRadius:v}})}U$.displayName="AvatarImage";var Mwe={display:"inline-flex",alignItems:"center",justifyContent:"center",textAlign:"center",textTransform:"uppercase",fontWeight:"medium",position:"relative",flexShrink:0},Dc=$e((e,i)=>{const a=Ai("Avatar",e),[l,u]=F.useState(!1),{src:p,srcSet:m,name:v,showBorder:y,borderRadius:S="full",onError:C,onLoad:R,getInitials:N=Dwe,icon:x=b.jsx(L$,{}),iconLabel:U=" avatar",loading:M,children:z,borderColor:V,ignoreFallback:W,crossOrigin:H,referrerPolicy:q,...ee}=ar(e),oe={borderRadius:S,borderWidth:y?"2px":void 0,...Mwe,...a.container};return V&&(oe.borderColor=V),b.jsx(je.span,{ref:i,...ee,className:ot("chakra-avatar",e.className),"data-loaded":Tt(l),__css:oe,children:b.jsxs(Pwe,{value:a,children:[b.jsx(U$,{src:p,srcSet:m,loading:M,onLoad:$t(R,()=>{u(!0)}),onError:C,getInitials:N,name:v,borderRadius:S,icon:x,iconLabel:U,ignoreFallback:W,crossOrigin:H,referrerPolicy:q}),z]})})});Dc.displayName="Avatar";function fx(e){return F.Children.toArray(e).filter(i=>F.isValidElement(i))}var[VLe,Uwe]=zn({strict:!1,name:"ButtonGroupContext"});function jwe(e){const[i,a]=F.useState(!e);return{ref:F.useCallback(p=>{p&&a(p.tagName==="BUTTON")},[]),type:i?"button":void 0}}function FP(e){const{children:i,className:a,...l}=e,u=F.isValidElement(i)?F.cloneElement(i,{"aria-hidden":!0,focusable:!1}):i,p=ot("chakra-button__icon",a);return b.jsx(je.span,{display:"inline-flex",alignSelf:"center",flexShrink:0,...l,className:p,children:u})}FP.displayName="ButtonIcon";function VP(e){const{label:i,placement:a,spacing:l="0.5rem",children:u=b.jsx(gC,{color:"currentColor",width:"1em",height:"1em"}),className:p,__css:m,...v}=e,y=ot("chakra-button__spinner",p),S=a==="start"?"marginEnd":"marginStart",C=F.useMemo(()=>({display:"flex",alignItems:"center",position:i?"relative":"absolute",[S]:i?l:0,fontSize:"1em",lineHeight:"normal",...m}),[m,i,S,l]);return b.jsx(je.div,{className:y,...v,__css:C,children:u})}VP.displayName="ButtonSpinner";var pn=$e((e,i)=>{const a=Uwe(),l=Ka("Button",{...a,...e}),{isDisabled:u=a==null?void 0:a.isDisabled,isLoading:p,isActive:m,children:v,leftIcon:y,rightIcon:S,loadingText:C,iconSpacing:R="0.5rem",type:N,spinner:x,spinnerPlacement:U="start",className:M,as:z,...V}=ar(e),W=F.useMemo(()=>{const oe={...l==null?void 0:l._focus,zIndex:1};return{display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",...l,...!!a&&{_focus:oe}}},[l,a]),{ref:H,type:q}=jwe(z),ee={rightIcon:S,leftIcon:y,iconSpacing:R,children:v};return b.jsxs(je.button,{ref:awe(i,H),as:z,type:N??q,"data-active":Tt(m),"data-loading":Tt(p),__css:W,className:ot("chakra-button",M),...V,disabled:u||p,children:[p&&U==="start"&&b.jsx(VP,{className:"chakra-button__spinner--start",label:C,placement:"start",spacing:R,children:x}),p?C||b.jsx(je.span,{opacity:0,children:b.jsx(CW,{...ee})}):b.jsx(CW,{...ee}),p&&U==="end"&&b.jsx(VP,{className:"chakra-button__spinner--end",label:C,placement:"end",spacing:R,children:x})]})});pn.displayName="Button";function CW(e){const{leftIcon:i,rightIcon:a,children:l,iconSpacing:u}=e;return b.jsxs(b.Fragment,{children:[i&&b.jsx(FP,{marginEnd:u,children:i}),l,a&&b.jsx(FP,{marginStart:u,children:a})]})}var j$=$e((e,i)=>{const{icon:a,children:l,isRound:u,"aria-label":p,...m}=e,v=a||l,y=F.isValidElement(v)?F.cloneElement(v,{"aria-hidden":!0,focusable:!1}):null;return b.jsx(pn,{padding:"0",borderRadius:u?"full":void 0,ref:i,"aria-label":p,...m,children:y})});j$.displayName="IconButton";var[Fwe,F$]=X9("Card"),Sl=$e(function(i,a){const{className:l,...u}=i,p=F$();return b.jsx(je.div,{ref:a,className:ot("chakra-card__body",l),__css:p.body,...u})}),FS=$e(function(i,a){const{className:l,...u}=i,p=F$();return b.jsx(je.div,{ref:a,className:ot("chakra-card__header",l),__css:p.header,...u})}),wc=$e(function(i,a){const{className:l,children:u,direction:p="column",justify:m,align:v,...y}=ar(i),S=Ai("Card",i);return b.jsx(je.div,{ref:a,className:ot("chakra-card",l),__css:{display:"flex",flexDirection:p,justifyContent:m,alignItems:v,position:"relative",minWidth:0,wordWrap:"break-word",...S.container},...y,children:b.jsx(Fwe,{value:S,children:u})})}),[BLe,Vwe]=zn({name:"CheckboxGroupContext",strict:!1});function Bwe(e){const[i,a]=F.useState(e),[l,u]=F.useState(!1);return e!==i&&(u(!0),a(e)),l}function Wwe(e){return b.jsx(je.svg,{width:"1.2em",viewBox:"0 0 12 10",style:{fill:"none",strokeWidth:2,stroke:"currentColor",strokeDasharray:16},...e,children:b.jsx("polyline",{points:"1.5 6 4.5 9 10.5 1"})})}function zwe(e){return b.jsx(je.svg,{width:"1.2em",viewBox:"0 0 24 24",style:{stroke:"currentColor",strokeWidth:4},...e,children:b.jsx("line",{x1:"21",x2:"3",y1:"12",y2:"12"})})}function Gwe(e){const{isIndeterminate:i,isChecked:a,...l}=e,u=i?zwe:Wwe;return a||i?b.jsx(je.div,{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:b.jsx(u,{...l})}):null}var[Hwe,V$]=zn({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[$we,Hh]=zn({strict:!1,name:"FormControlContext"});function Kwe(e){const{id:i,isRequired:a,isInvalid:l,isDisabled:u,isReadOnly:p,...m}=e,v=F.useId(),y=i||`field-${v}`,S=`${y}-label`,C=`${y}-feedback`,R=`${y}-helptext`,[N,x]=F.useState(!1),[U,M]=F.useState(!1),[z,V]=F.useState(!1),W=F.useCallback((se={},re=null)=>({id:R,...se,ref:yi(re,me=>{me&&M(!0)})}),[R]),H=F.useCallback((se={},re=null)=>({...se,ref:re,"data-focus":Tt(z),"data-disabled":Tt(u),"data-invalid":Tt(l),"data-readonly":Tt(p),id:se.id!==void 0?se.id:S,htmlFor:se.htmlFor!==void 0?se.htmlFor:y}),[y,u,z,l,p,S]),q=F.useCallback((se={},re=null)=>({id:C,...se,ref:yi(re,me=>{me&&x(!0)}),"aria-live":"polite"}),[C]),ee=F.useCallback((se={},re=null)=>({...se,...m,ref:re,role:"group","data-focus":Tt(z),"data-disabled":Tt(u),"data-invalid":Tt(l),"data-readonly":Tt(p)}),[m,u,z,l,p]),oe=F.useCallback((se={},re=null)=>({...se,ref:re,role:"presentation","aria-hidden":!0,children:se.children||"*"}),[]);return{isRequired:!!a,isInvalid:!!l,isReadOnly:!!p,isDisabled:!!u,isFocused:!!z,onFocus:()=>V(!0),onBlur:()=>V(!1),hasFeedbackText:N,setHasFeedbackText:x,hasHelpText:U,setHasHelpText:M,id:y,labelId:S,feedbackId:C,helpTextId:R,htmlProps:m,getHelpTextProps:W,getErrorMessageProps:q,getRootProps:ee,getLabelProps:H,getRequiredIndicatorProps:oe}}var fo=$e(function(i,a){const l=Ai("Form",i),u=ar(i),{getRootProps:p,htmlProps:m,...v}=Kwe(u),y=ot("chakra-form-control",i.className);return b.jsx($we,{value:v,children:b.jsx(Hwe,{value:l,children:b.jsx(je.div,{...p({},a),className:y,__css:l.container})})})});fo.displayName="FormControl";var Ywe=$e(function(i,a){const l=Hh(),u=V$(),p=ot("chakra-form__helper-text",i.className);return b.jsx(je.div,{...l==null?void 0:l.getHelpTextProps(i,a),__css:u.helperText,className:p})});Ywe.displayName="FormHelperText";var[qwe,Jwe]=zn({name:"FormErrorStylesContext",errorMessage:`useFormErrorStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormError />" `}),du=$e((e,i)=>{const a=Ai("FormError",e),l=ar(e),u=Hh();return u!=null&&u.isInvalid?b.jsx(qwe,{value:a,children:b.jsx(je.div,{...u==null?void 0:u.getErrorMessageProps(l,i),className:ot("chakra-form__error-message",e.className),__css:{display:"flex",alignItems:"center",...a.text}})}):null});du.displayName="FormErrorMessage";var Xwe=$e((e,i)=>{const a=Jwe(),l=Hh();if(!(l!=null&&l.isInvalid))return null;const u=ot("chakra-form__error-icon",e.className);return b.jsx(jr,{ref:i,"aria-hidden":!0,...e,__css:a.icon,className:u,children:b.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})});Xwe.displayName="FormErrorIcon";var On=$e(function(i,a){var l;const u=Ka("FormLabel",i),p=ar(i),{className:m,children:v,requiredIndicator:y=b.jsx(B$,{}),optionalIndicator:S=null,...C}=p,R=Hh(),N=(l=R==null?void 0:R.getLabelProps(C,a))!=null?l:{ref:a,...C};return b.jsxs(je.label,{...N,className:ot("chakra-form__label",p.className),__css:{display:"block",textAlign:"start",...u},children:[v,R!=null&&R.isRequired?y:S]})});On.displayName="FormLabel";var B$=$e(function(i,a){const l=Hh(),u=V$();if(!(l!=null&&l.isRequired))return null;const p=ot("chakra-form__required-indicator",i.className);return b.jsx(je.span,{...l==null?void 0:l.getRequiredIndicatorProps(i,a),__css:u.requiredIndicator,className:p})});B$.displayName="RequiredIndicator";function mx(e){const{isDisabled:i,isInvalid:a,isReadOnly:l,isRequired:u,...p}=W$(e);return{...p,disabled:i,readOnly:l,required:u,"aria-invalid":Jf(a),"aria-required":Jf(u),"aria-readonly":Jf(l)}}function W$(e){var i,a,l;const u=Hh(),{id:p,disabled:m,readOnly:v,required:y,isRequired:S,isInvalid:C,isReadOnly:R,isDisabled:N,onFocus:x,onBlur:U,...M}=e,z=e["aria-describedby"]?[e["aria-describedby"]]:[];return u!=null&&u.hasFeedbackText&&(u!=null&&u.isInvalid)&&z.push(u.feedbackId),u!=null&&u.hasHelpText&&z.push(u.helpTextId),{...M,"aria-describedby":z.join(" ")||void 0,id:p??(u==null?void 0:u.id),isDisabled:(i=m??N)!=null?i:u==null?void 0:u.isDisabled,isReadOnly:(a=v??R)!=null?a:u==null?void 0:u.isReadOnly,isRequired:(l=y??S)!=null?l:u==null?void 0:u.isRequired,isInvalid:C??(u==null?void 0:u.isInvalid),onFocus:$t(u==null?void 0:u.onFocus,x),onBlur:$t(u==null?void 0:u.onBlur,U)}}var Qwe={border:"0",clip:"rect(0, 0, 0, 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},Zwe=()=>typeof document<"u",wW=!1,uE=null,Ph=!1,BP=!1,WP=new Set;function gx(e,i){WP.forEach(a=>a(e,i))}var eRe=typeof window<"u"&&window.navigator!=null?/^Mac/.test(window.navigator.platform):!1;function tRe(e){return!(e.metaKey||!eRe&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function RW(e){Ph=!0,tRe(e)&&(uE="keyboard",gx("keyboard",e))}function df(e){if(uE="pointer",e.type==="mousedown"||e.type==="pointerdown"){Ph=!0;const i=e.composedPath?e.composedPath()[0]:e.target;let a=!1;try{a=i.matches(":focus-visible")}catch{}if(a)return;gx("pointer",e)}}function nRe(e){return e.mozInputSource===0&&e.isTrusted?!0:e.detail===0&&!e.pointerType}function rRe(e){nRe(e)&&(Ph=!0,uE="virtual")}function iRe(e){e.target===window||e.target===document||(!Ph&&!BP&&(uE="virtual",gx("virtual",e)),Ph=!1,BP=!1)}function oRe(){Ph=!1,BP=!0}function IW(){return uE!=="pointer"}function sRe(){if(!Zwe()||wW)return;const{focus:e}=HTMLElement.prototype;HTMLElement.prototype.focus=function(...a){Ph=!0,e.apply(this,a)},document.addEventListener("keydown",RW,!0),document.addEventListener("keyup",RW,!0),document.addEventListener("click",rRe,!0),window.addEventListener("focus",iRe,!0),window.addEventListener("blur",oRe,!1),typeof PointerEvent<"u"?(document.addEventListener("pointerdown",df,!0),document.addEventListener("pointermove",df,!0),document.addEventListener("pointerup",df,!0)):(document.addEventListener("mousedown",df,!0),document.addEventListener("mousemove",df,!0),document.addEventListener("mouseup",df,!0)),wW=!0}function z$(e){sRe(),e(IW());const i=()=>e(IW());return WP.add(i),()=>{WP.delete(i)}}function aRe(e,i=[]){const a=Object.assign({},e);for(const l of i)l in a&&delete a[l];return a}function cRe(e={}){const i=W$(e),{isDisabled:a,isReadOnly:l,isRequired:u,isInvalid:p,id:m,onBlur:v,onFocus:y,"aria-describedby":S}=i,{defaultChecked:C,isChecked:R,isFocusable:N,onChange:x,isIndeterminate:U,name:M,value:z,tabIndex:V=void 0,"aria-label":W,"aria-labelledby":H,"aria-invalid":q,...ee}=e,oe=aRe(ee,["isDisabled","isReadOnly","isRequired","isInvalid","id","onBlur","onFocus","aria-describedby"]),se=ss(x),re=ss(v),me=ss(y),[pe,Re]=F.useState(!1),[Ze,Qe]=F.useState(!1),[Oe,Ie]=F.useState(!1),[Te,de]=F.useState(!1);F.useEffect(()=>z$(Re),[]);const ue=F.useRef(null),[be,xe]=F.useState(!0),[He,rt]=F.useState(!!C),Ye=R!==void 0,Ge=Ye?R:He,_t=F.useCallback(Ct=>{if(l||a){Ct.preventDefault();return}Ye||rt(Ge?Ct.target.checked:U?!0:Ct.target.checked),se==null||se(Ct)},[l,a,Ge,Ye,U,se]);bl(()=>{ue.current&&(ue.current.indeterminate=!!U)},[U]),Nh(()=>{a&&Qe(!1)},[a,Qe]),bl(()=>{const Ct=ue.current;if(!(Ct!=null&&Ct.form))return;const Cn=()=>{rt(!!C)};return Ct.form.addEventListener("reset",Cn),()=>{var $n;return($n=Ct.form)==null?void 0:$n.removeEventListener("reset",Cn)}},[]);const kt=a&&!N,sn=F.useCallback(Ct=>{Ct.key===" "&&de(!0)},[de]),cn=F.useCallback(Ct=>{Ct.key===" "&&de(!1)},[de]);bl(()=>{if(!ue.current)return;ue.current.checked!==Ge&&rt(ue.current.checked)},[ue.current]);const Gn=F.useCallback((Ct={},Cn=null)=>{const $n=on=>{Ze&&on.preventDefault(),de(!0)};return{...Ct,ref:Cn,"data-active":Tt(Te),"data-hover":Tt(Oe),"data-checked":Tt(Ge),"data-focus":Tt(Ze),"data-focus-visible":Tt(Ze&&pe),"data-indeterminate":Tt(U),"data-disabled":Tt(a),"data-invalid":Tt(p),"data-readonly":Tt(l),"aria-hidden":!0,onMouseDown:$t(Ct.onMouseDown,$n),onMouseUp:$t(Ct.onMouseUp,()=>de(!1)),onMouseEnter:$t(Ct.onMouseEnter,()=>Ie(!0)),onMouseLeave:$t(Ct.onMouseLeave,()=>Ie(!1))}},[Te,Ge,a,Ze,pe,Oe,U,p,l]),vn=F.useCallback((Ct={},Cn=null)=>({...Ct,ref:Cn,"data-active":Tt(Te),"data-hover":Tt(Oe),"data-checked":Tt(Ge),"data-focus":Tt(Ze),"data-focus-visible":Tt(Ze&&pe),"data-indeterminate":Tt(U),"data-disabled":Tt(a),"data-invalid":Tt(p),"data-readonly":Tt(l)}),[Te,Ge,a,Ze,pe,Oe,U,p,l]),St=F.useCallback((Ct={},Cn=null)=>({...oe,...Ct,ref:yi(Cn,$n=>{$n&&xe($n.tagName==="LABEL")}),onClick:$t(Ct.onClick,()=>{var $n;be||(($n=ue.current)==null||$n.click(),requestAnimationFrame(()=>{var on;(on=ue.current)==null||on.focus({preventScroll:!0})}))}),"data-disabled":Tt(a),"data-checked":Tt(Ge),"data-invalid":Tt(p)}),[oe,a,Ge,p,be]),bt=F.useCallback((Ct={},Cn=null)=>({...Ct,ref:yi(ue,Cn),type:"checkbox",name:M,value:z,id:m,tabIndex:V,onChange:$t(Ct.onChange,_t),onBlur:$t(Ct.onBlur,re,()=>Qe(!1)),onFocus:$t(Ct.onFocus,me,()=>Qe(!0)),onKeyDown:$t(Ct.onKeyDown,sn),onKeyUp:$t(Ct.onKeyUp,cn),required:u,checked:Ge,disabled:kt,readOnly:l,"aria-label":W,"aria-labelledby":H,"aria-invalid":q?!!q:p,"aria-describedby":S,"aria-disabled":a,style:Qwe}),[M,z,m,_t,re,me,sn,cn,u,Ge,kt,l,W,H,q,p,S,a,V]),Qn=F.useCallback((Ct={},Cn=null)=>({...Ct,ref:Cn,onMouseDown:$t(Ct.onMouseDown,lRe),"data-disabled":Tt(a),"data-checked":Tt(Ge),"data-invalid":Tt(p)}),[Ge,a,p]);return{state:{isInvalid:p,isFocused:Ze,isChecked:Ge,isActive:Te,isHovered:Oe,isIndeterminate:U,isDisabled:a,isReadOnly:l,isRequired:u},getRootProps:St,getCheckboxProps:Gn,getIndicatorProps:vn,getInputProps:bt,getLabelProps:Qn,htmlProps:oe}}function lRe(e){e.preventDefault(),e.stopPropagation()}var dRe={display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"top",userSelect:"none",flexShrink:0},uRe={cursor:"pointer",display:"inline-flex",alignItems:"center",verticalAlign:"top",position:"relative"},hRe=iC({from:{opacity:0,strokeDashoffset:16,transform:"scale(0.95)"},to:{opacity:1,strokeDashoffset:0,transform:"scale(1)"}}),pRe=iC({from:{opacity:0},to:{opacity:1}}),fRe=iC({from:{transform:"scaleX(0.65)"},to:{transform:"scaleX(1)"}}),TT=$e(function(i,a){const l=Vwe(),u={...l,...i},p=Ai("Checkbox",u),m=ar(i),{spacing:v="0.5rem",className:y,children:S,iconColor:C,iconSize:R,icon:N=b.jsx(Gwe,{}),isChecked:x,isDisabled:U=l==null?void 0:l.isDisabled,onChange:M,inputProps:z,...V}=m;let W=x;l!=null&&l.value&&m.value&&(W=l.value.includes(m.value));let H=M;l!=null&&l.onChange&&m.value&&(H=vD(l.onChange,M));const{state:q,getInputProps:ee,getCheckboxProps:oe,getLabelProps:se,getRootProps:re}=cRe({...V,isDisabled:U,isChecked:W,onChange:H}),me=Bwe(q.isChecked),pe=F.useMemo(()=>({animation:me?q.isIndeterminate?`${pRe} 20ms linear, ${fRe} 200ms linear`:`${hRe} 200ms linear`:void 0,fontSize:R,color:C,...p.icon}),[C,R,me,q.isIndeterminate,p.icon]),Re=F.cloneElement(N,{__css:pe,isIndeterminate:q.isIndeterminate,isChecked:q.isChecked});return b.jsxs(je.label,{__css:{...uRe,...p.container},className:ot("chakra-checkbox",y),...re(),children:[b.jsx("input",{className:"chakra-checkbox__input",...ee(z,a)}),b.jsx(je.span,{__css:{...dRe,...p.control},className:"chakra-checkbox__control",...oe(),children:Re}),S&&b.jsx(je.span,{className:"chakra-checkbox__label",...se(),__css:{marginStart:v,...p.label},children:S})]})});TT.displayName="Checkbox";function mRe(e){const i=parseFloat(e);return typeof i!="number"||Number.isNaN(i)?0:i}function gRe(e,i){let a=mRe(e);const l=10**(i??10);return a=Math.round(a*l)/l,i?a.toFixed(i):a.toString()}function _Re(e){if(!Number.isFinite(e))return 0;let i=1,a=0;for(;Math.round(e*i)/i!==e;)i*=10,a+=1;return a}function AW(e,i,a){return(e-i)*100/(a-i)}function vRe(e,i,a){return(a-i)*e+i}function ERe(e,i,a){const l=Math.round((e-i)/a)*a+i,u=_Re(a);return gRe(l,u)}function OW(e,i,a){return e==null?e:(a<i&&console.warn("clamp: max cannot be less than min"),Math.min(Math.max(e,i),a))}function bT(e,i,a,l){const u=ss(a);return F.useEffect(()=>{const p=typeof e=="function"?e():e??document;if(!(!a||!p))return p.addEventListener(i,u,l),()=>{p.removeEventListener(i,u,l)}},[i,e,l,u,a]),()=>{const p=typeof e=="function"?e():e??document;p==null||p.removeEventListener(i,u,l)}}function yRe(e,i){if(e==null)return{};var a={},l=Object.keys(e),u,p;for(p=0;p<l.length;p++)u=l[p],!(i.indexOf(u)>=0)&&(a[u]=e[u]);return a}var zP="data-focus-lock",G$="data-focus-lock-disabled",SRe="data-no-focus-lock",TRe="data-autofocus-inside",bRe="data-no-autofocus";function BO(e,i){return typeof e=="function"?e(i):e&&(e.current=i),e}function CRe(e,i){var a=F.useState(function(){return{value:e,callback:i,facade:{get current(){return a.value},set current(l){var u=a.value;u!==l&&(a.value=l,a.callback(l,u))}}}})[0];return a.callback=i,a.facade}var wRe=typeof window<"u"?F.useLayoutEffect:F.useEffect,NW=new WeakMap;function H$(e,i){var a=CRe(null,function(l){return e.forEach(function(u){return BO(u,l)})});return wRe(function(){var l=NW.get(a);if(l){var u=new Set(l),p=new Set(e),m=a.current;u.forEach(function(v){p.has(v)||BO(v,null)}),p.forEach(function(v){u.has(v)||BO(v,m)})}NW.set(a,e)},[e]),a}var WO={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},Cc=function(){return Cc=Object.assign||function(i){for(var a,l=1,u=arguments.length;l<u;l++){a=arguments[l];for(var p in a)Object.prototype.hasOwnProperty.call(a,p)&&(i[p]=a[p])}return i},Cc.apply(this,arguments)};function $$(e,i){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&i.indexOf(l)<0&&(a[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(e);u<l.length;u++)i.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(e,l[u])&&(a[l[u]]=e[l[u]]);return a}function RRe(e,i,a){for(var l=0,u=i.length,p;l<u;l++)(p||!(l in i))&&(p||(p=Array.prototype.slice.call(i,0,l)),p[l]=i[l]);return e.concat(p||Array.prototype.slice.call(i))}function K$(e){return e}function Y$(e,i){i===void 0&&(i=K$);var a=[],l=!1,u={read:function(){if(l)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return a.length?a[a.length-1]:e},useMedium:function(p){var m=i(p,l);return a.push(m),function(){a=a.filter(function(v){return v!==m})}},assignSyncMedium:function(p){for(l=!0;a.length;){var m=a;a=[],m.forEach(p)}a={push:function(v){return p(v)},filter:function(){return a}}},assignMedium:function(p){l=!0;var m=[];if(a.length){var v=a;a=[],v.forEach(p),m=a}var y=function(){var C=m;m=[],C.forEach(p)},S=function(){return Promise.resolve().then(y)};S(),a={push:function(C){m.push(C),S()},filter:function(C){return m=m.filter(C),a}}}};return u}function _x(e,i){return i===void 0&&(i=K$),Y$(e,i)}function q$(e){e===void 0&&(e={});var i=Y$(null);return i.options=Cc({async:!0,ssr:!1},e),i}var J$=function(e){var i=e.sideCar,a=$$(e,["sideCar"]);if(!i)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var l=i.read();if(!l)throw new Error("Sidecar medium not found");return F.createElement(l,Cc({},a))};J$.isSideCarExport=!0;function IRe(e,i){return e.useMedium(i),J$}var X$=_x({},function(e){var i=e.target,a=e.currentTarget;return{target:i,currentTarget:a}}),Q$=_x(),ARe=_x(),ORe=q$({async:!0,ssr:typeof document<"u"}),NRe=F.createContext(void 0),PRe=[],vx=F.forwardRef(function(i,a){var l,u=F.useState(),p=u[0],m=u[1],v=F.useRef(),y=F.useRef(!1),S=F.useRef(null),C=F.useState({}),R=C[1],N=i.children,x=i.disabled,U=x===void 0?!1:x,M=i.noFocusGuards,z=M===void 0?!1:M,V=i.persistentFocus,W=V===void 0?!1:V,H=i.crossFrame,q=H===void 0?!0:H,ee=i.autoFocus,oe=ee===void 0?!0:ee;i.allowTextSelection;var se=i.group,re=i.className,me=i.whiteList,pe=i.hasPositiveIndices,Re=i.shards,Ze=Re===void 0?PRe:Re,Qe=i.as,Oe=Qe===void 0?"div":Qe,Ie=i.lockProps,Te=Ie===void 0?{}:Ie,de=i.sideCar,ue=i.returnFocus,be=ue===void 0?!1:ue,xe=i.focusOptions,He=i.onActivation,rt=i.onDeactivation,Ye=F.useState({}),Ge=Ye[0],_t=F.useCallback(function(Cn){var $n=Cn.captureFocusRestore;if(!S.current){var on,ji=(on=document)==null?void 0:on.activeElement;S.current=ji,ji!==document.body&&(S.current=$n(ji))}v.current&&He&&He(v.current),y.current=!0,R()},[He]),kt=F.useCallback(function(){y.current=!1,rt&&rt(v.current),R()},[rt]),sn=F.useCallback(function(Cn){var $n=S.current;if($n){var on=(typeof $n=="function"?$n():$n)||document.body,ji=typeof be=="function"?be(on):be;if(ji){var ai=typeof ji=="object"?ji:void 0;S.current=null,Cn?Promise.resolve().then(function(){return on.focus(ai)}):on.focus(ai)}}},[be]),cn=F.useCallback(function(Cn){y.current&&X$.useMedium(Cn)},[]),Gn=Q$.useMedium,vn=F.useCallback(function(Cn){v.current!==Cn&&(v.current=Cn,m(Cn))},[]),St=Oh((l={},l[G$]=U&&"disabled",l[zP]=se,l),Te),bt=z!==!0,Qn=bt&&z!=="tail",Hn=H$([a,vn]),Ct=F.useMemo(function(){return{observed:v,shards:Ze,enabled:!U,active:y.current}},[U,y.current,Ze,p]);return F.createElement(F.Fragment,null,bt&&[F.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:U?-1:0,style:WO}),pe?F.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:U?-1:1,style:WO}):null],!U&&F.createElement(de,{id:Ge,sideCar:ORe,observed:p,disabled:U,persistentFocus:W,crossFrame:q,autoFocus:oe,whiteList:me,shards:Ze,onActivation:_t,onDeactivation:kt,returnFocus:sn,focusOptions:xe}),F.createElement(Oe,Oh({ref:Hn},St,{className:re,onBlur:Gn,onFocus:cn}),F.createElement(NRe.Provider,{value:Ct},N)),Qn&&F.createElement("div",{"data-focus-guard":!0,tabIndex:U?-1:0,style:WO}))});vx.propTypes={};function GP(e,i){return GP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,u){return l.__proto__=u,l},GP(e,i)}function kRe(e,i){e.prototype=Object.create(i.prototype),e.prototype.constructor=e,GP(e,i)}function Wv(e){"@babel/helpers - typeof";return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Wv(e)}function DRe(e,i){if(Wv(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,i);if(Wv(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function xRe(e){var i=DRe(e,"string");return Wv(i)=="symbol"?i:i+""}function LRe(e,i,a){return i=xRe(i),i in e?Object.defineProperty(e,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[i]=a,e}function MRe(e,i){function a(l){return l.displayName||l.name||"Component"}return function(u){var p=[],m;function v(){m=e(p.map(function(S){return S.props})),i(m)}var y=function(S){kRe(C,S);function C(){return S.apply(this,arguments)||this}C.peek=function(){return m};var R=C.prototype;return R.componentDidMount=function(){p.push(this),v()},R.componentDidUpdate=function(){v()},R.componentWillUnmount=function(){var x=p.indexOf(this);p.splice(x,1),v()},R.render=function(){return ns.createElement(u,this.props)},C}(F.PureComponent);return LRe(y,"displayName","SideEffect("+a(u)+")"),y}}var Lc=function(e){for(var i=Array(e.length),a=0;a<e.length;++a)i[a]=e[a];return i},kh=function(e){return Array.isArray(e)?e:[e]},Z$=function(e){return Array.isArray(e)?e[0]:e},URe=function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var i=window.getComputedStyle(e,null);return!i||!i.getPropertyValue?!1:i.getPropertyValue("display")==="none"||i.getPropertyValue("visibility")==="hidden"},eK=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},tK=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},jRe=function(e){return e.hasAttribute("inert")},FRe=function(e,i){return!e||tK(e)||!URe(e)&&!jRe(e)&&i(eK(e))},nK=function(e,i){var a=e.get(i);if(a!==void 0)return a;var l=FRe(i,nK.bind(void 0,e));return e.set(i,l),l},VRe=function(e,i){return e&&!tK(e)?zRe(e)?i(eK(e)):!1:!0},rK=function(e,i){var a=e.get(i);if(a!==void 0)return a;var l=VRe(i,rK.bind(void 0,e));return e.set(i,l),l},iK=function(e){return e.dataset},BRe=function(e){return e.tagName==="BUTTON"},oK=function(e){return e.tagName==="INPUT"},sK=function(e){return oK(e)&&e.type==="radio"},WRe=function(e){return!((oK(e)||BRe(e))&&(e.type==="hidden"||e.disabled))},zRe=function(e){var i=e.getAttribute(bRe);return![!0,"true",""].includes(i)},Ex=function(e){var i;return!!(e&&(!((i=iK(e))===null||i===void 0)&&i.focusGuard))},HP=function(e){return!Ex(e)},GRe=function(e){return!!e},HRe=function(e,i){var a=Math.max(0,e.tabIndex),l=Math.max(0,i.tabIndex),u=a-l,p=e.index-i.index;if(u){if(!a)return 1;if(!l)return-1}return u||p},$Re=function(e){return e.tabIndex<0&&!e.hasAttribute("tabindex")?0:e.tabIndex},yx=function(e,i,a){return Lc(e).map(function(l,u){var p=$Re(l);return{node:l,index:u,tabIndex:a&&p===-1?(l.dataset||{}).focusGuard?0:-1:p}}).filter(function(l){return!i||l.tabIndex>=0}).sort(HRe)},KRe=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],Sx=KRe.join(","),YRe="".concat(Sx,", [data-focus-guard]"),aK=function(e,i){return Lc((e.shadowRoot||e).children).reduce(function(a,l){return a.concat(l.matches(i?YRe:Sx)?[l]:[],aK(l))},[])},qRe=function(e,i){var a;return e instanceof HTMLIFrameElement&&(!((a=e.contentDocument)===null||a===void 0)&&a.body)?Sm([e.contentDocument.body],i):[e]},Sm=function(e,i){return e.reduce(function(a,l){var u,p=aK(l,i),m=(u=[]).concat.apply(u,p.map(function(v){return qRe(v,i)}));return a.concat(m,l.parentNode?Lc(l.parentNode.querySelectorAll(Sx)).filter(function(v){return v===l}):[])},[])},JRe=function(e){var i=e.querySelectorAll("[".concat(TRe,"]"));return Lc(i).map(function(a){return Sm([a])}).reduce(function(a,l){return a.concat(l)},[])},Tx=function(e,i){return Lc(e).filter(function(a){return nK(i,a)}).filter(function(a){return WRe(a)})},PW=function(e,i){return i===void 0&&(i=new Map),Lc(e).filter(function(a){return rK(i,a)})},bx=function(e,i,a){return yx(Tx(Sm(e,a),i),!0,a)},Eb=function(e,i){return yx(Tx(Sm(e),i),!1)},XRe=function(e,i){return Tx(JRe(e),i)},yh=function(e,i){return e.shadowRoot?yh(e.shadowRoot,i):Object.getPrototypeOf(e).contains!==void 0&&Object.getPrototypeOf(e).contains.call(e,i)?!0:Lc(e.children).some(function(a){var l;if(a instanceof HTMLIFrameElement){var u=(l=a.contentDocument)===null||l===void 0?void 0:l.body;return u?yh(u,i):!1}return yh(a,i)})},QRe=function(e){for(var i=new Set,a=e.length,l=0;l<a;l+=1)for(var u=l+1;u<a;u+=1){var p=e[l].compareDocumentPosition(e[u]);(p&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&i.add(u),(p&Node.DOCUMENT_POSITION_CONTAINS)>0&&i.add(l)}return e.filter(function(m,v){return!i.has(v)})},cK=function(e){return e.parentNode?cK(e.parentNode):e},Cx=function(e){var i=kh(e);return i.filter(Boolean).reduce(function(a,l){var u=l.getAttribute(zP);return a.push.apply(a,u?QRe(Lc(cK(l).querySelectorAll("[".concat(zP,'="').concat(u,'"]:not([').concat(G$,'="disabled"])')))):[l]),a},[])},ZRe=function(e){try{return e()}catch{return}},zv=function(e){if(e===void 0&&(e=document),!(!e||!e.activeElement)){var i=e.activeElement;return i.shadowRoot?zv(i.shadowRoot):i instanceof HTMLIFrameElement&&ZRe(function(){return i.contentWindow.document})?zv(i.contentWindow.document):i}},eIe=function(e,i){return e===i},tIe=function(e,i){return!!Lc(e.querySelectorAll("iframe")).some(function(a){return eIe(a,i)})},lK=function(e,i){return i===void 0&&(i=zv(Z$(e).ownerDocument)),!i||i.dataset&&i.dataset.focusGuard?!1:Cx(e).some(function(a){return yh(a,i)||tIe(a,i)})},nIe=function(e){e===void 0&&(e=document);var i=zv(e);return i?Lc(e.querySelectorAll("[".concat(SRe,"]"))).some(function(a){return yh(a,i)}):!1},rIe=function(e,i){return i.filter(sK).filter(function(a){return a.name===e.name}).filter(function(a){return a.checked})[0]||e},wx=function(e,i){return sK(e)&&e.name?rIe(e,i):e},iIe=function(e){var i=new Set;return e.forEach(function(a){return i.add(wx(a,e))}),e.filter(function(a){return i.has(a)})},kW=function(e){return e[0]&&e.length>1?wx(e[0],e):e[0]},DW=function(e,i){return e.indexOf(wx(i,e))},$P="NEW_FOCUS",oIe=function(e,i,a,l,u){var p=e.length,m=e[0],v=e[p-1],y=Ex(l);if(!(l&&e.indexOf(l)>=0)){var S=l!==void 0?a.indexOf(l):-1,C=u?a.indexOf(u):S,R=u?e.indexOf(u):-1;if(S===-1)return R!==-1?R:$P;if(R===-1)return $P;var N=S-C,x=a.indexOf(m),U=a.indexOf(v),M=iIe(a),z=l!==void 0?M.indexOf(l):-1,V=z-(u?M.indexOf(u):S);if(!N&&R>=0||i.length===0)return R;var W=DW(e,i[0]),H=DW(e,i[i.length-1]);if(S<=x&&y&&Math.abs(N)>1)return H;if(S>=U&&y&&Math.abs(N)>1)return W;if(N&&Math.abs(V)>1)return R;if(S<=x)return H;if(S>U)return W;if(N)return Math.abs(N)>1?R:(p+R+N)%p}},sIe=function(e){return function(i){var a,l=(a=iK(i))===null||a===void 0?void 0:a.autofocus;return i.autofocus||l!==void 0&&l!=="false"||e.indexOf(i)>=0}},xW=function(e,i,a){var l=e.map(function(p){var m=p.node;return m}),u=PW(l.filter(sIe(a)));return u&&u.length?kW(u):kW(PW(i))},KP=function(e,i){return i===void 0&&(i=[]),i.push(e),e.parentNode&&KP(e.parentNode.host||e.parentNode,i),i},zO=function(e,i){for(var a=KP(e),l=KP(i),u=0;u<a.length;u+=1){var p=a[u];if(l.indexOf(p)>=0)return p}return!1},dK=function(e,i,a){var l=kh(e),u=kh(i),p=l[0],m=!1;return u.filter(Boolean).forEach(function(v){m=zO(m||v,v)||m,a.filter(Boolean).forEach(function(y){var S=zO(p,y);S&&(!m||yh(S,m)?m=S:m=zO(S,m))})}),m},LW=function(e,i){return e.reduce(function(a,l){return a.concat(XRe(l,i))},[])},aIe=function(e,i){var a=new Map;return i.forEach(function(l){return a.set(l.node,l)}),e.map(function(l){return a.get(l)}).filter(GRe)},cIe=function(e,i){var a=zv(kh(e).length>0?document:Z$(e).ownerDocument),l=Cx(e).filter(HP),u=dK(a||e,e,l),p=new Map,m=Eb(l,p),v=m.filter(function(U){var M=U.node;return HP(M)});if(v[0]){var y=Eb([u],p).map(function(U){var M=U.node;return M}),S=aIe(y,v),C=S.map(function(U){var M=U.node;return M}),R=S.filter(function(U){var M=U.tabIndex;return M>=0}).map(function(U){var M=U.node;return M}),N=oIe(C,R,y,a,i);if(N===$P){var x=xW(m,R,LW(l,p))||xW(m,C,LW(l,p));if(x)return{node:x};console.warn("focus-lock: cannot find any node to move focus into");return}return N===void 0?N:S[N]}},lIe=function(e){var i=Cx(e).filter(HP),a=dK(e,e,i),l=yx(Sm([a],!0),!0,!0),u=Sm(i,!1);return l.map(function(p){var m=p.node,v=p.index;return{node:m,index:v,lockItem:u.indexOf(m)>=0,guard:Ex(m)}})},Rx=function(e,i){e&&("focus"in e&&e.focus(i),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus())},GO=0,HO=!1,uK=function(e,i,a){a===void 0&&(a={});var l=cIe(e,i);if(!HO&&l){if(GO>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),HO=!0,setTimeout(function(){HO=!1},1);return}GO++,Rx(l.node,a.focusOptions),GO--}};function A_(e){if(!e)return null;if(typeof WeakRef>"u")return function(){return e||null};var i=e?new WeakRef(e):null;return function(){return(i==null?void 0:i.deref())||null}}var dIe=function(e){if(!e)return null;for(var i=[],a=e;a&&a!==document.body;)i.push({current:A_(a),parent:A_(a.parentElement),left:A_(a.previousElementSibling),right:A_(a.nextElementSibling)}),a=a.parentElement;return{element:A_(e),stack:i,ownerDocument:e.ownerDocument}},uIe=function(e){var i,a,l,u,p;if(e)for(var m=e.stack,v=e.ownerDocument,y=new Map,S=0,C=m;S<C.length;S++){var R=C[S],N=(i=R.parent)===null||i===void 0?void 0:i.call(R);if(N&&v.contains(N)){for(var x=(a=R.left)===null||a===void 0?void 0:a.call(R),U=R.current(),M=N.contains(U)?U:void 0,z=(l=R.right)===null||l===void 0?void 0:l.call(R),V=bx([N],y),W=(p=(u=M??(x==null?void 0:x.nextElementSibling))!==null&&u!==void 0?u:z)!==null&&p!==void 0?p:x;W;){for(var H=0,q=V;H<q.length;H++){var ee=q[H];if(W!=null&&W.contains(ee.node))return ee.node}W=W.nextElementSibling}if(V.length)return V[0].node}}},hIe=function(e){var i=dIe(e);return function(){return uIe(i)}},pIe=function(e,i,a){if(!e||!i)return console.error("no element or scope given"),{};var l=kh(i);if(l.every(function(m){return!yh(m,e)}))return console.error("Active element is not contained in the scope"),{};var u=a?bx(l,new Map):Eb(l,new Map),p=u.findIndex(function(m){var v=m.node;return v===e});if(p!==-1)return{prev:u[p-1],next:u[p+1],first:u[0],last:u[u.length-1]}},fIe=function(e,i){var a=i?bx(kh(e),new Map):Eb(kh(e),new Map);return{first:a[0],last:a[a.length-1]}},mIe=function(e){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},e)},hK=function(e,i,a){i===void 0&&(i={});var l=mIe(i),u=pIe(e,l.scope,l.onlyTabbable);if(u){var p=a(u,l.cycle);p&&Rx(p.node,l.focusOptions)}},gIe=function(e,i){i===void 0&&(i={}),hK(e,i,function(a,l){var u=a.next,p=a.first;return u||l&&p})},_Ie=function(e,i){i===void 0&&(i={}),hK(e,i,function(a,l){var u=a.prev,p=a.last;return u||l&&p})},pK=function(e,i,a){var l,u=fIe(e,(l=i.onlyTabbable)!==null&&l!==void 0?l:!0),p=u[a];p&&Rx(p.node,i.focusOptions)},vIe=function(e,i){i===void 0&&(i={}),pK(e,i,"first")},EIe=function(e,i){i===void 0&&(i={}),pK(e,i,"last")};function Ix(e){setTimeout(e,1)}var yIe=function(i){return i&&"current"in i?i.current:i},SIe=function(){return document&&document.activeElement===document.body},TIe=function(){return SIe()||nIe()},nm=null,Wf=null,rm=null,Gv=!1,bIe=function(){return!0},CIe=function(i){return(nm.whiteList||bIe)(i)},wIe=function(i,a){rm={observerNode:i,portaledElement:a}},RIe=function(i){return rm&&rm.portaledElement===i};function MW(e,i,a,l){var u=null,p=e;do{var m=l[p];if(m.guard)m.node.dataset.focusAutoGuard&&(u=m);else if(m.lockItem){if(p!==e)return;u=null}else break}while((p+=a)!==i);u&&(u.node.tabIndex=0)}var IIe=function(i){return i?!!Gv:Gv==="meanwhile"},AIe=function e(i,a,l){return a&&(a.host===i&&(!a.activeElement||l.contains(a.activeElement))||a.parentNode&&e(i,a.parentNode,l))},OIe=function(i,a){return a.some(function(l){return AIe(i,l,l)})},yb=function(){var i=!1;if(nm){var a=nm,l=a.observed,u=a.persistentFocus,p=a.autoFocus,m=a.shards,v=a.crossFrame,y=a.focusOptions,S=l||rm&&rm.portaledElement,C=document&&document.activeElement;if(S){var R=[S].concat(m.map(yIe).filter(Boolean));if((!C||CIe(C))&&(u||IIe(v)||!TIe()||!Wf&&p)&&(S&&!(lK(R)||C&&OIe(C,R)||RIe(C))&&(document&&!Wf&&C&&!p?(C.blur&&C.blur(),document.body.focus()):(i=uK(R,Wf,{focusOptions:y}),rm={})),Gv=!1,Wf=document&&document.activeElement),document&&C!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var N=document&&document.activeElement,x=lIe(R),U=x.map(function(M){var z=M.node;return z}).indexOf(N);U>-1&&(x.filter(function(M){var z=M.guard,V=M.node;return z&&V.dataset.focusAutoGuard}).forEach(function(M){var z=M.node;return z.removeAttribute("tabIndex")}),MW(U,x.length,1,x),MW(U,-1,-1,x))}}}return i},fK=function(i){yb()&&i&&(i.stopPropagation(),i.preventDefault())},Ax=function(){return Ix(yb)},NIe=function(i){var a=i.target,l=i.currentTarget;l.contains(a)||wIe(l,a)},PIe=function(){return null},mK=function(){Gv="just",Ix(function(){Gv="meanwhile"})},kIe=function(){document.addEventListener("focusin",fK),document.addEventListener("focusout",Ax),window.addEventListener("blur",mK)},DIe=function(){document.removeEventListener("focusin",fK),document.removeEventListener("focusout",Ax),window.removeEventListener("blur",mK)};function xIe(e){return e.filter(function(i){var a=i.disabled;return!a})}var gK={moveFocusInside:uK,focusInside:lK,focusNextElement:gIe,focusPrevElement:_Ie,focusFirstElement:vIe,focusLastElement:EIe,captureFocusRestore:hIe};function LIe(e){var i=e.slice(-1)[0];i&&!nm&&kIe();var a=nm,l=a&&i&&i.id===a.id;nm=i,a&&!l&&(a.onDeactivation(),e.filter(function(u){var p=u.id;return p===a.id}).length||a.returnFocus(!i)),i?(Wf=null,(!l||a.observed!==i.observed)&&i.onActivation(gK),yb(),Ix(yb)):(DIe(),Wf=null)}X$.assignSyncMedium(NIe);Q$.assignMedium(Ax);ARe.assignMedium(function(e){return e(gK)});const MIe=MRe(xIe,LIe)(PIe);var YP=F.forwardRef(function(i,a){return F.createElement(vx,Oh({sideCar:MIe,ref:a},i))}),_K=vx.propTypes||{};_K.sideCar;yRe(_K,["sideCar"]);YP.propTypes={};function vK(e){return e!=null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function Ox(e){var i;if(!vK(e))return!1;const a=(i=e.ownerDocument.defaultView)!=null?i:window;return e instanceof a.HTMLElement}function UIe(e){var i,a;return(a=(i=EK(e))==null?void 0:i.defaultView)!=null?a:window}function EK(e){return vK(e)?e.ownerDocument:document}function jIe(e){return EK(e).activeElement}function FIe(e){const i=e.ownerDocument.defaultView||window,{overflow:a,overflowX:l,overflowY:u}=i.getComputedStyle(e);return/auto|scroll|overlay|hidden/.test(a+u+l)}function VIe(e){return e.localName==="html"?e:e.assignedSlot||e.parentElement||e.ownerDocument.documentElement}function yK(e){return["html","body","#document"].includes(e.localName)?e.ownerDocument.body:Ox(e)&&FIe(e)?e:yK(VIe(e))}var SK=e=>e.hasAttribute("tabindex"),BIe=e=>SK(e)&&e.tabIndex===-1;function WIe(e){return!!e.getAttribute("disabled")||!!e.getAttribute("aria-disabled")}function TK(e){return e.parentElement&&TK(e.parentElement)?!0:e.hidden}function zIe(e){const i=e.getAttribute("contenteditable");return i!=="false"&&i!=null}function bK(e){if(!Ox(e)||TK(e)||WIe(e))return!1;const{localName:i}=e;if(["input","select","textarea","button"].indexOf(i)>=0)return!0;const l={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return i in l?l[i]():zIe(e)?!0:SK(e)}function GIe(e){return e?Ox(e)&&bK(e)&&!BIe(e):!1}var HIe=["input:not(:disabled):not([disabled])","select:not(:disabled):not([disabled])","textarea:not(:disabled):not([disabled])","embed","iframe","object","a[href]","area[href]","button:not(:disabled):not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],$Ie=HIe.join(),KIe=e=>e.offsetWidth>0&&e.offsetHeight>0;function YIe(e){const i=Array.from(e.querySelectorAll($Ie));return i.unshift(e),i.filter(a=>bK(a)&&KIe(a))}var UW,qIe=(UW=YP.default)!=null?UW:YP,CK=e=>{const{initialFocusRef:i,finalFocusRef:a,contentRef:l,restoreFocus:u,children:p,isDisabled:m,autoFocus:v,persistentFocus:y,lockFocusAcrossFrames:S}=e,C=F.useCallback(()=>{i!=null&&i.current?i.current.focus():l!=null&&l.current&&YIe(l.current).length===0&&requestAnimationFrame(()=>{var U;(U=l.current)==null||U.focus()})},[i,l]),R=F.useCallback(()=>{var x;(x=a==null?void 0:a.current)==null||x.focus()},[a]),N=u&&!a;return b.jsx(qIe,{crossFrame:S,persistentFocus:y,autoFocus:v,disabled:m,onActivation:C,onDeactivation:R,returnFocus:N,children:p})};CK.displayName="FocusLock";var JIe=Nye?F.useLayoutEffect:F.useEffect;function jW(e,i=[]){const a=F.useRef(e);return JIe(()=>{a.current=e}),F.useCallback((...l)=>{var u;return(u=a.current)==null?void 0:u.call(a,...l)},i)}function XIe(e,i){const a=F.useId();return F.useMemo(()=>e||[i,a].filter(Boolean).join("-"),[e,i,a])}function QIe(e,i){const a=e!==void 0;return[a,a&&typeof e<"u"?e:i]}function yC(e={}){const{onClose:i,onOpen:a,isOpen:l,id:u}=e,p=jW(a),m=jW(i),[v,y]=F.useState(e.defaultIsOpen||!1),[S,C]=QIe(l,v),R=XIe(u,"disclosure"),N=F.useCallback(()=>{S||y(!1),m==null||m()},[S,m]),x=F.useCallback(()=>{S||y(!0),p==null||p()},[S,p]),U=F.useCallback(()=>{(C?N:x)()},[C,x,N]);return{isOpen:!!C,onOpen:x,onClose:N,onToggle:U,isControlled:S,getButtonProps:(M={})=>({...M,"aria-expanded":C,"aria-controls":R,onClick:Lye(M.onClick,U)}),getDisclosureProps:(M={})=>({...M,hidden:!C,id:R})}}var[ZIe,eAe]=zn({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),Nx=$e(function(i,a){const l=Ai("Input",i),{children:u,className:p,...m}=ar(i),v=ot("chakra-input__group",p),y={},S=fx(u),C=l.field;S.forEach(N=>{var x,U;l&&(C&&N.type.id==="InputLeftElement"&&(y.paddingStart=(x=C.height)!=null?x:C.h),C&&N.type.id==="InputRightElement"&&(y.paddingEnd=(U=C.height)!=null?U:C.h),N.type.id==="InputRightAddon"&&(y.borderEndRadius=0),N.type.id==="InputLeftAddon"&&(y.borderStartRadius=0))});const R=S.map(N=>{var x,U;const M=ID({size:((x=N.props)==null?void 0:x.size)||i.size,variant:((U=N.props)==null?void 0:U.variant)||i.variant});return N.type.id!=="Input"?F.cloneElement(N,M):F.cloneElement(N,Object.assign(M,y,N.props))});return b.jsx(je.div,{className:v,ref:a,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate",...l.group},"data-group":!0,...m,children:b.jsx(ZIe,{value:l,children:R})})});Nx.displayName="InputGroup";var tAe=je("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),SC=$e(function(i,a){var l,u;const{placement:p="left",...m}=i,v=eAe(),y=v.field,C={[p==="left"?"insetStart":"insetEnd"]:"0",width:(l=y==null?void 0:y.height)!=null?l:y==null?void 0:y.h,height:(u=y==null?void 0:y.height)!=null?u:y==null?void 0:y.h,fontSize:y==null?void 0:y.fontSize,...v.element};return b.jsx(tAe,{ref:a,__css:C,...m})});SC.id="InputElement";SC.displayName="InputElement";var wK=$e(function(i,a){const{className:l,...u}=i,p=ot("chakra-input__left-element",l);return b.jsx(SC,{ref:a,placement:"left",className:p,...u})});wK.id="InputLeftElement";wK.displayName="InputLeftElement";var TC=$e(function(i,a){const{className:l,...u}=i,p=ot("chakra-input__right-element",l);return b.jsx(SC,{ref:a,placement:"right",className:p,...u})});TC.id="InputRightElement";TC.displayName="InputRightElement";var Ur=$e(function(i,a){const{htmlSize:l,...u}=i,p=Ai("Input",u),m=ar(u),v=mx(m),y=ot("chakra-input",i.className);return b.jsx(je.input,{size:l,...v,__css:p.field,ref:a,className:y})});Ur.displayName="Input";Ur.id="Input";var Sh=$e(function(i,a){const{templateAreas:l,gap:u,rowGap:p,columnGap:m,column:v,row:y,autoFlow:S,autoRows:C,templateRows:R,autoColumns:N,templateColumns:x,...U}=i,M={display:"grid",gridTemplateAreas:l,gridGap:u,gridRowGap:p,gridColumnGap:m,gridAutoColumns:N,gridColumn:v,gridRow:y,gridAutoFlow:S,gridAutoRows:C,gridTemplateRows:R,gridTemplateColumns:x};return b.jsx(je.div,{ref:a,__css:M,...U})});Sh.displayName="Grid";var RK=Object.freeze(["base","sm","md","lg","xl","2xl"]);function bC(e,i){return Array.isArray(e)?e.map(a=>a===null?null:i(a)):go(e)?Object.keys(e).reduce((a,l)=>(a[l]=i(e[l]),a),{}):e!=null?i(e):null}function nAe(e,i=RK){const a={};return e.forEach((l,u)=>{const p=i[u];l!=null&&(a[p]=l)}),a}var IK=$e(function(i,a){const{columns:l,spacingX:u,spacingY:p,spacing:m,minChildWidth:v,...y}=i,S=Bh(),C=v?iAe(v,S):oAe(l);return b.jsx(Sh,{ref:a,gap:m,columnGap:u,rowGap:p,templateColumns:C,...y})});IK.displayName="SimpleGrid";function rAe(e){return typeof e=="number"?`${e}px`:e}function iAe(e,i){return bC(e,a=>{const l=jhe("sizes",a,rAe(a))(i);return a===null?null:`repeat(auto-fit, minmax(${l}, 1fr))`})}function oAe(e){return bC(e,i=>i===null?null:`repeat(${i}, minmax(0, 1fr))`)}var Mc=je("div",{baseStyle:{flex:1,justifySelf:"stretch",alignSelf:"stretch"}});Mc.displayName="Spacer";var Pt=$e(function(i,a){const l=Ka("Text",i),{className:u,align:p,decoration:m,casing:v,...y}=ar(i),S=ID({textAlign:i.align,textDecoration:i.decoration,textTransform:i.casing});return b.jsx(je.p,{ref:a,className:ot("chakra-text",i.className),...S,...y,__css:l})});Pt.displayName="Text";var AK=e=>b.jsx(je.div,{className:"chakra-stack__item",...e,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...e.__css}});AK.displayName="StackItem";function sAe(e){const{spacing:i,direction:a}=e,l={column:{my:i,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:i,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:i,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:i,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":bC(a,u=>l[u])}}var CC=$e((e,i)=>{const{isInline:a,direction:l,align:u,justify:p,spacing:m="0.5rem",wrap:v,children:y,divider:S,className:C,shouldWrapChildren:R,...N}=e,x=a?"row":l??"column",U=F.useMemo(()=>sAe({spacing:m,direction:x}),[m,x]),M=!!S,z=!R&&!M,V=F.useMemo(()=>{const H=fx(y);return z?H:H.map((q,ee)=>{const oe=typeof q.key<"u"?q.key:ee,se=ee+1===H.length,me=R?b.jsx(AK,{children:q},oe):q;if(!M)return me;const pe=F.cloneElement(S,{__css:U}),Re=se?null:pe;return b.jsxs(F.Fragment,{children:[me,Re]},oe)})},[S,U,M,z,R,y]),W=ot("chakra-stack",C);return b.jsx(je.div,{ref:i,display:"flex",alignItems:u,justifyContent:p,flexDirection:x,flexWrap:v,gap:M?void 0:m,className:W,...N,children:V})});CC.displayName="Stack";function FW(e){return bC(e,i=>i==="auto"?"auto":`span ${i}/span ${i}`)}var Hv=$e(function(i,a){const{area:l,colSpan:u,colStart:p,colEnd:m,rowEnd:v,rowSpan:y,rowStart:S,...C}=i,R=ID({gridArea:l,gridColumn:FW(u),gridRow:FW(y),gridColumnStart:p,gridColumnEnd:m,gridRowStart:S,gridRowEnd:v});return b.jsx(je.div,{ref:a,__css:R,...C})});Hv.displayName="GridItem";var yt=$e(function(i,a){const l=Ka("Heading",i),{className:u,...p}=ar(i);return b.jsx(je.h2,{ref:a,className:ot("chakra-heading",i.className),...p,__css:l})});yt.displayName="Heading";var Pe=je("div");Pe.displayName="Box";var OK=$e(function(i,a){const{size:l,centerContent:u=!0,...p}=i,m=u?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return b.jsx(Pe,{ref:a,boxSize:l,__css:{...m,flexShrink:0,flexGrow:0},...p})});OK.displayName="Square";var aAe=$e(function(i,a){const{size:l,...u}=i;return b.jsx(OK,{size:l,ref:a,borderRadius:"9999px",...u})});aAe.displayName="Circle";var Tm=$e(function(i,a){const l=Ka("Badge",i),{className:u,...p}=ar(i);return b.jsx(je.span,{ref:a,className:ot("chakra-badge",i.className),...p,__css:{display:"inline-block",whiteSpace:"nowrap",verticalAlign:"middle",...l}})});Tm.displayName="Badge";var Rs=je("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});Rs.displayName="Center";var cAe={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};$e(function(i,a){const{axis:l="both",...u}=i;return b.jsx(je.div,{ref:a,__css:cAe[l],...u,position:"absolute"})});var mo=$e(function(i,a){const{borderLeftWidth:l,borderBottomWidth:u,borderTopWidth:p,borderRightWidth:m,borderWidth:v,borderStyle:y,borderColor:S,...C}=Ka("Divider",i),{className:R,orientation:N="horizontal",__css:x,...U}=ar(i),M={vertical:{borderLeftWidth:l||m||v||"1px",height:"100%"},horizontal:{borderBottomWidth:u||p||v||"1px",width:"100%"}};return b.jsx(je.hr,{ref:a,"aria-orientation":N,...U,__css:{...C,border:"0",borderColor:S,borderStyle:y,...M[N],...x},className:ot("chakra-divider",R)})});mo.displayName="Divider";var sr=$e(function(i,a){const{direction:l,align:u,justify:p,wrap:m,basis:v,grow:y,shrink:S,...C}=i,R={display:"flex",flexDirection:l,alignItems:u,justifyContent:p,flexWrap:m,flexBasis:v,flexGrow:y,flexShrink:S};return b.jsx(je.div,{ref:a,__css:R,...C})});sr.displayName="Flex";function lAe(e,i={}){const{ssr:a=!0,fallback:l}=i,{getWindow:u}=h0e(),p=Array.isArray(e)?e:[e];let m=Array.isArray(l)?l:[l];m=m.filter(S=>S!=null);const[v,y]=F.useState(()=>p.map((S,C)=>({media:S,matches:a?!!m[C]:u().matchMedia(S).matches})));return F.useEffect(()=>{const S=u();y(p.map(N=>({media:N,matches:S.matchMedia(N).matches})));const C=p.map(N=>S.matchMedia(N)),R=N=>{y(x=>x.slice().map(U=>U.media===N.media?{...U,matches:N.matches}:U))};return C.forEach(N=>{typeof N.addListener=="function"?N.addListener(R):N.addEventListener("change",R)}),()=>{C.forEach(N=>{typeof N.removeListener=="function"?N.removeListener(R):N.removeEventListener("change",R)})}},[u]),v.map(S=>S.matches)}function dAe(e,i,a=RK){let l=Object.keys(e).indexOf(i);if(l!==-1)return e[i];let u=a.indexOf(i);for(;u>=0;){const p=a[u];if(e.hasOwnProperty(p)){l=u;break}u-=1}if(l!==-1){const p=a[l];return e[p]}}function uAe(e){var i,a;const l=go(e)?e:{fallback:e??"base"},p=Bh().__breakpoints.details.map(({minMaxQuery:S,breakpoint:C})=>({breakpoint:C,query:S.replace("@media screen and ","")})),m=p.map(S=>S.breakpoint===l.fallback),y=lAe(p.map(S=>S.query),{fallback:m,ssr:l.ssr}).findIndex(S=>S==!0);return(a=(i=p[y])==null?void 0:i.breakpoint)!=null?a:l.fallback}function Lo(e,i){var a;const l=go(i)?i:{fallback:"base"},u=uAe(l),p=Bh();if(!u)return;const m=Array.from(((a=p.__breakpoints)==null?void 0:a.keys)||[]),v=Array.isArray(e)?Object.fromEntries(Object.entries(nAe(e,m)).map(([y,S])=>[y,S])):e;return dAe(v,u,m)}function hAe(e){const{key:i}=e;return i.length===1||i.length>1&&/[^a-zA-Z0-9]/.test(i)}function pAe(e={}){const{timeout:i=300,preventDefault:a=()=>!0}=e,[l,u]=F.useState([]),p=F.useRef(),m=()=>{p.current&&(clearTimeout(p.current),p.current=null)},v=()=>{m(),p.current=setTimeout(()=>{u([]),p.current=null},i)};F.useEffect(()=>m,[]);function y(S){return C=>{if(C.key==="Backspace"){const R=[...l];R.pop(),u(R);return}if(hAe(C)){const R=l.concat(C.key);a(C)&&(C.preventDefault(),C.stopPropagation()),u(R),S(R.join("")),v()}}}return y}function fAe(e,i,a,l){if(i==null)return l;if(!l)return e.find(m=>a(m).toLowerCase().startsWith(i.toLowerCase()));const u=e.filter(p=>a(p).toLowerCase().startsWith(i.toLowerCase()));if(u.length>0){let p;return u.includes(l)?(p=u.indexOf(l)+1,p===u.length&&(p=0),u[p]):(p=e.indexOf(u[0]),e[p])}return l}function mAe(){const e=F.useRef(new Map),i=e.current,a=F.useCallback((u,p,m,v)=>{e.current.set(m,{type:p,el:u,options:v}),u.addEventListener(p,m,v)},[]),l=F.useCallback((u,p,m,v)=>{u.removeEventListener(p,m,v),e.current.delete(m)},[]);return F.useEffect(()=>()=>{i.forEach((u,p)=>{l(u.el,u.type,p,u.options)})},[l,i]),{add:a,remove:l}}function $O(e){const i=e.target,{tagName:a,isContentEditable:l}=i;return a!=="INPUT"&&a!=="TEXTAREA"&&l!==!0}function NK(e={}){const{ref:i,isDisabled:a,isFocusable:l,clickOnEnter:u=!0,clickOnSpace:p=!0,onMouseDown:m,onMouseUp:v,onClick:y,onKeyDown:S,onKeyUp:C,tabIndex:R,onMouseOver:N,onMouseLeave:x,...U}=e,[M,z]=F.useState(!0),[V,W]=F.useState(!1),H=mAe(),q=de=>{de&&de.tagName!=="BUTTON"&&z(!1)},ee=M?R:R||0,oe=a&&!l,se=F.useCallback(de=>{if(a){de.stopPropagation(),de.preventDefault();return}de.currentTarget.focus(),y==null||y(de)},[a,y]),re=F.useCallback(de=>{V&&$O(de)&&(de.preventDefault(),de.stopPropagation(),W(!1),H.remove(document,"keyup",re,!1))},[V,H]),me=F.useCallback(de=>{if(S==null||S(de),a||de.defaultPrevented||de.metaKey||!$O(de.nativeEvent)||M)return;const ue=u&&de.key==="Enter";p&&de.key===" "&&(de.preventDefault(),W(!0)),ue&&(de.preventDefault(),de.currentTarget.click()),H.add(document,"keyup",re,!1)},[a,M,S,u,p,H,re]),pe=F.useCallback(de=>{if(C==null||C(de),a||de.defaultPrevented||de.metaKey||!$O(de.nativeEvent)||M)return;p&&de.key===" "&&(de.preventDefault(),W(!1),de.currentTarget.click())},[p,M,a,C]),Re=F.useCallback(de=>{de.button===0&&(W(!1),H.remove(document,"mouseup",Re,!1))},[H]),Ze=F.useCallback(de=>{if(de.button!==0)return;if(a){de.stopPropagation(),de.preventDefault();return}M||W(!0),de.currentTarget.focus({preventScroll:!0}),H.add(document,"mouseup",Re,!1),m==null||m(de)},[a,M,m,H,Re]),Qe=F.useCallback(de=>{de.button===0&&(M||W(!1),v==null||v(de))},[v,M]),Oe=F.useCallback(de=>{if(a){de.preventDefault();return}N==null||N(de)},[a,N]),Ie=F.useCallback(de=>{V&&(de.preventDefault(),W(!1)),x==null||x(de)},[V,x]),Te=yi(i,q);return M?{...U,ref:Te,type:"button","aria-disabled":oe?void 0:a,disabled:oe,onClick:se,onMouseDown:m,onMouseUp:v,onKeyUp:C,onKeyDown:S,onMouseOver:N,onMouseLeave:x}:{...U,ref:Te,role:"button","data-active":Tt(V),"aria-disabled":a?"true":void 0,tabIndex:oe?void 0:ee,onClick:se,onMouseDown:Ze,onMouseUp:Qe,onKeyUp:pe,onKeyDown:me,onMouseOver:Oe,onMouseLeave:Ie}}function gAe(e){const i=e.current;if(!i)return!1;const a=jIe(i);return!a||i.contains(a)?!1:!!GIe(a)}function _Ae(e,i){const{shouldFocus:a,visible:l,focusRef:u}=i,p=a&&!l;Nh(()=>{if(!p||gAe(e))return;const m=(u==null?void 0:u.current)||e.current;let v;if(m)return v=requestAnimationFrame(()=>{m.focus({preventScroll:!0})}),()=>{cancelAnimationFrame(v)}},[p,e,u])}var uf=(e,i)=>({var:e,varRef:i?`var(${e}, ${i})`:`var(${e})`}),Ki={arrowShadowColor:uf("--popper-arrow-shadow-color"),arrowSize:uf("--popper-arrow-size","8px"),arrowSizeHalf:uf("--popper-arrow-size-half"),arrowBg:uf("--popper-arrow-bg"),transformOrigin:uf("--popper-transform-origin"),arrowOffset:uf("--popper-arrow-offset")};function vAe(e){if(e.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(e.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(e.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(e.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}var EAe={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},yAe=e=>EAe[e],VW={scroll:!0,resize:!0};function SAe(e){let i;return typeof e=="object"?i={enabled:!0,options:{...VW,...e}}:i={enabled:e,options:VW},i}var TAe={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:e})=>{e.styles.popper.width=`${e.rects.reference.width}px`},effect:({state:e})=>()=>{const i=e.elements.reference;e.elements.popper.style.width=`${i.offsetWidth}px`}},bAe={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:e})=>{BW(e)},effect:({state:e})=>()=>{BW(e)}},BW=e=>{e.elements.popper.style.setProperty(Ki.transformOrigin.var,yAe(e.placement))},CAe={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:e})=>{wAe(e)}},wAe=e=>{var i;if(!e.placement)return;const a=RAe(e.placement);if((i=e.elements)!=null&&i.arrow&&a){Object.assign(e.elements.arrow.style,{[a.property]:a.value,width:Ki.arrowSize.varRef,height:Ki.arrowSize.varRef,zIndex:-1});const l={[Ki.arrowSizeHalf.var]:`calc(${Ki.arrowSize.varRef} / 2 - 1px)`,[Ki.arrowOffset.var]:`calc(${Ki.arrowSizeHalf.varRef} * -1)`};for(const u in l)e.elements.arrow.style.setProperty(u,l[u])}},RAe=e=>{if(e.startsWith("top"))return{property:"bottom",value:Ki.arrowOffset.varRef};if(e.startsWith("bottom"))return{property:"top",value:Ki.arrowOffset.varRef};if(e.startsWith("left"))return{property:"right",value:Ki.arrowOffset.varRef};if(e.startsWith("right"))return{property:"left",value:Ki.arrowOffset.varRef}},IAe={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:e})=>{WW(e)},effect:({state:e})=>()=>{WW(e)}},WW=e=>{if(!e.elements.arrow)return;const i=e.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!i)return;const a=vAe(e.placement);a&&i.style.setProperty("--popper-arrow-default-shadow",a),Object.assign(i.style,{transform:"rotate(45deg)",background:Ki.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},AAe={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},OAe={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function NAe(e,i="ltr"){var a,l;const u=((a=AAe[e])==null?void 0:a[i])||e;return i==="ltr"?u:(l=OAe[e])!=null?l:u}var as="top",Sa="bottom",Ta="right",cs="left",Px="auto",hE=[as,Sa,Ta,cs],bm="start",$v="end",PAe="clippingParents",PK="viewport",O_="popper",kAe="reference",zW=hE.reduce(function(e,i){return e.concat([i+"-"+bm,i+"-"+$v])},[]),kK=[].concat(hE,[Px]).reduce(function(e,i){return e.concat([i,i+"-"+bm,i+"-"+$v])},[]),DAe="beforeRead",xAe="read",LAe="afterRead",MAe="beforeMain",UAe="main",jAe="afterMain",FAe="beforeWrite",VAe="write",BAe="afterWrite",WAe=[DAe,xAe,LAe,MAe,UAe,jAe,FAe,VAe,BAe];function xc(e){return e?(e.nodeName||"").toLowerCase():null}function Ls(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var i=e.ownerDocument;return i&&i.defaultView||window}return e}function Dh(e){var i=Ls(e).Element;return e instanceof i||e instanceof Element}function ga(e){var i=Ls(e).HTMLElement;return e instanceof i||e instanceof HTMLElement}function kx(e){if(typeof ShadowRoot>"u")return!1;var i=Ls(e).ShadowRoot;return e instanceof i||e instanceof ShadowRoot}function zAe(e){var i=e.state;Object.keys(i.elements).forEach(function(a){var l=i.styles[a]||{},u=i.attributes[a]||{},p=i.elements[a];!ga(p)||!xc(p)||(Object.assign(p.style,l),Object.keys(u).forEach(function(m){var v=u[m];v===!1?p.removeAttribute(m):p.setAttribute(m,v===!0?"":v)}))})}function GAe(e){var i=e.state,a={popper:{position:i.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(i.elements.popper.style,a.popper),i.styles=a,i.elements.arrow&&Object.assign(i.elements.arrow.style,a.arrow),function(){Object.keys(i.elements).forEach(function(l){var u=i.elements[l],p=i.attributes[l]||{},m=Object.keys(i.styles.hasOwnProperty(l)?i.styles[l]:a[l]),v=m.reduce(function(y,S){return y[S]="",y},{});!ga(u)||!xc(u)||(Object.assign(u.style,v),Object.keys(p).forEach(function(y){u.removeAttribute(y)}))})}}const HAe={name:"applyStyles",enabled:!0,phase:"write",fn:zAe,effect:GAe,requires:["computeStyles"]};function kc(e){return e.split("-")[0]}var Th=Math.max,Sb=Math.min,Cm=Math.round;function qP(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(i){return i.brand+"/"+i.version}).join(" "):navigator.userAgent}function DK(){return!/^((?!chrome|android).)*safari/i.test(qP())}function wm(e,i,a){i===void 0&&(i=!1),a===void 0&&(a=!1);var l=e.getBoundingClientRect(),u=1,p=1;i&&ga(e)&&(u=e.offsetWidth>0&&Cm(l.width)/e.offsetWidth||1,p=e.offsetHeight>0&&Cm(l.height)/e.offsetHeight||1);var m=Dh(e)?Ls(e):window,v=m.visualViewport,y=!DK()&&a,S=(l.left+(y&&v?v.offsetLeft:0))/u,C=(l.top+(y&&v?v.offsetTop:0))/p,R=l.width/u,N=l.height/p;return{width:R,height:N,top:C,right:S+R,bottom:C+N,left:S,x:S,y:C}}function Dx(e){var i=wm(e),a=e.offsetWidth,l=e.offsetHeight;return Math.abs(i.width-a)<=1&&(a=i.width),Math.abs(i.height-l)<=1&&(l=i.height),{x:e.offsetLeft,y:e.offsetTop,width:a,height:l}}function xK(e,i){var a=i.getRootNode&&i.getRootNode();if(e.contains(i))return!0;if(a&&kx(a)){var l=i;do{if(l&&e.isSameNode(l))return!0;l=l.parentNode||l.host}while(l)}return!1}function xl(e){return Ls(e).getComputedStyle(e)}function $Ae(e){return["table","td","th"].indexOf(xc(e))>=0}function mu(e){return((Dh(e)?e.ownerDocument:e.document)||window.document).documentElement}function wC(e){return xc(e)==="html"?e:e.assignedSlot||e.parentNode||(kx(e)?e.host:null)||mu(e)}function GW(e){return!ga(e)||xl(e).position==="fixed"?null:e.offsetParent}function KAe(e){var i=/firefox/i.test(qP()),a=/Trident/i.test(qP());if(a&&ga(e)){var l=xl(e);if(l.position==="fixed")return null}var u=wC(e);for(kx(u)&&(u=u.host);ga(u)&&["html","body"].indexOf(xc(u))<0;){var p=xl(u);if(p.transform!=="none"||p.perspective!=="none"||p.contain==="paint"||["transform","perspective"].indexOf(p.willChange)!==-1||i&&p.willChange==="filter"||i&&p.filter&&p.filter!=="none")return u;u=u.parentNode}return null}function pE(e){for(var i=Ls(e),a=GW(e);a&&$Ae(a)&&xl(a).position==="static";)a=GW(a);return a&&(xc(a)==="html"||xc(a)==="body"&&xl(a).position==="static")?i:a||KAe(e)||i}function xx(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function dv(e,i,a){return Th(e,Sb(i,a))}function YAe(e,i,a){var l=dv(e,i,a);return l>a?a:l}function LK(){return{top:0,right:0,bottom:0,left:0}}function MK(e){return Object.assign({},LK(),e)}function UK(e,i){return i.reduce(function(a,l){return a[l]=e,a},{})}var qAe=function(i,a){return i=typeof i=="function"?i(Object.assign({},a.rects,{placement:a.placement})):i,MK(typeof i!="number"?i:UK(i,hE))};function JAe(e){var i,a=e.state,l=e.name,u=e.options,p=a.elements.arrow,m=a.modifiersData.popperOffsets,v=kc(a.placement),y=xx(v),S=[cs,Ta].indexOf(v)>=0,C=S?"height":"width";if(!(!p||!m)){var R=qAe(u.padding,a),N=Dx(p),x=y==="y"?as:cs,U=y==="y"?Sa:Ta,M=a.rects.reference[C]+a.rects.reference[y]-m[y]-a.rects.popper[C],z=m[y]-a.rects.reference[y],V=pE(p),W=V?y==="y"?V.clientHeight||0:V.clientWidth||0:0,H=M/2-z/2,q=R[x],ee=W-N[C]-R[U],oe=W/2-N[C]/2+H,se=dv(q,oe,ee),re=y;a.modifiersData[l]=(i={},i[re]=se,i.centerOffset=se-oe,i)}}function XAe(e){var i=e.state,a=e.options,l=a.element,u=l===void 0?"[data-popper-arrow]":l;u!=null&&(typeof u=="string"&&(u=i.elements.popper.querySelector(u),!u)||xK(i.elements.popper,u)&&(i.elements.arrow=u))}const QAe={name:"arrow",enabled:!0,phase:"main",fn:JAe,effect:XAe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Rm(e){return e.split("-")[1]}var ZAe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function e1e(e,i){var a=e.x,l=e.y,u=i.devicePixelRatio||1;return{x:Cm(a*u)/u||0,y:Cm(l*u)/u||0}}function HW(e){var i,a=e.popper,l=e.popperRect,u=e.placement,p=e.variation,m=e.offsets,v=e.position,y=e.gpuAcceleration,S=e.adaptive,C=e.roundOffsets,R=e.isFixed,N=m.x,x=N===void 0?0:N,U=m.y,M=U===void 0?0:U,z=typeof C=="function"?C({x,y:M}):{x,y:M};x=z.x,M=z.y;var V=m.hasOwnProperty("x"),W=m.hasOwnProperty("y"),H=cs,q=as,ee=window;if(S){var oe=pE(a),se="clientHeight",re="clientWidth";if(oe===Ls(a)&&(oe=mu(a),xl(oe).position!=="static"&&v==="absolute"&&(se="scrollHeight",re="scrollWidth")),oe=oe,u===as||(u===cs||u===Ta)&&p===$v){q=Sa;var me=R&&oe===ee&&ee.visualViewport?ee.visualViewport.height:oe[se];M-=me-l.height,M*=y?1:-1}if(u===cs||(u===as||u===Sa)&&p===$v){H=Ta;var pe=R&&oe===ee&&ee.visualViewport?ee.visualViewport.width:oe[re];x-=pe-l.width,x*=y?1:-1}}var Re=Object.assign({position:v},S&&ZAe),Ze=C===!0?e1e({x,y:M},Ls(a)):{x,y:M};if(x=Ze.x,M=Ze.y,y){var Qe;return Object.assign({},Re,(Qe={},Qe[q]=W?"0":"",Qe[H]=V?"0":"",Qe.transform=(ee.devicePixelRatio||1)<=1?"translate("+x+"px, "+M+"px)":"translate3d("+x+"px, "+M+"px, 0)",Qe))}return Object.assign({},Re,(i={},i[q]=W?M+"px":"",i[H]=V?x+"px":"",i.transform="",i))}function t1e(e){var i=e.state,a=e.options,l=a.gpuAcceleration,u=l===void 0?!0:l,p=a.adaptive,m=p===void 0?!0:p,v=a.roundOffsets,y=v===void 0?!0:v,S={placement:kc(i.placement),variation:Rm(i.placement),popper:i.elements.popper,popperRect:i.rects.popper,gpuAcceleration:u,isFixed:i.options.strategy==="fixed"};i.modifiersData.popperOffsets!=null&&(i.styles.popper=Object.assign({},i.styles.popper,HW(Object.assign({},S,{offsets:i.modifiersData.popperOffsets,position:i.options.strategy,adaptive:m,roundOffsets:y})))),i.modifiersData.arrow!=null&&(i.styles.arrow=Object.assign({},i.styles.arrow,HW(Object.assign({},S,{offsets:i.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:y})))),i.attributes.popper=Object.assign({},i.attributes.popper,{"data-popper-placement":i.placement})}const n1e={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:t1e,data:{}};var VS={passive:!0};function r1e(e){var i=e.state,a=e.instance,l=e.options,u=l.scroll,p=u===void 0?!0:u,m=l.resize,v=m===void 0?!0:m,y=Ls(i.elements.popper),S=[].concat(i.scrollParents.reference,i.scrollParents.popper);return p&&S.forEach(function(C){C.addEventListener("scroll",a.update,VS)}),v&&y.addEventListener("resize",a.update,VS),function(){p&&S.forEach(function(C){C.removeEventListener("scroll",a.update,VS)}),v&&y.removeEventListener("resize",a.update,VS)}}const i1e={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:r1e,data:{}};var o1e={left:"right",right:"left",bottom:"top",top:"bottom"};function CT(e){return e.replace(/left|right|bottom|top/g,function(i){return o1e[i]})}var s1e={start:"end",end:"start"};function $W(e){return e.replace(/start|end/g,function(i){return s1e[i]})}function Lx(e){var i=Ls(e),a=i.pageXOffset,l=i.pageYOffset;return{scrollLeft:a,scrollTop:l}}function Mx(e){return wm(mu(e)).left+Lx(e).scrollLeft}function a1e(e,i){var a=Ls(e),l=mu(e),u=a.visualViewport,p=l.clientWidth,m=l.clientHeight,v=0,y=0;if(u){p=u.width,m=u.height;var S=DK();(S||!S&&i==="fixed")&&(v=u.offsetLeft,y=u.offsetTop)}return{width:p,height:m,x:v+Mx(e),y}}function c1e(e){var i,a=mu(e),l=Lx(e),u=(i=e.ownerDocument)==null?void 0:i.body,p=Th(a.scrollWidth,a.clientWidth,u?u.scrollWidth:0,u?u.clientWidth:0),m=Th(a.scrollHeight,a.clientHeight,u?u.scrollHeight:0,u?u.clientHeight:0),v=-l.scrollLeft+Mx(e),y=-l.scrollTop;return xl(u||a).direction==="rtl"&&(v+=Th(a.clientWidth,u?u.clientWidth:0)-p),{width:p,height:m,x:v,y}}function Ux(e){var i=xl(e),a=i.overflow,l=i.overflowX,u=i.overflowY;return/auto|scroll|overlay|hidden/.test(a+u+l)}function jK(e){return["html","body","#document"].indexOf(xc(e))>=0?e.ownerDocument.body:ga(e)&&Ux(e)?e:jK(wC(e))}function uv(e,i){var a;i===void 0&&(i=[]);var l=jK(e),u=l===((a=e.ownerDocument)==null?void 0:a.body),p=Ls(l),m=u?[p].concat(p.visualViewport||[],Ux(l)?l:[]):l,v=i.concat(m);return u?v:v.concat(uv(wC(m)))}function JP(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function l1e(e,i){var a=wm(e,!1,i==="fixed");return a.top=a.top+e.clientTop,a.left=a.left+e.clientLeft,a.bottom=a.top+e.clientHeight,a.right=a.left+e.clientWidth,a.width=e.clientWidth,a.height=e.clientHeight,a.x=a.left,a.y=a.top,a}function KW(e,i,a){return i===PK?JP(a1e(e,a)):Dh(i)?l1e(i,a):JP(c1e(mu(e)))}function d1e(e){var i=uv(wC(e)),a=["absolute","fixed"].indexOf(xl(e).position)>=0,l=a&&ga(e)?pE(e):e;return Dh(l)?i.filter(function(u){return Dh(u)&&xK(u,l)&&xc(u)!=="body"}):[]}function u1e(e,i,a,l){var u=i==="clippingParents"?d1e(e):[].concat(i),p=[].concat(u,[a]),m=p[0],v=p.reduce(function(y,S){var C=KW(e,S,l);return y.top=Th(C.top,y.top),y.right=Sb(C.right,y.right),y.bottom=Sb(C.bottom,y.bottom),y.left=Th(C.left,y.left),y},KW(e,m,l));return v.width=v.right-v.left,v.height=v.bottom-v.top,v.x=v.left,v.y=v.top,v}function FK(e){var i=e.reference,a=e.element,l=e.placement,u=l?kc(l):null,p=l?Rm(l):null,m=i.x+i.width/2-a.width/2,v=i.y+i.height/2-a.height/2,y;switch(u){case as:y={x:m,y:i.y-a.height};break;case Sa:y={x:m,y:i.y+i.height};break;case Ta:y={x:i.x+i.width,y:v};break;case cs:y={x:i.x-a.width,y:v};break;default:y={x:i.x,y:i.y}}var S=u?xx(u):null;if(S!=null){var C=S==="y"?"height":"width";switch(p){case bm:y[S]=y[S]-(i[C]/2-a[C]/2);break;case $v:y[S]=y[S]+(i[C]/2-a[C]/2);break}}return y}function Kv(e,i){i===void 0&&(i={});var a=i,l=a.placement,u=l===void 0?e.placement:l,p=a.strategy,m=p===void 0?e.strategy:p,v=a.boundary,y=v===void 0?PAe:v,S=a.rootBoundary,C=S===void 0?PK:S,R=a.elementContext,N=R===void 0?O_:R,x=a.altBoundary,U=x===void 0?!1:x,M=a.padding,z=M===void 0?0:M,V=MK(typeof z!="number"?z:UK(z,hE)),W=N===O_?kAe:O_,H=e.rects.popper,q=e.elements[U?W:N],ee=u1e(Dh(q)?q:q.contextElement||mu(e.elements.popper),y,C,m),oe=wm(e.elements.reference),se=FK({reference:oe,element:H,strategy:"absolute",placement:u}),re=JP(Object.assign({},H,se)),me=N===O_?re:oe,pe={top:ee.top-me.top+V.top,bottom:me.bottom-ee.bottom+V.bottom,left:ee.left-me.left+V.left,right:me.right-ee.right+V.right},Re=e.modifiersData.offset;if(N===O_&&Re){var Ze=Re[u];Object.keys(pe).forEach(function(Qe){var Oe=[Ta,Sa].indexOf(Qe)>=0?1:-1,Ie=[as,Sa].indexOf(Qe)>=0?"y":"x";pe[Qe]+=Ze[Ie]*Oe})}return pe}function h1e(e,i){i===void 0&&(i={});var a=i,l=a.placement,u=a.boundary,p=a.rootBoundary,m=a.padding,v=a.flipVariations,y=a.allowedAutoPlacements,S=y===void 0?kK:y,C=Rm(l),R=C?v?zW:zW.filter(function(U){return Rm(U)===C}):hE,N=R.filter(function(U){return S.indexOf(U)>=0});N.length===0&&(N=R);var x=N.reduce(function(U,M){return U[M]=Kv(e,{placement:M,boundary:u,rootBoundary:p,padding:m})[kc(M)],U},{});return Object.keys(x).sort(function(U,M){return x[U]-x[M]})}function p1e(e){if(kc(e)===Px)return[];var i=CT(e);return[$W(e),i,$W(i)]}function f1e(e){var i=e.state,a=e.options,l=e.name;if(!i.modifiersData[l]._skip){for(var u=a.mainAxis,p=u===void 0?!0:u,m=a.altAxis,v=m===void 0?!0:m,y=a.fallbackPlacements,S=a.padding,C=a.boundary,R=a.rootBoundary,N=a.altBoundary,x=a.flipVariations,U=x===void 0?!0:x,M=a.allowedAutoPlacements,z=i.options.placement,V=kc(z),W=V===z,H=y||(W||!U?[CT(z)]:p1e(z)),q=[z].concat(H).reduce(function(Ge,_t){return Ge.concat(kc(_t)===Px?h1e(i,{placement:_t,boundary:C,rootBoundary:R,padding:S,flipVariations:U,allowedAutoPlacements:M}):_t)},[]),ee=i.rects.reference,oe=i.rects.popper,se=new Map,re=!0,me=q[0],pe=0;pe<q.length;pe++){var Re=q[pe],Ze=kc(Re),Qe=Rm(Re)===bm,Oe=[as,Sa].indexOf(Ze)>=0,Ie=Oe?"width":"height",Te=Kv(i,{placement:Re,boundary:C,rootBoundary:R,altBoundary:N,padding:S}),de=Oe?Qe?Ta:cs:Qe?Sa:as;ee[Ie]>oe[Ie]&&(de=CT(de));var ue=CT(de),be=[];if(p&&be.push(Te[Ze]<=0),v&&be.push(Te[de]<=0,Te[ue]<=0),be.every(function(Ge){return Ge})){me=Re,re=!1;break}se.set(Re,be)}if(re)for(var xe=U?3:1,He=function(_t){var kt=q.find(function(sn){var cn=se.get(sn);if(cn)return cn.slice(0,_t).every(function(Gn){return Gn})});if(kt)return me=kt,"break"},rt=xe;rt>0;rt--){var Ye=He(rt);if(Ye==="break")break}i.placement!==me&&(i.modifiersData[l]._skip=!0,i.placement=me,i.reset=!0)}}const m1e={name:"flip",enabled:!0,phase:"main",fn:f1e,requiresIfExists:["offset"],data:{_skip:!1}};function YW(e,i,a){return a===void 0&&(a={x:0,y:0}),{top:e.top-i.height-a.y,right:e.right-i.width+a.x,bottom:e.bottom-i.height+a.y,left:e.left-i.width-a.x}}function qW(e){return[as,Ta,Sa,cs].some(function(i){return e[i]>=0})}function g1e(e){var i=e.state,a=e.name,l=i.rects.reference,u=i.rects.popper,p=i.modifiersData.preventOverflow,m=Kv(i,{elementContext:"reference"}),v=Kv(i,{altBoundary:!0}),y=YW(m,l),S=YW(v,u,p),C=qW(y),R=qW(S);i.modifiersData[a]={referenceClippingOffsets:y,popperEscapeOffsets:S,isReferenceHidden:C,hasPopperEscaped:R},i.attributes.popper=Object.assign({},i.attributes.popper,{"data-popper-reference-hidden":C,"data-popper-escaped":R})}const _1e={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:g1e};function v1e(e,i,a){var l=kc(e),u=[cs,as].indexOf(l)>=0?-1:1,p=typeof a=="function"?a(Object.assign({},i,{placement:e})):a,m=p[0],v=p[1];return m=m||0,v=(v||0)*u,[cs,Ta].indexOf(l)>=0?{x:v,y:m}:{x:m,y:v}}function E1e(e){var i=e.state,a=e.options,l=e.name,u=a.offset,p=u===void 0?[0,0]:u,m=kK.reduce(function(C,R){return C[R]=v1e(R,i.rects,p),C},{}),v=m[i.placement],y=v.x,S=v.y;i.modifiersData.popperOffsets!=null&&(i.modifiersData.popperOffsets.x+=y,i.modifiersData.popperOffsets.y+=S),i.modifiersData[l]=m}const y1e={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:E1e};function S1e(e){var i=e.state,a=e.name;i.modifiersData[a]=FK({reference:i.rects.reference,element:i.rects.popper,strategy:"absolute",placement:i.placement})}const T1e={name:"popperOffsets",enabled:!0,phase:"read",fn:S1e,data:{}};function b1e(e){return e==="x"?"y":"x"}function C1e(e){var i=e.state,a=e.options,l=e.name,u=a.mainAxis,p=u===void 0?!0:u,m=a.altAxis,v=m===void 0?!1:m,y=a.boundary,S=a.rootBoundary,C=a.altBoundary,R=a.padding,N=a.tether,x=N===void 0?!0:N,U=a.tetherOffset,M=U===void 0?0:U,z=Kv(i,{boundary:y,rootBoundary:S,padding:R,altBoundary:C}),V=kc(i.placement),W=Rm(i.placement),H=!W,q=xx(V),ee=b1e(q),oe=i.modifiersData.popperOffsets,se=i.rects.reference,re=i.rects.popper,me=typeof M=="function"?M(Object.assign({},i.rects,{placement:i.placement})):M,pe=typeof me=="number"?{mainAxis:me,altAxis:me}:Object.assign({mainAxis:0,altAxis:0},me),Re=i.modifiersData.offset?i.modifiersData.offset[i.placement]:null,Ze={x:0,y:0};if(oe){if(p){var Qe,Oe=q==="y"?as:cs,Ie=q==="y"?Sa:Ta,Te=q==="y"?"height":"width",de=oe[q],ue=de+z[Oe],be=de-z[Ie],xe=x?-re[Te]/2:0,He=W===bm?se[Te]:re[Te],rt=W===bm?-re[Te]:-se[Te],Ye=i.elements.arrow,Ge=x&&Ye?Dx(Ye):{width:0,height:0},_t=i.modifiersData["arrow#persistent"]?i.modifiersData["arrow#persistent"].padding:LK(),kt=_t[Oe],sn=_t[Ie],cn=dv(0,se[Te],Ge[Te]),Gn=H?se[Te]/2-xe-cn-kt-pe.mainAxis:He-cn-kt-pe.mainAxis,vn=H?-se[Te]/2+xe+cn+sn+pe.mainAxis:rt+cn+sn+pe.mainAxis,St=i.elements.arrow&&pE(i.elements.arrow),bt=St?q==="y"?St.clientTop||0:St.clientLeft||0:0,Qn=(Qe=Re==null?void 0:Re[q])!=null?Qe:0,Hn=de+Gn-Qn-bt,Ct=de+vn-Qn,Cn=dv(x?Sb(ue,Hn):ue,de,x?Th(be,Ct):be);oe[q]=Cn,Ze[q]=Cn-de}if(v){var $n,on=q==="x"?as:cs,ji=q==="x"?Sa:Ta,ai=oe[ee],br=ee==="y"?"height":"width",Jr=ai+z[on],Oi=ai-z[ji],us=[as,cs].indexOf(V)!==-1,Fc=($n=Re==null?void 0:Re[ee])!=null?$n:0,Vc=us?Jr:ai-se[br]-re[br]-Fc+pe.altAxis,$r=us?ai+se[br]+re[br]-Fc-pe.altAxis:Oi,Fi=x&&us?YAe(Vc,ai,$r):dv(x?Vc:Jr,ai,x?$r:Oi);oe[ee]=Fi,Ze[ee]=Fi-ai}i.modifiersData[l]=Ze}}const w1e={name:"preventOverflow",enabled:!0,phase:"main",fn:C1e,requiresIfExists:["offset"]};function R1e(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function I1e(e){return e===Ls(e)||!ga(e)?Lx(e):R1e(e)}function A1e(e){var i=e.getBoundingClientRect(),a=Cm(i.width)/e.offsetWidth||1,l=Cm(i.height)/e.offsetHeight||1;return a!==1||l!==1}function O1e(e,i,a){a===void 0&&(a=!1);var l=ga(i),u=ga(i)&&A1e(i),p=mu(i),m=wm(e,u,a),v={scrollLeft:0,scrollTop:0},y={x:0,y:0};return(l||!l&&!a)&&((xc(i)!=="body"||Ux(p))&&(v=I1e(i)),ga(i)?(y=wm(i,!0),y.x+=i.clientLeft,y.y+=i.clientTop):p&&(y.x=Mx(p))),{x:m.left+v.scrollLeft-y.x,y:m.top+v.scrollTop-y.y,width:m.width,height:m.height}}function N1e(e){var i=new Map,a=new Set,l=[];e.forEach(function(p){i.set(p.name,p)});function u(p){a.add(p.name);var m=[].concat(p.requires||[],p.requiresIfExists||[]);m.forEach(function(v){if(!a.has(v)){var y=i.get(v);y&&u(y)}}),l.push(p)}return e.forEach(function(p){a.has(p.name)||u(p)}),l}function P1e(e){var i=N1e(e);return WAe.reduce(function(a,l){return a.concat(i.filter(function(u){return u.phase===l}))},[])}function k1e(e){var i;return function(){return i||(i=new Promise(function(a){Promise.resolve().then(function(){i=void 0,a(e())})})),i}}function D1e(e){var i=e.reduce(function(a,l){var u=a[l.name];return a[l.name]=u?Object.assign({},u,l,{options:Object.assign({},u.options,l.options),data:Object.assign({},u.data,l.data)}):l,a},{});return Object.keys(i).map(function(a){return i[a]})}var JW={placement:"bottom",modifiers:[],strategy:"absolute"};function XW(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return!i.some(function(l){return!(l&&typeof l.getBoundingClientRect=="function")})}function x1e(e){e===void 0&&(e={});var i=e,a=i.defaultModifiers,l=a===void 0?[]:a,u=i.defaultOptions,p=u===void 0?JW:u;return function(v,y,S){S===void 0&&(S=p);var C={placement:"bottom",orderedModifiers:[],options:Object.assign({},JW,p),modifiersData:{},elements:{reference:v,popper:y},attributes:{},styles:{}},R=[],N=!1,x={state:C,setOptions:function(V){var W=typeof V=="function"?V(C.options):V;M(),C.options=Object.assign({},p,C.options,W),C.scrollParents={reference:Dh(v)?uv(v):v.contextElement?uv(v.contextElement):[],popper:uv(y)};var H=P1e(D1e([].concat(l,C.options.modifiers)));return C.orderedModifiers=H.filter(function(q){return q.enabled}),U(),x.update()},forceUpdate:function(){if(!N){var V=C.elements,W=V.reference,H=V.popper;if(XW(W,H)){C.rects={reference:O1e(W,pE(H),C.options.strategy==="fixed"),popper:Dx(H)},C.reset=!1,C.placement=C.options.placement,C.orderedModifiers.forEach(function(pe){return C.modifiersData[pe.name]=Object.assign({},pe.data)});for(var q=0;q<C.orderedModifiers.length;q++){if(C.reset===!0){C.reset=!1,q=-1;continue}var ee=C.orderedModifiers[q],oe=ee.fn,se=ee.options,re=se===void 0?{}:se,me=ee.name;typeof oe=="function"&&(C=oe({state:C,options:re,name:me,instance:x})||C)}}}},update:k1e(function(){return new Promise(function(z){x.forceUpdate(),z(C)})}),destroy:function(){M(),N=!0}};if(!XW(v,y))return x;x.setOptions(S).then(function(z){!N&&S.onFirstUpdate&&S.onFirstUpdate(z)});function U(){C.orderedModifiers.forEach(function(z){var V=z.name,W=z.options,H=W===void 0?{}:W,q=z.effect;if(typeof q=="function"){var ee=q({state:C,name:V,instance:x,options:H}),oe=function(){};R.push(ee||oe)}})}function M(){R.forEach(function(z){return z()}),R=[]}return x}}var L1e=[i1e,T1e,n1e,HAe,y1e,m1e,w1e,QAe,_1e],M1e=x1e({defaultModifiers:L1e});function VK(e={}){const{enabled:i=!0,modifiers:a,placement:l="bottom",strategy:u="absolute",arrowPadding:p=8,eventListeners:m=!0,offset:v,gutter:y=8,flip:S=!0,boundary:C="clippingParents",preventOverflow:R=!0,matchWidth:N,direction:x="ltr"}=e,U=F.useRef(null),M=F.useRef(null),z=F.useRef(null),V=NAe(l,x),W=F.useRef(()=>{}),H=F.useCallback(()=>{var pe;!i||!U.current||!M.current||((pe=W.current)==null||pe.call(W),z.current=M1e(U.current,M.current,{placement:V,modifiers:[IAe,CAe,bAe,{...TAe,enabled:!!N},{name:"eventListeners",...SAe(m)},{name:"arrow",options:{padding:p}},{name:"offset",options:{offset:v??[0,y]}},{name:"flip",enabled:!!S,options:{padding:8}},{name:"preventOverflow",enabled:!!R,options:{boundary:C}},...a??[]],strategy:u}),z.current.forceUpdate(),W.current=z.current.destroy)},[V,i,a,N,m,p,v,y,S,R,C,u]);F.useEffect(()=>()=>{var pe;!U.current&&!M.current&&((pe=z.current)==null||pe.destroy(),z.current=null)},[]);const q=F.useCallback(pe=>{U.current=pe,H()},[H]),ee=F.useCallback((pe={},Re=null)=>({...pe,ref:yi(q,Re)}),[q]),oe=F.useCallback(pe=>{M.current=pe,H()},[H]),se=F.useCallback((pe={},Re=null)=>({...pe,ref:yi(oe,Re),style:{...pe.style,position:u,minWidth:N?void 0:"max-content",inset:"0 auto auto 0"}}),[u,oe,N]),re=F.useCallback((pe={},Re=null)=>{const{size:Ze,shadowColor:Qe,bg:Oe,style:Ie,...Te}=pe;return{...Te,ref:Re,"data-popper-arrow":"",style:U1e(pe)}},[]),me=F.useCallback((pe={},Re=null)=>({...pe,ref:Re,"data-popper-arrow-inner":""}),[]);return{update(){var pe;(pe=z.current)==null||pe.update()},forceUpdate(){var pe;(pe=z.current)==null||pe.forceUpdate()},transformOrigin:Ki.transformOrigin.varRef,referenceRef:q,popperRef:oe,getPopperProps:se,getArrowProps:re,getArrowInnerProps:me,getReferenceProps:ee}}function U1e(e){const{size:i,shadowColor:a,bg:l,style:u}=e,p={...u,position:"absolute"};return i&&(p["--popper-arrow-size"]=i),a&&(p["--popper-arrow-shadow-color"]=a),l&&(p["--popper-arrow-bg"]=l),p}function BK(e={}){const{onClose:i,onOpen:a,isOpen:l,id:u}=e,p=ss(a),m=ss(i),[v,y]=F.useState(e.defaultIsOpen||!1),S=l!==void 0?l:v,C=l!==void 0,R=F.useId(),N=u??`disclosure-${R}`,x=F.useCallback(()=>{C||y(!1),m==null||m()},[C,m]),U=F.useCallback(()=>{C||y(!0),p==null||p()},[C,p]),M=F.useCallback(()=>{S?x():U()},[S,U,x]);function z(W={}){return{...W,"aria-expanded":S,"aria-controls":N,onClick(H){var q;(q=W.onClick)==null||q.call(W,H),M()}}}function V(W={}){return{...W,hidden:!S,id:N}}return{isOpen:S,onOpen:U,onClose:x,onToggle:M,isControlled:C,getButtonProps:z,getDisclosureProps:V}}function j1e(e){const{ref:i,handler:a,enabled:l=!0}=e,u=ss(a),m=F.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;F.useEffect(()=>{if(!l)return;const v=R=>{KO(R,i)&&(m.isPointerDown=!0)},y=R=>{if(m.ignoreEmulatedMouseEvents){m.ignoreEmulatedMouseEvents=!1;return}m.isPointerDown&&a&&KO(R,i)&&(m.isPointerDown=!1,u(R))},S=R=>{m.ignoreEmulatedMouseEvents=!0,a&&m.isPointerDown&&KO(R,i)&&(m.isPointerDown=!1,u(R))},C=WK(i.current);return C.addEventListener("mousedown",v,!0),C.addEventListener("mouseup",y,!0),C.addEventListener("touchstart",v,!0),C.addEventListener("touchend",S,!0),()=>{C.removeEventListener("mousedown",v,!0),C.removeEventListener("mouseup",y,!0),C.removeEventListener("touchstart",v,!0),C.removeEventListener("touchend",S,!0)}},[a,i,u,m,l])}function KO(e,i){var a;const l=e.target;return l&&!WK(l).contains(l)?!1:!((a=i.current)!=null&&a.contains(l))}function WK(e){var i;return(i=e==null?void 0:e.ownerDocument)!=null?i:document}function F1e(e){const{isOpen:i,ref:a}=e,[l,u]=F.useState(i),[p,m]=F.useState(!1);return F.useEffect(()=>{p||(u(i),m(!0))},[i,p,l]),bT(()=>a.current,"animationend",()=>{u(i)}),{present:!(i?!1:!l),onComplete(){var y;const S=UIe(a.current),C=new S.CustomEvent("animationend",{bubbles:!0});(y=a.current)==null||y.dispatchEvent(C)}}}function zK(e){const{wasSelected:i,enabled:a,isSelected:l,mode:u="unmount"}=e;return!!(!a||l||u==="keepMounted"&&i)}var[V1e,B1e,W1e,z1e]=lx(),[G1e,fE]=zn({strict:!1,name:"MenuContext"});function H1e(e,...i){const a=F.useId(),l=e||a;return F.useMemo(()=>i.map(u=>`${u}-${l}`),[l,i])}function GK(e){var i;return(i=e==null?void 0:e.ownerDocument)!=null?i:document}function QW(e){return GK(e).activeElement===e}function $1e(e={}){const{id:i,closeOnSelect:a=!0,closeOnBlur:l=!0,initialFocusRef:u,autoSelect:p=!0,isLazy:m,isOpen:v,defaultIsOpen:y,onClose:S,onOpen:C,placement:R="bottom-start",lazyBehavior:N="unmount",direction:x,computePositionOnMount:U=!1,...M}=e,z=F.useRef(null),V=F.useRef(null),W=W1e(),H=F.useCallback(()=>{requestAnimationFrame(()=>{var Ye;(Ye=z.current)==null||Ye.focus({preventScroll:!1})})},[]),q=F.useCallback(()=>{const Ye=setTimeout(()=>{var Ge;if(u)(Ge=u.current)==null||Ge.focus();else{const _t=W.firstEnabled();_t&&Qe(_t.index)}});ue.current.add(Ye)},[W,u]),ee=F.useCallback(()=>{const Ye=setTimeout(()=>{const Ge=W.lastEnabled();Ge&&Qe(Ge.index)});ue.current.add(Ye)},[W]),oe=F.useCallback(()=>{C==null||C(),p?q():H()},[p,q,H,C]),{isOpen:se,onOpen:re,onClose:me,onToggle:pe}=BK({isOpen:v,defaultIsOpen:y,onClose:S,onOpen:oe});j1e({enabled:se&&l,ref:z,handler:Ye=>{var Ge;(Ge=V.current)!=null&&Ge.contains(Ye.target)||me()}});const Re=VK({...M,enabled:se||U,placement:R,direction:x}),[Ze,Qe]=F.useState(-1);Nh(()=>{se||Qe(-1)},[se]),_Ae(z,{focusRef:V,visible:se,shouldFocus:!0});const Oe=F1e({isOpen:se,ref:z}),[Ie,Te]=H1e(i,"menu-button","menu-list"),de=F.useCallback(()=>{re(),H()},[re,H]),ue=F.useRef(new Set([]));F.useEffect(()=>{const Ye=ue.current;return()=>{Ye.forEach(Ge=>clearTimeout(Ge)),Ye.clear()}},[]);const be=F.useCallback(()=>{re(),q()},[q,re]),xe=F.useCallback(()=>{re(),ee()},[re,ee]),He=F.useCallback(()=>{var Ye,Ge;const _t=GK(z.current),kt=(Ye=z.current)==null?void 0:Ye.contains(_t.activeElement);if(!(se&&!kt))return;const cn=(Ge=W.item(Ze))==null?void 0:Ge.node;cn==null||cn.focus({preventScroll:!0})},[se,Ze,W]),rt=F.useRef(null);return{openAndFocusMenu:de,openAndFocusFirstItem:be,openAndFocusLastItem:xe,onTransitionEnd:He,unstable__animationState:Oe,descendants:W,popper:Re,buttonId:Ie,menuId:Te,forceUpdate:Re.forceUpdate,orientation:"vertical",isOpen:se,onToggle:pe,onOpen:re,onClose:me,menuRef:z,buttonRef:V,focusedIndex:Ze,closeOnSelect:a,closeOnBlur:l,autoSelect:p,setFocusedIndex:Qe,isLazy:m,lazyBehavior:N,initialFocusRef:u,rafId:rt}}function K1e(e={},i=null){const a=fE(),{onToggle:l,popper:u,openAndFocusFirstItem:p,openAndFocusLastItem:m}=a,v=F.useCallback(y=>{const S=y.key,R={Enter:p,ArrowDown:p,ArrowUp:m}[S];R&&(y.preventDefault(),y.stopPropagation(),R(y))},[p,m]);return{...e,ref:yi(a.buttonRef,i,u.referenceRef),id:a.buttonId,"data-active":Tt(a.isOpen),"aria-expanded":a.isOpen,"aria-haspopup":"menu","aria-controls":a.menuId,onClick:$t(e.onClick,l),onKeyDown:$t(e.onKeyDown,v)}}function XP(e){var i;return X1e(e)&&!!((i=e==null?void 0:e.getAttribute("role"))!=null&&i.startsWith("menuitem"))}function Y1e(e={},i=null){const a=fE();if(!a)throw new Error("useMenuContext: context is undefined. Seems you forgot to wrap component within <Menu>");const{focusedIndex:l,setFocusedIndex:u,menuRef:p,isOpen:m,onClose:v,menuId:y,isLazy:S,lazyBehavior:C,unstable__animationState:R}=a,N=B1e(),x=pAe({preventDefault:V=>V.key!==" "&&XP(V.target)}),U=F.useCallback(V=>{if(!V.currentTarget.contains(V.target))return;const W=V.key,q={Tab:oe=>oe.preventDefault(),Escape:v,ArrowDown:()=>{const oe=N.nextEnabled(l);oe&&u(oe.index)},ArrowUp:()=>{const oe=N.prevEnabled(l);oe&&u(oe.index)}}[W];if(q){V.preventDefault(),q(V);return}const ee=x(oe=>{const se=fAe(N.values(),oe,re=>{var me,pe;return(pe=(me=re==null?void 0:re.node)==null?void 0:me.textContent)!=null?pe:""},N.item(l));if(se){const re=N.indexOf(se.node);u(re)}});XP(V.target)&&ee(V)},[N,l,x,v,u]),M=F.useRef(!1);m&&(M.current=!0);const z=zK({wasSelected:M.current,enabled:S,mode:C,isSelected:R.present});return{...e,ref:yi(p,i),children:z?e.children:null,tabIndex:-1,role:"menu",id:y,style:{...e.style,transformOrigin:"var(--popper-transform-origin)"},"aria-orientation":"vertical",onKeyDown:$t(e.onKeyDown,U)}}function q1e(e={}){const{popper:i,isOpen:a}=fE();return i.getPopperProps({...e,style:{visibility:a?"visible":"hidden",...e.style}})}function J1e(e={},i=null){const{onMouseEnter:a,onMouseMove:l,onMouseLeave:u,onClick:p,onFocus:m,isDisabled:v,isFocusable:y,closeOnSelect:S,type:C,...R}=e,N=fE(),{setFocusedIndex:x,focusedIndex:U,closeOnSelect:M,onClose:z,menuRef:V,isOpen:W,menuId:H,rafId:q}=N,ee=F.useRef(null),oe=`${H}-menuitem-${F.useId()}`,{index:se,register:re}=z1e({disabled:v&&!y}),me=F.useCallback(de=>{a==null||a(de),!v&&x(se)},[x,se,v,a]),pe=F.useCallback(de=>{l==null||l(de),ee.current&&!QW(ee.current)&&me(de)},[me,l]),Re=F.useCallback(de=>{u==null||u(de),!v&&x(-1)},[x,v,u]),Ze=F.useCallback(de=>{p==null||p(de),XP(de.currentTarget)&&(S??M)&&z()},[z,p,M,S]),Qe=F.useCallback(de=>{m==null||m(de),x(se)},[x,m,se]),Oe=se===U,Ie=v&&!y;Nh(()=>{if(W)return Oe&&!Ie&&ee.current?(q.current&&cancelAnimationFrame(q.current),q.current=requestAnimationFrame(()=>{var de;(de=ee.current)==null||de.focus({preventScroll:!0}),q.current=null})):V.current&&!QW(V.current)&&V.current.focus({preventScroll:!0}),()=>{q.current&&cancelAnimationFrame(q.current)}},[Oe,Ie,V,W]);const Te=NK({onClick:Ze,onFocus:Qe,onMouseEnter:me,onMouseMove:pe,onMouseLeave:Re,ref:yi(re,ee,i),isDisabled:v,isFocusable:y});return{...R,...Te,type:C??Te.type,id:oe,role:"menuitem",tabIndex:Oe?0:-1}}function X1e(e){var i;if(!Q1e(e))return!1;const a=(i=e.ownerDocument.defaultView)!=null?i:window;return e instanceof a.HTMLElement}function Q1e(e){return e!=null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}var[Z1e,$h]=zn({name:"MenuStylesContext",errorMessage:`useMenuStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Menu />" `}),im=e=>{const{children:i}=e,a=Ai("Menu",e),l=ar(e),{direction:u}=Bh(),{descendants:p,...m}=$1e({...l,direction:u}),v=F.useMemo(()=>m,[m]),{isOpen:y,onClose:S,forceUpdate:C}=v;return b.jsx(V1e,{value:p,children:b.jsx(G1e,{value:v,children:b.jsx(Z1e,{value:a,children:ts(i,{isOpen:y,onClose:S,forceUpdate:C})})})})};im.displayName="Menu";var HK=$e((e,i)=>{const a=$h();return b.jsx(je.span,{ref:i,...e,__css:a.command,className:"chakra-menu__command"})});HK.displayName="MenuCommand";var eOe=$e((e,i)=>{const{type:a,...l}=e,u=$h(),p=l.as||a?a??void 0:"button",m=F.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...u.item}),[u.item]);return b.jsx(je.button,{ref:i,type:p,...l,__css:m})}),$K=e=>{const{className:i,children:a,...l}=e,u=$h(),p=F.Children.only(a),m=F.isValidElement(p)?F.cloneElement(p,{focusable:"false","aria-hidden":!0,className:ot("chakra-menu__icon",p.props.className)}):null,v=ot("chakra-menu__icon-wrapper",i);return b.jsx(je.span,{className:v,...l,__css:u.icon,children:m})};$K.displayName="MenuIcon";var Is=$e((e,i)=>{const{icon:a,iconSpacing:l="0.75rem",command:u,commandSpacing:p="0.75rem",children:m,...v}=e,y=J1e(v,i),C=a||u?b.jsx("span",{style:{pointerEvents:"none",flex:1},children:m}):m;return b.jsxs(eOe,{...y,className:ot("chakra-menu__menuitem",y.className),children:[a&&b.jsx($K,{fontSize:"0.8em",marginEnd:l,children:a}),C,u&&b.jsx(HK,{marginStart:p,children:u})]})});Is.displayName="MenuItem";var tOe={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},nOe=je(Ml.div),om=$e(function(i,a){var l,u;const{rootProps:p,motionProps:m,...v}=i,{isOpen:y,onTransitionEnd:S,unstable__animationState:C}=fE(),R=Y1e(v,a),N=q1e(p),x=$h();return b.jsx(je.div,{...N,__css:{zIndex:(u=i.zIndex)!=null?u:(l=x.list)==null?void 0:l.zIndex},children:b.jsx(nOe,{variants:tOe,initial:!1,animate:y?"enter":"exit",__css:{outline:0,...x.list},...m,className:ot("chakra-menu__menu-list",R.className),...R,onUpdate:S,onAnimationComplete:vD(C.onComplete,R.onAnimationComplete)})})});om.displayName="MenuList";var QP=$e((e,i)=>{const{title:a,children:l,className:u,...p}=e,m=ot("chakra-menu__group__title",u),v=$h();return b.jsxs("div",{ref:i,className:"chakra-menu__group",role:"group",children:[a&&b.jsx(je.p,{className:m,...p,__css:v.groupTitle,children:a}),l]})});QP.displayName="MenuGroup";var rOe=$e((e,i)=>{const a=$h();return b.jsx(je.button,{ref:i,...e,__css:{display:"inline-flex",appearance:"none",alignItems:"center",outline:0,...a.button}})}),sm=$e((e,i)=>{const{children:a,as:l,...u}=e,p=K1e(u,i),m=l||rOe;return b.jsx(m,{...p,className:ot("chakra-menu__menu-button",e.className),children:b.jsx(je.span,{__css:{pointerEvents:"none",flex:"1 1 auto",minW:0},children:e.children})})});sm.displayName="MenuButton";var jx=e=>{const{className:i,...a}=e,l=$h();return b.jsx(je.hr,{"aria-orientation":"horizontal",className:ot("chakra-menu__divider",i),...a,__css:l.divider})};jx.displayName="MenuDivider";var iOe={slideInBottom:{...z_,custom:{offsetY:16,reverse:!0}},slideInRight:{...z_,custom:{offsetX:16,reverse:!0}},slideInTop:{...z_,custom:{offsetY:-16,reverse:!0}},slideInLeft:{...z_,custom:{offsetX:-16,reverse:!0}},scale:{...P$,custom:{initialScale:.95,reverse:!0}},none:{}},oOe=je(Ml.section),sOe=e=>iOe[e||"none"],KK=F.forwardRef((e,i)=>{const{preset:a,motionProps:l=sOe(a),...u}=e;return b.jsx(oOe,{ref:i,...l,...u})});KK.displayName="ModalTransition";var aOe=Object.defineProperty,cOe=(e,i,a)=>i in e?aOe(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,lOe=(e,i,a)=>(cOe(e,i+"",a),a),dOe=class{constructor(){lOe(this,"modals"),this.modals=new Map}add(e){return this.modals.set(e,this.modals.size+1),this.modals.size}remove(e){this.modals.delete(e)}isTopModal(e){return e?this.modals.get(e)===this.modals.size:!1}},ZP=new dOe;function YK(e,i){const[a,l]=F.useState(0);return F.useEffect(()=>{const u=e.current;if(u){if(i){const p=ZP.add(u);l(p)}return()=>{ZP.remove(u),l(0)}}},[i,e]),a}var uOe=function(e){if(typeof document>"u")return null;var i=Array.isArray(e)?e[0]:e;return i.ownerDocument.body},hf=new WeakMap,BS=new WeakMap,WS={},YO=0,qK=function(e){return e&&(e.host||qK(e.parentNode))},hOe=function(e,i){return i.map(function(a){if(e.contains(a))return a;var l=qK(a);return l&&e.contains(l)?l:(console.error("aria-hidden",a,"in not contained inside",e,". Doing nothing"),null)}).filter(function(a){return!!a})},pOe=function(e,i,a,l){var u=hOe(i,Array.isArray(e)?e:[e]);WS[a]||(WS[a]=new WeakMap);var p=WS[a],m=[],v=new Set,y=new Set(u),S=function(R){!R||v.has(R)||(v.add(R),S(R.parentNode))};u.forEach(S);var C=function(R){!R||y.has(R)||Array.prototype.forEach.call(R.children,function(N){if(v.has(N))C(N);else try{var x=N.getAttribute(l),U=x!==null&&x!=="false",M=(hf.get(N)||0)+1,z=(p.get(N)||0)+1;hf.set(N,M),p.set(N,z),m.push(N),M===1&&U&&BS.set(N,!0),z===1&&N.setAttribute(a,"true"),U||N.setAttribute(l,"true")}catch(V){console.error("aria-hidden: cannot operate on ",N,V)}})};return C(i),v.clear(),YO++,function(){m.forEach(function(R){var N=hf.get(R)-1,x=p.get(R)-1;hf.set(R,N),p.set(R,x),N||(BS.has(R)||R.removeAttribute(l),BS.delete(R)),x||R.removeAttribute(a)}),YO--,YO||(hf=new WeakMap,hf=new WeakMap,BS=new WeakMap,WS={})}},fOe=function(e,i,a){a===void 0&&(a="data-aria-hidden");var l=Array.from(Array.isArray(e)?e:[e]),u=uOe(e);return u?(l.push.apply(l,Array.from(u.querySelectorAll("[aria-live]"))),pOe(l,u,a,"aria-hidden")):function(){return null}};function mOe(e){const{isOpen:i,onClose:a,id:l,closeOnOverlayClick:u=!0,closeOnEsc:p=!0,useInert:m=!0,onOverlayClick:v,onEsc:y}=e,S=F.useRef(null),C=F.useRef(null),[R,N,x]=_Oe(l,"chakra-modal","chakra-modal--header","chakra-modal--body");gOe(S,i&&m);const U=YK(S,i),M=F.useRef(null),z=F.useCallback(me=>{M.current=me.target},[]),V=F.useCallback(me=>{me.key==="Escape"&&(me.stopPropagation(),p&&(a==null||a()),y==null||y())},[p,a,y]),[W,H]=F.useState(!1),[q,ee]=F.useState(!1),oe=F.useCallback((me={},pe=null)=>({role:"dialog",...me,ref:yi(pe,S),id:R,tabIndex:-1,"aria-modal":!0,"aria-labelledby":W?N:void 0,"aria-describedby":q?x:void 0,onClick:$t(me.onClick,Re=>Re.stopPropagation())}),[x,q,R,N,W]),se=F.useCallback(me=>{me.stopPropagation(),M.current===me.target&&ZP.isTopModal(S.current)&&(u&&(a==null||a()),v==null||v())},[a,u,v]),re=F.useCallback((me={},pe=null)=>({...me,ref:yi(pe,C),onClick:$t(me.onClick,se),onKeyDown:$t(me.onKeyDown,V),onMouseDown:$t(me.onMouseDown,z)}),[V,z,se]);return{isOpen:i,onClose:a,headerId:N,bodyId:x,setBodyMounted:ee,setHeaderMounted:H,dialogRef:S,overlayRef:C,getDialogProps:oe,getDialogContainerProps:re,index:U}}function gOe(e,i){const a=e.current;F.useEffect(()=>{if(!(!e.current||!i))return fOe(e.current)},[i,e,a])}function _Oe(e,...i){const a=F.useId(),l=e||a;return F.useMemo(()=>i.map(u=>`${u}-${l}`),[l,i])}var[vOe,Dm]=zn({name:"ModalStylesContext",errorMessage:`useModalStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Modal />" `}),[EOe,xh]=zn({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),mE=e=>{const i={scrollBehavior:"outside",autoFocus:!0,trapFocus:!0,returnFocusOnClose:!0,blockScrollOnMount:!0,allowPinchZoom:!1,motionPreset:"scale",lockFocusAcrossFrames:!0,...e},{portalProps:a,children:l,autoFocus:u,trapFocus:p,initialFocusRef:m,finalFocusRef:v,returnFocusOnClose:y,blockScrollOnMount:S,allowPinchZoom:C,preserveScrollBarGap:R,motionPreset:N,lockFocusAcrossFrames:x,onCloseComplete:U}=i,M=Ai("Modal",i),V={...mOe(i),autoFocus:u,trapFocus:p,initialFocusRef:m,finalFocusRef:v,returnFocusOnClose:y,blockScrollOnMount:S,allowPinchZoom:C,preserveScrollBarGap:R,motionPreset:N,lockFocusAcrossFrames:x};return b.jsx(EOe,{value:V,children:b.jsx(vOe,{value:M,children:b.jsx(zh,{onExitComplete:U,children:V.isOpen&&b.jsx(Vh,{...a,children:l})})})})};mE.displayName="Modal";var wT="right-scroll-bar-position",RT="width-before-scroll-bar",yOe="with-scroll-bars-hidden",SOe="--removed-body-scroll-bar-size",JK=q$(),qO=function(){},RC=F.forwardRef(function(e,i){var a=F.useRef(null),l=F.useState({onScrollCapture:qO,onWheelCapture:qO,onTouchMoveCapture:qO}),u=l[0],p=l[1],m=e.forwardProps,v=e.children,y=e.className,S=e.removeScrollBar,C=e.enabled,R=e.shards,N=e.sideCar,x=e.noIsolation,U=e.inert,M=e.allowPinchZoom,z=e.as,V=z===void 0?"div":z,W=e.gapMode,H=$$(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),q=N,ee=H$([a,i]),oe=Cc(Cc({},H),u);return F.createElement(F.Fragment,null,C&&F.createElement(q,{sideCar:JK,removeScrollBar:S,shards:R,noIsolation:x,inert:U,setCallbacks:p,allowPinchZoom:!!M,lockRef:a,gapMode:W}),m?F.cloneElement(F.Children.only(v),Cc(Cc({},oe),{ref:ee})):F.createElement(V,Cc({},oe,{className:y,ref:ee}),v))});RC.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RC.classNames={fullWidth:RT,zeroRight:wT};var TOe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function bOe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var i=TOe();return i&&e.setAttribute("nonce",i),e}function COe(e,i){e.styleSheet?e.styleSheet.cssText=i:e.appendChild(document.createTextNode(i))}function wOe(e){var i=document.head||document.getElementsByTagName("head")[0];i.appendChild(e)}var ROe=function(){var e=0,i=null;return{add:function(a){e==0&&(i=bOe())&&(COe(i,a),wOe(i)),e++},remove:function(){e--,!e&&i&&(i.parentNode&&i.parentNode.removeChild(i),i=null)}}},IOe=function(){var e=ROe();return function(i,a){F.useEffect(function(){return e.add(i),function(){e.remove()}},[i&&a])}},XK=function(){var e=IOe(),i=function(a){var l=a.styles,u=a.dynamic;return e(l,u),null};return i},AOe={left:0,top:0,right:0,gap:0},JO=function(e){return parseInt(e||"",10)||0},OOe=function(e){var i=window.getComputedStyle(document.body),a=i[e==="padding"?"paddingLeft":"marginLeft"],l=i[e==="padding"?"paddingTop":"marginTop"],u=i[e==="padding"?"paddingRight":"marginRight"];return[JO(a),JO(l),JO(u)]},NOe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return AOe;var i=OOe(e),a=document.documentElement.clientWidth,l=window.innerWidth;return{left:i[0],top:i[1],right:i[2],gap:Math.max(0,l-a+i[2]-i[0])}},POe=XK(),am="data-scroll-locked",kOe=function(e,i,a,l){var u=e.left,p=e.top,m=e.right,v=e.gap;return a===void 0&&(a="margin"),`
  .`.concat(yOe,` {
   overflow: hidden `).concat(l,`;
   padding-right: `).concat(v,"px ").concat(l,`;
  }
  body[`).concat(am,`] {
    overflow: hidden `).concat(l,`;
    overscroll-behavior: contain;
    `).concat([i&&"position: relative ".concat(l,";"),a==="margin"&&`
    padding-left: `.concat(u,`px;
    padding-top: `).concat(p,`px;
    padding-right: `).concat(m,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(v,"px ").concat(l,`;
    `),a==="padding"&&"padding-right: ".concat(v,"px ").concat(l,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(wT,` {
    right: `).concat(v,"px ").concat(l,`;
  }
  
  .`).concat(RT,` {
    margin-right: `).concat(v,"px ").concat(l,`;
  }
  
  .`).concat(wT," .").concat(wT,` {
    right: 0 `).concat(l,`;
  }
  
  .`).concat(RT," .").concat(RT,` {
    margin-right: 0 `).concat(l,`;
  }
  
  body[`).concat(am,`] {
    `).concat(SOe,": ").concat(v,`px;
  }
`)},ZW=function(){var e=parseInt(document.body.getAttribute(am)||"0",10);return isFinite(e)?e:0},DOe=function(){F.useEffect(function(){return document.body.setAttribute(am,(ZW()+1).toString()),function(){var e=ZW()-1;e<=0?document.body.removeAttribute(am):document.body.setAttribute(am,e.toString())}},[])},xOe=function(e){var i=e.noRelative,a=e.noImportant,l=e.gapMode,u=l===void 0?"margin":l;DOe();var p=F.useMemo(function(){return NOe(u)},[u]);return F.createElement(POe,{styles:kOe(p,!i,u,a?"":"!important")})},ek=!1;if(typeof window<"u")try{var zS=Object.defineProperty({},"passive",{get:function(){return ek=!0,!0}});window.addEventListener("test",zS,zS),window.removeEventListener("test",zS,zS)}catch{ek=!1}var pf=ek?{passive:!1}:!1,LOe=function(e){return e.tagName==="TEXTAREA"},QK=function(e,i){var a=window.getComputedStyle(e);return a[i]!=="hidden"&&!(a.overflowY===a.overflowX&&!LOe(e)&&a[i]==="visible")},MOe=function(e){return QK(e,"overflowY")},UOe=function(e){return QK(e,"overflowX")},ez=function(e,i){var a=i.ownerDocument,l=i;do{typeof ShadowRoot<"u"&&l instanceof ShadowRoot&&(l=l.host);var u=ZK(e,l);if(u){var p=eY(e,l),m=p[1],v=p[2];if(m>v)return!0}l=l.parentNode}while(l&&l!==a.body);return!1},jOe=function(e){var i=e.scrollTop,a=e.scrollHeight,l=e.clientHeight;return[i,a,l]},FOe=function(e){var i=e.scrollLeft,a=e.scrollWidth,l=e.clientWidth;return[i,a,l]},ZK=function(e,i){return e==="v"?MOe(i):UOe(i)},eY=function(e,i){return e==="v"?jOe(i):FOe(i)},VOe=function(e,i){return e==="h"&&i==="rtl"?-1:1},BOe=function(e,i,a,l,u){var p=VOe(e,window.getComputedStyle(i).direction),m=p*l,v=a.target,y=i.contains(v),S=!1,C=m>0,R=0,N=0;do{var x=eY(e,v),U=x[0],M=x[1],z=x[2],V=M-z-p*U;(U||V)&&ZK(e,v)&&(R+=V,N+=U),v instanceof ShadowRoot?v=v.host:v=v.parentNode}while(!y&&v!==document.body||y&&(i.contains(v)||i===v));return(C&&(Math.abs(R)<1||!u)||!C&&(Math.abs(N)<1||!u))&&(S=!0),S},GS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},tz=function(e){return[e.deltaX,e.deltaY]},nz=function(e){return e&&"current"in e?e.current:e},WOe=function(e,i){return e[0]===i[0]&&e[1]===i[1]},zOe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},GOe=0,ff=[];function HOe(e){var i=F.useRef([]),a=F.useRef([0,0]),l=F.useRef(),u=F.useState(GOe++)[0],p=F.useState(XK)[0],m=F.useRef(e);F.useEffect(function(){m.current=e},[e]),F.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(u));var M=RRe([e.lockRef.current],(e.shards||[]).map(nz)).filter(Boolean);return M.forEach(function(z){return z.classList.add("allow-interactivity-".concat(u))}),function(){document.body.classList.remove("block-interactivity-".concat(u)),M.forEach(function(z){return z.classList.remove("allow-interactivity-".concat(u))})}}},[e.inert,e.lockRef.current,e.shards]);var v=F.useCallback(function(M,z){if("touches"in M&&M.touches.length===2)return!m.current.allowPinchZoom;var V=GS(M),W=a.current,H="deltaX"in M?M.deltaX:W[0]-V[0],q="deltaY"in M?M.deltaY:W[1]-V[1],ee,oe=M.target,se=Math.abs(H)>Math.abs(q)?"h":"v";if("touches"in M&&se==="h"&&oe.type==="range")return!1;var re=ez(se,oe);if(!re)return!0;if(re?ee=se:(ee=se==="v"?"h":"v",re=ez(se,oe)),!re)return!1;if(!l.current&&"changedTouches"in M&&(H||q)&&(l.current=ee),!ee)return!0;var me=l.current||ee;return BOe(me,z,M,me==="h"?H:q,!0)},[]),y=F.useCallback(function(M){var z=M;if(!(!ff.length||ff[ff.length-1]!==p)){var V="deltaY"in z?tz(z):GS(z),W=i.current.filter(function(ee){return ee.name===z.type&&(ee.target===z.target||z.target===ee.shadowParent)&&WOe(ee.delta,V)})[0];if(W&&W.should){z.cancelable&&z.preventDefault();return}if(!W){var H=(m.current.shards||[]).map(nz).filter(Boolean).filter(function(ee){return ee.contains(z.target)}),q=H.length>0?v(z,H[0]):!m.current.noIsolation;q&&z.cancelable&&z.preventDefault()}}},[]),S=F.useCallback(function(M,z,V,W){var H={name:M,delta:z,target:V,should:W,shadowParent:$Oe(V)};i.current.push(H),setTimeout(function(){i.current=i.current.filter(function(q){return q!==H})},1)},[]),C=F.useCallback(function(M){a.current=GS(M),l.current=void 0},[]),R=F.useCallback(function(M){S(M.type,tz(M),M.target,v(M,e.lockRef.current))},[]),N=F.useCallback(function(M){S(M.type,GS(M),M.target,v(M,e.lockRef.current))},[]);F.useEffect(function(){return ff.push(p),e.setCallbacks({onScrollCapture:R,onWheelCapture:R,onTouchMoveCapture:N}),document.addEventListener("wheel",y,pf),document.addEventListener("touchmove",y,pf),document.addEventListener("touchstart",C,pf),function(){ff=ff.filter(function(M){return M!==p}),document.removeEventListener("wheel",y,pf),document.removeEventListener("touchmove",y,pf),document.removeEventListener("touchstart",C,pf)}},[]);var x=e.removeScrollBar,U=e.inert;return F.createElement(F.Fragment,null,U?F.createElement(p,{styles:zOe(u)}):null,x?F.createElement(xOe,{gapMode:e.gapMode}):null)}function $Oe(e){for(var i=null;e!==null;)e instanceof ShadowRoot&&(i=e.host,e=e.host),e=e.parentNode;return i}const KOe=IRe(JK,HOe);var tY=F.forwardRef(function(e,i){return F.createElement(RC,Cc({},e,{ref:i,sideCar:KOe}))});tY.classNames=RC.classNames;function YOe(e){const{autoFocus:i,trapFocus:a,dialogRef:l,initialFocusRef:u,blockScrollOnMount:p,allowPinchZoom:m,finalFocusRef:v,returnFocusOnClose:y,preserveScrollBarGap:S,lockFocusAcrossFrames:C,isOpen:R}=xh(),[N,x]=a$();F.useEffect(()=>{!N&&x&&setTimeout(x)},[N,x]);const U=YK(l,R);return b.jsx(CK,{autoFocus:i,isDisabled:!a,initialFocusRef:u,finalFocusRef:v,restoreFocus:y,contentRef:l,lockFocusAcrossFrames:C,children:b.jsx(tY,{removeScrollBar:!S,allowPinchZoom:m,enabled:U===1&&p,forwardProps:!0,children:e.children})})}var gE=$e((e,i)=>{const{className:a,children:l,containerProps:u,motionProps:p,...m}=e,{getDialogProps:v,getDialogContainerProps:y}=xh(),S=v(m,i),C=y(u),R=ot("chakra-modal__content",a),N=Dm(),x={display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0,...N.dialog},U={display:"flex",width:"100vw",height:"$100vh",position:"fixed",left:0,top:0,...N.dialogContainer},{motionPreset:M}=xh();return b.jsx(YOe,{children:b.jsx(je.div,{...C,className:"chakra-modal__content-container",tabIndex:-1,__css:U,children:b.jsx(KK,{preset:M,motionProps:p,className:R,...S,__css:x,children:l})})})});gE.displayName="ModalContent";function qOe(e){const{leastDestructiveRef:i,...a}=e;return b.jsx(mE,{...a,initialFocusRef:i})}var JOe=$e((e,i)=>b.jsx(gE,{ref:i,role:"alertdialog",...e})),_E=$e((e,i)=>{const{className:a,...l}=e,u=ot("chakra-modal__footer",a),m={display:"flex",alignItems:"center",justifyContent:"flex-end",...Dm().footer};return b.jsx(je.footer,{ref:i,...l,__css:m,className:u})});_E.displayName="ModalFooter";var Fx=$e((e,i)=>{const{className:a,...l}=e,{headerId:u,setHeaderMounted:p}=xh();F.useEffect(()=>(p(!0),()=>p(!1)),[p]);const m=ot("chakra-modal__header",a),y={flex:0,...Dm().header};return b.jsx(je.header,{ref:i,className:m,id:u,...l,__css:y})});Fx.displayName="ModalHeader";var XOe=je(Ml.div),vE=$e((e,i)=>{const{className:a,transition:l,motionProps:u,...p}=e,m=ot("chakra-modal__overlay",a),y={pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh",...Dm().overlay},{motionPreset:S}=xh(),R=u||(S==="none"?{}:N$);return b.jsx(XOe,{...R,__css:y,ref:i,className:m,...p})});vE.displayName="ModalOverlay";var EE=$e((e,i)=>{const{className:a,...l}=e,{bodyId:u,setBodyMounted:p}=xh();F.useEffect(()=>(p(!0),()=>p(!1)),[p]);const m=ot("chakra-modal__body",a),v=Dm();return b.jsx(je.div,{ref:i,className:m,id:u,...l,__css:v.body})});EE.displayName="ModalBody";var nY=$e((e,i)=>{const{onClick:a,className:l,...u}=e,{onClose:p}=xh(),m=ot("chakra-modal__close-btn",l),v=Dm();return b.jsx(_C,{ref:i,__css:v.closeButton,className:m,onClick:$t(a,y=>{y.stopPropagation(),p()}),...u})});nY.displayName="ModalCloseButton";function QOe(e){return e&&go(e)&&go(e.target)}function ZOe(e={}){const{onChange:i,value:a,defaultValue:l,name:u,isDisabled:p,isFocusable:m,isNative:v,...y}=e,[S,C]=F.useState(l||""),R=typeof a<"u",N=R?a:S,x=F.useRef(null),U=F.useCallback(()=>{const ee=x.current;if(!ee)return;let oe="input:not(:disabled):checked";const se=ee.querySelector(oe);if(se){se.focus();return}oe="input:not(:disabled)";const re=ee.querySelector(oe);re==null||re.focus()},[]),z=`radio-${F.useId()}`,V=u||z,W=F.useCallback(ee=>{const oe=QOe(ee)?ee.target.value:ee;R||C(oe),i==null||i(String(oe))},[i,R]),H=F.useCallback((ee={},oe=null)=>({...ee,ref:yi(oe,x),role:"radiogroup"}),[]),q=F.useCallback((ee={},oe=null)=>({...ee,ref:oe,name:V,[v?"checked":"isChecked"]:N!=null?ee.value===N:void 0,onChange(re){W(re)},"data-radiogroup":!0}),[v,V,W,N]);return{getRootProps:H,getRadioProps:q,name:V,ref:x,focus:U,setValue:C,value:N,onChange:W,isDisabled:p,isFocusable:m,htmlProps:y}}var[eNe,rY]=zn({name:"RadioGroupContext",strict:!1}),IC=$e((e,i)=>{const{colorScheme:a,size:l,variant:u,children:p,className:m,isDisabled:v,isFocusable:y,...S}=e,{value:C,onChange:R,getRootProps:N,name:x,htmlProps:U}=ZOe(S),M=F.useMemo(()=>({name:x,size:l,onChange:R,colorScheme:a,value:C,variant:u,isDisabled:v,isFocusable:y}),[x,l,R,a,C,u,v,y]);return b.jsx(eNe,{value:M,children:b.jsx(je.div,{...N(U,i),className:ot("chakra-radio-group",m),children:p})})});IC.displayName="RadioGroup";var tNe={border:"0",clip:"rect(0, 0, 0, 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};function nNe(e={}){const{defaultChecked:i,isChecked:a,isFocusable:l,isDisabled:u,isReadOnly:p,isRequired:m,onChange:v,isInvalid:y,name:S,value:C,id:R,"data-radiogroup":N,"aria-describedby":x,...U}=e,M=`radio-${F.useId()}`,z=Hh(),W=!!rY()||!!N;let q=!!z&&!W?z.id:M;q=R??q;const ee=u??(z==null?void 0:z.isDisabled),oe=p??(z==null?void 0:z.isReadOnly),se=m??(z==null?void 0:z.isRequired),re=y??(z==null?void 0:z.isInvalid),[me,pe]=F.useState(!1),[Re,Ze]=F.useState(!1),[Qe,Oe]=F.useState(!1),[Ie,Te]=F.useState(!1),[de,ue]=F.useState(!!i),be=typeof a<"u",xe=be?a:de;F.useEffect(()=>z$(pe),[]);const He=F.useCallback(St=>{if(oe||ee){St.preventDefault();return}be||ue(St.target.checked),v==null||v(St)},[be,ee,oe,v]),rt=F.useCallback(St=>{St.key===" "&&Te(!0)},[Te]),Ye=F.useCallback(St=>{St.key===" "&&Te(!1)},[Te]),Ge=F.useCallback((St={},bt=null)=>({...St,ref:bt,"data-active":Tt(Ie),"data-hover":Tt(Qe),"data-disabled":Tt(ee),"data-invalid":Tt(re),"data-checked":Tt(xe),"data-focus":Tt(Re),"data-focus-visible":Tt(Re&&me),"data-readonly":Tt(oe),"aria-hidden":!0,onMouseDown:$t(St.onMouseDown,()=>Te(!0)),onMouseUp:$t(St.onMouseUp,()=>Te(!1)),onMouseEnter:$t(St.onMouseEnter,()=>Oe(!0)),onMouseLeave:$t(St.onMouseLeave,()=>Oe(!1))}),[Ie,Qe,ee,re,xe,Re,oe,me]),{onFocus:_t,onBlur:kt}=z??{},sn=F.useCallback((St={},bt=null)=>{const Qn=ee&&!l;return{...St,id:q,ref:bt,type:"radio",name:S,value:C,onChange:$t(St.onChange,He),onBlur:$t(kt,St.onBlur,()=>Ze(!1)),onFocus:$t(_t,St.onFocus,()=>Ze(!0)),onKeyDown:$t(St.onKeyDown,rt),onKeyUp:$t(St.onKeyUp,Ye),checked:xe,disabled:Qn,readOnly:oe,required:se,"aria-invalid":Jf(re),"aria-disabled":Jf(Qn),"aria-required":Jf(se),"data-readonly":Tt(oe),"aria-describedby":x,style:tNe}},[ee,l,q,S,C,He,kt,_t,rt,Ye,xe,oe,se,re,x]);return{state:{isInvalid:re,isFocused:Re,isChecked:xe,isActive:Ie,isHovered:Qe,isDisabled:ee,isReadOnly:oe,isRequired:se},getCheckboxProps:Ge,getRadioProps:Ge,getInputProps:sn,getLabelProps:(St={},bt=null)=>({...St,ref:bt,onMouseDown:$t(St.onMouseDown,rNe),"data-disabled":Tt(ee),"data-checked":Tt(xe),"data-invalid":Tt(re)}),getRootProps:(St,bt=null)=>({...St,ref:bt,"data-disabled":Tt(ee),"data-checked":Tt(xe),"data-invalid":Tt(re)}),htmlProps:U}}function rNe(e){e.preventDefault(),e.stopPropagation()}function iNe(e,i){const a={},l={};for(const[u,p]of Object.entries(e))i.includes(u)?a[u]=p:l[u]=p;return[a,l]}var As=$e((e,i)=>{var a;const l=rY(),{onChange:u,value:p}=e,m=Ai("Radio",{...l,...e}),v=ar(e),{spacing:y="0.5rem",children:S,isDisabled:C=l==null?void 0:l.isDisabled,isFocusable:R=l==null?void 0:l.isFocusable,inputProps:N,...x}=v;let U=e.isChecked;(l==null?void 0:l.value)!=null&&p!=null&&(U=l.value===p);let M=u;l!=null&&l.onChange&&p!=null&&(M=vD(l.onChange,u));const z=(a=e==null?void 0:e.name)!=null?a:l==null?void 0:l.name,{getInputProps:V,getCheckboxProps:W,getLabelProps:H,getRootProps:q,htmlProps:ee}=nNe({...x,isChecked:U,isFocusable:R,isDisabled:C,onChange:M,name:z}),[oe,se]=iNe(ee,w9),re=W(se),me=V(N,i),pe=H(),Re=Object.assign({},oe,q()),Ze={display:"inline-flex",alignItems:"center",verticalAlign:"top",cursor:"pointer",position:"relative",...m.container},Qe={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,...m.control},Oe={userSelect:"none",marginStart:y,...m.label};return b.jsxs(je.label,{className:"chakra-radio",...Re,__css:Ze,children:[b.jsx("input",{className:"chakra-radio__input",...me}),b.jsx(je.span,{className:"chakra-radio__control",...re,__css:Qe}),S&&b.jsx(je.span,{className:"chakra-radio__label",...pe,__css:Oe,children:S})]})});As.displayName="Radio";var iY=$e(function(i,a){const{children:l,placeholder:u,className:p,...m}=i;return b.jsxs(je.select,{...m,ref:a,className:ot("chakra-select",p),children:[u&&b.jsx("option",{value:"",children:u}),l]})});iY.displayName="SelectField";function oNe(e,i){const a={},l={};for(const[u,p]of Object.entries(e))i.includes(u)?a[u]=p:l[u]=p;return[a,l]}var ru=$e((e,i)=>{var a;const l=Ai("Select",e),{rootProps:u,placeholder:p,icon:m,color:v,height:y,h:S,minH:C,minHeight:R,iconColor:N,iconSize:x,...U}=ar(e),[M,z]=oNe(U,w9),V=mx(z),W={width:"100%",height:"fit-content",position:"relative",color:v},H={paddingEnd:"2rem",...l.field,_focus:{zIndex:"unset",...(a=l.field)==null?void 0:a._focus}};return b.jsxs(je.div,{className:"chakra-select__wrapper",__css:W,...M,...u,children:[b.jsx(iY,{ref:i,height:S??y,minH:C??R,placeholder:p,...V,__css:H,children:e.children}),b.jsx(oY,{"data-disabled":Tt(V.disabled),...(N||v)&&{color:N||v},__css:l.icon,...x&&{fontSize:x},children:m})]})});ru.displayName="Select";var sNe=e=>b.jsx("svg",{viewBox:"0 0 24 24",...e,children:b.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),aNe=je("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),oY=e=>{const{children:i=b.jsx(sNe,{}),...a}=e,l=F.cloneElement(i,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return b.jsx(aNe,{...a,className:"chakra-select__icon-wrapper",children:F.isValidElement(i)?l:null})};oY.displayName="SelectIcon";var mf=e=>e?"":void 0,XO=e=>e?!0:void 0,Vx=(...e)=>e.filter(Boolean).join(" ");function QO(...e){return function(a){e.some(l=>(l==null||l(a),a==null?void 0:a.defaultPrevented))}}function cNe(e){return{root:`slider-root-${e}`,getThumb:i=>`slider-thumb-${e}-${i}`,getInput:i=>`slider-input-${e}-${i}`,track:`slider-track-${e}`,innerTrack:`slider-filled-track-${e}`,getMarker:i=>`slider-marker-${e}-${i}`,output:`slider-output-${e}`}}function G_(e){const{orientation:i,vertical:a,horizontal:l}=e;return i==="vertical"?a:l}var IT={width:0,height:0},HS=e=>e||IT;function lNe(e){const{orientation:i,thumbPercents:a,thumbRects:l,isReversed:u}=e,p=M=>{var z;const V=(z=l[M])!=null?z:IT;return{position:"absolute",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",touchAction:"none",...G_({orientation:i,vertical:{bottom:`calc(${a[M]}% - ${V.height/2}px)`},horizontal:{left:`calc(${a[M]}% - ${V.width/2}px)`}})}},m=i==="vertical"?l.reduce((M,z)=>HS(M).height>HS(z).height?M:z,IT):l.reduce((M,z)=>HS(M).width>HS(z).width?M:z,IT),v={position:"relative",touchAction:"none",WebkitTapHighlightColor:"rgba(0,0,0,0)",userSelect:"none",outline:0,...G_({orientation:i,vertical:m?{paddingLeft:m.width/2,paddingRight:m.width/2}:{},horizontal:m?{paddingTop:m.height/2,paddingBottom:m.height/2}:{}})},y={position:"absolute",...G_({orientation:i,vertical:{left:"50%",transform:"translateX(-50%)",height:"100%"},horizontal:{top:"50%",transform:"translateY(-50%)",width:"100%"}})},S=a.length===1,C=[0,u?100-a[0]:a[0]],R=S?C:a;let N=R[0];!S&&u&&(N=100-N);const x=Math.abs(R[R.length-1]-R[0]),U={...y,...G_({orientation:i,vertical:u?{height:`${x}%`,top:`${N}%`}:{height:`${x}%`,bottom:`${N}%`},horizontal:u?{width:`${x}%`,right:`${N}%`}:{width:`${x}%`,left:`${N}%`}})};return{trackStyle:y,innerTrackStyle:U,rootStyle:v,getThumbStyle:p}}function dNe(e){const{isReversed:i,direction:a,orientation:l}=e;return a==="ltr"||l==="vertical"?i:!i}function uNe(e,i,a,l){return e.addEventListener(i,a,l),()=>{e.removeEventListener(i,a,l)}}function hNe(e){const i=fNe(e);return typeof i.PointerEvent<"u"&&e instanceof i.PointerEvent?e.pointerType==="mouse":e instanceof i.MouseEvent}function sY(e){return!!e.touches}function pNe(e){return sY(e)&&e.touches.length>1}function fNe(e){var i;return(i=e.view)!=null?i:window}function mNe(e,i="page"){const a=e.touches[0]||e.changedTouches[0];return{x:a[`${i}X`],y:a[`${i}Y`]}}function gNe(e,i="page"){return{x:e[`${i}X`],y:e[`${i}Y`]}}function aY(e,i="page"){return sY(e)?mNe(e,i):gNe(e,i)}function _Ne(e){return i=>{const a=hNe(i);(!a||a&&i.button===0)&&e(i)}}function vNe(e,i=!1){function a(u){e(u,{point:aY(u)})}return i?_Ne(a):a}function AT(e,i,a,l){return uNe(e,i,vNe(a,i==="pointerdown"),l)}var ENe=Object.defineProperty,yNe=(e,i,a)=>i in e?ENe(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,Fa=(e,i,a)=>(yNe(e,typeof i!="symbol"?i+"":i,a),a),SNe=class{constructor(e,i,a){Fa(this,"history",[]),Fa(this,"startEvent",null),Fa(this,"lastEvent",null),Fa(this,"lastEventInfo",null),Fa(this,"handlers",{}),Fa(this,"removeListeners",()=>{}),Fa(this,"threshold",3),Fa(this,"win"),Fa(this,"updatePoint",()=>{if(!(this.lastEvent&&this.lastEventInfo))return;const v=ZO(this.lastEventInfo,this.history),y=this.startEvent!==null,S=wNe(v.offset,{x:0,y:0})>=this.threshold;if(!y&&!S)return;const{timestamp:C}=o8();this.history.push({...v.point,timestamp:C});const{onStart:R,onMove:N}=this.handlers;y||(R==null||R(this.lastEvent,v),this.startEvent=this.lastEvent),N==null||N(this.lastEvent,v)}),Fa(this,"onPointerMove",(v,y)=>{this.lastEvent=v,this.lastEventInfo=y,Fye.update(this.updatePoint,!0)}),Fa(this,"onPointerUp",(v,y)=>{const S=ZO(y,this.history),{onEnd:C,onSessionEnd:R}=this.handlers;R==null||R(v,S),this.end(),!(!C||!this.startEvent)&&(C==null||C(v,S))});var l;if(this.win=(l=e.view)!=null?l:window,pNe(e))return;this.handlers=i,a&&(this.threshold=a),e.stopPropagation(),e.preventDefault();const u={point:aY(e)},{timestamp:p}=o8();this.history=[{...u.point,timestamp:p}];const{onSessionStart:m}=i;m==null||m(e,ZO(u,this.history)),this.removeListeners=CNe(AT(this.win,"pointermove",this.onPointerMove),AT(this.win,"pointerup",this.onPointerUp),AT(this.win,"pointercancel",this.onPointerUp))}updateHandlers(e){this.handlers=e}end(){var e;(e=this.removeListeners)==null||e.call(this),Vye.update(this.updatePoint)}};function rz(e,i){return{x:e.x-i.x,y:e.y-i.y}}function ZO(e,i){return{point:e.point,delta:rz(e.point,i[i.length-1]),offset:rz(e.point,i[0]),velocity:bNe(i,.1)}}var TNe=e=>e*1e3;function bNe(e,i){if(e.length<2)return{x:0,y:0};let a=e.length-1,l=null;const u=e[e.length-1];for(;a>=0&&(l=e[a],!(u.timestamp-l.timestamp>TNe(i)));)a--;if(!l)return{x:0,y:0};const p=(u.timestamp-l.timestamp)/1e3;if(p===0)return{x:0,y:0};const m={x:(u.x-l.x)/p,y:(u.y-l.y)/p};return m.x===1/0&&(m.x=0),m.y===1/0&&(m.y=0),m}function CNe(...e){return i=>e.reduce((a,l)=>l(a),i)}function eN(e,i){return Math.abs(e-i)}function iz(e){return"x"in e&&"y"in e}function wNe(e,i){if(typeof e=="number"&&typeof i=="number")return eN(e,i);if(iz(e)&&iz(i)){const a=eN(e.x,i.x),l=eN(e.y,i.y);return Math.sqrt(a**2+l**2)}return 0}function RNe(e){const i=F.useRef(null);return i.current=e,i}function INe(e,i){const{onPan:a,onPanStart:l,onPanEnd:u,onPanSessionStart:p,onPanSessionEnd:m,threshold:v}=i,y=!!(a||l||u||p||m),S=F.useRef(null),C=RNe({onSessionStart:p,onSessionEnd:m,onStart:l,onMove:a,onEnd(R,N){S.current=null,u==null||u(R,N)}});F.useEffect(()=>{var R;(R=S.current)==null||R.updateHandlers(C.current)}),F.useEffect(()=>{const R=e.current;if(!R||!y)return;function N(x){S.current=new SNe(x,C.current,v)}return AT(R,"pointerdown",N)},[e,y,C,v]),F.useEffect(()=>()=>{var R;(R=S.current)==null||R.end(),S.current=null},[])}function ANe(e,i){if(!e){i(void 0);return}i({width:e.offsetWidth,height:e.offsetHeight});const a=e.ownerDocument.defaultView??window,l=new a.ResizeObserver(u=>{if(!Array.isArray(u)||!u.length)return;const[p]=u;let m,v;if("borderBoxSize"in p){const y=p.borderBoxSize,S=Array.isArray(y)?y[0]:y;m=S.inlineSize,v=S.blockSize}else m=e.offsetWidth,v=e.offsetHeight;i({width:m,height:v})});return l.observe(e,{box:"border-box"}),()=>l.unobserve(e)}var ONe=globalThis!=null&&globalThis.document?F.useLayoutEffect:F.useEffect;function NNe(e,i){var a,l;if(!e||!e.parentElement)return;const u=(l=(a=e.ownerDocument)==null?void 0:a.defaultView)!=null?l:window,p=new u.MutationObserver(()=>{i()});return p.observe(e.parentElement,{childList:!0}),()=>{p.disconnect()}}function PNe({getNodes:e,observeMutation:i=!0}){const[a,l]=F.useState([]),[u,p]=F.useState(0);return ONe(()=>{const m=e(),v=m.map((y,S)=>ANe(y,C=>{l(R=>[...R.slice(0,S),C,...R.slice(S+1)])}));if(i){const y=m[0];v.push(NNe(y,()=>{p(S=>S+1)}))}return()=>{v.forEach(y=>{y==null||y()})}},[u]),a}function kNe(e){const{min:i=0,max:a=100,onChange:l,value:u,defaultValue:p,isReversed:m,direction:v="ltr",orientation:y="horizontal",id:S,isDisabled:C,isReadOnly:R,onChangeStart:N,onChangeEnd:x,step:U=1,getAriaValueText:M,"aria-valuetext":z,"aria-label":V,"aria-labelledby":W,name:H,focusThumbOnChange:q=!0,minStepsBetweenThumbs:ee=0,...oe}=e,se=ss(N),re=ss(x),me=ss(M),pe=dNe({isReversed:m,direction:v,orientation:y}),[Re,Ze]=ux({value:u,defaultValue:p??[25,75],onChange:l});if(!Array.isArray(Re))throw new TypeError(`[range-slider] You passed an invalid value for \`value\` or \`defaultValue\`, expected \`Array\` but got \`${typeof Re}\``);const[Qe,Oe]=F.useState(!1),[Ie,Te]=F.useState(!1),[de,ue]=F.useState(-1),be=!(C||R),xe=F.useRef(Re),He=Re.map(et=>OW(et,i,a)),rt=ee*U,Ye=DNe(He,i,a,rt),Ge=F.useRef({eventSource:null,value:[],valueBounds:[]});Ge.current.value=He,Ge.current.valueBounds=Ye;const _t=He.map(et=>a-et+i),sn=(pe?_t:He).map(et=>AW(et,i,a)),cn=y==="vertical",Gn=F.useRef(null),vn=F.useRef(null),St=PNe({getNodes(){const et=vn.current,At=et==null?void 0:et.querySelectorAll("[role=slider]");return At?Array.from(At):[]}}),bt=F.useId(),Hn=cNe(S??bt),Ct=F.useCallback(et=>{var At,Zt;if(!Gn.current)return;Ge.current.eventSource="pointer";const Kt=Gn.current.getBoundingClientRect(),{clientX:Zn,clientY:Xi}=(Zt=(At=et.touches)==null?void 0:At[0])!=null?Zt:et,Si=cn?Kt.bottom-Xi:Zn-Kt.left,ba=cn?Kt.height:Kt.width;let hs=Si/ba;return pe&&(hs=1-hs),vRe(hs,i,a)},[cn,pe,a,i]),Cn=(a-i)/10,$n=U||(a-i)/100,on=F.useMemo(()=>({setValueAtIndex(et,At){if(!be)return;const Zt=Ge.current.valueBounds[et];At=parseFloat(ERe(At,Zt.min,$n)),At=OW(At,Zt.min,Zt.max);const Kt=[...Ge.current.value];Kt[et]=At,Ze(Kt)},setActiveIndex:ue,stepUp(et,At=$n){const Zt=Ge.current.value[et],Kt=pe?Zt-At:Zt+At;on.setValueAtIndex(et,Kt)},stepDown(et,At=$n){const Zt=Ge.current.value[et],Kt=pe?Zt+At:Zt-At;on.setValueAtIndex(et,Kt)},reset(){Ze(xe.current)}}),[$n,pe,Ze,be]),ji=F.useCallback(et=>{const At=et.key,Kt={ArrowRight:()=>on.stepUp(de),ArrowUp:()=>on.stepUp(de),ArrowLeft:()=>on.stepDown(de),ArrowDown:()=>on.stepDown(de),PageUp:()=>on.stepUp(de,Cn),PageDown:()=>on.stepDown(de,Cn),Home:()=>{const{min:Zn}=Ye[de];on.setValueAtIndex(de,Zn)},End:()=>{const{max:Zn}=Ye[de];on.setValueAtIndex(de,Zn)}}[At];Kt&&(et.preventDefault(),et.stopPropagation(),Kt(et),Ge.current.eventSource="keyboard")},[on,de,Cn,Ye]),{getThumbStyle:ai,rootStyle:br,trackStyle:Jr,innerTrackStyle:Oi}=F.useMemo(()=>lNe({isReversed:pe,orientation:y,thumbRects:St,thumbPercents:sn}),[pe,y,sn,St]),us=F.useCallback(et=>{var At;const Zt=et??de;if(Zt!==-1&&q){const Kt=Hn.getThumb(Zt),Zn=(At=vn.current)==null?void 0:At.ownerDocument.getElementById(Kt);Zn&&setTimeout(()=>Zn.focus())}},[q,de,Hn]);Nh(()=>{Ge.current.eventSource==="keyboard"&&(re==null||re(Ge.current.value))},[He,re]);const Fc=et=>{const At=Ct(et)||0,Zt=Ge.current.value.map(ba=>Math.abs(ba-At)),Kt=Math.min(...Zt);let Zn=Zt.indexOf(Kt);const Xi=Zt.filter(ba=>ba===Kt);Xi.length>1&&At>Ge.current.value[Zn]&&(Zn=Zn+Xi.length-1),ue(Zn),on.setValueAtIndex(Zn,At),us(Zn)},Vc=et=>{if(de==-1)return;const At=Ct(et)||0;ue(de),on.setValueAtIndex(de,At),us(de)};INe(vn,{onPanSessionStart(et){be&&(Oe(!0),Fc(et),se==null||se(Ge.current.value))},onPanSessionEnd(){be&&(Oe(!1),re==null||re(Ge.current.value))},onPan(et){be&&Vc(et)}});const $r=F.useCallback((et={},At=null)=>({...et,...oe,id:Hn.root,ref:yi(At,vn),tabIndex:-1,"aria-disabled":XO(C),"data-focused":mf(Ie),style:{...et.style,...br}}),[oe,C,Ie,br,Hn]),Fi=F.useCallback((et={},At=null)=>({...et,ref:yi(At,Gn),id:Hn.track,"data-disabled":mf(C),style:{...et.style,...Jr}}),[C,Jr,Hn]),_u=F.useCallback((et={},At=null)=>({...et,ref:At,id:Hn.innerTrack,style:{...et.style,...Oi}}),[Oi,Hn]),jl=F.useCallback((et,At=null)=>{var Zt;const{index:Kt,...Zn}=et,Xi=He[Kt];if(Xi==null)throw new TypeError(`[range-slider > thumb] Cannot find value at index \`${Kt}\`. The \`value\` or \`defaultValue\` length is : ${He.length}`);const Si=Ye[Kt];return{...Zn,ref:At,role:"slider",tabIndex:be?0:void 0,id:Hn.getThumb(Kt),"data-active":mf(Qe&&de===Kt),"aria-valuetext":(Zt=me==null?void 0:me(Xi))!=null?Zt:z==null?void 0:z[Kt],"aria-valuemin":Si.min,"aria-valuemax":Si.max,"aria-valuenow":Xi,"aria-orientation":y,"aria-disabled":XO(C),"aria-readonly":XO(R),"aria-label":V==null?void 0:V[Kt],"aria-labelledby":V!=null&&V[Kt]||W==null?void 0:W[Kt],style:{...et.style,...ai(Kt)},onKeyDown:QO(et.onKeyDown,ji),onFocus:QO(et.onFocus,()=>{Te(!0),ue(Kt)}),onBlur:QO(et.onBlur,()=>{Te(!1),ue(-1)})}},[Hn,He,Ye,be,Qe,de,me,z,y,C,R,V,W,ai,ji,Te]),vu=F.useCallback((et={},At=null)=>({...et,ref:At,id:Hn.output,htmlFor:He.map((Zt,Kt)=>Hn.getThumb(Kt)).join(" "),"aria-live":"off"}),[Hn,He]),Eu=F.useCallback((et,At=null)=>{const{value:Zt,...Kt}=et,Zn=!(Zt<i||Zt>a),Xi=Zt>=He[0]&&Zt<=He[He.length-1];let Si=AW(Zt,i,a);Si=pe?100-Si:Si;const ba={position:"absolute",pointerEvents:"none",...G_({orientation:y,vertical:{bottom:`${Si}%`},horizontal:{left:`${Si}%`}})};return{...Kt,ref:At,id:Hn.getMarker(et.value),role:"presentation","aria-hidden":!0,"data-disabled":mf(C),"data-invalid":mf(!Zn),"data-highlighted":mf(Xi),style:{...et.style,...ba}}},[C,pe,a,i,y,He,Hn]),qh=F.useCallback((et,At=null)=>{const{index:Zt,...Kt}=et;return{...Kt,ref:At,id:Hn.getInput(Zt),type:"hidden",value:He[Zt],name:Array.isArray(H)?H[Zt]:`${H}-${Zt}`}},[H,He,Hn]);return{state:{value:He,isFocused:Ie,isDragging:Qe,getThumbPercent:et=>sn[et],getThumbMinValue:et=>Ye[et].min,getThumbMaxValue:et=>Ye[et].max},actions:on,getRootProps:$r,getTrackProps:Fi,getInnerTrackProps:_u,getThumbProps:jl,getMarkerProps:Eu,getInputProps:qh,getOutputProps:vu}}function DNe(e,i,a,l){return e.map((u,p)=>{const m=p===0?i:e[p-1]+l,v=p===e.length-1?a:e[p+1]-l;return{min:m,max:v}})}var[xNe,AC]=zn({name:"SliderContext",errorMessage:"useSliderContext: `context` is undefined. Seems you forgot to wrap all slider components within <RangeSlider />"}),[LNe,OC]=zn({name:"RangeSliderStylesContext",errorMessage:`useRangeSliderStyles returned is 'undefined'. Seems you forgot to wrap the components in "<RangeSlider />" `}),cY=$e(function(i,a){const l={orientation:"horizontal",...i},u=Ai("Slider",l),p=ar(l),{direction:m}=Bh();p.direction=m;const{getRootProps:v,...y}=kNe(p),S=F.useMemo(()=>({...y,name:l.name}),[y,l.name]);return b.jsx(xNe,{value:S,children:b.jsx(LNe,{value:u,children:b.jsx(je.div,{...v({},a),className:"chakra-slider",__css:u.container,children:l.children})})})});cY.displayName="RangeSlider";var tk=$e(function(i,a){const{getThumbProps:l,getInputProps:u,name:p}=AC(),m=OC(),v=l(i,a);return b.jsxs(je.div,{...v,className:Vx("chakra-slider__thumb",i.className),__css:m.thumb,children:[v.children,p&&b.jsx("input",{...u({index:i.index})})]})});tk.displayName="RangeSliderThumb";var lY=$e(function(i,a){const{getTrackProps:l}=AC(),u=OC(),p=l(i,a);return b.jsx(je.div,{...p,className:Vx("chakra-slider__track",i.className),__css:u.track,"data-testid":"chakra-range-slider-track"})});lY.displayName="RangeSliderTrack";var dY=$e(function(i,a){const{getInnerTrackProps:l}=AC(),u=OC(),p=l(i,a);return b.jsx(je.div,{...p,className:"chakra-slider__filled-track",__css:u.filledTrack})});dY.displayName="RangeSliderFilledTrack";var MNe=$e(function(i,a){const{getMarkerProps:l}=AC(),u=OC(),p=l(i,a);return b.jsx(je.div,{...p,className:Vx("chakra-slider__marker",i.className),__css:u.mark})});MNe.displayName="RangeSliderMark";var[UNe,uY]=zn({name:"StatStylesContext",errorMessage:`useStatStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Stat />" `}),cm=$e(function(i,a){const l=Ai("Stat",i),u={position:"relative",flex:"1 1 0%",...l.container},{className:p,children:m,...v}=ar(i);return b.jsx(UNe,{value:l,children:b.jsx(je.div,{ref:a,...v,className:ot("chakra-stat",p),__css:u,children:b.jsx("dl",{children:m})})})});cm.displayName="Stat";var hY=$e(function(i,a){return b.jsx(je.div,{...i,ref:a,role:"group",className:ot("chakra-stat__group",i.className),__css:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",alignItems:"flex-start"}})});hY.displayName="StatGroup";var lm=$e(function(i,a){const l=uY();return b.jsx(je.dt,{ref:a,...i,className:ot("chakra-stat__label",i.className),__css:l.label})});lm.displayName="StatLabel";var Tb=$e(function(i,a){const l=uY();return b.jsx(je.dd,{ref:a,...i,className:ot("chakra-stat__number",i.className),__css:{...l.number,fontFeatureSettings:"pnum",fontVariantNumeric:"proportional-nums"}})});Tb.displayName="StatNumber";var[jNe,Kh]=zn({name:"StepContext"}),[FNe,xm]=X9("Stepper"),VNe=$e(function(i,a){const{status:l}=Kh(),u=xm();return b.jsx(je.h3,{ref:a,"data-status":l,...i,__css:u.title,className:ot("chakra-step__title",i.className)})}),BNe=$e(function(i,a){const{orientation:l,status:u,showLastSeparator:p}=Kh(),m=xm();return b.jsx(je.div,{ref:a,"data-status":u,"data-orientation":l,"data-stretch":Tt(p),__css:m.step,...i,className:ot("chakra-step",i.className)})}),WNe=$e(function(i,a){const l=Ai("Stepper",i),{children:u,index:p,orientation:m="horizontal",showLastSeparator:v=!1,...y}=ar(i),S=F.Children.toArray(u),C=S.length;function R(N){return N<p?"complete":N>p?"incomplete":"active"}return b.jsx(je.div,{ref:a,"aria-label":"Progress","data-orientation":m,...y,__css:l.stepper,className:ot("chakra-stepper",i.className),children:b.jsx(FNe,{value:l,children:S.map((N,x)=>b.jsx(jNe,{value:{index:x,status:R(x),orientation:m,showLastSeparator:v,count:C,isFirst:x===0,isLast:x===C-1},children:N},x))})})});function zNe(e={}){const{index:i=0,count:a}=e,[l,u]=F.useState(i),p=typeof a=="number"?a-1:0,m=l/p;return{activeStep:l,setActiveStep:u,activeStepPercent:m,isActiveStep(v){return v===l},isCompleteStep(v){return v<l},isIncompleteStep(v){return v>l},getStatus(v){return v<l?"complete":v>l?"incomplete":"active"},goToNext(){u(v=>typeof a=="number"?Math.min(a,v+1):v+1)},goToPrevious(){u(v=>Math.max(0,v-1))}}}function GNe(e){const{complete:i,incomplete:a,active:l}=e,u=Kh();let p=null;switch(u.status){case"complete":p=ts(i,u);break;case"incomplete":p=ts(a,u);break;case"active":p=ts(l,u);break}return p?b.jsx(b.Fragment,{children:p}):null}function HNe(e){return b.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 20 20","aria-hidden":"true",height:"1em",width:"1em",...e,children:b.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}function $Ne(e){const{status:i}=Kh(),a=xm(),l=i==="complete"?HNe:void 0;return b.jsx(jr,{as:l,__css:a.icon,...e,className:ot("chakra-step__icon",e.className)})}var oz=$e(function(i,a){const{children:l,...u}=i,{status:p,index:m}=Kh(),v=xm();return b.jsx(je.div,{ref:a,"data-status":p,__css:v.number,...u,className:ot("chakra-step__number",i.className),children:l||m+1})});function KNe(e){const{status:i}=Kh(),a=xm();return b.jsx(je.div,{"data-status":i,...e,__css:a.indicator,className:ot("chakra-step__indicator",e.className)})}var YNe=$e(function(i,a){const{orientation:l,status:u,isLast:p,showLastSeparator:m}=Kh(),v=xm();return p&&!m?null:b.jsx(je.div,{ref:a,role:"separator","data-orientation":l,"data-status":u,__css:v.separator,...i,className:ot("chakra-step__separator",i.className)})}),[qNe,yE]=zn({name:"TableStylesContext",errorMessage:`useTableStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Table />" `}),pY=$e((e,i)=>{const a=Ai("Table",e),{className:l,layout:u,...p}=ar(e);return b.jsx(qNe,{value:a,children:b.jsx(je.table,{ref:i,__css:{tableLayout:u,...a.table},className:ot("chakra-table",l),...p})})});pY.displayName="Table";var JNe=$e((e,i)=>{const a=yE();return b.jsx(je.thead,{...e,ref:i,__css:a.thead})}),tN=$e((e,i)=>{const a=yE();return b.jsx(je.tr,{...e,ref:i,__css:a.tr})}),XNe=$e((e,i)=>{var a;const{overflow:l,overflowX:u,className:p,...m}=e;return b.jsx(je.div,{ref:i,className:ot("chakra-table__container",p),...m,__css:{display:"block",whiteSpace:"nowrap",WebkitOverflowScrolling:"touch",overflowX:(a=l??u)!=null?a:"auto",overflowY:"hidden",maxWidth:"100%"}})}),QNe=$e((e,i)=>{const a=yE();return b.jsx(je.tbody,{...e,ref:i,__css:a.tbody})}),gf=$e(({isNumeric:e,...i},a)=>{const l=yE();return b.jsx(je.td,{...i,ref:a,__css:l.td,"data-is-numeric":e})}),$S=$e(({isNumeric:e,...i},a)=>{const l=yE();return b.jsx(je.th,{...i,ref:a,__css:l.th,"data-is-numeric":e})}),[ZNe,ePe,tPe,nPe]=lx();function rPe(e){var i;const{defaultIndex:a,onChange:l,index:u,isManual:p,isLazy:m,lazyBehavior:v="unmount",orientation:y="horizontal",direction:S="ltr",...C}=e,[R,N]=F.useState(a??0),[x,U]=ux({defaultValue:a??0,value:u,onChange:l});F.useEffect(()=>{u!=null&&N(u)},[u]);const M=tPe(),z=F.useId();return{id:`tabs-${(i=e.id)!=null?i:z}`,selectedIndex:x,focusedIndex:R,setSelectedIndex:U,setFocusedIndex:N,isManual:p,isLazy:m,lazyBehavior:v,orientation:y,descendants:M,direction:S,htmlProps:C}}var[iPe,NC]=zn({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function oPe(e){const{focusedIndex:i,orientation:a,direction:l}=NC(),u=ePe(),p=F.useCallback(m=>{const v=()=>{var W;const H=u.nextEnabled(i);H&&((W=H.node)==null||W.focus())},y=()=>{var W;const H=u.prevEnabled(i);H&&((W=H.node)==null||W.focus())},S=()=>{var W;const H=u.firstEnabled();H&&((W=H.node)==null||W.focus())},C=()=>{var W;const H=u.lastEnabled();H&&((W=H.node)==null||W.focus())},R=a==="horizontal",N=a==="vertical",x=m.key,U=l==="ltr"?"ArrowLeft":"ArrowRight",M=l==="ltr"?"ArrowRight":"ArrowLeft",V={[U]:()=>R&&y(),[M]:()=>R&&v(),ArrowDown:()=>N&&v(),ArrowUp:()=>N&&y(),Home:S,End:C}[x];V&&(m.preventDefault(),V(m))},[u,i,a,l]);return{...e,role:"tablist","aria-orientation":a,onKeyDown:$t(e.onKeyDown,p)}}function sPe(e){const{isDisabled:i=!1,isFocusable:a=!1,...l}=e,{setSelectedIndex:u,isManual:p,id:m,setFocusedIndex:v,selectedIndex:y}=NC(),{index:S,register:C}=nPe({disabled:i&&!a}),R=S===y,N=()=>{u(S)},x=()=>{v(S),!p&&!(i&&a)&&u(S)};return{...NK({...l,ref:yi(C,e.ref),isDisabled:i,isFocusable:a,onClick:$t(e.onClick,N)}),id:fY(m,S),role:"tab",tabIndex:R?0:-1,type:"button","aria-selected":R,"aria-controls":mY(m,S),onFocus:i?void 0:$t(e.onFocus,x)}}var[aPe,cPe]=zn({});function lPe(e){const i=NC(),{id:a,selectedIndex:l}=i,p=fx(e.children).map((m,v)=>F.createElement(aPe,{key:v,value:{isSelected:v===l,id:mY(a,v),tabId:fY(a,v),selectedIndex:l}},m));return{...e,children:p}}function dPe(e){const{children:i,...a}=e,{isLazy:l,lazyBehavior:u}=NC(),{isSelected:p,id:m,tabId:v}=cPe(),y=F.useRef(!1);p&&(y.current=!0);const S=zK({wasSelected:y.current,isSelected:p,enabled:l,mode:u});return{tabIndex:0,...a,children:S?i:null,role:"tabpanel","aria-labelledby":v,hidden:!p,id:m}}function fY(e,i){return`${e}--tab-${i}`}function mY(e,i){return`${e}--tabpanel-${i}`}var[uPe,PC]=zn({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),gY=$e(function(i,a){const l=Ai("Tabs",i),{children:u,className:p,...m}=ar(i),{htmlProps:v,descendants:y,...S}=rPe(m),C=F.useMemo(()=>S,[S]),{isFitted:R,...N}=v,x={position:"relative",...l.root};return b.jsx(ZNe,{value:y,children:b.jsx(iPe,{value:C,children:b.jsx(uPe,{value:l,children:b.jsx(je.div,{className:ot("chakra-tabs",p),ref:a,...N,__css:x,children:u})})})})});gY.displayName="Tabs";var _Y=$e(function(i,a){const l=oPe({...i,ref:a}),p={display:"flex",...PC().tablist};return b.jsx(je.div,{...l,className:ot("chakra-tabs__tablist",i.className),__css:p})});_Y.displayName="TabList";var OT=$e(function(i,a){const l=dPe({...i,ref:a}),u=PC();return b.jsx(je.div,{outline:"0",...l,className:ot("chakra-tabs__tab-panel",i.className),__css:u.tabpanel})});OT.displayName="TabPanel";var vY=$e(function(i,a){const l=lPe(i),u=PC();return b.jsx(je.div,{...l,width:"100%",ref:a,className:ot("chakra-tabs__tab-panels",i.className),__css:u.tabpanels})});vY.displayName="TabPanels";var NT=$e(function(i,a){const l=PC(),u=sPe({...i,ref:a}),p={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...l.tab};return b.jsx(je.button,{...u,className:ot("chakra-tabs__tab",i.className),__css:p})});NT.displayName="Tab";var[hPe,EY]=zn({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),gl=$e((e,i)=>{const a=Ai("Tag",e),l=ar(e),u={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...a.container};return b.jsx(hPe,{value:a,children:b.jsx(je.span,{ref:i,...l,__css:u})})});gl.displayName="Tag";var pPe=$e((e,i)=>{const a=EY();return b.jsx(je.span,{ref:i,noOfLines:1,...e,__css:a.label})});pPe.displayName="TagLabel";var fPe=$e((e,i)=>b.jsx(jr,{ref:i,verticalAlign:"top",marginEnd:"0.5rem",...e}));fPe.displayName="TagLeftIcon";var mPe=$e((e,i)=>b.jsx(jr,{ref:i,verticalAlign:"top",marginStart:"0.5rem",...e}));mPe.displayName="TagRightIcon";var yY=e=>b.jsx(jr,{verticalAlign:"inherit",viewBox:"0 0 512 512",...e,children:b.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});yY.displayName="TagCloseIcon";var SY=$e((e,i)=>{const{isDisabled:a,children:l,...u}=e,m={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...EY().closeButton};return b.jsx(je.button,{ref:i,"aria-label":"close",...u,type:"button",disabled:a,__css:m,children:l||b.jsx(yY,{})})});SY.displayName="TagCloseButton";function gPe(e,i=[]){const a=Object.assign({},e);for(const l of i)l in a&&delete a[l];return a}var _Pe=["h","minH","height","minHeight"],nk=$e((e,i)=>{const a=Ka("Textarea",e),{className:l,rows:u,...p}=ar(e),m=mx(p),v=u?gPe(a,_Pe):a;return b.jsx(je.textarea,{ref:i,rows:u,...m,className:ot("chakra-textarea",l),__css:v})});nk.displayName="Textarea";var vPe={exit:{scale:.85,opacity:0,transition:{opacity:{duration:.15,easings:"easeInOut"},scale:{duration:.2,easings:"easeInOut"}}},enter:{scale:1,opacity:1,transition:{opacity:{easings:"easeOut",duration:.2},scale:{duration:.2,ease:[.175,.885,.4,1.1]}}}},rk=e=>{var i;return((i=e.current)==null?void 0:i.ownerDocument)||document},PT=e=>{var i,a;return((a=(i=e.current)==null?void 0:i.ownerDocument)==null?void 0:a.defaultView)||window};function EPe(e={}){const{openDelay:i=0,closeDelay:a=0,closeOnClick:l=!0,closeOnMouseDown:u,closeOnScroll:p,closeOnPointerDown:m=u,closeOnEsc:v=!0,onOpen:y,onClose:S,placement:C,id:R,isOpen:N,defaultIsOpen:x,arrowSize:U=10,arrowShadowColor:M,arrowPadding:z,modifiers:V,isDisabled:W,gutter:H,offset:q,direction:ee,...oe}=e,{isOpen:se,onOpen:re,onClose:me}=BK({isOpen:N,defaultIsOpen:x,onOpen:y,onClose:S}),{referenceRef:pe,getPopperProps:Re,getArrowInnerProps:Ze,getArrowProps:Qe}=VK({enabled:se,placement:C,arrowPadding:z,modifiers:V,gutter:H,offset:q,direction:ee}),Oe=F.useId(),Te=`tooltip-${R??Oe}`,de=F.useRef(null),ue=F.useRef(),be=F.useCallback(()=>{ue.current&&(clearTimeout(ue.current),ue.current=void 0)},[]),xe=F.useRef(),He=F.useCallback(()=>{xe.current&&(clearTimeout(xe.current),xe.current=void 0)},[]),rt=F.useCallback(()=>{He(),me()},[me,He]),Ye=yPe(de,rt),Ge=F.useCallback(()=>{if(!W&&!ue.current){se&&Ye();const bt=PT(de);ue.current=bt.setTimeout(re,i)}},[Ye,W,se,re,i]),_t=F.useCallback(()=>{be();const bt=PT(de);xe.current=bt.setTimeout(rt,a)},[a,rt,be]),kt=F.useCallback(()=>{se&&l&&_t()},[l,_t,se]),sn=F.useCallback(()=>{se&&m&&_t()},[m,_t,se]),cn=F.useCallback(bt=>{se&&bt.key==="Escape"&&_t()},[se,_t]);bT(()=>rk(de),"keydown",v?cn:void 0),bT(()=>{if(!p)return null;const bt=de.current;if(!bt)return null;const Qn=yK(bt);return Qn.localName==="body"?PT(de):Qn},"scroll",()=>{se&&p&&rt()},{passive:!0,capture:!0}),F.useEffect(()=>{W&&(be(),se&&me())},[W,se,me,be]),F.useEffect(()=>()=>{be(),He()},[be,He]),bT(()=>de.current,"pointerleave",_t);const Gn=F.useCallback((bt={},Qn=null)=>({...bt,ref:yi(de,Qn,pe),onPointerEnter:$t(bt.onPointerEnter,Ct=>{Ct.pointerType!=="touch"&&Ge()}),onClick:$t(bt.onClick,kt),onPointerDown:$t(bt.onPointerDown,sn),onFocus:$t(bt.onFocus,Ge),onBlur:$t(bt.onBlur,_t),"aria-describedby":se?Te:void 0}),[Ge,_t,sn,se,Te,kt,pe]),vn=F.useCallback((bt={},Qn=null)=>Re({...bt,style:{...bt.style,[Ki.arrowSize.var]:U?`${U}px`:void 0,[Ki.arrowShadowColor.var]:M}},Qn),[Re,U,M]),St=F.useCallback((bt={},Qn=null)=>{const Hn={...bt.style,position:"relative",transformOrigin:Ki.transformOrigin.varRef};return{ref:Qn,...oe,...bt,id:Te,role:"tooltip",style:Hn}},[oe,Te]);return{isOpen:se,show:Ge,hide:_t,getTriggerProps:Gn,getTooltipProps:St,getTooltipPositionerProps:vn,getArrowProps:Qe,getArrowInnerProps:Ze}}var nN="chakra-ui:close-tooltip";function yPe(e,i){return F.useEffect(()=>{const a=rk(e);return a.addEventListener(nN,i),()=>a.removeEventListener(nN,i)},[i,e]),()=>{const a=rk(e),l=PT(e);a.dispatchEvent(new l.CustomEvent(nN))}}function SPe(e,i=[]){const a=Object.assign({},e);for(const l of i)l in a&&delete a[l];return a}function TPe(e,i){const a={};for(const l of i)l in e&&(a[l]=e[l]);return a}var bPe=je(Ml.div),_f=$e((e,i)=>{var a,l;const u=Ka("Tooltip",e),p=ar(e),m=Bh(),{children:v,label:y,shouldWrapChildren:S,"aria-label":C,hasArrow:R,bg:N,portalProps:x,background:U,backgroundColor:M,bgColor:z,motionProps:V,...W}=p,H=(l=(a=U??M)!=null?a:N)!=null?l:z;if(H){u.bg=H;const Re=rfe(m,"colors",H);u[Ki.arrowBg.var]=Re}const q=EPe({...W,direction:m.direction}),ee=typeof v=="string"||S;let oe;if(ee)oe=b.jsx(je.span,{display:"inline-block",tabIndex:0,...q.getTriggerProps(),children:v});else{const Re=F.Children.only(v);oe=F.cloneElement(Re,q.getTriggerProps(Re.props,Re.ref))}const se=!!C,re=q.getTooltipProps({},i),me=se?SPe(re,["role","id"]):re,pe=TPe(re,["role","id"]);return y?b.jsxs(b.Fragment,{children:[oe,b.jsx(zh,{children:q.isOpen&&b.jsx(Vh,{...x,children:b.jsx(je.div,{...q.getTooltipPositionerProps(),__css:{zIndex:u.zIndex,pointerEvents:"none"},children:b.jsxs(bPe,{variants:vPe,initial:"exit",animate:"enter",exit:"exit",...V,...me,__css:u,children:[y,se&&b.jsx(je.span,{srOnly:!0,...pe,children:C}),R&&b.jsx(je.div,{"data-popper-arrow":!0,className:"chakra-tooltip__arrow-wrapper",children:b.jsx(je.div,{"data-popper-arrow-inner":!0,className:"chakra-tooltip__arrow",__css:{bg:u.bg}})})]})})})})]}):b.jsx(b.Fragment,{children:v})});_f.displayName="Tooltip";/**
 * @remix-run/router v1.15.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yv(){return Yv=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},Yv.apply(this,arguments)}var $d;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})($d||($d={}));const sz="popstate";function CPe(e){e===void 0&&(e={});function i(l,u){let{pathname:p,search:m,hash:v}=l.location;return ik("",{pathname:p,search:m,hash:v},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function a(l,u){return typeof u=="string"?u:bb(u)}return RPe(i,a,null,e)}function Ei(e,i){if(e===!1||e===null||typeof e>"u")throw new Error(i)}function TY(e,i){if(!e){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function wPe(){return Math.random().toString(36).substr(2,8)}function az(e,i){return{usr:e.state,key:e.key,idx:i}}function ik(e,i,a,l){return a===void 0&&(a=null),Yv({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof i=="string"?Lm(i):i,{state:a,key:i&&i.key||l||wPe()})}function bb(e){let{pathname:i="/",search:a="",hash:l=""}=e;return a&&a!=="?"&&(i+=a.charAt(0)==="?"?a:"?"+a),l&&l!=="#"&&(i+=l.charAt(0)==="#"?l:"#"+l),i}function Lm(e){let i={};if(e){let a=e.indexOf("#");a>=0&&(i.hash=e.substr(a),e=e.substr(0,a));let l=e.indexOf("?");l>=0&&(i.search=e.substr(l),e=e.substr(0,l)),e&&(i.pathname=e)}return i}function RPe(e,i,a,l){l===void 0&&(l={});let{window:u=document.defaultView,v5Compat:p=!1}=l,m=u.history,v=$d.Pop,y=null,S=C();S==null&&(S=0,m.replaceState(Yv({},m.state,{idx:S}),""));function C(){return(m.state||{idx:null}).idx}function R(){v=$d.Pop;let z=C(),V=z==null?null:z-S;S=z,y&&y({action:v,location:M.location,delta:V})}function N(z,V){v=$d.Push;let W=ik(M.location,z,V);S=C()+1;let H=az(W,S),q=M.createHref(W);try{m.pushState(H,"",q)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;u.location.assign(q)}p&&y&&y({action:v,location:M.location,delta:1})}function x(z,V){v=$d.Replace;let W=ik(M.location,z,V);S=C();let H=az(W,S),q=M.createHref(W);m.replaceState(H,"",q),p&&y&&y({action:v,location:M.location,delta:0})}function U(z){let V=u.location.origin!=="null"?u.location.origin:u.location.href,W=typeof z=="string"?z:bb(z);return W=W.replace(/ $/,"%20"),Ei(V,"No window.location.(origin|href) available to create URL for href: "+W),new URL(W,V)}let M={get action(){return v},get location(){return e(u,m)},listen(z){if(y)throw new Error("A history only accepts one active listener");return u.addEventListener(sz,R),y=z,()=>{u.removeEventListener(sz,R),y=null}},createHref(z){return i(u,z)},createURL:U,encodeLocation(z){let V=U(z);return{pathname:V.pathname,search:V.search,hash:V.hash}},push:N,replace:x,go(z){return m.go(z)}};return M}var cz;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(cz||(cz={}));function IPe(e,i,a){a===void 0&&(a="/");let l=typeof i=="string"?Lm(i):i,u=Bx(l.pathname||"/",a);if(u==null)return null;let p=bY(e);APe(p);let m=null;for(let v=0;m==null&&v<p.length;++v){let y=VPe(u);m=UPe(p[v],y)}return m}function bY(e,i,a,l){i===void 0&&(i=[]),a===void 0&&(a=[]),l===void 0&&(l="");let u=(p,m,v)=>{let y={relativePath:v===void 0?p.path||"":v,caseSensitive:p.caseSensitive===!0,childrenIndex:m,route:p};y.relativePath.startsWith("/")&&(Ei(y.relativePath.startsWith(l),'Absolute route path "'+y.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),y.relativePath=y.relativePath.slice(l.length));let S=iu([l,y.relativePath]),C=a.concat(y);p.children&&p.children.length>0&&(Ei(p.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+S+'".')),bY(p.children,i,C,S)),!(p.path==null&&!p.index)&&i.push({path:S,score:LPe(S,p.index),routesMeta:C})};return e.forEach((p,m)=>{var v;if(p.path===""||!((v=p.path)!=null&&v.includes("?")))u(p,m);else for(let y of CY(p.path))u(p,m,y)}),i}function CY(e){let i=e.split("/");if(i.length===0)return[];let[a,...l]=i,u=a.endsWith("?"),p=a.replace(/\?$/,"");if(l.length===0)return u?[p,""]:[p];let m=CY(l.join("/")),v=[];return v.push(...m.map(y=>y===""?p:[p,y].join("/"))),u&&v.push(...m),v.map(y=>e.startsWith("/")&&y===""?"/":y)}function APe(e){e.sort((i,a)=>i.score!==a.score?a.score-i.score:MPe(i.routesMeta.map(l=>l.childrenIndex),a.routesMeta.map(l=>l.childrenIndex)))}const OPe=/^:[\w-]+$/,NPe=3,PPe=2,kPe=1,DPe=10,xPe=-2,lz=e=>e==="*";function LPe(e,i){let a=e.split("/"),l=a.length;return a.some(lz)&&(l+=xPe),i&&(l+=PPe),a.filter(u=>!lz(u)).reduce((u,p)=>u+(OPe.test(p)?NPe:p===""?kPe:DPe),l)}function MPe(e,i){return e.length===i.length&&e.slice(0,-1).every((l,u)=>l===i[u])?e[e.length-1]-i[i.length-1]:0}function UPe(e,i){let{routesMeta:a}=e,l={},u="/",p=[];for(let m=0;m<a.length;++m){let v=a[m],y=m===a.length-1,S=u==="/"?i:i.slice(u.length)||"/",C=jPe({path:v.relativePath,caseSensitive:v.caseSensitive,end:y},S);if(!C)return null;Object.assign(l,C.params);let R=v.route;p.push({params:l,pathname:iu([u,C.pathname]),pathnameBase:GPe(iu([u,C.pathnameBase])),route:R}),C.pathnameBase!=="/"&&(u=iu([u,C.pathnameBase]))}return p}function jPe(e,i){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,l]=FPe(e.path,e.caseSensitive,e.end),u=i.match(a);if(!u)return null;let p=u[0],m=p.replace(/(.)\/+$/,"$1"),v=u.slice(1);return{params:l.reduce((S,C,R)=>{let{paramName:N,isOptional:x}=C;if(N==="*"){let M=v[R]||"";m=p.slice(0,p.length-M.length).replace(/(.)\/+$/,"$1")}const U=v[R];return x&&!U?S[N]=void 0:S[N]=(U||"").replace(/%2F/g,"/"),S},{}),pathname:p,pathnameBase:m,pattern:e}}function FPe(e,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),TY(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let l=[],u="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,v,y)=>(l.push({paramName:v,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(l.push({paramName:"*"}),u+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?u+="\\/*$":e!==""&&e!=="/"&&(u+="(?:(?=\\/|$))"),[new RegExp(u,i?void 0:"i"),l]}function VPe(e){try{return e.split("/").map(i=>decodeURIComponent(i).replace(/\//g,"%2F")).join("/")}catch(i){return TY(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),e}}function Bx(e,i){if(i==="/")return e;if(!e.toLowerCase().startsWith(i.toLowerCase()))return null;let a=i.endsWith("/")?i.length-1:i.length,l=e.charAt(a);return l&&l!=="/"?null:e.slice(a)||"/"}function BPe(e,i){i===void 0&&(i="/");let{pathname:a,search:l="",hash:u=""}=typeof e=="string"?Lm(e):e;return{pathname:a?a.startsWith("/")?a:WPe(a,i):i,search:HPe(l),hash:$Pe(u)}}function WPe(e,i){let a=i.replace(/\/+$/,"").split("/");return e.split("/").forEach(u=>{u===".."?a.length>1&&a.pop():u!=="."&&a.push(u)}),a.length>1?a.join("/"):"/"}function rN(e,i,a,l){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+i+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zPe(e){return e.filter((i,a)=>a===0||i.route.path&&i.route.path.length>0)}function wY(e,i){let a=zPe(e);return i?a.map((l,u)=>u===e.length-1?l.pathname:l.pathnameBase):a.map(l=>l.pathnameBase)}function RY(e,i,a,l){l===void 0&&(l=!1);let u;typeof e=="string"?u=Lm(e):(u=Yv({},e),Ei(!u.pathname||!u.pathname.includes("?"),rN("?","pathname","search",u)),Ei(!u.pathname||!u.pathname.includes("#"),rN("#","pathname","hash",u)),Ei(!u.search||!u.search.includes("#"),rN("#","search","hash",u)));let p=e===""||u.pathname==="",m=p?"/":u.pathname,v;if(m==null)v=a;else{let R=i.length-1;if(!l&&m.startsWith("..")){let N=m.split("/");for(;N[0]==="..";)N.shift(),R-=1;u.pathname=N.join("/")}v=R>=0?i[R]:"/"}let y=BPe(u,v),S=m&&m!=="/"&&m.endsWith("/"),C=(p||m===".")&&a.endsWith("/");return!y.pathname.endsWith("/")&&(S||C)&&(y.pathname+="/"),y}const iu=e=>e.join("/").replace(/\/\/+/g,"/"),GPe=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),HPe=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,$Pe=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function KPe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const IY=["post","put","patch","delete"];new Set(IY);const YPe=["get",...IY];new Set(YPe);/**
 * React Router v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qv(){return qv=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},qv.apply(this,arguments)}const Wx=F.createContext(null),qPe=F.createContext(null),Yh=F.createContext(null),kC=F.createContext(null),gu=F.createContext({outlet:null,matches:[],isDataRoute:!1}),AY=F.createContext(null);function JPe(e,i){let{relative:a}=i===void 0?{}:i;SE()||Ei(!1);let{basename:l,navigator:u}=F.useContext(Yh),{hash:p,pathname:m,search:v}=NY(e,{relative:a}),y=m;return l!=="/"&&(y=m==="/"?l:iu([l,m])),u.createHref({pathname:y,search:v,hash:p})}function SE(){return F.useContext(kC)!=null}function Ul(){return SE()||Ei(!1),F.useContext(kC).location}function OY(e){F.useContext(Yh).static||F.useLayoutEffect(e)}function ds(){let{isDataRoute:e}=F.useContext(gu);return e?dke():XPe()}function XPe(){SE()||Ei(!1);let e=F.useContext(Wx),{basename:i,future:a,navigator:l}=F.useContext(Yh),{matches:u}=F.useContext(gu),{pathname:p}=Ul(),m=JSON.stringify(wY(u,a.v7_relativeSplatPath)),v=F.useRef(!1);return OY(()=>{v.current=!0}),F.useCallback(function(S,C){if(C===void 0&&(C={}),!v.current)return;if(typeof S=="number"){l.go(S);return}let R=RY(S,JSON.parse(m),p,C.relative==="path");e==null&&i!=="/"&&(R.pathname=R.pathname==="/"?i:iu([i,R.pathname])),(C.replace?l.replace:l.push)(R,C.state,C)},[i,l,m,p,e])}function QPe(){let{matches:e}=F.useContext(gu),i=e[e.length-1];return i?i.params:{}}function NY(e,i){let{relative:a}=i===void 0?{}:i,{future:l}=F.useContext(Yh),{matches:u}=F.useContext(gu),{pathname:p}=Ul(),m=JSON.stringify(wY(u,l.v7_relativeSplatPath));return F.useMemo(()=>RY(e,JSON.parse(m),p,a==="path"),[e,m,p,a])}function ZPe(e,i){return eke(e,i)}function eke(e,i,a,l){SE()||Ei(!1);let{navigator:u}=F.useContext(Yh),{matches:p}=F.useContext(gu),m=p[p.length-1],v=m?m.params:{};m&&m.pathname;let y=m?m.pathnameBase:"/";m&&m.route;let S=Ul(),C;if(i){var R;let z=typeof i=="string"?Lm(i):i;y==="/"||(R=z.pathname)!=null&&R.startsWith(y)||Ei(!1),C=z}else C=S;let N=C.pathname||"/",x=N;if(y!=="/"){let z=y.replace(/^\//,"").split("/");x="/"+N.replace(/^\//,"").split("/").slice(z.length).join("/")}let U=IPe(e,{pathname:x}),M=oke(U&&U.map(z=>Object.assign({},z,{params:Object.assign({},v,z.params),pathname:iu([y,u.encodeLocation?u.encodeLocation(z.pathname).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?y:iu([y,u.encodeLocation?u.encodeLocation(z.pathnameBase).pathname:z.pathnameBase])})),p,a,l);return i&&M?F.createElement(kC.Provider,{value:{location:qv({pathname:"/",search:"",hash:"",state:null,key:"default"},C),navigationType:$d.Pop}},M):M}function tke(){let e=lke(),i=KPe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,u={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},i),a?F.createElement("pre",{style:u},a):null,null)}const nke=F.createElement(tke,null);class rke extends F.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,a){return a.location!==i.location||a.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:a.error,location:a.location,revalidation:i.revalidation||a.revalidation}}componentDidCatch(i,a){console.error("React Router caught the following error during render",i,a)}render(){return this.state.error!==void 0?F.createElement(gu.Provider,{value:this.props.routeContext},F.createElement(AY.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ike(e){let{routeContext:i,match:a,children:l}=e,u=F.useContext(Wx);return u&&u.static&&u.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(u.staticContext._deepestRenderedBoundaryId=a.route.id),F.createElement(gu.Provider,{value:i},l)}function oke(e,i,a,l){var u;if(i===void 0&&(i=[]),a===void 0&&(a=null),l===void 0&&(l=null),e==null){var p;if((p=a)!=null&&p.errors)e=a.matches;else return null}let m=e,v=(u=a)==null?void 0:u.errors;if(v!=null){let C=m.findIndex(R=>R.route.id&&(v==null?void 0:v[R.route.id]));C>=0||Ei(!1),m=m.slice(0,Math.min(m.length,C+1))}let y=!1,S=-1;if(a&&l&&l.v7_partialHydration)for(let C=0;C<m.length;C++){let R=m[C];if((R.route.HydrateFallback||R.route.hydrateFallbackElement)&&(S=C),R.route.id){let{loaderData:N,errors:x}=a,U=R.route.loader&&N[R.route.id]===void 0&&(!x||x[R.route.id]===void 0);if(R.route.lazy||U){y=!0,S>=0?m=m.slice(0,S+1):m=[m[0]];break}}}return m.reduceRight((C,R,N)=>{let x,U=!1,M=null,z=null;a&&(x=v&&R.route.id?v[R.route.id]:void 0,M=R.route.errorElement||nke,y&&(S<0&&N===0?(uke("route-fallback"),U=!0,z=null):S===N&&(U=!0,z=R.route.hydrateFallbackElement||null)));let V=i.concat(m.slice(0,N+1)),W=()=>{let H;return x?H=M:U?H=z:R.route.Component?H=F.createElement(R.route.Component,null):R.route.element?H=R.route.element:H=C,F.createElement(ike,{match:R,routeContext:{outlet:C,matches:V,isDataRoute:a!=null},children:H})};return a&&(R.route.ErrorBoundary||R.route.errorElement||N===0)?F.createElement(rke,{location:a.location,revalidation:a.revalidation,component:M,error:x,children:W(),routeContext:{outlet:null,matches:V,isDataRoute:!0}}):W()},null)}var PY=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(PY||{}),Cb=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Cb||{});function ske(e){let i=F.useContext(Wx);return i||Ei(!1),i}function ake(e){let i=F.useContext(qPe);return i||Ei(!1),i}function cke(e){let i=F.useContext(gu);return i||Ei(!1),i}function kY(e){let i=cke(),a=i.matches[i.matches.length-1];return a.route.id||Ei(!1),a.route.id}function lke(){var e;let i=F.useContext(AY),a=ake(Cb.UseRouteError),l=kY(Cb.UseRouteError);return i!==void 0?i:(e=a.errors)==null?void 0:e[l]}function dke(){let{router:e}=ske(PY.UseNavigateStable),i=kY(Cb.UseNavigateStable),a=F.useRef(!1);return OY(()=>{a.current=!0}),F.useCallback(function(u,p){p===void 0&&(p={}),a.current&&(typeof u=="number"?e.navigate(u):e.navigate(u,qv({fromRouteId:i},p)))},[e,i])}const dz={};function uke(e,i,a){dz[e]||(dz[e]=!0)}function lo(e){Ei(!1)}function hke(e){let{basename:i="/",children:a=null,location:l,navigationType:u=$d.Pop,navigator:p,static:m=!1,future:v}=e;SE()&&Ei(!1);let y=i.replace(/^\/*/,"/"),S=F.useMemo(()=>({basename:y,navigator:p,static:m,future:qv({v7_relativeSplatPath:!1},v)}),[y,v,p,m]);typeof l=="string"&&(l=Lm(l));let{pathname:C="/",search:R="",hash:N="",state:x=null,key:U="default"}=l,M=F.useMemo(()=>{let z=Bx(C,y);return z==null?null:{location:{pathname:z,search:R,hash:N,state:x,key:U},navigationType:u}},[y,C,R,N,x,U,u]);return M==null?null:F.createElement(Yh.Provider,{value:S},F.createElement(kC.Provider,{children:a,value:M}))}function pke(e){let{children:i,location:a}=e;return ZPe(ok(i),a)}new Promise(()=>{});function ok(e,i){i===void 0&&(i=[]);let a=[];return F.Children.forEach(e,(l,u)=>{if(!F.isValidElement(l))return;let p=[...i,u];if(l.type===F.Fragment){a.push.apply(a,ok(l.props.children,p));return}l.type!==lo&&Ei(!1),!l.props.index||!l.props.children||Ei(!1);let m={id:l.props.id||p.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(m.children=ok(l.props.children,p)),a.push(m)}),a}/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sk(){return sk=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},sk.apply(this,arguments)}function fke(e,i){if(e==null)return{};var a={},l=Object.keys(e),u,p;for(p=0;p<l.length;p++)u=l[p],!(i.indexOf(u)>=0)&&(a[u]=e[u]);return a}function mke(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function gke(e,i){return e.button===0&&(!i||i==="_self")&&!mke(e)}const _ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],vke="6";try{window.__reactRouterVersion=vke}catch{}const Eke="startTransition",uz=fN[Eke];function yke(e){let{basename:i,children:a,future:l,window:u}=e,p=F.useRef();p.current==null&&(p.current=CPe({window:u,v5Compat:!0}));let m=p.current,[v,y]=F.useState({action:m.action,location:m.location}),{v7_startTransition:S}=l||{},C=F.useCallback(R=>{S&&uz?uz(()=>y(R)):y(R)},[y,S]);return F.useLayoutEffect(()=>m.listen(C),[m,C]),F.createElement(hke,{basename:i,children:a,location:v.location,navigationType:v.action,navigator:m,future:l})}const Ske=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Tke=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bn=F.forwardRef(function(i,a){let{onClick:l,relative:u,reloadDocument:p,replace:m,state:v,target:y,to:S,preventScrollReset:C,unstable_viewTransition:R}=i,N=fke(i,_ke),{basename:x}=F.useContext(Yh),U,M=!1;if(typeof S=="string"&&Tke.test(S)&&(U=S,Ske))try{let H=new URL(window.location.href),q=S.startsWith("//")?new URL(H.protocol+S):new URL(S),ee=Bx(q.pathname,x);q.origin===H.origin&&ee!=null?S=ee+q.search+q.hash:M=!0}catch{}let z=JPe(S,{relative:u}),V=bke(S,{replace:m,state:v,target:y,preventScrollReset:C,relative:u,unstable_viewTransition:R});function W(H){l&&l(H),H.defaultPrevented||V(H)}return F.createElement("a",sk({},N,{href:U||z,onClick:M||p?l:W,ref:a,target:y}))});var hz;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(hz||(hz={}));var pz;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(pz||(pz={}));function bke(e,i){let{target:a,replace:l,state:u,preventScrollReset:p,relative:m,unstable_viewTransition:v}=i===void 0?{}:i,y=ds(),S=Ul(),C=NY(e,{relative:m});return F.useCallback(R=>{if(gke(R,a)){R.preventDefault();let N=l!==void 0?l:bb(S)===bb(C);y(e,{replace:N,state:u,preventScrollReset:p,relative:m,unstable_viewTransition:v})}},[S,y,C,l,u,a,e,p,m,v])}function DY(e,i){return function(){return e.apply(i,arguments)}}const{toString:Cke}=Object.prototype,{getPrototypeOf:zx}=Object,DC=(e=>i=>{const a=Cke.call(i);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),Uc=e=>(e=e.toLowerCase(),i=>DC(i)===e),xC=e=>i=>typeof i===e,{isArray:Mm}=Array,Jv=xC("undefined");function wke(e){return e!==null&&!Jv(e)&&e.constructor!==null&&!Jv(e.constructor)&&_a(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const xY=Uc("ArrayBuffer");function Rke(e){let i;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?i=ArrayBuffer.isView(e):i=e&&e.buffer&&xY(e.buffer),i}const Ike=xC("string"),_a=xC("function"),LY=xC("number"),LC=e=>e!==null&&typeof e=="object",Ake=e=>e===!0||e===!1,kT=e=>{if(DC(e)!=="object")return!1;const i=zx(e);return(i===null||i===Object.prototype||Object.getPrototypeOf(i)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Oke=Uc("Date"),Nke=Uc("File"),Pke=Uc("Blob"),kke=Uc("FileList"),Dke=e=>LC(e)&&_a(e.pipe),xke=e=>{let i;return e&&(typeof FormData=="function"&&e instanceof FormData||_a(e.append)&&((i=DC(e))==="formdata"||i==="object"&&_a(e.toString)&&e.toString()==="[object FormData]"))},Lke=Uc("URLSearchParams"),Mke=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function TE(e,i,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let l,u;if(typeof e!="object"&&(e=[e]),Mm(e))for(l=0,u=e.length;l<u;l++)i.call(null,e[l],l,e);else{const p=a?Object.getOwnPropertyNames(e):Object.keys(e),m=p.length;let v;for(l=0;l<m;l++)v=p[l],i.call(null,e[v],v,e)}}function MY(e,i){i=i.toLowerCase();const a=Object.keys(e);let l=a.length,u;for(;l-- >0;)if(u=a[l],i===u.toLowerCase())return u;return null}const UY=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,jY=e=>!Jv(e)&&e!==UY;function ak(){const{caseless:e}=jY(this)&&this||{},i={},a=(l,u)=>{const p=e&&MY(i,u)||u;kT(i[p])&&kT(l)?i[p]=ak(i[p],l):kT(l)?i[p]=ak({},l):Mm(l)?i[p]=l.slice():i[p]=l};for(let l=0,u=arguments.length;l<u;l++)arguments[l]&&TE(arguments[l],a);return i}const Uke=(e,i,a,{allOwnKeys:l}={})=>(TE(i,(u,p)=>{a&&_a(u)?e[p]=DY(u,a):e[p]=u},{allOwnKeys:l}),e),jke=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Fke=(e,i,a,l)=>{e.prototype=Object.create(i.prototype,l),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:i.prototype}),a&&Object.assign(e.prototype,a)},Vke=(e,i,a,l)=>{let u,p,m;const v={};if(i=i||{},e==null)return i;do{for(u=Object.getOwnPropertyNames(e),p=u.length;p-- >0;)m=u[p],(!l||l(m,e,i))&&!v[m]&&(i[m]=e[m],v[m]=!0);e=a!==!1&&zx(e)}while(e&&(!a||a(e,i))&&e!==Object.prototype);return i},Bke=(e,i,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=i.length;const l=e.indexOf(i,a);return l!==-1&&l===a},Wke=e=>{if(!e)return null;if(Mm(e))return e;let i=e.length;if(!LY(i))return null;const a=new Array(i);for(;i-- >0;)a[i]=e[i];return a},zke=(e=>i=>e&&i instanceof e)(typeof Uint8Array<"u"&&zx(Uint8Array)),Gke=(e,i)=>{const l=(e&&e[Symbol.iterator]).call(e);let u;for(;(u=l.next())&&!u.done;){const p=u.value;i.call(e,p[0],p[1])}},Hke=(e,i)=>{let a;const l=[];for(;(a=e.exec(i))!==null;)l.push(a);return l},$ke=Uc("HTMLFormElement"),Kke=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,l,u){return l.toUpperCase()+u}),fz=(({hasOwnProperty:e})=>(i,a)=>e.call(i,a))(Object.prototype),Yke=Uc("RegExp"),FY=(e,i)=>{const a=Object.getOwnPropertyDescriptors(e),l={};TE(a,(u,p)=>{let m;(m=i(u,p,e))!==!1&&(l[p]=m||u)}),Object.defineProperties(e,l)},qke=e=>{FY(e,(i,a)=>{if(_a(e)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const l=e[a];if(_a(l)){if(i.enumerable=!1,"writable"in i){i.writable=!1;return}i.set||(i.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},Jke=(e,i)=>{const a={},l=u=>{u.forEach(p=>{a[p]=!0})};return Mm(e)?l(e):l(String(e).split(i)),a},Xke=()=>{},Qke=(e,i)=>(e=+e,Number.isFinite(e)?e:i),iN="abcdefghijklmnopqrstuvwxyz",mz="0123456789",VY={DIGIT:mz,ALPHA:iN,ALPHA_DIGIT:iN+iN.toUpperCase()+mz},Zke=(e=16,i=VY.ALPHA_DIGIT)=>{let a="";const{length:l}=i;for(;e--;)a+=i[Math.random()*l|0];return a};function eDe(e){return!!(e&&_a(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const tDe=e=>{const i=new Array(10),a=(l,u)=>{if(LC(l)){if(i.indexOf(l)>=0)return;if(!("toJSON"in l)){i[u]=l;const p=Mm(l)?[]:{};return TE(l,(m,v)=>{const y=a(m,u+1);!Jv(y)&&(p[v]=y)}),i[u]=void 0,p}}return l};return a(e,0)},nDe=Uc("AsyncFunction"),rDe=e=>e&&(LC(e)||_a(e))&&_a(e.then)&&_a(e.catch),Ue={isArray:Mm,isArrayBuffer:xY,isBuffer:wke,isFormData:xke,isArrayBufferView:Rke,isString:Ike,isNumber:LY,isBoolean:Ake,isObject:LC,isPlainObject:kT,isUndefined:Jv,isDate:Oke,isFile:Nke,isBlob:Pke,isRegExp:Yke,isFunction:_a,isStream:Dke,isURLSearchParams:Lke,isTypedArray:zke,isFileList:kke,forEach:TE,merge:ak,extend:Uke,trim:Mke,stripBOM:jke,inherits:Fke,toFlatObject:Vke,kindOf:DC,kindOfTest:Uc,endsWith:Bke,toArray:Wke,forEachEntry:Gke,matchAll:Hke,isHTMLForm:$ke,hasOwnProperty:fz,hasOwnProp:fz,reduceDescriptors:FY,freezeMethods:qke,toObjectSet:Jke,toCamelCase:Kke,noop:Xke,toFiniteNumber:Qke,findKey:MY,global:UY,isContextDefined:jY,ALPHABET:VY,generateString:Zke,isSpecCompliantForm:eDe,toJSONObject:tDe,isAsyncFn:nDe,isThenable:rDe};function Tn(e,i,a,l,u){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",i&&(this.code=i),a&&(this.config=a),l&&(this.request=l),u&&(this.response=u)}Ue.inherits(Tn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ue.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const BY=Tn.prototype,WY={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{WY[e]={value:e}});Object.defineProperties(Tn,WY);Object.defineProperty(BY,"isAxiosError",{value:!0});Tn.from=(e,i,a,l,u,p)=>{const m=Object.create(BY);return Ue.toFlatObject(e,m,function(y){return y!==Error.prototype},v=>v!=="isAxiosError"),Tn.call(m,e.message,i,a,l,u),m.cause=e,m.name=e.name,p&&Object.assign(m,p),m};const iDe=null;function ck(e){return Ue.isPlainObject(e)||Ue.isArray(e)}function zY(e){return Ue.endsWith(e,"[]")?e.slice(0,-2):e}function gz(e,i,a){return e?e.concat(i).map(function(u,p){return u=zY(u),!a&&p?"["+u+"]":u}).join(a?".":""):i}function oDe(e){return Ue.isArray(e)&&!e.some(ck)}const sDe=Ue.toFlatObject(Ue,{},null,function(i){return/^is[A-Z]/.test(i)});function MC(e,i,a){if(!Ue.isObject(e))throw new TypeError("target must be an object");i=i||new FormData,a=Ue.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(M,z){return!Ue.isUndefined(z[M])});const l=a.metaTokens,u=a.visitor||C,p=a.dots,m=a.indexes,y=(a.Blob||typeof Blob<"u"&&Blob)&&Ue.isSpecCompliantForm(i);if(!Ue.isFunction(u))throw new TypeError("visitor must be a function");function S(U){if(U===null)return"";if(Ue.isDate(U))return U.toISOString();if(!y&&Ue.isBlob(U))throw new Tn("Blob is not supported. Use a Buffer instead.");return Ue.isArrayBuffer(U)||Ue.isTypedArray(U)?y&&typeof Blob=="function"?new Blob([U]):Buffer.from(U):U}function C(U,M,z){let V=U;if(U&&!z&&typeof U=="object"){if(Ue.endsWith(M,"{}"))M=l?M:M.slice(0,-2),U=JSON.stringify(U);else if(Ue.isArray(U)&&oDe(U)||(Ue.isFileList(U)||Ue.endsWith(M,"[]"))&&(V=Ue.toArray(U)))return M=zY(M),V.forEach(function(H,q){!(Ue.isUndefined(H)||H===null)&&i.append(m===!0?gz([M],q,p):m===null?M:M+"[]",S(H))}),!1}return ck(U)?!0:(i.append(gz(z,M,p),S(U)),!1)}const R=[],N=Object.assign(sDe,{defaultVisitor:C,convertValue:S,isVisitable:ck});function x(U,M){if(!Ue.isUndefined(U)){if(R.indexOf(U)!==-1)throw Error("Circular reference detected in "+M.join("."));R.push(U),Ue.forEach(U,function(V,W){(!(Ue.isUndefined(V)||V===null)&&u.call(i,V,Ue.isString(W)?W.trim():W,M,N))===!0&&x(V,M?M.concat(W):[W])}),R.pop()}}if(!Ue.isObject(e))throw new TypeError("data must be an object");return x(e),i}function _z(e){const i={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(l){return i[l]})}function Gx(e,i){this._pairs=[],e&&MC(e,this,i)}const GY=Gx.prototype;GY.append=function(i,a){this._pairs.push([i,a])};GY.toString=function(i){const a=i?function(l){return i.call(this,l,_z)}:_z;return this._pairs.map(function(u){return a(u[0])+"="+a(u[1])},"").join("&")};function aDe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function HY(e,i,a){if(!i)return e;const l=a&&a.encode||aDe,u=a&&a.serialize;let p;if(u?p=u(i,a):p=Ue.isURLSearchParams(i)?i.toString():new Gx(i,a).toString(l),p){const m=e.indexOf("#");m!==-1&&(e=e.slice(0,m)),e+=(e.indexOf("?")===-1?"?":"&")+p}return e}class vz{constructor(){this.handlers=[]}use(i,a,l){return this.handlers.push({fulfilled:i,rejected:a,synchronous:l?l.synchronous:!1,runWhen:l?l.runWhen:null}),this.handlers.length-1}eject(i){this.handlers[i]&&(this.handlers[i]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(i){Ue.forEach(this.handlers,function(l){l!==null&&i(l)})}}const $Y={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},cDe=typeof URLSearchParams<"u"?URLSearchParams:Gx,lDe=typeof FormData<"u"?FormData:null,dDe=typeof Blob<"u"?Blob:null,uDe={isBrowser:!0,classes:{URLSearchParams:cDe,FormData:lDe,Blob:dDe},protocols:["http","https","file","blob","url","data"]},KY=typeof window<"u"&&typeof document<"u",hDe=(e=>KY&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),pDe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",fDe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:KY,hasStandardBrowserEnv:hDe,hasStandardBrowserWebWorkerEnv:pDe},Symbol.toStringTag,{value:"Module"})),Rc={...fDe,...uDe};function mDe(e,i){return MC(e,new Rc.classes.URLSearchParams,Object.assign({visitor:function(a,l,u,p){return Rc.isNode&&Ue.isBuffer(a)?(this.append(l,a.toString("base64")),!1):p.defaultVisitor.apply(this,arguments)}},i))}function gDe(e){return Ue.matchAll(/\w+|\[(\w*)]/g,e).map(i=>i[0]==="[]"?"":i[1]||i[0])}function _De(e){const i={},a=Object.keys(e);let l;const u=a.length;let p;for(l=0;l<u;l++)p=a[l],i[p]=e[p];return i}function YY(e){function i(a,l,u,p){let m=a[p++];if(m==="__proto__")return!0;const v=Number.isFinite(+m),y=p>=a.length;return m=!m&&Ue.isArray(u)?u.length:m,y?(Ue.hasOwnProp(u,m)?u[m]=[u[m],l]:u[m]=l,!v):((!u[m]||!Ue.isObject(u[m]))&&(u[m]=[]),i(a,l,u[m],p)&&Ue.isArray(u[m])&&(u[m]=_De(u[m])),!v)}if(Ue.isFormData(e)&&Ue.isFunction(e.entries)){const a={};return Ue.forEachEntry(e,(l,u)=>{i(gDe(l),u,a,0)}),a}return null}function vDe(e,i,a){if(Ue.isString(e))try{return(i||JSON.parse)(e),Ue.trim(e)}catch(l){if(l.name!=="SyntaxError")throw l}return(0,JSON.stringify)(e)}const bE={transitional:$Y,adapter:["xhr","http"],transformRequest:[function(i,a){const l=a.getContentType()||"",u=l.indexOf("application/json")>-1,p=Ue.isObject(i);if(p&&Ue.isHTMLForm(i)&&(i=new FormData(i)),Ue.isFormData(i))return u?JSON.stringify(YY(i)):i;if(Ue.isArrayBuffer(i)||Ue.isBuffer(i)||Ue.isStream(i)||Ue.isFile(i)||Ue.isBlob(i))return i;if(Ue.isArrayBufferView(i))return i.buffer;if(Ue.isURLSearchParams(i))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),i.toString();let v;if(p){if(l.indexOf("application/x-www-form-urlencoded")>-1)return mDe(i,this.formSerializer).toString();if((v=Ue.isFileList(i))||l.indexOf("multipart/form-data")>-1){const y=this.env&&this.env.FormData;return MC(v?{"files[]":i}:i,y&&new y,this.formSerializer)}}return p||u?(a.setContentType("application/json",!1),vDe(i)):i}],transformResponse:[function(i){const a=this.transitional||bE.transitional,l=a&&a.forcedJSONParsing,u=this.responseType==="json";if(i&&Ue.isString(i)&&(l&&!this.responseType||u)){const m=!(a&&a.silentJSONParsing)&&u;try{return JSON.parse(i)}catch(v){if(m)throw v.name==="SyntaxError"?Tn.from(v,Tn.ERR_BAD_RESPONSE,this,null,this.response):v}}return i}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Rc.classes.FormData,Blob:Rc.classes.Blob},validateStatus:function(i){return i>=200&&i<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ue.forEach(["delete","get","head","post","put","patch"],e=>{bE.headers[e]={}});const EDe=Ue.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),yDe=e=>{const i={};let a,l,u;return e&&e.split(`
`).forEach(function(m){u=m.indexOf(":"),a=m.substring(0,u).trim().toLowerCase(),l=m.substring(u+1).trim(),!(!a||i[a]&&EDe[a])&&(a==="set-cookie"?i[a]?i[a].push(l):i[a]=[l]:i[a]=i[a]?i[a]+", "+l:l)}),i},Ez=Symbol("internals");function N_(e){return e&&String(e).trim().toLowerCase()}function DT(e){return e===!1||e==null?e:Ue.isArray(e)?e.map(DT):String(e)}function SDe(e){const i=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let l;for(;l=a.exec(e);)i[l[1]]=l[2];return i}const TDe=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function oN(e,i,a,l,u){if(Ue.isFunction(l))return l.call(this,i,a);if(u&&(i=a),!!Ue.isString(i)){if(Ue.isString(l))return i.indexOf(l)!==-1;if(Ue.isRegExp(l))return l.test(i)}}function bDe(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(i,a,l)=>a.toUpperCase()+l)}function CDe(e,i){const a=Ue.toCamelCase(" "+i);["get","set","has"].forEach(l=>{Object.defineProperty(e,l+a,{value:function(u,p,m){return this[l].call(this,i,u,p,m)},configurable:!0})})}class va{constructor(i){i&&this.set(i)}set(i,a,l){const u=this;function p(v,y,S){const C=N_(y);if(!C)throw new Error("header name must be a non-empty string");const R=Ue.findKey(u,C);(!R||u[R]===void 0||S===!0||S===void 0&&u[R]!==!1)&&(u[R||y]=DT(v))}const m=(v,y)=>Ue.forEach(v,(S,C)=>p(S,C,y));return Ue.isPlainObject(i)||i instanceof this.constructor?m(i,a):Ue.isString(i)&&(i=i.trim())&&!TDe(i)?m(yDe(i),a):i!=null&&p(a,i,l),this}get(i,a){if(i=N_(i),i){const l=Ue.findKey(this,i);if(l){const u=this[l];if(!a)return u;if(a===!0)return SDe(u);if(Ue.isFunction(a))return a.call(this,u,l);if(Ue.isRegExp(a))return a.exec(u);throw new TypeError("parser must be boolean|regexp|function")}}}has(i,a){if(i=N_(i),i){const l=Ue.findKey(this,i);return!!(l&&this[l]!==void 0&&(!a||oN(this,this[l],l,a)))}return!1}delete(i,a){const l=this;let u=!1;function p(m){if(m=N_(m),m){const v=Ue.findKey(l,m);v&&(!a||oN(l,l[v],v,a))&&(delete l[v],u=!0)}}return Ue.isArray(i)?i.forEach(p):p(i),u}clear(i){const a=Object.keys(this);let l=a.length,u=!1;for(;l--;){const p=a[l];(!i||oN(this,this[p],p,i,!0))&&(delete this[p],u=!0)}return u}normalize(i){const a=this,l={};return Ue.forEach(this,(u,p)=>{const m=Ue.findKey(l,p);if(m){a[m]=DT(u),delete a[p];return}const v=i?bDe(p):String(p).trim();v!==p&&delete a[p],a[v]=DT(u),l[v]=!0}),this}concat(...i){return this.constructor.concat(this,...i)}toJSON(i){const a=Object.create(null);return Ue.forEach(this,(l,u)=>{l!=null&&l!==!1&&(a[u]=i&&Ue.isArray(l)?l.join(", "):l)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([i,a])=>i+": "+a).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(i){return i instanceof this?i:new this(i)}static concat(i,...a){const l=new this(i);return a.forEach(u=>l.set(u)),l}static accessor(i){const l=(this[Ez]=this[Ez]={accessors:{}}).accessors,u=this.prototype;function p(m){const v=N_(m);l[v]||(CDe(u,m),l[v]=!0)}return Ue.isArray(i)?i.forEach(p):p(i),this}}va.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ue.reduceDescriptors(va.prototype,({value:e},i)=>{let a=i[0].toUpperCase()+i.slice(1);return{get:()=>e,set(l){this[a]=l}}});Ue.freezeMethods(va);function sN(e,i){const a=this||bE,l=i||a,u=va.from(l.headers);let p=l.data;return Ue.forEach(e,function(v){p=v.call(a,p,u.normalize(),i?i.status:void 0)}),u.normalize(),p}function qY(e){return!!(e&&e.__CANCEL__)}function CE(e,i,a){Tn.call(this,e??"canceled",Tn.ERR_CANCELED,i,a),this.name="CanceledError"}Ue.inherits(CE,Tn,{__CANCEL__:!0});function wDe(e,i,a){const l=a.config.validateStatus;!a.status||!l||l(a.status)?e(a):i(new Tn("Request failed with status code "+a.status,[Tn.ERR_BAD_REQUEST,Tn.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}const RDe=Rc.hasStandardBrowserEnv?{write(e,i,a,l,u,p){const m=[e+"="+encodeURIComponent(i)];Ue.isNumber(a)&&m.push("expires="+new Date(a).toGMTString()),Ue.isString(l)&&m.push("path="+l),Ue.isString(u)&&m.push("domain="+u),p===!0&&m.push("secure"),document.cookie=m.join("; ")},read(e){const i=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function IDe(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function ADe(e,i){return i?e.replace(/\/?\/$/,"")+"/"+i.replace(/^\/+/,""):e}function JY(e,i){return e&&!IDe(i)?ADe(e,i):i}const ODe=Rc.hasStandardBrowserEnv?function(){const i=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");let l;function u(p){let m=p;return i&&(a.setAttribute("href",m),m=a.href),a.setAttribute("href",m),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:a.pathname.charAt(0)==="/"?a.pathname:"/"+a.pathname}}return l=u(window.location.href),function(m){const v=Ue.isString(m)?u(m):m;return v.protocol===l.protocol&&v.host===l.host}}():function(){return function(){return!0}}();function NDe(e){const i=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return i&&i[1]||""}function PDe(e,i){e=e||10;const a=new Array(e),l=new Array(e);let u=0,p=0,m;return i=i!==void 0?i:1e3,function(y){const S=Date.now(),C=l[p];m||(m=S),a[u]=y,l[u]=S;let R=p,N=0;for(;R!==u;)N+=a[R++],R=R%e;if(u=(u+1)%e,u===p&&(p=(p+1)%e),S-m<i)return;const x=C&&S-C;return x?Math.round(N*1e3/x):void 0}}function yz(e,i){let a=0;const l=PDe(50,250);return u=>{const p=u.loaded,m=u.lengthComputable?u.total:void 0,v=p-a,y=l(v),S=p<=m;a=p;const C={loaded:p,total:m,progress:m?p/m:void 0,bytes:v,rate:y||void 0,estimated:y&&m&&S?(m-p)/y:void 0,event:u};C[i?"download":"upload"]=!0,e(C)}}const kDe=typeof XMLHttpRequest<"u",DDe=kDe&&function(e){return new Promise(function(a,l){let u=e.data;const p=va.from(e.headers).normalize();let{responseType:m,withXSRFToken:v}=e,y;function S(){e.cancelToken&&e.cancelToken.unsubscribe(y),e.signal&&e.signal.removeEventListener("abort",y)}let C;if(Ue.isFormData(u)){if(Rc.hasStandardBrowserEnv||Rc.hasStandardBrowserWebWorkerEnv)p.setContentType(!1);else if((C=p.getContentType())!==!1){const[M,...z]=C?C.split(";").map(V=>V.trim()).filter(Boolean):[];p.setContentType([M||"multipart/form-data",...z].join("; "))}}let R=new XMLHttpRequest;if(e.auth){const M=e.auth.username||"",z=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";p.set("Authorization","Basic "+btoa(M+":"+z))}const N=JY(e.baseURL,e.url);R.open(e.method.toUpperCase(),HY(N,e.params,e.paramsSerializer),!0),R.timeout=e.timeout;function x(){if(!R)return;const M=va.from("getAllResponseHeaders"in R&&R.getAllResponseHeaders()),V={data:!m||m==="text"||m==="json"?R.responseText:R.response,status:R.status,statusText:R.statusText,headers:M,config:e,request:R};wDe(function(H){a(H),S()},function(H){l(H),S()},V),R=null}if("onloadend"in R?R.onloadend=x:R.onreadystatechange=function(){!R||R.readyState!==4||R.status===0&&!(R.responseURL&&R.responseURL.indexOf("file:")===0)||setTimeout(x)},R.onabort=function(){R&&(l(new Tn("Request aborted",Tn.ECONNABORTED,e,R)),R=null)},R.onerror=function(){l(new Tn("Network Error",Tn.ERR_NETWORK,e,R)),R=null},R.ontimeout=function(){let z=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const V=e.transitional||$Y;e.timeoutErrorMessage&&(z=e.timeoutErrorMessage),l(new Tn(z,V.clarifyTimeoutError?Tn.ETIMEDOUT:Tn.ECONNABORTED,e,R)),R=null},Rc.hasStandardBrowserEnv&&(v&&Ue.isFunction(v)&&(v=v(e)),v||v!==!1&&ODe(N))){const M=e.xsrfHeaderName&&e.xsrfCookieName&&RDe.read(e.xsrfCookieName);M&&p.set(e.xsrfHeaderName,M)}u===void 0&&p.setContentType(null),"setRequestHeader"in R&&Ue.forEach(p.toJSON(),function(z,V){R.setRequestHeader(V,z)}),Ue.isUndefined(e.withCredentials)||(R.withCredentials=!!e.withCredentials),m&&m!=="json"&&(R.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&R.addEventListener("progress",yz(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&R.upload&&R.upload.addEventListener("progress",yz(e.onUploadProgress)),(e.cancelToken||e.signal)&&(y=M=>{R&&(l(!M||M.type?new CE(null,e,R):M),R.abort(),R=null)},e.cancelToken&&e.cancelToken.subscribe(y),e.signal&&(e.signal.aborted?y():e.signal.addEventListener("abort",y)));const U=NDe(N);if(U&&Rc.protocols.indexOf(U)===-1){l(new Tn("Unsupported protocol "+U+":",Tn.ERR_BAD_REQUEST,e));return}R.send(u||null)})},lk={http:iDe,xhr:DDe};Ue.forEach(lk,(e,i)=>{if(e){try{Object.defineProperty(e,"name",{value:i})}catch{}Object.defineProperty(e,"adapterName",{value:i})}});const Sz=e=>`- ${e}`,xDe=e=>Ue.isFunction(e)||e===null||e===!1,XY={getAdapter:e=>{e=Ue.isArray(e)?e:[e];const{length:i}=e;let a,l;const u={};for(let p=0;p<i;p++){a=e[p];let m;if(l=a,!xDe(a)&&(l=lk[(m=String(a)).toLowerCase()],l===void 0))throw new Tn(`Unknown adapter '${m}'`);if(l)break;u[m||"#"+p]=l}if(!l){const p=Object.entries(u).map(([v,y])=>`adapter ${v} `+(y===!1?"is not supported by the environment":"is not available in the build"));let m=i?p.length>1?`since :
`+p.map(Sz).join(`
`):" "+Sz(p[0]):"as no adapter specified";throw new Tn("There is no suitable adapter to dispatch the request "+m,"ERR_NOT_SUPPORT")}return l},adapters:lk};function aN(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CE(null,e)}function Tz(e){return aN(e),e.headers=va.from(e.headers),e.data=sN.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),XY.getAdapter(e.adapter||bE.adapter)(e).then(function(l){return aN(e),l.data=sN.call(e,e.transformResponse,l),l.headers=va.from(l.headers),l},function(l){return qY(l)||(aN(e),l&&l.response&&(l.response.data=sN.call(e,e.transformResponse,l.response),l.response.headers=va.from(l.response.headers))),Promise.reject(l)})}const bz=e=>e instanceof va?{...e}:e;function Im(e,i){i=i||{};const a={};function l(S,C,R){return Ue.isPlainObject(S)&&Ue.isPlainObject(C)?Ue.merge.call({caseless:R},S,C):Ue.isPlainObject(C)?Ue.merge({},C):Ue.isArray(C)?C.slice():C}function u(S,C,R){if(Ue.isUndefined(C)){if(!Ue.isUndefined(S))return l(void 0,S,R)}else return l(S,C,R)}function p(S,C){if(!Ue.isUndefined(C))return l(void 0,C)}function m(S,C){if(Ue.isUndefined(C)){if(!Ue.isUndefined(S))return l(void 0,S)}else return l(void 0,C)}function v(S,C,R){if(R in i)return l(S,C);if(R in e)return l(void 0,S)}const y={url:p,method:p,data:p,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:v,headers:(S,C)=>u(bz(S),bz(C),!0)};return Ue.forEach(Object.keys(Object.assign({},e,i)),function(C){const R=y[C]||u,N=R(e[C],i[C],C);Ue.isUndefined(N)&&R!==v||(a[C]=N)}),a}const QY="1.6.8",Hx={};["object","boolean","number","function","string","symbol"].forEach((e,i)=>{Hx[e]=function(l){return typeof l===e||"a"+(i<1?"n ":" ")+e}});const Cz={};Hx.transitional=function(i,a,l){function u(p,m){return"[Axios v"+QY+"] Transitional option '"+p+"'"+m+(l?". "+l:"")}return(p,m,v)=>{if(i===!1)throw new Tn(u(m," has been removed"+(a?" in "+a:"")),Tn.ERR_DEPRECATED);return a&&!Cz[m]&&(Cz[m]=!0,console.warn(u(m," has been deprecated since v"+a+" and will be removed in the near future"))),i?i(p,m,v):!0}};function LDe(e,i,a){if(typeof e!="object")throw new Tn("options must be an object",Tn.ERR_BAD_OPTION_VALUE);const l=Object.keys(e);let u=l.length;for(;u-- >0;){const p=l[u],m=i[p];if(m){const v=e[p],y=v===void 0||m(v,p,e);if(y!==!0)throw new Tn("option "+p+" must be "+y,Tn.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new Tn("Unknown option "+p,Tn.ERR_BAD_OPTION)}}const dk={assertOptions:LDe,validators:Hx},Md=dk.validators;class bh{constructor(i){this.defaults=i,this.interceptors={request:new vz,response:new vz}}async request(i,a){try{return await this._request(i,a)}catch(l){if(l instanceof Error){let u;Error.captureStackTrace?Error.captureStackTrace(u={}):u=new Error;const p=u.stack?u.stack.replace(/^.+\n/,""):"";l.stack?p&&!String(l.stack).endsWith(p.replace(/^.+\n.+\n/,""))&&(l.stack+=`
`+p):l.stack=p}throw l}}_request(i,a){typeof i=="string"?(a=a||{},a.url=i):a=i||{},a=Im(this.defaults,a);const{transitional:l,paramsSerializer:u,headers:p}=a;l!==void 0&&dk.assertOptions(l,{silentJSONParsing:Md.transitional(Md.boolean),forcedJSONParsing:Md.transitional(Md.boolean),clarifyTimeoutError:Md.transitional(Md.boolean)},!1),u!=null&&(Ue.isFunction(u)?a.paramsSerializer={serialize:u}:dk.assertOptions(u,{encode:Md.function,serialize:Md.function},!0)),a.method=(a.method||this.defaults.method||"get").toLowerCase();let m=p&&Ue.merge(p.common,p[a.method]);p&&Ue.forEach(["delete","get","head","post","put","patch","common"],U=>{delete p[U]}),a.headers=va.concat(m,p);const v=[];let y=!0;this.interceptors.request.forEach(function(M){typeof M.runWhen=="function"&&M.runWhen(a)===!1||(y=y&&M.synchronous,v.unshift(M.fulfilled,M.rejected))});const S=[];this.interceptors.response.forEach(function(M){S.push(M.fulfilled,M.rejected)});let C,R=0,N;if(!y){const U=[Tz.bind(this),void 0];for(U.unshift.apply(U,v),U.push.apply(U,S),N=U.length,C=Promise.resolve(a);R<N;)C=C.then(U[R++],U[R++]);return C}N=v.length;let x=a;for(R=0;R<N;){const U=v[R++],M=v[R++];try{x=U(x)}catch(z){M.call(this,z);break}}try{C=Tz.call(this,x)}catch(U){return Promise.reject(U)}for(R=0,N=S.length;R<N;)C=C.then(S[R++],S[R++]);return C}getUri(i){i=Im(this.defaults,i);const a=JY(i.baseURL,i.url);return HY(a,i.params,i.paramsSerializer)}}Ue.forEach(["delete","get","head","options"],function(i){bh.prototype[i]=function(a,l){return this.request(Im(l||{},{method:i,url:a,data:(l||{}).data}))}});Ue.forEach(["post","put","patch"],function(i){function a(l){return function(p,m,v){return this.request(Im(v||{},{method:i,headers:l?{"Content-Type":"multipart/form-data"}:{},url:p,data:m}))}}bh.prototype[i]=a(),bh.prototype[i+"Form"]=a(!0)});class $x{constructor(i){if(typeof i!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(p){a=p});const l=this;this.promise.then(u=>{if(!l._listeners)return;let p=l._listeners.length;for(;p-- >0;)l._listeners[p](u);l._listeners=null}),this.promise.then=u=>{let p;const m=new Promise(v=>{l.subscribe(v),p=v}).then(u);return m.cancel=function(){l.unsubscribe(p)},m},i(function(p,m,v){l.reason||(l.reason=new CE(p,m,v),a(l.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]}unsubscribe(i){if(!this._listeners)return;const a=this._listeners.indexOf(i);a!==-1&&this._listeners.splice(a,1)}static source(){let i;return{token:new $x(function(u){i=u}),cancel:i}}}function MDe(e){return function(a){return e.apply(null,a)}}function UDe(e){return Ue.isObject(e)&&e.isAxiosError===!0}const uk={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(uk).forEach(([e,i])=>{uk[i]=e});function ZY(e){const i=new bh(e),a=DY(bh.prototype.request,i);return Ue.extend(a,bh.prototype,i,{allOwnKeys:!0}),Ue.extend(a,i,null,{allOwnKeys:!0}),a.create=function(u){return ZY(Im(e,u))},a}const Dt=ZY(bE);Dt.Axios=bh;Dt.CanceledError=CE;Dt.CancelToken=$x;Dt.isCancel=qY;Dt.VERSION=QY;Dt.toFormData=MC;Dt.AxiosError=Tn;Dt.Cancel=Dt.CanceledError;Dt.all=function(i){return Promise.all(i)};Dt.spread=MDe;Dt.isAxiosError=UDe;Dt.mergeConfig=Im;Dt.AxiosHeaders=va;Dt.formToJSON=e=>YY(Ue.isHTMLForm(e)?new FormData(e):e);Dt.getAdapter=XY.getAdapter;Dt.HttpStatusCode=uk;Dt.default=Dt;var jDe={},UC={},wE={};Object.defineProperty(wE,"__esModule",{value:!0});wE.createListenersContainer=void 0;wE.createListenersContainer=function(){var e=[],i=function(u){e.push(u)},a=function(u){e=e.filter(function(p){return p!==u})},l=function(){e.forEach(function(u){return u()})};return{subscribe:i,unsubscribe:a,notify:l}};var Lh={},wz=rn&&rn.__awaiter||function(e,i,a,l){function u(p){return p instanceof a?p:new a(function(m){m(p)})}return new(a||(a=Promise))(function(p,m){function v(C){try{S(l.next(C))}catch(R){m(R)}}function y(C){try{S(l.throw(C))}catch(R){m(R)}}function S(C){C.done?p(C.value):u(C.value).then(v,y)}S((l=l.apply(e,i||[])).next())})},Rz=rn&&rn.__generator||function(e,i){var a={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},l,u,p,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(S){return function(C){return y([S,C])}}function y(S){if(l)throw new TypeError("Generator is already executing.");for(;a;)try{if(l=1,u&&(p=S[0]&2?u.return:S[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,S[1])).done)return p;switch(u=0,p&&(S=[S[0]&2,p.value]),S[0]){case 0:case 1:p=S;break;case 4:return a.label++,{value:S[1],done:!1};case 5:a.label++,u=S[1],S=[0];continue;case 7:S=a.ops.pop(),a.trys.pop();continue;default:if(p=a.trys,!(p=p.length>0&&p[p.length-1])&&(S[0]===6||S[0]===2)){a=0;continue}if(S[0]===3&&(!p||S[1]>p[0]&&S[1]<p[3])){a.label=S[1];break}if(S[0]===6&&a.label<p[1]){a.label=p[1],p=S;break}if(p&&a.label<p[2]){a.label=p[2],a.ops.push(S);break}p[2]&&a.ops.pop(),a.trys.pop();continue}S=i.call(e,a)}catch(C){S=[6,C],u=0}finally{l=p=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(Lh,"__esModule",{value:!0});Lh.createAsyncTokenProvider=Lh.createTokenProvider=void 0;Lh.createTokenProvider=function(e){var i=e.storageKey,a=e.storage,l=function(v){return v&&JSON.parse(v)||null},u=function(v){return JSON.stringify(v)},p=function(){return l(a.getItem(i))},m=function(v){return v?a.setItem(i,u(v)):a.removeItem(i)};return{getToken:p,setToken:m}};Lh.createAsyncTokenProvider=function(e){var i=e.storageKey,a=e.storage,l=function(v){return v&&JSON.parse(v)||null},u=function(v){return JSON.stringify(v)},p=function(){return wz(void 0,void 0,void 0,function(){var v;return Rz(this,function(y){switch(y.label){case 0:return v=l,[4,a.getItem(i)];case 1:return[2,v.apply(void 0,[y.sent()])]}})})},m=function(v){return wz(void 0,void 0,void 0,function(){return Rz(this,function(y){return[2,v?a.setItem(i,u(v)):a.removeItem(i)]})})};return{getToken:p,setToken:m}};var RE={},hk={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var i="",a,l,u,p,m,v,y,S=0;for(e=hk._utf8_encode(e);S<e.length;)a=e.charCodeAt(S++),l=e.charCodeAt(S++),u=e.charCodeAt(S++),p=a>>2,m=(a&3)<<4|l>>4,v=(l&15)<<2|u>>6,y=u&63,isNaN(l)?v=y=64:isNaN(u)&&(y=64),i=i+this._keyStr.charAt(p)+this._keyStr.charAt(m)+this._keyStr.charAt(v)+this._keyStr.charAt(y);return i},decode:function(e){var i="",a,l,u,p,m,v,y,S=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");S<e.length;)p=this._keyStr.indexOf(e.charAt(S++)),m=this._keyStr.indexOf(e.charAt(S++)),v=this._keyStr.indexOf(e.charAt(S++)),y=this._keyStr.indexOf(e.charAt(S++)),a=p<<2|m>>4,l=(m&15)<<4|v>>2,u=(v&3)<<6|y,i=i+String.fromCharCode(a),v!=64&&(i=i+String.fromCharCode(l)),y!=64&&(i=i+String.fromCharCode(u));return i=hk._utf8_decode(i),i},_utf8_encode:function(e){e=e.replace(/\r\n/g,`
`);for(var i="",a=0;a<e.length;a++){var l=e.charCodeAt(a);l<128?i+=String.fromCharCode(l):l>127&&l<2048?(i+=String.fromCharCode(l>>6|192),i+=String.fromCharCode(l&63|128)):(i+=String.fromCharCode(l>>12|224),i+=String.fromCharCode(l>>6&63|128),i+=String.fromCharCode(l&63|128))}return i},_utf8_decode:function(e){for(var i="",a=0,l=0,u=0;a<e.length;)u=e.charCodeAt(a),u<128?(i+=String.fromCharCode(u),a++):u>191&&u<224?(l=e.charCodeAt(a+1),i+=String.fromCharCode((u&31)<<6|l&63),a+=2):(l=e.charCodeAt(a+1),c3=e.charCodeAt(a+2),i+=String.fromCharCode((u&15)<<12|(l&63)<<6|c3&63),a+=3);return i}},FDe={Base64:hk};Object.defineProperty(RE,"__esModule",{value:!0});RE.isTokenExpired=void 0;var VDe=FDe;RE.isTokenExpired=function(e,i,a){return WDe(BDe(e,a),i,a)};var BDe=function(e,i){var a=e.split(".");if(i==null||i.log("jwtExp","split",a),a.length<2)return null;try{var l=VDe.Base64.decode(e.split(".")[1]);i==null||i.log("jwtExp","middlePart",l);var u=JSON.parse(l);return i==null||i.log("jwtExp","jwt",u),u&&u.exp&&Number.isFinite(u.exp)?u.exp*1e3:null}catch(p){return console.warn(p),null}},WDe=function(e,i,a){return a==null||a.log("isTimestampExpired","exp",e),e?(a==null||a.log("isTimestampExpired","Date.now()",Date.now()),a==null||a.log("isTimestampExpired","(thresholdMillisec ?? 0",i??0),Date.now()>e-(i??0)):!1},IE={},zDe=rn&&rn.__awaiter||function(e,i,a,l){function u(p){return p instanceof a?p:new a(function(m){m(p)})}return new(a||(a=Promise))(function(p,m){function v(C){try{S(l.next(C))}catch(R){m(R)}}function y(C){try{S(l.throw(C))}catch(R){m(R)}}function S(C){C.done?p(C.value):u(C.value).then(v,y)}S((l=l.apply(e,i||[])).next())})},GDe=rn&&rn.__generator||function(e,i){var a={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},l,u,p,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(S){return function(C){return y([S,C])}}function y(S){if(l)throw new TypeError("Generator is already executing.");for(;a;)try{if(l=1,u&&(p=S[0]&2?u.return:S[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,S[1])).done)return p;switch(u=0,p&&(S=[S[0]&2,p.value]),S[0]){case 0:case 1:p=S;break;case 4:return a.label++,{value:S[1],done:!1};case 5:a.label++,u=S[1],S=[0];continue;case 7:S=a.ops.pop(),a.trys.pop();continue;default:if(p=a.trys,!(p=p.length>0&&p[p.length-1])&&(S[0]===6||S[0]===2)){a=0;continue}if(S[0]===3&&(!p||S[1]>p[0]&&S[1]<p[3])){a.label=S[1];break}if(S[0]===6&&a.label<p[1]){a.label=p[1],p=S;break}if(p&&a.label<p[2]){a.label=p[2],a.ops.push(S);break}p[2]&&a.ops.pop(),a.trys.pop();continue}S=i.call(e,a)}catch(C){S=[6,C],u=0}finally{l=p=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(IE,"__esModule",{value:!0});IE.createTokenUpdater=void 0;IE.createTokenUpdater=function(e){var i=null,a=function(l){return zDe(void 0,void 0,void 0,function(){return GDe(this,function(u){return i?[2,i]:(i=e(l).then(function(p){return i=null,p}),[2,i])})})};return{updateToken:a}};var AE={};Object.defineProperty(AE,"__esModule",{value:!0});AE.createUseAuth=void 0;var KS=F;AE.createUseAuth=function(e){var i=e.getSessionState,a=e.onHydratation,l=e.listenersContainer;return function(){var u=KS.useState(null),p=u[0],m=u[1],v=function(){var S=i();a&&a(S),m(S)};KS.useEffect(function(){v()},[]);var y=KS.useCallback(function(){v()},[]);return KS.useEffect(function(){return l.subscribe(y),function(){l.unsubscribe(y)}},[y]),[HDe(p),p]}};var HDe=function(e){return!!e},OE={},wb=rn&&rn.__assign||function(){return wb=Object.assign||function(e){for(var i,a=1,l=arguments.length;a<l;a++){i=arguments[a];for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(e[u]=i[u])}return e},wb.apply(this,arguments)},$De=rn&&rn.__awaiter||function(e,i,a,l){function u(p){return p instanceof a?p:new a(function(m){m(p)})}return new(a||(a=Promise))(function(p,m){function v(C){try{S(l.next(C))}catch(R){m(R)}}function y(C){try{S(l.throw(C))}catch(R){m(R)}}function S(C){C.done?p(C.value):u(C.value).then(v,y)}S((l=l.apply(e,i||[])).next())})},KDe=rn&&rn.__generator||function(e,i){var a={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},l,u,p,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(S){return function(C){return y([S,C])}}function y(S){if(l)throw new TypeError("Generator is already executing.");for(;a;)try{if(l=1,u&&(p=S[0]&2?u.return:S[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,S[1])).done)return p;switch(u=0,p&&(S=[S[0]&2,p.value]),S[0]){case 0:case 1:p=S;break;case 4:return a.label++,{value:S[1],done:!1};case 5:a.label++,u=S[1],S=[0];continue;case 7:S=a.ops.pop(),a.trys.pop();continue;default:if(p=a.trys,!(p=p.length>0&&p[p.length-1])&&(S[0]===6||S[0]===2)){a=0;continue}if(S[0]===3&&(!p||S[1]>p[0]&&S[1]<p[3])){a.label=S[1];break}if(S[0]===6&&a.label<p[1]){a.label=p[1],p=S;break}if(p&&a.label<p[2]){a.label=p[2],a.ops.push(S);break}p[2]&&a.ops.pop(),a.trys.pop();continue}S=i.call(e,a)}catch(C){S=[6,C],u=0}finally{l=p=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(OE,"__esModule",{value:!0});OE.createAuthFetch=void 0;OE.createAuthFetch=function(e,i){return function(a,l){return $De(void 0,void 0,void 0,function(){var u;return KDe(this,function(p){switch(p.label){case 0:return[4,e()];case 1:return u=p.sent(),l=l||{},u?l.headers=wb(wb({},l.headers),{Authorization:"Bearer "+u}):console.warn("'authFetch' was called without access token. Probably storage has no session or session were expired"),[2,i(a,l)]}})})}};var Mh={},cN=rn&&rn.__awaiter||function(e,i,a,l){function u(p){return p instanceof a?p:new a(function(m){m(p)})}return new(a||(a=Promise))(function(p,m){function v(C){try{S(l.next(C))}catch(R){m(R)}}function y(C){try{S(l.throw(C))}catch(R){m(R)}}function S(C){C.done?p(C.value):u(C.value).then(v,y)}S((l=l.apply(e,i||[])).next())})},lN=rn&&rn.__generator||function(e,i){var a={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},l,u,p,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(S){return function(C){return y([S,C])}}function y(S){if(l)throw new TypeError("Generator is already executing.");for(;a;)try{if(l=1,u&&(p=S[0]&2?u.return:S[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,S[1])).done)return p;switch(u=0,p&&(S=[S[0]&2,p.value]),S[0]){case 0:case 1:p=S;break;case 4:return a.label++,{value:S[1],done:!1};case 5:a.label++,u=S[1],S=[0];continue;case 7:S=a.ops.pop(),a.trys.pop();continue;default:if(p=a.trys,!(p=p.length>0&&p[p.length-1])&&(S[0]===6||S[0]===2)){a=0;continue}if(S[0]===3&&(!p||S[1]>p[0]&&S[1]<p[3])){a.label=S[1];break}if(S[0]===6&&a.label<p[1]){a.label=p[1],p=S;break}if(p&&a.label<p[2]){a.label=p[2],a.ops.push(S);break}p[2]&&a.ops.pop(),a.trys.pop();continue}S=i.call(e,a)}catch(C){S=[6,C],u=0}finally{l=p=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(Mh,"__esModule",{value:!0});Mh.createDefaultAsyncStore=Mh.createDefaultStore=void 0;Mh.createDefaultStore=function(e){e===void 0&&(e={});var i=e,a=function(p){return i[p]},l=function(p,m){i[p]=m,localStorage.setItem(p,m)},u=function(p){delete i[p],localStorage.removeItem(p)};return{getItem:a,setItem:l,removeItem:u}};Mh.createDefaultAsyncStore=function(e){e===void 0&&(e={});var i=e,a=function(p){return cN(void 0,void 0,void 0,function(){return lN(this,function(m){return[2,i[p]]})})},l=function(p,m){return cN(void 0,void 0,void 0,function(){return lN(this,function(v){return i[p]=m,localStorage.setItem(p,m),[2]})})},u=function(p){return cN(void 0,void 0,void 0,function(){return lN(this,function(m){return delete i[p],localStorage.removeItem(p),[2]})})};return{getItem:a,setItem:l,removeItem:u}};var NE={};Object.defineProperty(NE,"__esModule",{value:!0});NE.extractAccessToken=void 0;NE.extractAccessToken=function(e,i){if(!e)return null;if(i)return i(e);if(typeof e!="string")throw Error("Access token can not be extracted. Either whole 'session' must be a string (access token only) or 'getAccessToken' function should be provided");return e};var Iz=rn&&rn.__awaiter||function(e,i,a,l){function u(p){return p instanceof a?p:new a(function(m){m(p)})}return new(a||(a=Promise))(function(p,m){function v(C){try{S(l.next(C))}catch(R){m(R)}}function y(C){try{S(l.throw(C))}catch(R){m(R)}}function S(C){C.done?p(C.value):u(C.value).then(v,y)}S((l=l.apply(e,i||[])).next())})},Az=rn&&rn.__generator||function(e,i){var a={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},l,u,p,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(S){return function(C){return y([S,C])}}function y(S){if(l)throw new TypeError("Generator is already executing.");for(;a;)try{if(l=1,u&&(p=S[0]&2?u.return:S[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,S[1])).done)return p;switch(u=0,p&&(S=[S[0]&2,p.value]),S[0]){case 0:case 1:p=S;break;case 4:return a.label++,{value:S[1],done:!1};case 5:a.label++,u=S[1],S=[0];continue;case 7:S=a.ops.pop(),a.trys.pop();continue;default:if(p=a.trys,!(p=p.length>0&&p[p.length-1])&&(S[0]===6||S[0]===2)){a=0;continue}if(S[0]===3&&(!p||S[1]>p[0]&&S[1]<p[3])){a.label=S[1];break}if(S[0]===6&&a.label<p[1]){a.label=p[1],p=S;break}if(p&&a.label<p[2]){a.label=p[2],a.ops.push(S);break}p[2]&&a.ops.pop(),a.trys.pop();continue}S=i.call(e,a)}catch(C){S=[6,C],u=0}finally{l=p=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(UC,"__esModule",{value:!0});UC.createAuthProvider=void 0;var YDe=wE,qDe=Lh,JDe=RE,XDe=IE,QDe=AE,ZDe=OE,exe=Mh,Oz=NE;UC.createAuthProvider=function(e){var i,a=e.storageKey,l=a===void 0?"REACT_TOKEN_AUTH_KEY":a,u=e.onUpdateToken,p=e.onHydratation,m=e.storage,v=m===void 0?exe.createDefaultStore((i={},i[l]=localStorage.getItem(l),i)):m,y=e.fetchFunction,S=y===void 0?fetch:y,C=e.getAccessToken,R=e.expirationThresholdMillisec,N=R===void 0?5e3:R,x=YDe.createListenersContainer(),U=qDe.createTokenProvider({storageKey:l,storage:v}),M=u&&XDe.createTokenUpdater(u),z=U.getToken(),V=function(re){U.setToken(re),z=re,x.notify()},W=function(re){return V(re)},H=function(){return V(null)},q=function(){return z},ee=function(){return Iz(void 0,void 0,void 0,function(){var re,me;return Az(this,function(pe){switch(pe.label){case 0:return re=Oz.extractAccessToken(q(),C),z&&M&&re&&JDe.isTokenExpired(re,N)?[4,M.updateToken(z)]:[3,2];case 1:me=pe.sent(),V(me),pe.label=2;case 2:return[2,q()]}})})},oe=ZDe.createAuthFetch(function(){return Iz(void 0,void 0,void 0,function(){var re;return Az(this,function(me){switch(me.label){case 0:return re=Oz.extractAccessToken,[4,ee()];case 1:return[2,re.apply(void 0,[me.sent(),C])]}})})},S),se=QDe.createUseAuth({getSessionState:q,onHydratation:p,listenersContainer:x});return{useAuth:se,authFetch:oe,login:W,logout:H,getSession:ee,getSessionState:q}};var jC={},FC={},txe=rn&&rn.__spreadArrays||function(){for(var e=0,i=0,a=arguments.length;i<a;i++)e+=arguments[i].length;for(var l=Array(e),u=0,i=0;i<a;i++)for(var p=arguments[i],m=0,v=p.length;m<v;m++,u++)l[u]=p[m];return l};Object.defineProperty(FC,"__esModule",{value:!0});FC.createLogger=void 0;FC.createLogger=function(e){var i=function(a,l){for(var u=[],p=2;p<arguments.length;p++)u[p-2]=arguments[p];e&&console.log.apply(console,txe(["[react-token-auth]"+a+"::"+l],u.map(function(m){return JSON.stringify(m)})))};return{log:i}};var dN=rn&&rn.__awaiter||function(e,i,a,l){function u(p){return p instanceof a?p:new a(function(m){m(p)})}return new(a||(a=Promise))(function(p,m){function v(C){try{S(l.next(C))}catch(R){m(R)}}function y(C){try{S(l.throw(C))}catch(R){m(R)}}function S(C){C.done?p(C.value):u(C.value).then(v,y)}S((l=l.apply(e,i||[])).next())})},uN=rn&&rn.__generator||function(e,i){var a={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},l,u,p,m;return m={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function v(S){return function(C){return y([S,C])}}function y(S){if(l)throw new TypeError("Generator is already executing.");for(;a;)try{if(l=1,u&&(p=S[0]&2?u.return:S[0]?u.throw||((p=u.return)&&p.call(u),0):u.next)&&!(p=p.call(u,S[1])).done)return p;switch(u=0,p&&(S=[S[0]&2,p.value]),S[0]){case 0:case 1:p=S;break;case 4:return a.label++,{value:S[1],done:!1};case 5:a.label++,u=S[1],S=[0];continue;case 7:S=a.ops.pop(),a.trys.pop();continue;default:if(p=a.trys,!(p=p.length>0&&p[p.length-1])&&(S[0]===6||S[0]===2)){a=0;continue}if(S[0]===3&&(!p||S[1]>p[0]&&S[1]<p[3])){a.label=S[1];break}if(S[0]===6&&a.label<p[1]){a.label=p[1],p=S;break}if(p&&a.label<p[2]){a.label=p[2],a.ops.push(S);break}p[2]&&a.ops.pop(),a.trys.pop();continue}S=i.call(e,a)}catch(C){S=[6,C],u=0}finally{l=p=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}};Object.defineProperty(jC,"__esModule",{value:!0});jC.createAsyncAuthProvider=void 0;var nxe=wE,rxe=Lh,Nz=RE,ixe=FC,oxe=IE,sxe=AE,axe=OE,cxe=Mh,Pz=NE;jC.createAsyncAuthProvider=function(e){var i,a=e.storageKey,l=a===void 0?"REACT_TOKEN_AUTH_KEY":a,u=e.onUpdateToken,p=e.onHydratation,m=e.storage,v=m===void 0?cxe.createDefaultAsyncStore((i={},i[l]=localStorage.getItem(l),i)):m,y=e.fetchFunction,S=y===void 0?fetch:y,C=e.getAccessToken,R=e.expirationThresholdMillisec,N=R===void 0?5e3:R,x=e.debug,U=x===void 0?!1:x,M=ixe.createLogger(U),z=nxe.createListenersContainer(),V=rxe.createAsyncTokenProvider({storageKey:l,storage:v}),W=u&&oxe.createTokenUpdater(u),H=null,q=function(Qe){return dN(void 0,void 0,void 0,function(){return uN(this,function(Oe){switch(Oe.label){case 0:return M.log("updateSession","session",Qe),[4,V.setToken(Qe)];case 1:return Oe.sent(),H=Qe,z.notify(),[2]}})})},ee=V.getToken().then(q).then(function(){ee=null}).catch(console.error),oe=function(){return ee},se=function(Qe){return q(Qe)},re=function(){return q(null)},me=function(){return H},pe=function(){return dN(void 0,void 0,void 0,function(){var Qe,Oe;return uN(this,function(Ie){switch(Ie.label){case 0:return Qe=Pz.extractAccessToken(me(),C),M.log("getSession","accessToken",Qe),M.log("getSession","tokenUpdater",W),Qe&&M.log("getSession","isTokenExpired(accessToken, expirationThresholdMillisec)",Nz.isTokenExpired(Qe,N,M)),H&&W&&Qe&&Nz.isTokenExpired(Qe,N)?[4,W.updateToken(H)]:[3,3];case 1:return Oe=Ie.sent(),M.log("getSession","updatedSession",Qe),[4,q(Oe)];case 2:Ie.sent(),Ie.label=3;case 3:return[2,me()]}})})},Re=axe.createAuthFetch(function(){return dN(void 0,void 0,void 0,function(){var Qe;return uN(this,function(Oe){switch(Oe.label){case 0:return Qe=Pz.extractAccessToken,[4,pe()];case 1:return[2,Qe.apply(void 0,[Oe.sent(),C])]}})})},S),Ze=sxe.createUseAuth({getSessionState:me,onHydratation:p,listenersContainer:z});return{useAuth:Ze,authFetch:Re,login:se,logout:re,getSession:pe,getSessionState:me,waitInit:oe}};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createAsyncAuthProvider=e.createAuthProvider=void 0;var i=UC;Object.defineProperty(e,"createAuthProvider",{enumerable:!0,get:function(){return i.createAuthProvider}});var a=jC;Object.defineProperty(e,"createAsyncAuthProvider",{enumerable:!0,get:function(){return a.createAsyncAuthProvider}})})(jDe);const eq=F.createContext(),Ji=()=>F.useContext(eq),lxe=({children:e})=>{const[i,a]=F.useState(()=>localStorage.getItem("authToken")),[l,u]=F.useState(()=>localStorage.getItem("refreshToken")),[p,m]=F.useState({});F.useState(),F.useEffect(()=>(i?(localStorage.setItem("authToken",i),localStorage.setItem("refreshToken",l)):(localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken",l)),()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken",l)}),[i]);const v=()=>(C(),i),y=(R,N)=>{a(R),u(N),localStorage.setItem("authToken",i),localStorage.setItem("refreshToken",l)},S=()=>{a(null),u(null),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken")},C=()=>(async()=>{try{const R=await Dt.get("http://127.0.0.1:5000/auth/refresh",{headers:{Authorization:"Bearer "+l}});return a(R.data.access_token),console.log("refresh token"),R.data.access_token}catch(R){console.log(R.response.data)}})();return b.jsx(eq.Provider,{value:{authToken:i,getAccess:v,user:p,setUser:m,login:y,logout:S,refresh:C},children:e})};var dxe=Gh({d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z",displayName:"SearchIcon"}),uxe=Gh({displayName:"HamburgerIcon",viewBox:"0 0 24 24",d:"M 3 5 A 1.0001 1.0001 0 1 0 3 7 L 21 7 A 1.0001 1.0001 0 1 0 21 5 L 3 5 z M 3 11 A 1.0001 1.0001 0 1 0 3 13 L 21 13 A 1.0001 1.0001 0 1 0 21 11 L 3 11 z M 3 17 A 1.0001 1.0001 0 1 0 3 19 L 21 19 A 1.0001 1.0001 0 1 0 21 17 L 3 17 z"}),P_=Gh({displayName:"InfoOutlineIcon",path:b.jsxs("g",{fill:"currentColor",stroke:"currentColor",strokeLinecap:"square",strokeWidth:"2",children:[b.jsx("circle",{cx:"12",cy:"12",fill:"none",r:"11",stroke:"currentColor"}),b.jsx("line",{fill:"none",x1:"11.959",x2:"11.959",y1:"11",y2:"17"}),b.jsx("circle",{cx:"11.959",cy:"7",r:"1",stroke:"none"})]})}),hxe=Gh({d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z",displayName:"ChevronLeftIcon"}),pxe=Gh({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"}),hN=Gh({displayName:"ChevronDownIcon",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),fxe=Gh({d:"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z",displayName:"ArrowForwardIcon"});function mxe(){return b.jsxs(Sh,{templateColumns:"1fr 1fr",gap:6,m:"60px",color:"black",justifyContent:"center",children:[b.jsxs(Hv,{colSpan:{base:2,lg:1},pt:"90px",gap:2,children:[b.jsx(yt,{mb:4,as:"h3",size:"3xl",children:"Welcome to LexiLink"}),b.jsx(Pt,{fontSize:"xl",w:"auto",children:"Unlock the door to fluent English with LexiLink, your gateway to tailored language mastery through personalized mentorship sessions."}),b.jsx(bn,{to:"/browse",children:b.jsx(pn,{rightIcon:b.jsx(fxe,{}),colorScheme:"faceboo",bg:"brand.800",mt:"24px",w:"300px",h:"50px;",borderRadius:"lg",children:"Get Started"})})]}),b.jsx(Hv,{colSpan:{base:2,lg:1},children:b.jsx(Nn,{src:"/img/banner.png",alt:"Banner-Cover",boxSize:"auto",width:"auto",height:"auto"})})]})}const gxe=()=>b.jsx(Pe,{w:"100%",overflow:"hidden",whiteSpace:"nowrap",position:"relative",bg:"brand.700",mt:"10px",children:b.jsx(Pe,{as:"div",display:"inline-block",mt:"10px",mb:"10px",children:b.jsx(Pt,{color:"white",children:"LAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAH"})})});function _xe(){return b.jsxs(Pe,{as:"div",m:"80px",children:[b.jsx(Rs,{children:b.jsx(yt,{fontSize:"5xl",children:"How It Works"})}),b.jsxs(IK,{gap:6,templateColumns:{md:"repeat(2, 1fr)",xl:"repeat(4, minmax(200px, 1fr))"},m:"60px",children:[b.jsxs(wc,{children:[b.jsx(FS,{children:b.jsx(yt,{size:"md",children:" Register"})}),b.jsxs(Sl,{children:[b.jsx(Rs,{mb:4,children:b.jsx(Nn,{src:"/img/why-1.png",alt:"Girl-Thinking",boxSize:"auto",width:"auto",height:"150px"})}),b.jsx(Pt,{children:" Create your account on LexiLink and set up your profile. Tell us about your language learning goals, preferences, and availability."})]})]}),b.jsxs(wc,{children:[b.jsx(FS,{children:b.jsx(yt,{size:"md",children:" Explore Mentors"})}),b.jsxs(Sl,{children:[b.jsx(Rs,{mb:4,children:b.jsx(Nn,{src:"/img/why-2.png",alt:"Girl-Reading",boxSize:"auto",width:"auto",height:"150px"})}),b.jsx(Pt,{children:"Browse through our extensive list of mentors and discover the perfect match for your learning journey. Explore their profiles, including their areas of expertise, availability, and pricing."})]})]}),b.jsxs(wc,{children:[b.jsx(FS,{children:b.jsx(yt,{size:"md",children:"Schedule Class"})}),b.jsxs(Sl,{children:[b.jsx(Rs,{mb:4,children:b.jsx(Nn,{src:"/img/why-3.png",alt:"Man-Clock",boxSize:"auto",width:"auto",height:"150px"})}),b.jsx(Pt,{children:"Select your preferred mentor and schedule your sessions based on their availability. With just a few clicks, you'll be on your way to unlocking your full linguistic potential."})]})]}),b.jsxs(wc,{children:[b.jsx(FS,{children:b.jsx(yt,{size:"md",children:"Learn and Grow"})}),b.jsxs(Sl,{children:[b.jsx(Rs,{mb:4,children:b.jsx(Nn,{src:"/img/why-4.png",alt:"Boy Celebrating",boxSize:"auto",width:"auto",height:"150px"})}),b.jsx(Pt,{children:"Dive into your personalized mentorship sessions and watch your English skills flourish. Receive tailored guidance, constructive feedback, and expert insights that propel you towards fluency and confidence."})]})]})]})]})}function vxe(){const e=Lo({base:!0,md:!1});return b.jsxs(Pe,{pos:"relative",children:[b.jsx(Nn,{src:"/img/hands-5.png",alt:"Your Image",w:"100%",h:"auto"}),b.jsxs(Pe,{color:"white",pos:"absolute",top:"50%",left:"50%",transform:"translate(-80%, -50%)",textAlign:"left",children:[b.jsx(yt,{fontSize:{base:"2xl",xl:"5xl"},mb:4,children:"Join Our Community"}),e?null:b.jsx(b.Fragment,{children:b.jsx(Pt,{maxW:"1050px",fontSize:{base:"l",xl:"xl"},children:"Are you passionate about English language learning? Are you an experienced English tutor looking to make a meaningful impact? Join our vibrant community of learners and mentors on LexiLink."})}),b.jsx(bn,{to:"/join-us",children:b.jsx(pn,{color:"white",bg:"brand.700",mt:"24px",w:"200px",h:"50px;",borderRadius:"lg",children:"Become a Tutor"})})]})]})}var tq={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},kz=ns.createContext&&ns.createContext(tq),Exe=["attr","size","title"];function yxe(e,i){if(e==null)return{};var a=Sxe(e,i),l,u;if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(u=0;u<p.length;u++)l=p[u],!(i.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(e,l)&&(a[l]=e[l])}return a}function Sxe(e,i){if(e==null)return{};var a={},l=Object.keys(e),u,p;for(p=0;p<l.length;p++)u=l[p],!(i.indexOf(u)>=0)&&(a[u]=e[u]);return a}function Rb(){return Rb=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},Rb.apply(this,arguments)}function Dz(e,i){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);i&&(l=l.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),a.push.apply(a,l)}return a}function Ib(e){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Dz(Object(a),!0).forEach(function(l){Txe(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dz(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Txe(e,i,a){return i=bxe(i),i in e?Object.defineProperty(e,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[i]=a,e}function bxe(e){var i=Cxe(e,"string");return typeof i=="symbol"?i:String(i)}function Cxe(e,i){if(typeof e!="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,i);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function nq(e){return e&&e.map((i,a)=>ns.createElement(i.tag,Ib({key:a},i.attr),nq(i.child)))}function Fs(e){return i=>ns.createElement(wxe,Rb({attr:Ib({},e.attr)},i),nq(e.child))}function wxe(e){var i=a=>{var{attr:l,size:u,title:p}=e,m=yxe(e,Exe),v=u||a.size||"1em",y;return a.className&&(y=a.className),e.className&&(y=(y?y+" ":"")+e.className),ns.createElement("svg",Rb({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,l,m,{className:y,style:Ib(Ib({color:e.color||a.color},a.style),e.style),height:v,width:v,xmlns:"http://www.w3.org/2000/svg"}),p&&ns.createElement("title",null,p),e.children)};return kz!==void 0?ns.createElement(kz.Consumer,null,a=>i(a)):i(tq)}function Rxe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(e)}function Ixe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"},child:[]}]})(e)}function Axe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M313.6 304c-28.7 0-42.5 16-89.6 16-47.1 0-60.8-16-89.6-16C60.2 304 0 364.2 0 438.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-25.6c0-74.2-60.2-134.4-134.4-134.4zM400 464H48v-25.6c0-47.6 38.8-86.4 86.4-86.4 14.6 0 38.3 16 89.6 16 51.7 0 74.9-16 89.6-16 47.6 0 86.4 38.8 86.4 86.4V464zM224 288c79.5 0 144-64.5 144-144S303.5 0 224 0 80 64.5 80 144s64.5 144 144 144zm0-240c52.9 0 96 43.1 96 96s-43.1 96-96 96-96-43.1-96-96 43.1-96 96-96z"},child:[]}]})(e)}function Oxe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13.0281 2.00073C14.1535 2.00259 14.7238 2.00855 15.2166 2.02322L15.4107 2.02956C15.6349 2.03753 15.8561 2.04753 16.1228 2.06003C17.1869 2.1092 17.9128 2.27753 18.5503 2.52503C19.2094 2.7792 19.7661 3.12253 20.3219 3.67837C20.8769 4.2342 21.2203 4.79253 21.4753 5.45003C21.7219 6.0867 21.8903 6.81337 21.9403 7.87753C21.9522 8.1442 21.9618 8.3654 21.9697 8.58964L21.976 8.78373C21.9906 9.27647 21.9973 9.84686 21.9994 10.9723L22.0002 11.7179C22.0003 11.809 22.0003 11.903 22.0003 12L22.0002 12.2821L21.9996 13.0278C21.9977 14.1532 21.9918 14.7236 21.9771 15.2163L21.9707 15.4104C21.9628 15.6347 21.9528 15.8559 21.9403 16.1225C21.8911 17.1867 21.7219 17.9125 21.4753 18.55C21.2211 19.2092 20.8769 19.7659 20.3219 20.3217C19.7661 20.8767 19.2069 21.22 18.5503 21.475C17.9128 21.7217 17.1869 21.89 16.1228 21.94C15.8561 21.9519 15.6349 21.9616 15.4107 21.9694L15.2166 21.9757C14.7238 21.9904 14.1535 21.997 13.0281 21.9992L12.2824 22C12.1913 22 12.0973 22 12.0003 22L11.7182 22L10.9725 21.9993C9.8471 21.9975 9.27672 21.9915 8.78397 21.9768L8.58989 21.9705C8.36564 21.9625 8.14444 21.9525 7.87778 21.94C6.81361 21.8909 6.08861 21.7217 5.45028 21.475C4.79194 21.2209 4.23444 20.8767 3.67861 20.3217C3.12278 19.7659 2.78028 19.2067 2.52528 18.55C2.27778 17.9125 2.11028 17.1867 2.06028 16.1225C2.0484 15.8559 2.03871 15.6347 2.03086 15.4104L2.02457 15.2163C2.00994 14.7236 2.00327 14.1532 2.00111 13.0278L2.00098 10.9723C2.00284 9.84686 2.00879 9.27647 2.02346 8.78373L2.02981 8.58964C2.03778 8.3654 2.04778 8.1442 2.06028 7.87753C2.10944 6.81253 2.27778 6.08753 2.52528 5.45003C2.77944 4.7917 3.12278 4.2342 3.67861 3.67837C4.23444 3.12253 4.79278 2.78003 5.45028 2.52503C6.08778 2.27753 6.81278 2.11003 7.87778 2.06003C8.14444 2.04816 8.36564 2.03847 8.58989 2.03062L8.78397 2.02433C9.27672 2.00969 9.8471 2.00302 10.9725 2.00086L13.0281 2.00073ZM12.0003 7.00003C9.23738 7.00003 7.00028 9.23956 7.00028 12C7.00028 14.7629 9.23981 17 12.0003 17C14.7632 17 17.0003 14.7605 17.0003 12C17.0003 9.23713 14.7607 7.00003 12.0003 7.00003ZM12.0003 9.00003C13.6572 9.00003 15.0003 10.3427 15.0003 12C15.0003 13.6569 13.6576 15 12.0003 15C10.3434 15 9.00028 13.6574 9.00028 12C9.00028 10.3431 10.3429 9.00003 12.0003 9.00003ZM17.2503 5.50003C16.561 5.50003 16.0003 6.05994 16.0003 6.74918C16.0003 7.43843 16.5602 7.9992 17.2503 7.9992C17.9395 7.9992 18.5003 7.4393 18.5003 6.74918C18.5003 6.05994 17.9386 5.49917 17.2503 5.50003Z"},child:[]}]})(e)}function Nxe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18.2048 2.25H21.5128L14.2858 10.51L22.7878 21.75H16.1308L10.9168 14.933L4.95084 21.75H1.64084L9.37084 12.915L1.21484 2.25H8.04084L12.7538 8.481L18.2048 2.25ZM17.0438 19.77H18.8768L7.04484 4.126H5.07784L17.0438 19.77Z"},child:[]}]})(e)}function Pxe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(e)}function kxe(){return b.jsxs(Pe,{bg:"brand.800",color:"white",pt:"10",pb:"5",textAlign:"center",children:[b.jsxs(sr,{justifyContent:"center",gap:4,m:"10px",children:[b.jsx(jr,{boxSize:"25px",as:Rxe}),b.jsx(jr,{boxSize:"25px",as:Nxe}),b.jsx(jr,{boxSize:"25px",as:Oxe}),b.jsx(jr,{boxSize:"25px",as:Pxe})]}),b.jsxs(sr,{m:"60px",mb:"0px",mt:"10px",children:[b.jsx(Pt,{children:"© .LEXILINK INC 2024"}),b.jsx(Mc,{}),b.jsxs(sr,{gap:6,children:[b.jsx(bn,{to:"/",children:b.jsx(yt,{fontSize:"md",children:"Home"})}),b.jsx(bn,{to:"/about",children:b.jsx(yt,{fontSize:"md",children:"About"})}),b.jsx(bn,{to:"/mentor",children:b.jsx(yt,{fontSize:"md",children:"Join Us"})}),b.jsx(bn,{to:"/browse",children:b.jsx(yt,{fontSize:"md",children:"Browse a Tutor"})})]})]})]})}function Dxe(){const{authToken:e}=Ji(),i=ds();return F.useEffect(()=>{e&&i("/dashboard")},[]),b.jsx(b.Fragment,{children:!e&&b.jsxs("div",{children:[b.jsx(mxe,{}),b.jsx(gxe,{}),b.jsx(_xe,{}),b.jsx(vxe,{}),b.jsx(kxe,{})]})})}function jc({ajax:e=async()=>{},callback:i=async()=>{},isImmediate:a=!0}){const[l,u]=F.useState(!1),[p,m]=F.useState(!1),[v,y]=F.useState(!1),[S,C]=F.useState(),{refresh:R,authToken:N}=Ji(),x=(U,M)=>{u(!0),U(N).then(z=>{M(z),m(!0),C(z),u(!1)}).catch(z=>{z.response.status==410?(y(!0),R().then(V=>{U(V).then(W=>{M(W),m(!0),u(!1),C(W)}).catch(W=>console.log({err:W}))}).catch(V=>console.log({err:V}))):console.log({err:z})})};return F.useEffect(()=>{let U=!1;return a&&!U&&(u(!0),e(N).then(M=>{m(!0),C(M),u(!1),i(M)}).catch(M=>{M.response.status==410?(y(!0),R().then(z=>{e(z).then(V=>{i(V),m(!0),u(!1),C(V)}).catch(V=>console.log({err:V}))}).catch(z=>console.log({err:z}))):console.log({err:M})})),()=>{U=!0}},[]),[x,{isSuccess:p,isLoading:l,data:S,isRefreshing:v}]}function xxe({children:e}){const i=ds(),{authToken:a,refresh:l,logout:u}=Ji(),p=vC(),[m,{isLoading:v,isSuccess:y,isRefreshing:S}]=jc({isImmediate:!1}),C=async()=>{console.log("toast is here!!");try{p({title:"You've been logged out successfully.",status:"success",duration:3e3,isClosable:!0})}catch(x){console.error(x)}},R=()=>{u(),i("/"),C()},N=async()=>{await m(x=>Dt.delete("http://127.0.0.1:5000/auth/logout",{headers:{Authorization:"Bearer "+x}}),x=>R())};return b.jsxs(im,{children:[b.jsx(sm,{children:e}),b.jsx(Vh,{children:b.jsxs(om,{children:[b.jsx(bn,{to:"/profile",children:b.jsx(Is,{children:"Profile"})}),b.jsx(Is,{children:"Invite a friend"}),b.jsx(jx,{}),b.jsx(Is,{color:"red",onClick:N,children:"Log Out"})]})})]})}function Lxe({isloggedIn:e}){return b.jsx(b.Fragment,{children:b.jsxs(im,{children:[b.jsx(sm,{as:j$,"aria-label":"Options",icon:b.jsx(uxe,{}),variant:"outline"}),b.jsxs(om,{children:[b.jsxs(QP,{title:"Navigation",children:[b.jsx(bn,{to:"/",children:b.jsx(Is,{children:"Home"})}),b.jsx(bn,{to:"/browse",children:b.jsx(Is,{children:"Browse a Mentor"})}),b.jsx(bn,{to:"/mentor/",children:b.jsx(Is,{children:"Join Us"})})]}),b.jsx(jx,{}),!e&&b.jsxs(QP,{title:"Profile",children:[b.jsx(bn,{to:"/sign-in",children:b.jsx(Is,{children:"Login"})}),b.jsx(bn,{to:"/sign-up",children:b.jsx(Is,{children:"Sign up"})})]})]})]})})}function Mxe(){const e=Ul().pathname,i=Lo({base:!0,md:!1}),{authToken:a,refresh:l,setUser:u}=Ji(),[p,m]=F.useState(""),[v,{isLoading:y,isSuccess:S,isRefreshing:C}]=jc({isImmediate:!1}),R=N=>{u(N.data),m(N.data.profile_picture)};return F.useEffect(()=>{a&&(async()=>await v(x=>Dt.get("http://127.0.0.1:5000/student/profile",{headers:{Authorization:"Bearer "+x}}),x=>{R(x)}))()},[]),b.jsxs(Pe,{display:"flex",as:"nav",alignItems:"center",m:"30px",p:"30px",h:"40px",bg:"white",rounded:"full",boxShadow:"base",children:[b.jsx(Pe,{children:b.jsx(bn,{to:"/",children:b.jsx(Nn,{src:"/img/logo.png",alt:"Logo",boxSize:"auto",width:"100px",height:"auto"})})}),b.jsx(Mc,{}),i?b.jsx(Lxe,{isloggedIn:!!a}):b.jsxs(b.Fragment,{children:[b.jsx(bn,{to:"/",children:b.jsx(pn,{colorScheme:"gray",color:e==="/"||e==="/dashboard"?"brand.700":"black",variant:"ghost",children:"Home"})}),b.jsx(bn,{to:"/browse",children:b.jsx(pn,{colorScheme:"gray",color:e==="/browse"?"brand.700":"black",variant:"ghost",children:"Browse a Tutor"})}),b.jsx(bn,{to:"/mentor",children:b.jsx(pn,{colorScheme:"gray",color:e==="/mentor/join-us"?"brand.700":"black",variant:"ghost",children:"Join Us"})})]}),a?b.jsx(Pe,{ml:4,className:"image-container",children:b.jsx(xxe,{children:p?b.jsx(Dc,{size:"sm",bg:"red.500",src:p}):b.jsxs(b.Fragment,{children:[b.jsx(Nn,{w:"50px",src:"/img/profile.gif",className:"gif-image"}),b.jsx(Nn,{w:"50px",src:"/img/profile-still.png",className:"still-image"})]})})}):!i&&b.jsxs(Pe,{children:[b.jsx(bn,{to:"/sign-in",children:b.jsx(pn,{colorScheme:"facebook",variant:"outline",ml:"10px",children:"Login"})}),b.jsx(bn,{to:"/sign-up",children:b.jsx(pn,{colorScheme:"facebook",ml:"10px",variant:"solid",children:"Sign up"})})]})]})}function xz(){const e=Lo({base:!1,lg:!0}),i=b.jsx(Nn,{m:"30px",src:"/img/mentor.png",maxW:{base:"80%",lg:"40%"},height:"auto"});return b.jsxs(Pe,{children:[b.jsx(Pe,{display:"flex",justifyContent:"center",bg:"brand.100",color:"white",children:b.jsxs(Pe,{display:{base:"block",md:"flex"},p:"60px",pb:"5px",pt:"10px",maxW:"1250px",alignItems:"center",children:[e?i:b.jsx(Rs,{children:i}),b.jsxs(Pe,{p:"20px",m:"10px",children:[b.jsx(gl,{size:"md",mb:4,variant:"outline",color:"white",textDecoration:"none",borderWidth:2,children:b.jsx(Pt,{as:"b",children:"Tutor anytime, anywhere"})}),b.jsx(yt,{fontSize:"4xl",mb:4,children:"Become a LexiLink Mentor"}),b.jsx(Pt,{fontSize:"xl",children:"Are you passionate about helping others learn English and eager to share your knowledge and expertise? Join our community of mentors at LexiLink and make a difference in the lives of language learners around the world."}),b.jsx(pn,{size:"lg",mt:"30px",children:"Get Started Now"})]})]})}),b.jsx(Rs,{children:b.jsx(yt,{fontSize:"3xl",m:"30px",mt:"50px",children:"Why Become a Mentor?"})}),b.jsx(Pe,{maxW:"1300px",mx:"auto",mb:"50px",p:"40px",bg:"brand.700",boxShadow:"xl",rounded:"2xl",children:b.jsxs(Sh,{templateColumns:{base:"1fr",md:"repeat(3, 1fr)"},gap:9,justifyItems:"center",children:[b.jsx(wc,{minH:"280px",w:{lg:"full"},p:4,bg:"white",boxShadow:"md",rounded:"lg",children:b.jsxs(Sl,{display:"flex",flexDirection:"column",alignItems:"center",children:[b.jsx(Nn,{src:"/img/mirror.png",alt:"Mirror",objectFit:"cover",h:150,w:"auto",mb:4}),b.jsxs(Pe,{children:[b.jsx(yt,{fontSize:"xl",mb:2,children:"Impactful"}),b.jsx(Pt,{fontSize:"md",children:"Inspire and empower students to achieve their language learning goals through personalized guidance and support."})]})]})}),b.jsx(wc,{minH:"280px",w:{lg:"full"},p:4,bg:"white",boxShadow:"md",rounded:"lg",children:b.jsxs(Sl,{display:"flex",flexDirection:"column",alignItems:"center",children:[b.jsx(Nn,{src:"/img/computer.png",alt:"Computer",objectFit:"cover",h:165,w:"auto",mb:4}),b.jsxs(Pe,{children:[b.jsx(yt,{fontSize:"xl",mb:2,children:"Flexible"}),b.jsx(Pt,{fontSize:"md",children:"Set your own schedule and availability, allowing you to mentor students at times that work best for you."})]})]})}),b.jsx(wc,{minH:"280px",w:{lg:"full"},p:4,bg:"white",boxShadow:"md",rounded:"lg",children:b.jsxs(Sl,{display:"flex",flexDirection:"column",alignItems:"center",children:[b.jsx(Nn,{src:"/img/reward.png",alt:"Reward",h:"150",w:"auto",mb:4}),b.jsxs(Pe,{children:[b.jsx(yt,{fontSize:"xl",mb:2,children:"Rewarding"}),b.jsx(Pt,{fontSize:"md",children:"Experience the satisfaction of seeing your students grow and succeed, knowing that you played a crucial role in their language learning journey."})]})]})})]})})]})}function Uxe(e={}){const{nonce:i,onScriptLoadSuccess:a,onScriptLoadError:l}=e,[u,p]=F.useState(!1),m=F.useRef(a);m.current=a;const v=F.useRef(l);return v.current=l,F.useEffect(()=>{const y=document.createElement("script");return y.src="https://accounts.google.com/gsi/client",y.async=!0,y.defer=!0,y.nonce=i,y.onload=()=>{var S;p(!0),(S=m.current)===null||S===void 0||S.call(m)},y.onerror=()=>{var S;p(!1),(S=v.current)===null||S===void 0||S.call(v)},document.body.appendChild(y),()=>{document.body.removeChild(y)}},[i]),u}const rq=F.createContext(null);function jxe({clientId:e,nonce:i,onScriptLoadSuccess:a,onScriptLoadError:l,children:u}){const p=Uxe({nonce:i,onScriptLoadSuccess:a,onScriptLoadError:l}),m=F.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:p}),[e,p]);return ns.createElement(rq.Provider,{value:m},u)}function Fxe(){const e=F.useContext(rq);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function Vxe(e){var i;return(i=e==null?void 0:e.clientId)!==null&&i!==void 0?i:e==null?void 0:e.client_id}const Bxe={large:40,medium:32,small:20};function VC({onSuccess:e,onError:i,useOneTap:a,promptMomentNotification:l,type:u="standard",theme:p="outline",size:m="large",text:v,shape:y,logo_alignment:S,width:C,locale:R,click_listener:N,containerProps:x,...U}){const M=F.useRef(null),{clientId:z,scriptLoadedSuccessfully:V}=Fxe(),W=F.useRef(e);W.current=e;const H=F.useRef(i);H.current=i;const q=F.useRef(l);return q.current=l,F.useEffect(()=>{var ee,oe,se,re,me,pe,Re,Ze,Qe;if(V)return(se=(oe=(ee=window==null?void 0:window.google)===null||ee===void 0?void 0:ee.accounts)===null||oe===void 0?void 0:oe.id)===null||se===void 0||se.initialize({client_id:z,callback:Oe=>{var Ie;if(!(Oe!=null&&Oe.credential))return(Ie=H.current)===null||Ie===void 0?void 0:Ie.call(H);const{credential:Te,select_by:de}=Oe;W.current({credential:Te,clientId:Vxe(Oe),select_by:de})},...U}),(pe=(me=(re=window==null?void 0:window.google)===null||re===void 0?void 0:re.accounts)===null||me===void 0?void 0:me.id)===null||pe===void 0||pe.renderButton(M.current,{type:u,theme:p,size:m,text:v,shape:y,logo_alignment:S,width:C,locale:R,click_listener:N}),a&&((Qe=(Ze=(Re=window==null?void 0:window.google)===null||Re===void 0?void 0:Re.accounts)===null||Ze===void 0?void 0:Ze.id)===null||Qe===void 0||Qe.prompt(q.current)),()=>{var Oe,Ie,Te;a&&((Te=(Ie=(Oe=window==null?void 0:window.google)===null||Oe===void 0?void 0:Oe.accounts)===null||Ie===void 0?void 0:Ie.id)===null||Te===void 0||Te.cancel())}},[z,V,a,u,p,m,v,y,S,C,R]),ns.createElement("div",{...x,ref:M,style:{height:Bxe[m],...x==null?void 0:x.style}})}function Wxe(){const{authToken:e,login:i,logout:a}=Ji(),l=Lo({base:!0,md:!1}),[u,p]=F.useState({email:"",password:"",user_type:"student"}),[m,v]=F.useState(""),y=ds(),S=vC(),C=U=>{console.log(U)},R=U=>{const{name:M,value:z}=U.currentTarget;p({...u,[M]:z}),v(!1)},N=async()=>{try{await S({title:"You've been logged in successfully.",status:"success",duration:3e3,isClosable:!0})}catch(U){console.log(U)}},x=()=>{Object.values(u).every(U=>U)?(async()=>{try{await Dt.post("http://127.0.0.1:5000/auth/login",u).then(U=>{console.log(U.data),i(U.data.access_token,U.data.refresh_token),setTimeout(()=>{y("/")},1e3)}).then(U=>N()).catch(U=>console.log(U))}catch{v("Email or Password provided are incorrect")}})():v("Both fields are required")};return b.jsx(b.Fragment,{children:b.jsxs(Pe,{display:"flex",bg:"white",h:"600px",m:{base:"60px",xl:"100px"},mt:"10px",rounded:"3xl",boxShadow:"md",children:[!l&&b.jsxs(Pe,{pos:"relative",children:[b.jsx(Nn,{src:"/img/bad-school-1.png",alt:"hands with text",boxSize:"600px",objectFit:"cover",roundedLeft:"3xl"}),b.jsx(Pe,{pos:"absolute",width:"120px",height:"auto",top:"10%",left:{base:"28%",lg:"23%"},transform:"translate(-80%, -50%)",children:b.jsx(bn,{to:"/",children:b.jsx(Nn,{src:"/img/logo-2.png"})})})]}),b.jsxs(Pe,{w:{base:"100%",md:"70%",lg:"50%"},children:[l&&b.jsx(sr,{m:"50px",mb:"0px",justify:"flex",children:b.jsx(bn,{to:"/",children:b.jsx(Nn,{src:"/img/logo.png",width:"100px",height:"auto"})})}),b.jsxs(Pe,{m:"50px",mt:{base:"40px",lg:"70px"},mb:"0px",children:[b.jsx(Pt,{mb:2,children:"Welcome back! "}),b.jsx(yt,{mb:2,children:"Log in to your Account"}),b.jsxs(Pt,{children:["New User?  ",b.jsx(bn,{to:"/sign-up",children:b.jsx("span",{children:"Sign Up."})})]}),b.jsx(Pe,{w:"85%",mt:"20px",children:b.jsx(VC,{buttonText:"Sign in with Google",onSuccess:C,onError:()=>{console.log("Login Failed")}})})]}),b.jsxs("form",{onSubmit:U=>U.preventDefault(),children:[" ",b.jsxs(fo,{mb:3,isInvalid:m,children:[b.jsx(On,{children:"Email Address"}),b.jsx(Ur,{placeholder:"Enter your email address",w:"85%",name:"email",value:u.email,onChange:R})]}),b.jsxs(fo,{isInvalid:m,children:[b.jsx(On,{children:"Password"}),b.jsx(Ur,{type:"password",placeholder:"Enter your password",w:"85%",name:"password",value:u.password,onChange:R}),b.jsx(du,{children:m})]}),b.jsx(pn,{colorScheme:"facebook",type:"submit",h:"40px",w:"85%",mt:6,onClick:x,children:"Sign In"}),b.jsx(sr,{w:"85%",mt:4,justifyContent:"center",children:b.jsx(Pt,{children:b.jsx(bn,{to:"/",children:"Forgot Password?"})})})]})]})]})})}function zxe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M349.6 64c-36.4 0-70.7 16.7-93.6 43.9C233.1 80.7 198.8 64 162.4 64 97.9 64 48 114.2 48 179.1c0 79.5 70.7 143.3 177.8 241.7L256 448l30.2-27.2C393.3 322.4 464 258.6 464 179.1 464 114.2 414.1 64 349.6 64zm-80.8 329.3l-4.2 3.9-8.6 7.8-8.6-7.8-4.2-3.9c-50.4-46.3-94-86.3-122.7-122-28-34.7-40.4-63.1-40.4-92.2 0-22.9 8.4-43.9 23.7-59.3 15.2-15.4 36-23.8 58.6-23.8 26.1 0 52 12.2 69.1 32.5l24.5 29.1 24.5-29.1c17.1-20.4 43-32.5 69.1-32.5 22.6 0 43.4 8.4 58.7 23.8 15.3 15.4 23.7 36.5 23.7 59.3 0 29-12.5 57.5-40.4 92.2-28.8 35.7-72.3 75.7-122.8 122z"},child:[]}]})(e)}function Gxe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 448l-30.164-27.211C118.718 322.442 48 258.61 48 179.095 48 114.221 97.918 64 162.4 64c36.399 0 70.717 16.742 93.6 43.947C278.882 80.742 313.199 64 349.6 64 414.082 64 464 114.221 464 179.095c0 79.516-70.719 143.348-177.836 241.694L256 448z"},child:[]}]})(e)}function Hxe({isOpen:e,onClose:i}){const a=ds();return b.jsx(b.Fragment,{children:b.jsxs(mE,{isOpen:e,onClose:i,children:[b.jsx(vE,{}),b.jsxs(gE,{children:[b.jsx(nY,{}),b.jsxs(EE,{textAlign:"center",children:[b.jsx(Nn,{src:"/img/horse.gif"}),b.jsx(yt,{color:"brand.800",mb:2,fontSize:"3xl",children:"Enroll for Access to Exceptional Mentors!"}),b.jsx(Pt,{fontSize:"lg",children:"Unlock access to mentors by registering today"})]}),b.jsx(_E,{mb:"20px",children:b.jsx(pn,{w:"100%",colorScheme:"facebook",mr:3,onClick:()=>a("/sign-up"),children:"Sign Up"})})]})]})})}function $xe({filter:e,search:i,setSearch:a}){const{authToken:l,refresh:u}=Ji(),p=Lo({base:!1,md:!0}),[m,v]=F.useState(null),[y,S]=F.useState(1),[C,R]=F.useState([]),[N,x]=F.useState([]),[U,M]=F.useState(!1),[z,V]=F.useState(),{isOpen:W,onOpen:H,onClose:q}=yC(),ee=ds(),[oe,{isLoading:se,isSuccess:re,isRefreshing:me}]=jc({isImmediate:!1}),pe=de=>{Te(),V(N.some(ue=>ue.id===de.id)?de.id:0),M(!0),v(de),setTimeout(()=>{M(!1)},1e3)},Re=de=>{l?ee(`/booking/${de.username}`,{state:{mentor:de}}):H()},Ze=async()=>{if(i){console.log("hi");try{let de=1,ue=[],be;do be=(await Dt.get("http://127.0.0.1:5000/mentor/all/",{params:{page:de}})).data.mentors,ue=[...ue,...be.filter(He=>`${He.first_name} ${He.last_name}`.includes(i))],de++;while(be.length);R(ue),v(ue[0])}catch(de){console.log(de)}}},Qe=async de=>{l?z===de.id?(V(0),await oe(ue=>Dt.delete("http://127.0.0.1:5000/student/mentors/favorites/",{headers:{Authorization:"Bearer "+ue},data:{mentor:de.username}}),ue=>console.log(`you removed the mentor: ${de.first_name} to your favorites`))):(V(de.id),await oe(ue=>Dt.post("http://127.0.0.1:5000/student/mentors/favorites/",{mentor:de.username},{headers:{Authorization:"Bearer "+ue}}),ue=>console.log(`you added the mentor: ${de.first_name} to your favorites`))):H()},Oe=()=>{S(y+1)},Ie=de=>(e&&e[0]&&(e[0].length>0&&(de=de.filter(ue=>e[0].includes(ue.type))),e[1].length>0&&(de=de.filter(ue=>e[1].includes(ue.first_language)||e[1].includes(ue.other_languages))),de=de.filter(ue=>ue.price_per_hour<=e[2][1]&&ue.price_per_hour>=e[2][0])),e=null,de);F.useEffect(()=>{(async()=>{try{const ue=await Dt.get("http://127.0.0.1:5000/mentor/all/",{params:{page:y}});R([...C,...ue.data.mentors]),y===1&&v(ue.data.mentors[0]),console.log("this is filter ",e)}catch(ue){console.log("An error occured during retrival of mentors from the database: ",ue)}})()},[y]),F.useEffect(()=>{i?(Ze(),e=null):a("")},[i]);const Te=async()=>{await oe(de=>Dt.get("http://127.0.0.1:5000/student/mentors/favorites/",{headers:{Authorization:"Bearer "+de}}),de=>x(de.data.mentors))};return F.useEffect(()=>{var de;l&&(Te(),V(N.some(ue=>{var be;return ue.id===((be=C[0])==null?void 0:be.id)})?(de=C[0])==null?void 0:de.id:0))},[C]),b.jsx(Pe,{display:"flex",justifyContent:"center",children:b.jsxs(Pe,{maxW:"1200px",display:"flex",justifyContent:"center",overflowY:"auto",children:[b.jsxs(Pe,{m:"20px",mr:"10px",mt:"0px",w:"90%",overflowY:"auto",height:{base:"auto",md:"150vh"},children:[Ie(C).map((de,ue)=>b.jsx(wc,{borderWidth:1.7,borderColor:(m==null?void 0:m.id)===de.id?"brand.700":"grey",m:"15px",p:"10px",style:{cursor:"pointer"},onClick:()=>pe(de),children:b.jsxs(Sl,{children:[b.jsxs(Pe,{display:{base:"block",sm:"flex"},alignItems:"center",textAlign:{base:"center",sm:"left"},overflow:"hidden",whiteSpace:"wrap",textOverflow:"ellipsis",children:[b.jsx(Dc,{m:"10px",mb:3,size:{base:"xl",lg:"2xl"},src:de.profile_picture}),b.jsxs(Pe,{m:"10px",children:[b.jsxs(yt,{size:"md",children:[de.first_name," ",de.last_name]}),b.jsxs(Tm,{colorScheme:de.type==="Community"?"blue":"yellow",children:[de.type," Mentor"]}),b.jsxs(Pt,{mt:"3px",children:["Languages: ",b.jsx(gl,{m:"2px",children:de.first_language}),Array.isArray(de==null?void 0:de.other_languages)?de.other_languages.map((be,xe)=>b.jsx(gl,{m:"2px",children:be},xe)):b.jsx(gl,{m:"2px",children:de.other_languages},ue)]}),b.jsx(Pt,{mt:2,children:de.bio})]})]}),b.jsx(Pe,{display:"flex",alignItems:"center",justifyContent:"flex-end",m:"10px",mt:"10px",mb:"0px",children:b.jsxs(yt,{color:"brand.800",size:"md",children:["USD ",de.price_per_hour]})})]})},ue)),!i&&b.jsx(pn,{w:"100%",colorScheme:"orange",variant:"ghost",onClick:Oe,children:"Load More"})]}),p&&C.length&&b.jsx(Pe,{m:"20px",ml:"10px",mt:"0px",w:"100%",height:"150vh",overflowY:"auto",top:"0",children:U?b.jsx(wc,{children:b.jsxs(Pe,{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",children:[b.jsx(gC,{size:"xl",color:"blue.500"}),b.jsx(Pe,{ml:"2",children:"Loading..."})," "]})}):b.jsx(wc,{m:"8px",children:b.jsxs(Sl,{children:[b.jsx(Pe,{display:"flex",justifyContent:"center",textAlign:"center",children:b.jsxs(Pe,{children:[b.jsx(Dc,{m:"20px",size:"2xl",src:m==null?void 0:m.profile_picture}),b.jsxs(yt,{fontSize:"3xl",children:[m==null?void 0:m.first_name," ",m==null?void 0:m.last_name]}),b.jsxs(Tm,{colorScheme:(m==null?void 0:m.type)==="Community"?"blue":"yellow",children:[m==null?void 0:m.type," Mentor"]})]})}),b.jsxs(Pe,{m:"20px",children:[b.jsx(yt,{mb:2,fontSize:"lg",children:"Languages"}),b.jsxs(sr,{mb:4,gap:2,flexWrap:"wrap",children:[b.jsx(gl,{m:"2px",children:m==null?void 0:m.first_language}),Array.isArray(m==null?void 0:m.other_languages)?m.other_languages.map((de,ue)=>b.jsx(gl,{m:"2px",children:de},ue)):null]}),b.jsx(yt,{mb:1,fontSize:"lg",children:"Bio"}),b.jsx(Pt,{mb:4,children:m==null?void 0:m.bio}),b.jsx(yt,{mb:1,fontSize:"lg",children:"Expertise"}),b.jsx(Pt,{mb:4,children:m==null?void 0:m.expertise}),b.jsx(mo,{orientation:"horizontal",mb:6}),b.jsx("iframe",{width:"100%",height:"315",src:m==null?void 0:m.demo_video,frameBorder:"0",allow:"autoplay; encrypted-media",allowFullScreen:!0}),b.jsx(D$,{mt:4,allowToggle:!0,children:b.jsxs(O$,{children:[b.jsx("h2",{children:b.jsxs(I$,{children:[b.jsx(Pe,{as:"span",flex:"1",textAlign:"left",children:"Read More"}),b.jsx(A$,{})]})}),b.jsx(k$,{pb:4,children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."})]})}),b.jsxs(Pe,{display:"flex",alignItems:"center",m:"20px",children:[b.jsx(pn,{colorScheme:"teal",w:"80%",onClick:()=>Re(m),children:"Book Now"}),b.jsx(Mc,{}),b.jsx(jr,{boxSize:"30px",as:z?Gxe:zxe,onClick:()=>Qe(m),style:{cursor:"pointer"}})]})]})]})})}),b.jsx(Hxe,{isOpen:W,onClose:q})]})})}function Lz(){const e=["English","Mandarin Chinese","Hindi","Spanish","French","Standard Arabic","Bengali","Portuguese","Russian","Urdu","Indonesian","Standard German","Japanese","Nigerian Pidgin","Egyptian Spoken Arabic","Marathi","Telugu","Turkish","Tamil","Yue Chinese"],i=Lo({base:!1,lg:!0}),a=b.jsx(Nn,{m:"20px",src:"/img/faces-3.png",maxW:{base:"80%",lg:"40%"},height:"auto"}),[l,u]=F.useState([0,100]),[p,m]=F.useState([]),[v,y]=F.useState([]),[S,C]=F.useState(""),[R,N]=F.useState(!1),[x,U]=F.useState(!1),M=ds(),z=oe=>{u(oe)},V=()=>{M(0)},W=oe=>{p.includes(oe)?m(p.filter(se=>se!==oe)):m([...p,oe])},H=oe=>{R&&N(!1);const{value:se}=oe.currentTarget;C(se)},q=oe=>{N(!0),U(!0)},ee=oe=>{v.includes(oe)?y(v.filter(se=>se!==oe)):y([...v,oe])};return b.jsxs(b.Fragment,{children:[b.jsx(Pe,{display:"flex",justifyContent:"center",bg:"brand.800",color:"white",children:b.jsxs(Pe,{display:{base:"block",lg:"flex"},p:"60px",pb:"10px",pt:"10px",maxW:"1250px",children:[b.jsxs(Pe,{pt:"70px",m:{base:"0px",lg:"10px"},children:[b.jsx(gl,{size:"md",mb:4,variant:"outline",color:"white",textDecoration:"none",borderWidth:2,children:b.jsx(Pt,{as:"b",children:"1-on-1 Sessions"})}),b.jsx(yt,{fontSize:"4xl",mb:4,children:"Empower Your Learning Journey with Tailored Mentorship"}),b.jsx(Pt,{fontSize:"xl",children:"Whether you're looking to improve your speaking skills, prepare for exams, or simply boost your confidence in English, our mentors are here to help you succeed. Explore our Mentor Directory now and take the first step towards achieving your language learning aspirations."})]}),i?a:b.jsx(Rs,{children:a})]})}),b.jsx(Pe,{display:"flex",justifyContent:"center",children:b.jsxs(Pe,{p:"40px",w:{base:"100%",lg:"50%"},children:[R&&b.jsxs(gl,{mb:2,children:[S,b.jsx(SY,{mr:2,onClick:V})]}),b.jsxs(Nx,{size:"md",color:"white",children:[b.jsx(Ur,{boxShadow:"md",pr:"4.5rem",color:"black",placeholder:"Search for Mentors",bg:"white",value:S,onChange:H,isReadOnly:x}),b.jsx(TC,{width:"4.5rem",children:b.jsx(pn,{h:"1.75rem",size:"sm",colorScheme:"teal",rounded:"xl",onClick:q,children:b.jsx(dxe,{})})})]}),b.jsxs(Pe,{display:"flex",mt:4,justifyContent:"center",gap:3,children:[b.jsxs(im,{closeOnSelect:!1,children:[b.jsx(sm,{as:pn,rightIcon:b.jsx(hN,{}),color:"white",bg:"brand.700",rounded:"full",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",children:b.jsx(Pt,{display:{base:"none",sm:"block"},children:"Type"})}),b.jsxs(om,{children:[b.jsx(Is,{children:b.jsx(TT,{size:"sm",colorScheme:"red",isChecked:v.includes("Professional"),onChange:()=>ee("Professional"),children:"Professional mentor"})}),b.jsx(Is,{children:b.jsx(TT,{size:"sm",colorScheme:"red",isChecked:v.includes("Community"),onChange:()=>ee("Community"),children:"Community mentor"})})]})]}),b.jsxs(im,{closeOnSelect:!1,boundary:"scrollParent",children:[b.jsx(sm,{as:pn,rightIcon:b.jsx(hN,{}),color:"white",bg:"brand.700",rounded:"full",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",children:b.jsx(Pt,{display:{base:"none",sm:"block"},children:"Language"})}),b.jsx(om,{height:"300px",overflowY:"auto",children:e.map(oe=>b.jsx(Is,{children:b.jsx(TT,{size:"sm",colorScheme:"red",isChecked:p.includes(oe),onChange:()=>W(oe),children:oe})},oe))})]}),b.jsxs(im,{closeOnSelect:!1,children:[b.jsx(sm,{as:pn,rightIcon:b.jsx(hN,{}),color:"white",bg:"brand.700",rounded:"full",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",children:b.jsx(Pt,{display:{base:"none",sm:"block"},children:"Price"})}),b.jsx(om,{children:b.jsx(Is,{children:b.jsxs(Pe,{w:"100%",textAlign:"center",p:"5px",children:[b.jsxs(cY,{defaultValue:[0,100],min:4,max:100,step:10,onChange:z,children:[b.jsx(lY,{bg:"red.100",children:b.jsx(dY,{bg:"brand.700"})}),b.jsx(tk,{boxSize:3,index:0}),b.jsx(tk,{boxSize:3,index:1})]}),b.jsxs(Pt,{children:["$ ",l[0]," - $ ",l[1]]})]})})})]})]})]})}),b.jsx($xe,{filter:[v,p,l],search:R?S:null,setSearch:C})]})}const Kxe=({input:e,formError:i,onChange:a,onClick:l})=>{const u=Lo({base:!0,md:!1}),p=m=>{console.log(m)};return b.jsx(b.Fragment,{children:b.jsxs(Pe,{display:"flex",bg:"white",h:"600px",m:{base:"60px",xl:"100px"},rounded:"3xl",boxShadow:"md",children:[b.jsxs(Pe,{roundedLeft:"3xl",w:{base:"100%",md:"50%"},children:[b.jsxs(Pe,{m:"50px",mb:"0px",children:[u&&b.jsx(sr,{mb:"0px",justify:"flex",children:b.jsx(bn,{to:"/",children:b.jsx(Nn,{src:"/img/logo.png",width:"100px",height:"auto"})})}),b.jsx(Pt,{mt:{base:"50px",lg:"100px"},mb:2,children:"Register Now"}),b.jsx(yt,{mb:2,children:"Sign Up For Free"}),b.jsxs(Pt,{children:["Already have an account? ",b.jsx(bn,{to:"/sign-in",children:b.jsx("span",{children:"Sign In."})})]}),b.jsx(Pe,{w:"85%",mt:"20px",children:b.jsx(VC,{onSuccess:p,onError:()=>{console.log("Login Failed")}})})]}),b.jsxs("form",{onSubmit:m=>m.preventDefault(),children:[" ",b.jsxs(fo,{mb:3,isInvalid:!!i.email,children:[b.jsx(On,{children:"Email Address"}),b.jsx(Ur,{placeholder:"Enter your email address",w:"85%",name:"email",value:e.email,onChange:a}),i.email&&b.jsx(du,{children:i.email})]}),b.jsxs(fo,{isInvalid:!!i.password,children:[b.jsx(On,{children:"Password"}),b.jsx(Ur,{type:"password",placeholder:"Enter your password",w:"85%",name:"password",value:e.password,onChange:a}),i.password&&b.jsx(du,{children:i.password})]}),b.jsx(pn,{colorScheme:"facebook",type:"submit",h:"40px",w:"85%",mt:6,onClick:l,children:"Next"})]})]}),b.jsx(Mc,{}),!u&&b.jsxs(Pe,{pos:"relative",children:[b.jsx(Nn,{src:"/img/hash-1.png",alt:"a boy with his teacher",boxSize:"600px",objectFit:"cover",roundedRight:"3xl"}),b.jsx(Pe,{pos:"absolute",width:"120px",height:"auto",top:"10%",left:{base:"28%",lg:"23%"},transform:"translate(-80%, -50%)",children:b.jsx(bn,{to:"/",children:b.jsx(Nn,{src:"/img/logo-2.png"})})})]})]})})};function Yxe({isOpen:e}){const i=ds();return F.useEffect(()=>{e&&setTimeout(()=>{i("/sign-in")},4e3)},[e]),b.jsx(b.Fragment,{children:b.jsxs(mE,{isOpen:e,children:[b.jsx(vE,{}),b.jsxs(gE,{children:[b.jsx(Fx,{children:"Congratulations!"}),b.jsxs(EE,{children:[b.jsx(Pt,{fontSize:"lg",children:"Welcome to our community. Let the learning journey begin!"}),b.jsx("br",{}),b.jsx(Rs,{children:b.jsx(Nn,{mt:4,boxSize:"80%",src:"/img/rocket.png"})}),b.jsx(Rs,{children:b.jsx(Pt,{children:"You will be redirected to sign in to your account"})})]}),b.jsx(_E,{})]})]})})}const qxe=({input:e,formError:i,setFormError:a,onChange:l,setInput:u})=>{const p=Lo({base:!0,lg:!1}),{isOpen:m,onOpen:v,onClose:y}=yC(),S=U=>{u({...e,proficiency:U})},C=()=>{v()},R=U=>{const M={...i};for(let[z,V]of Object.entries(e))V?M[z]="":M[z]="This field is required";(async()=>{try{const z=await Dt.post("http://127.0.0.1:5000/auth/verify_username",{username:e.username,user_type:"student"});a({...M}),Object.values(e).every(V=>V)&&(async()=>{try{const V=await Dt.post("http://127.0.0.1:5000/auth/signup",e);C()}catch(V){V.response&&console.error("An error occurred:",V)}})()}catch(z){z.response&&z.response.status===400?(M.username=z.response.data.error,a({...M})):console.error("An error occurred:",z)}})()},[N,x]=F.useState([]);return F.useEffect(()=>{(async()=>{try{const M=await Dt.get("https://restcountries.com/v3.1/all?fields=name,demonyms");M.data.sort((z,V)=>z.name.common.localeCompare(V.name.common)),x(M.data)}catch(M){console.error("Error fetching data:",M)}})()},[]),b.jsxs(b.Fragment,{children:[b.jsxs(Pe,{display:"grid",p:"50px",gridTemplateColumns:"10fr 1fr 10fr",gap:6,m:"100px",color:"black",bg:"white",justifyContent:"center",rounded:"3xl",boxShadow:"md",children:[b.jsxs(Hv,{colSpan:{base:3,lg:1},children:[b.jsx(yt,{mb:2,children:"Let's get to know you better!"}),b.jsx(Pt,{mb:10,children:"Provide the following details to tailor your learning journey"}),b.jsxs(fo,{isInvalid:!!i.username,children:[b.jsx(On,{children:"Username"}),b.jsx(Ur,{mb:3,placeholder:"Enter your username",name:"username",value:e.username,onChange:l})]}),b.jsxs(fo,{isInvalid:!!i.first_name,children:[b.jsx(On,{children:"First Name"}),b.jsx(Ur,{mb:3,placeholder:"Enter your first name",name:"first_name",value:e.first_name,onChange:l})]}),b.jsxs(fo,{isInvalid:!!i.last_name,children:[b.jsx(On,{children:"Last Name"}),b.jsx(Ur,{mb:3,placeholder:"Enter your last name",name:"last_name",value:e.last_name,onChange:l})]}),b.jsx(On,{children:"Country"}),b.jsx(ru,{isInvalid:!!i.country,placeholder:"Select your country",name:"country",value:e.country,onChange:l,children:N==null?void 0:N.map((U,M)=>b.jsx("option",{value:U.name.common,children:U.name.common},M))})]}),!p&&b.jsx(mo,{ml:"20px",orientation:"vertical",h:"500px"}),b.jsxs(Hv,{colSpan:{base:3,lg:1},children:[b.jsxs(fo,{children:[b.jsx(On,{mt:{md:"70px",xl:"100px"},children:"First Language"}),b.jsx(Ur,{isInvalid:!!i.first_language,mb:3,placeholder:"Enter your first language",name:"first_language",value:e.first_language,onChange:l})]}),b.jsx(On,{children:"Nationality"}),b.jsx(ru,{isInvalid:!!i.nationality,mb:7,placeholder:"Select your nationality",name:"nationality",value:e.nationality,onChange:l,children:N==null?void 0:N.map((U,M)=>b.jsx("option",{value:U.demonyms.eng.m,children:U.demonyms.eng.m},M))}),b.jsx(On,{children:"How would you describe your English proficiency?"}),b.jsx(IC,{mb:"30px",name:"proficiency",value:e.proficiency,onChange:S,children:b.jsxs(CC,{children:[b.jsxs(sr,{children:[b.jsx(As,{mr:1,value:"0",children:"0 - No proficiency"}),b.jsx(_f,{placement:"right-start",label:"I'm just starting to learn English. I can understand basic words and phrases, like greetings and simple questions.",fontSize:"sm",children:b.jsx(P_,{})})]}),b.jsxs(sr,{children:[b.jsx(As,{mr:1,value:"1",children:"1 - Low proficiency"}),b.jsx(_f,{placement:"right-start",label:"I'm building my English skills. I can express myself in simple sentences and understand basic instructions.",fontSize:"sm",children:b.jsx(P_,{})})]}),b.jsxs(sr,{children:[b.jsx(As,{mr:1,value:"2",children:"2 - Intermediate proficiency"}),b.jsx(_f,{placement:"right-start",label:"I'm becoming more confident in English. I can hold conversations on familiar topics and understand more complex sentences.",fontSize:"sm",children:b.jsx(P_,{})})]}),b.jsxs(sr,{children:[b.jsx(As,{mr:1,value:"3",children:"3 - Upper Intermediate proficiency"}),b.jsx(_f,{placement:"right-start",label:"I'm getting pretty good at English. I can understand most conversations and read and write with few mistakes.",fontSize:"sm",children:b.jsx(P_,{})})]}),b.jsxs(sr,{children:[b.jsx(As,{mr:1,value:"4",children:"4 - High proficiency"}),b.jsx(_f,{placement:"right-start",label:"I'm fluent in English. I can speak, read, and write with ease, almost like a native speaker. I understand idioms and slang, and I can communicate effectively in any situation.",fontSize:"sm",children:b.jsx(P_,{})})]})]})}),b.jsx(sr,{justify:"flex-end",children:b.jsx(pn,{onClick:R,className:"right-aligned",colorScheme:"facebook",children:"Submit"})})]})]}),b.jsx(Yxe,{isOpen:m})]})};function Jxe(){const[e,i]=F.useState({email:"",password:"",username:"",first_name:"",last_name:"",country:"",nationality:"",first_language:"",proficiency:"",user_type:"student"}),[a,l]=F.useState(1),[u,p]=F.useState({email:"",password:"",username:"",first_name:"",last_name:"",country:"",nationality:"",first_language:"",proficiency:""});let m=!0;const v=()=>{const R={...u,email:"",password:""};e.email?C(e.email)||(R.email="Invalid email address"):R.email="This field is required",e.password.length<6&&(R.password="This field must be at least 6 characters"),(async()=>{try{const N=await Dt.post("http://127.0.0.1:5000/auth/verify_email",{email:e.email,user_type:"student"})}catch(N){N.response&&N.response.status===400?(R.email=N.response.data.error,m=!1):console.error("An error occurred:",N)}p({...R}),e.email&&C(e.email)&&e.password.length>=6&&m&&y()})()},y=()=>{l(a+1)},S=R=>{const{name:N,value:x}=R.currentTarget;i({...e,[N]:x}),p({...u,[N]:""})},C=R=>/^[^@]+@[^@]+\.[^@]+$/.test(R);return b.jsxs(b.Fragment,{children:[a===1&&b.jsx(Kxe,{input:e,formError:u,onChange:S,onClick:v}),a==2&&b.jsx(qxe,{input:e,formError:u,setFormError:p,onChange:S,setInput:i})]})}function Xxe(){return b.jsx("h1",{children:"error 404"})}var iq={exports:{}};(function(e,i){(function(a,l){e.exports=l()})(rn,function(){var a=1e3,l=6e4,u=36e5,p="millisecond",m="second",v="minute",y="hour",S="day",C="week",R="month",N="quarter",x="year",U="date",M="Invalid Date",z=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,V=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,W={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Oe){var Ie=["th","st","nd","rd"],Te=Oe%100;return"["+Oe+(Ie[(Te-20)%10]||Ie[Te]||Ie[0])+"]"}},H=function(Oe,Ie,Te){var de=String(Oe);return!de||de.length>=Ie?Oe:""+Array(Ie+1-de.length).join(Te)+Oe},q={s:H,z:function(Oe){var Ie=-Oe.utcOffset(),Te=Math.abs(Ie),de=Math.floor(Te/60),ue=Te%60;return(Ie<=0?"+":"-")+H(de,2,"0")+":"+H(ue,2,"0")},m:function Oe(Ie,Te){if(Ie.date()<Te.date())return-Oe(Te,Ie);var de=12*(Te.year()-Ie.year())+(Te.month()-Ie.month()),ue=Ie.clone().add(de,R),be=Te-ue<0,xe=Ie.clone().add(de+(be?-1:1),R);return+(-(de+(Te-ue)/(be?ue-xe:xe-ue))||0)},a:function(Oe){return Oe<0?Math.ceil(Oe)||0:Math.floor(Oe)},p:function(Oe){return{M:R,y:x,w:C,d:S,D:U,h:y,m:v,s:m,ms:p,Q:N}[Oe]||String(Oe||"").toLowerCase().replace(/s$/,"")},u:function(Oe){return Oe===void 0}},ee="en",oe={};oe[ee]=W;var se="$isDayjsObject",re=function(Oe){return Oe instanceof Ze||!(!Oe||!Oe[se])},me=function Oe(Ie,Te,de){var ue;if(!Ie)return ee;if(typeof Ie=="string"){var be=Ie.toLowerCase();oe[be]&&(ue=be),Te&&(oe[be]=Te,ue=be);var xe=Ie.split("-");if(!ue&&xe.length>1)return Oe(xe[0])}else{var He=Ie.name;oe[He]=Ie,ue=He}return!de&&ue&&(ee=ue),ue||!de&&ee},pe=function(Oe,Ie){if(re(Oe))return Oe.clone();var Te=typeof Ie=="object"?Ie:{};return Te.date=Oe,Te.args=arguments,new Ze(Te)},Re=q;Re.l=me,Re.i=re,Re.w=function(Oe,Ie){return pe(Oe,{locale:Ie.$L,utc:Ie.$u,x:Ie.$x,$offset:Ie.$offset})};var Ze=function(){function Oe(Te){this.$L=me(Te.locale,null,!0),this.parse(Te),this.$x=this.$x||Te.x||{},this[se]=!0}var Ie=Oe.prototype;return Ie.parse=function(Te){this.$d=function(de){var ue=de.date,be=de.utc;if(ue===null)return new Date(NaN);if(Re.u(ue))return new Date;if(ue instanceof Date)return new Date(ue);if(typeof ue=="string"&&!/Z$/i.test(ue)){var xe=ue.match(z);if(xe){var He=xe[2]-1||0,rt=(xe[7]||"0").substring(0,3);return be?new Date(Date.UTC(xe[1],He,xe[3]||1,xe[4]||0,xe[5]||0,xe[6]||0,rt)):new Date(xe[1],He,xe[3]||1,xe[4]||0,xe[5]||0,xe[6]||0,rt)}}return new Date(ue)}(Te),this.init()},Ie.init=function(){var Te=this.$d;this.$y=Te.getFullYear(),this.$M=Te.getMonth(),this.$D=Te.getDate(),this.$W=Te.getDay(),this.$H=Te.getHours(),this.$m=Te.getMinutes(),this.$s=Te.getSeconds(),this.$ms=Te.getMilliseconds()},Ie.$utils=function(){return Re},Ie.isValid=function(){return this.$d.toString()!==M},Ie.isSame=function(Te,de){var ue=pe(Te);return this.startOf(de)<=ue&&ue<=this.endOf(de)},Ie.isAfter=function(Te,de){return pe(Te)<this.startOf(de)},Ie.isBefore=function(Te,de){return this.endOf(de)<pe(Te)},Ie.$g=function(Te,de,ue){return Re.u(Te)?this[de]:this.set(ue,Te)},Ie.unix=function(){return Math.floor(this.valueOf()/1e3)},Ie.valueOf=function(){return this.$d.getTime()},Ie.startOf=function(Te,de){var ue=this,be=!!Re.u(de)||de,xe=Re.p(Te),He=function(Gn,vn){var St=Re.w(ue.$u?Date.UTC(ue.$y,vn,Gn):new Date(ue.$y,vn,Gn),ue);return be?St:St.endOf(S)},rt=function(Gn,vn){return Re.w(ue.toDate()[Gn].apply(ue.toDate("s"),(be?[0,0,0,0]:[23,59,59,999]).slice(vn)),ue)},Ye=this.$W,Ge=this.$M,_t=this.$D,kt="set"+(this.$u?"UTC":"");switch(xe){case x:return be?He(1,0):He(31,11);case R:return be?He(1,Ge):He(0,Ge+1);case C:var sn=this.$locale().weekStart||0,cn=(Ye<sn?Ye+7:Ye)-sn;return He(be?_t-cn:_t+(6-cn),Ge);case S:case U:return rt(kt+"Hours",0);case y:return rt(kt+"Minutes",1);case v:return rt(kt+"Seconds",2);case m:return rt(kt+"Milliseconds",3);default:return this.clone()}},Ie.endOf=function(Te){return this.startOf(Te,!1)},Ie.$set=function(Te,de){var ue,be=Re.p(Te),xe="set"+(this.$u?"UTC":""),He=(ue={},ue[S]=xe+"Date",ue[U]=xe+"Date",ue[R]=xe+"Month",ue[x]=xe+"FullYear",ue[y]=xe+"Hours",ue[v]=xe+"Minutes",ue[m]=xe+"Seconds",ue[p]=xe+"Milliseconds",ue)[be],rt=be===S?this.$D+(de-this.$W):de;if(be===R||be===x){var Ye=this.clone().set(U,1);Ye.$d[He](rt),Ye.init(),this.$d=Ye.set(U,Math.min(this.$D,Ye.daysInMonth())).$d}else He&&this.$d[He](rt);return this.init(),this},Ie.set=function(Te,de){return this.clone().$set(Te,de)},Ie.get=function(Te){return this[Re.p(Te)]()},Ie.add=function(Te,de){var ue,be=this;Te=Number(Te);var xe=Re.p(de),He=function(Ge){var _t=pe(be);return Re.w(_t.date(_t.date()+Math.round(Ge*Te)),be)};if(xe===R)return this.set(R,this.$M+Te);if(xe===x)return this.set(x,this.$y+Te);if(xe===S)return He(1);if(xe===C)return He(7);var rt=(ue={},ue[v]=l,ue[y]=u,ue[m]=a,ue)[xe]||1,Ye=this.$d.getTime()+Te*rt;return Re.w(Ye,this)},Ie.subtract=function(Te,de){return this.add(-1*Te,de)},Ie.format=function(Te){var de=this,ue=this.$locale();if(!this.isValid())return ue.invalidDate||M;var be=Te||"YYYY-MM-DDTHH:mm:ssZ",xe=Re.z(this),He=this.$H,rt=this.$m,Ye=this.$M,Ge=ue.weekdays,_t=ue.months,kt=ue.meridiem,sn=function(vn,St,bt,Qn){return vn&&(vn[St]||vn(de,be))||bt[St].slice(0,Qn)},cn=function(vn){return Re.s(He%12||12,vn,"0")},Gn=kt||function(vn,St,bt){var Qn=vn<12?"AM":"PM";return bt?Qn.toLowerCase():Qn};return be.replace(V,function(vn,St){return St||function(bt){switch(bt){case"YY":return String(de.$y).slice(-2);case"YYYY":return Re.s(de.$y,4,"0");case"M":return Ye+1;case"MM":return Re.s(Ye+1,2,"0");case"MMM":return sn(ue.monthsShort,Ye,_t,3);case"MMMM":return sn(_t,Ye);case"D":return de.$D;case"DD":return Re.s(de.$D,2,"0");case"d":return String(de.$W);case"dd":return sn(ue.weekdaysMin,de.$W,Ge,2);case"ddd":return sn(ue.weekdaysShort,de.$W,Ge,3);case"dddd":return Ge[de.$W];case"H":return String(He);case"HH":return Re.s(He,2,"0");case"h":return cn(1);case"hh":return cn(2);case"a":return Gn(He,rt,!0);case"A":return Gn(He,rt,!1);case"m":return String(rt);case"mm":return Re.s(rt,2,"0");case"s":return String(de.$s);case"ss":return Re.s(de.$s,2,"0");case"SSS":return Re.s(de.$ms,3,"0");case"Z":return xe}return null}(vn)||xe.replace(":","")})},Ie.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Ie.diff=function(Te,de,ue){var be,xe=this,He=Re.p(de),rt=pe(Te),Ye=(rt.utcOffset()-this.utcOffset())*l,Ge=this-rt,_t=function(){return Re.m(xe,rt)};switch(He){case x:be=_t()/12;break;case R:be=_t();break;case N:be=_t()/3;break;case C:be=(Ge-Ye)/6048e5;break;case S:be=(Ge-Ye)/864e5;break;case y:be=Ge/u;break;case v:be=Ge/l;break;case m:be=Ge/a;break;default:be=Ge}return ue?be:Re.a(be)},Ie.daysInMonth=function(){return this.endOf(R).$D},Ie.$locale=function(){return oe[this.$L]},Ie.locale=function(Te,de){if(!Te)return this.$L;var ue=this.clone(),be=me(Te,de,!0);return be&&(ue.$L=be),ue},Ie.clone=function(){return Re.w(this.$d,this)},Ie.toDate=function(){return new Date(this.valueOf())},Ie.toJSON=function(){return this.isValid()?this.toISOString():null},Ie.toISOString=function(){return this.$d.toISOString()},Ie.toString=function(){return this.$d.toUTCString()},Oe}(),Qe=Ze.prototype;return pe.prototype=Qe,[["$ms",p],["$s",m],["$m",v],["$H",y],["$W",S],["$M",R],["$y",x],["$D",U]].forEach(function(Oe){Qe[Oe[1]]=function(Ie){return this.$g(Ie,Oe[0],Oe[1])}}),pe.extend=function(Oe,Ie){return Oe.$i||(Oe(Ie,Ze,pe),Oe.$i=!0),pe},pe.locale=me,pe.isDayjs=re,pe.unix=function(Oe){return pe(1e3*Oe)},pe.en=oe[ee],pe.Ls=oe,pe.p={},pe})})(iq);var Qxe=iq.exports;const Wn=Uh(Qxe);var oq={exports:{}};(function(e,i){(function(a,l){e.exports=l()})(rn,function(){var a="minute",l=/[+-]\d\d(?::?\d\d)?/g,u=/([+-]|\d\d)/g;return function(p,m,v){var y=m.prototype;v.utc=function(M){var z={date:M,utc:!0,args:arguments};return new m(z)},y.utc=function(M){var z=v(this.toDate(),{locale:this.$L,utc:!0});return M?z.add(this.utcOffset(),a):z},y.local=function(){return v(this.toDate(),{locale:this.$L,utc:!1})};var S=y.parse;y.parse=function(M){M.utc&&(this.$u=!0),this.$utils().u(M.$offset)||(this.$offset=M.$offset),S.call(this,M)};var C=y.init;y.init=function(){if(this.$u){var M=this.$d;this.$y=M.getUTCFullYear(),this.$M=M.getUTCMonth(),this.$D=M.getUTCDate(),this.$W=M.getUTCDay(),this.$H=M.getUTCHours(),this.$m=M.getUTCMinutes(),this.$s=M.getUTCSeconds(),this.$ms=M.getUTCMilliseconds()}else C.call(this)};var R=y.utcOffset;y.utcOffset=function(M,z){var V=this.$utils().u;if(V(M))return this.$u?0:V(this.$offset)?R.call(this):this.$offset;if(typeof M=="string"&&(M=function(ee){ee===void 0&&(ee="");var oe=ee.match(l);if(!oe)return null;var se=(""+oe[0]).match(u)||["-",0,0],re=se[0],me=60*+se[1]+ +se[2];return me===0?0:re==="+"?me:-me}(M),M===null))return this;var W=Math.abs(M)<=16?60*M:M,H=this;if(z)return H.$offset=W,H.$u=M===0,H;if(M!==0){var q=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(H=this.local().add(W+q,a)).$offset=W,H.$x.$localOffset=q}else H=this.utc();return H};var N=y.format;y.format=function(M){var z=M||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return N.call(this,z)},y.valueOf=function(){var M=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*M},y.isUTC=function(){return!!this.$u},y.toISOString=function(){return this.toDate().toISOString()},y.toString=function(){return this.toDate().toUTCString()};var x=y.toDate;y.toDate=function(M){return M==="s"&&this.$offset?v(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():x.call(this)};var U=y.diff;y.diff=function(M,z,V){if(M&&this.$u===M.$u)return U.call(this,M,z,V);var W=this.local(),H=v(M).local();return U.call(W,H,z,V)}}})})(oq);var Zxe=oq.exports;const sq=Uh(Zxe);var aq={exports:{}};(function(e,i){(function(a,l){e.exports=l()})(rn,function(){return function(a,l){l.prototype.isSameOrAfter=function(u,p){return this.isSame(u,p)||this.isAfter(u,p)}}})})(aq);var eLe=aq.exports;const tLe=Uh(eLe);Wn.extend(sq);Wn.extend(tLe);function nLe(){const e=ds(),[i,a]=F.useState();Ji();const[l,{isLoading:u,isSuccess:p,isRefreshing:m}]=jc({isImmediate:!1}),v=async x=>{const U=await Promise.all(x.data.sessions.map(async M=>{const z=await N(M.mentor_id);return{...M,mentorName:z[0],mentorDp:z[1],mentorType:z[2]}}));a(U.sort((M,z)=>new Date(z.date)-new Date(M.date)))};F.useEffect(()=>{(async()=>{await l(U=>Dt.get("http://127.0.0.1:5000/sessions/",{headers:{Authorization:"Bearer "+U}}),U=>v(U))})()},[]);const y={Pending:"",Completed:"green",Declined:"red",Approved:"purple"},S=(x,U)=>{const M=Wn().utcOffset(),z=Math.floor(M/60),V={hours:parseInt(U.split(":")[0])+z,minutes:parseInt(U.split(":")[1])},W=`${V.hours}:${V.minutes}`,H=Wn.utc(x+"Z"),q=Wn.utc(Wn().format("YYYY-MM-DD")+" "+W);return H.format("DD MMM")+" - "+q.format("hh:mm A")},C=(x,U,M,z)=>{if(M==="Approved"){const V=Wn(),W=Wn(Wn.utc(x+"Z").format("YYYY-MM-DD")+" "+U);if(V.isSame(W,"date"))return V.isSameOrAfter(W)?2:1}return 0},R=(x,U)=>{const M=Wn(),z=Wn(Wn.utc(x+"Z").format("YYYY-MM-DD")+" "+U),V=z.diff(M,"hour");return V===0?`${z.diff(M,"minute")} mins`:`${V} hrs`},N=x=>(async()=>{try{const U=await Dt.get(`http://127.0.0.1:5000/mentor/${x}`);return[`${U.data.first_name} ${U.data.last_name}`,U.data.profile_picture,U.data.type]}catch(U){console.log(`An error occured during retrival of ${x} info `,U)}})();return b.jsx(XNe,{bg:"white",rounded:"xl",boxShadow:"lg",maxH:"41vh",overflowY:"auto",children:b.jsxs(pY,{variant:"simple",children:[b.jsx(JNe,{children:b.jsxs(tN,{children:[b.jsx($S,{children:"Mentor"}),b.jsx($S,{children:"Date/Time"}),b.jsx($S,{children:"Duration"}),b.jsx($S,{children:"Status"})]})}),b.jsx(QNe,{textAlign:"center",children:i!=null&&i.length?b.jsx(b.Fragment,{children:i.map((x,U)=>b.jsxs(tN,{children:[b.jsx(gf,{children:b.jsxs(sr,{alignItems:"center",mr:4,children:[b.jsx(Dc,{size:"md",src:x.mentorDp}),b.jsxs(Pe,{ml:"15px",children:[b.jsx(yt,{fontSize:"md",children:x.mentorName}),b.jsxs(Pt,{fontSize:"xs",children:[x.mentorType," Mentor"]})]})]})}),b.jsx(gf,{children:S(x.date,x.time)}),b.jsxs(gf,{children:[x.duration.substring(3,5)," min"]}),C(x.date,x.time,x.status,x.id)?b.jsx(gf,{children:C(x.date,x.time,x.status,x.id)===2?b.jsx(pn,{size:"xs",colorScheme:"teal",onClick:()=>e(`/room/${x.id}`),children:"Session started!"}):b.jsxs(Tm,{textDecoration:"none",colorScheme:"teal",children:["Starts in ",R(x.date,x.time)]})}):b.jsx(gf,{children:b.jsx(Tm,{textDecoration:"none",colorScheme:y[x.status],children:x.status})})]},U))}):b.jsx(tN,{children:b.jsx(gf,{children:b.jsx(Pt,{m:"22px",children:" No Upcoming classes.."})})})})]})})}function rLe(){Lo({base:!1,xl:!0}),Ji();const[e,i]=F.useState(null),[a,{isLoading:l,isSuccess:u,isRefreshing:p}]=jc({isImmediate:!1}),m=async()=>{await a(y=>Dt.get("http://127.0.0.1:5000/student/mentors/favorites/",{headers:{Authorization:"Bearer "+y}}),y=>{i(y.data.mentors)})},v=async y=>{await a(S=>Dt.request({url:"http://127.0.0.1:5000/student/mentors/favorites/",headers:{Authorization:"Bearer "+S},method:"DELETE",data:{mentor:y}}),S=>{m()})};return F.useEffect(()=>{m()},[]),b.jsx(b.Fragment,{children:Array.isArray(e)&&e.length>0&&b.jsxs(Pe,{display:"block",children:[b.jsx(yt,{m:"10px",mt:0,fontSize:"xl",children:"Favorites"}),b.jsx(Pe,{display:{base:"block",sm:"flex",xl:"block"},gap:3,height:{xl:"43vh"},overflowY:"auto",children:e.map(y=>b.jsx(Pe,{display:"flex",bg:"brand.700",color:"white",rounded:"2xl",m:"10px",p:2,boxShadow:"lg",children:b.jsxs(sr,{alignItems:"center",justifyContent:"space-between",flex:"1",children:[b.jsxs(sr,{alignItems:"center",children:[b.jsx(Dc,{size:"sm",src:y.profile_picture}),b.jsxs(Pe,{ml:"15px",children:[b.jsxs(yt,{fontSize:"sm",children:[y.first_name," ",y.last_name]}),b.jsxs(Pt,{fontSize:"xs",children:[y.type," Mentor"]})]})]}),b.jsx(_C,{size:"sm",ml:"3",onClick:()=>v(y.username)})]})},y.id))})]})})}function iLe(){const[e,i]=F.useState({minutes:0,lessons:0}),a=Lo({base:!1,xl:!0}),{user:l,authToken:u,refresh:p}=Ji(),[m,{isLoading:v,isSuccess:y,isRefreshing:S}]=jc({isImmediate:!1}),C=ds();F.useEffect(()=>{u||C("/")},[]);const R=N=>{const x={minutes:0,lessons:0};N.data.sessions.forEach(U=>{U.status==="Completed"&&(x.minutes+=Number(U.duration.substring(3,5)),x.lessons++)}),i(x)};return F.useEffect(()=>{(async()=>{await m(x=>Dt.get("http://127.0.0.1:5000/sessions/",{headers:{Authorization:"Bearer "+x}}),x=>R(x))})()},[]),b.jsx(b.Fragment,{children:b.jsxs(Pe,{display:"flex",m:"10px",flexDirection:a?"row":"column",justifyContent:"center",children:[b.jsxs(sr,{direction:"column",maxW:a?"500px":void 0,children:[b.jsxs(sr,{m:"20px",bg:"white",boxShadow:"lg",direction:"column",textAlign:"center",p:"30px",rounded:"xl",children:[b.jsx(Rs,{children:b.jsx(Dc,{size:"xl",bg:"brand.700",src:l.profile_picture,mb:"0px"})}),b.jsx(Rs,{children:b.jsxs(yt,{mt:"10px",mb:"3px",size:"xl",children:["Hello, ",l.first_name]})}),b.jsx(Pt,{color:"grey",children:"Welcome to endless possibilities."}),b.jsx(Pe,{mt:"20px",children:b.jsxs(hY,{children:[" ",b.jsxs(cm,{rounded:"xl",bg:"teal.100",p:"10px",m:"10px",children:[b.jsx(lm,{fontSize:"md",children:"Minutes"}),b.jsx(Tb,{fontSize:"3xl",children:e.minutes})]}),b.jsxs(cm,{rounded:"xl",bg:"orange.100",p:"10px",m:"10px",children:[b.jsx(lm,{fontSize:"md",children:"Lessons"}),b.jsx(Tb,{fontSize:"3xl",children:e.lessons})]})]})})]}),b.jsxs(Pe,{display:"flex",alignItems:"center",bg:"brand.800",m:"20px",p:"20px",rounded:"xl",boxShadow:"xl",children:[b.jsx(Nn,{src:"/img/flower.png",maxW:"70px",mr:4}),b.jsx(bn,{to:"/browse",children:b.jsxs(Pe,{color:"white",children:[b.jsx(yt,{fontSize:"xl",children:"Explore Your Mentors"}),b.jsx(Pt,{fontSize:"sm",children:"Discover a Welcoming Tutor to Enhance Your English Journey"})]})})]})]}),b.jsxs(Pe,{children:[a&&b.jsxs(Pe,{m:"20px",position:"relative",children:[b.jsx(Nn,{h:"200px",filter:"brightness(60%)",boxShadow:"lg",rounded:"xl",w:"100%",objectFit:"cover",src:"/img/cover-3.gif"}),b.jsxs(Pe,{color:"white",position:"absolute",top:"10%",p:"50px",overflow:"hidden",children:[b.jsx(yt,{children:"Learn. Grow. Thrive."}),b.jsx(Pt,{fontSize:"lg",children:"Watch your progress and growth in knowledge"})]})]}),b.jsxs(Pe,{display:"flex",flexDirection:a?"row":"column",m:"20px",gap:"20px",children:[" ",b.jsxs(Pe,{children:[b.jsxs(sr,{alignItems:"center",mb:4,children:[b.jsx(yt,{fontSize:"xl",children:"Your Lessons"}),b.jsx(Mc,{})]}),b.jsx(nLe,{})]}),b.jsx(rLe,{})]})]})]})})}function oLe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11 4V2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1s-1-.45-1-1zm7.36 3.05 1.41-1.42a.996.996 0 1 0-1.41-1.41l-1.41 1.42a.996.996 0 1 0 1.41 1.41zM22 11h-2c-.55 0-1 .45-1 1s.45 1 1 1h2c.55 0 1-.45 1-1s-.45-1-1-1zm-10 8c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1zM5.64 7.05 4.22 5.64c-.39-.39-.39-1.03 0-1.41s1.03-.39 1.41 0l1.41 1.41c.39.39.39 1.03 0 1.41s-1.02.39-1.4 0zm11.31 9.9a.996.996 0 0 0 0 1.41l1.41 1.41c.39.39 1.03.39 1.41 0a.996.996 0 0 0 0-1.41l-1.41-1.41a.996.996 0 0 0-1.41 0zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm3.64 6.78 1.41-1.41c.39-.39.39-1.03 0-1.41s-1.03-.39-1.41 0l-1.41 1.41a.996.996 0 0 0 0 1.41c.38.39 1.02.39 1.41 0zM12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6z"},child:[]}]})(e)}function sLe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M19.43 12.98c.04-.32.07-.64.07-.98 0-.34-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46a.5.5 0 0 0-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65A.488.488 0 0 0 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1a.566.566 0 0 0-.18-.03c-.17 0-.34.09-.43.25l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98 0 .33.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46a.5.5 0 0 0 .61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.06.02.12.03.18.03.17 0 .34-.09.43-.25l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zm-1.98-1.71c.04.31.05.52.05.73 0 .21-.02.43-.05.73l-.14 1.13.89.7 1.08.84-.7 1.21-1.27-.51-1.04-.42-.9.68c-.43.32-.84.56-1.25.73l-1.06.43-.16 1.13-.2 1.35h-1.4l-.19-1.35-.16-1.13-1.06-.43c-.43-.18-.83-.41-1.23-.71l-.91-.7-1.06.43-1.27.51-.7-1.21 1.08-.84.89-.7-.14-1.13c-.03-.31-.05-.54-.05-.74s.02-.43.05-.73l.14-1.13-.89-.7-1.08-.84.7-1.21 1.27.51 1.04.42.9-.68c.43-.32.84-.56 1.25-.73l1.06-.43.16-1.13.2-1.35h1.39l.19 1.35.16 1.13 1.06.43c.43.18.83.41 1.23.71l.91.7 1.06-.43 1.27-.51.7 1.21-1.07.85-.89.7.14 1.13zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"},child:[]}]})(e)}function aLe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6zm-2 0-8 4.99L4 6h16zm0 12H4V8l8 5 8-5v10z"},child:[]}]})(e)}function cLe(){const{authToken:e,refresh:i,setUser:a}=Ji();F.useRef(null);const[l,{isLoading:u,isSuccess:p,isRefreshing:m}]=jc({isImmediate:!1}),[v,y]=F.useState({}),[S,C]=F.useState([]),R=vC(),N=W=>{y({...v,proficiency:W})},x=W=>{y(W.data),a(W.data)},U=async()=>{await l(W=>Dt.get("http://127.0.0.1:5000/student/profile",{headers:{Authorization:"Bearer "+W}}),W=>x(W)),i()};F.useEffect(()=>{(async()=>{try{const H=await Dt.get("https://restcountries.com/v3.1/all?fields=name,demonyms");H.data.sort((q,ee)=>q.name.common.localeCompare(ee.name.common)),C(H.data)}catch(H){console.error("Error fetching data:",H)}})(),U()},[]);const M=async()=>{await R({title:"Your profile has been updated successfully!",status:"success",duration:3e3,isClosable:!0})()},z=()=>{for(let W in v)v[W]||delete v[W];(async()=>await l(W=>Dt.put("http://127.0.0.1:5000/student/profile",v,{headers:{Authorization:"Bearer "+W}}),W=>{U(),M()}))()},V=W=>{const{name:H,value:q}=W.currentTarget;y({...v,[H]:q})};return b.jsxs(Pe,{m:"30px",mt:"0px",children:[b.jsx(yt,{fontSize:"xl",mb:4,children:"Personal Information"}),b.jsx(mo,{orientation:"horizontal",mb:4}),b.jsxs(Pe,{children:[b.jsxs(Pe,{display:"flex",gap:10,children:[b.jsxs(Pe,{w:"70%",children:[b.jsx(On,{children:"Profile picture"}),b.jsx(Ur,{type:"file",variant:"filled",name:"profile_picture",accept:"image/png, image/jpeg"}),b.jsx(On,{mt:3,children:"First name"}),b.jsx(Ur,{variant:"filled",name:"first_name",value:v.first_name,onChange:V}),b.jsx(On,{mt:3,children:"Last name"}),b.jsx(Ur,{variant:"filled",name:"last_name",value:v.last_name,onChange:V})]}),b.jsx(Mc,{}),b.jsx(Dc,{size:"2xl",bg:"brand.700",src:v.profile_picture})]}),b.jsx(mo,{orientation:"horizontal",mt:7,mb:5}),b.jsxs(Pe,{w:"70%",children:[b.jsx(On,{mt:3,children:"Country"}),b.jsx(ru,{variant:"filled",name:"country",value:v.country,onChange:V,children:S==null?void 0:S.map((W,H)=>b.jsx("option",{value:W.name.common,children:W.name.common},H))}),b.jsx(On,{mt:3,children:"Nationality"}),b.jsx(ru,{variant:"filled",name:"nationality",value:v.nationality,onChange:V,children:S==null?void 0:S.map((W,H)=>b.jsx("option",{value:W.name.common,children:W.name.common},H))}),b.jsx(On,{mt:3,children:"First language"}),b.jsx(Ur,{variant:"filled",name:"first_language",value:v.first_language,onChange:V}),b.jsx(On,{mt:3,children:"Other languages"}),b.jsx(Ur,{variant:"filled",name:"other_languages",value:v.other_languages,onChange:V})]}),b.jsx(mo,{orientation:"horizontal",mt:7,mb:5}),b.jsxs(IC,{variant:"filled",mb:"30px",name:"proficiency",value:v.proficiency,onChange:N,children:[b.jsx(On,{mt:3,children:"Proficiency"}),b.jsxs(CC,{children:[b.jsx(As,{mr:1,value:"0",children:"0 - No proficiency"}),b.jsx(As,{mr:1,value:"1",children:"1 - Low proficiency"}),b.jsx(As,{mr:1,value:"2",children:"2 - Intermediate proficiency"}),b.jsx(As,{mr:1,value:"3",children:"3 - Upper Intermediate proficiency"}),b.jsx(As,{mr:1,value:"4",children:"4 - High proficiency"})]})]}),b.jsx(sr,{justify:"flex-end",children:b.jsx(pn,{className:"right-aligned",colorScheme:"teal",onClick:z,children:"Save"})})]})]})}function lLe(){const{isOpen:e,onOpen:i,onClose:a}=yC(),l=F.useRef(),{authToken:u,logout:p}=Ji(),m=ds(),[v,{isLoading:y,isSuccess:S,isRefreshing:C}]=jc({isImmediate:!1}),R=async()=>{await v(N=>Dt.request({url:"http://127.0.0.1:5000/student/profile",headers:{Authorization:"Bearer "+N},method:"DELETE"}),N=>{console.log(N),console.log("I deleted the user"),a(),p(),m("/")})};return b.jsxs(Pe,{m:"30px",mt:"0px",children:[b.jsx(yt,{fontSize:"xl",mb:4,children:"Delete account"}),b.jsx(mo,{orientation:"horizontal",mb:4}),b.jsx(Pt,{children:"Account deletion is permanent. Please confirm your decision."}),b.jsx(pn,{mt:2,colorScheme:"red",variant:"outline",onClick:i,children:"Delete your account"}),b.jsx(qOe,{isOpen:e,leastDestructiveRef:l,onClose:a,children:b.jsx(vE,{children:b.jsxs(JOe,{children:[b.jsx(Fx,{fontSize:"lg",fontWeight:"bold",children:"Delete your account"}),b.jsx(EE,{children:"Are you sure? You can't undo this action afterwards."}),b.jsxs(_E,{children:[b.jsx(pn,{ref:l,onClick:a,children:"Cancel"}),b.jsx(pn,{colorScheme:"red",onClick:R,ml:3,children:"Delete"})]})]})})})]})}function dLe(){const{user:e}=Ji();return b.jsxs(Pe,{m:"30px",mt:"0px",children:[b.jsx(yt,{fontSize:"xl",mb:4,children:"Email preferences"}),b.jsx(mo,{orientation:"horizontal",mb:4}),b.jsx(Pt,{mb:3,children:"Subscribe across the different marketing platforms we offer."}),b.jsxs(Nx,{size:"md",w:"80%",children:[b.jsx(Ur,{pr:"4.5rem",type:"text",value:e.email,isDisabled:!0,variant:"filled"}),b.jsx(TC,{width:"4.5rem",children:b.jsx(pn,{h:"1.75rem",size:"sm",children:"manage"})})]})]})}function uLe(){const{user:e}=Ji();return b.jsx(Pe,{display:"flex",justifyContent:"center",m:"30px",children:b.jsxs(Pe,{bg:"white",rounded:"xl",maxW:"1000",width:"100%",children:[b.jsxs(sr,{alignItems:"center",m:"35px",children:[b.jsx(Dc,{size:"md",src:e.profile_picture}),b.jsxs(Pe,{ml:"15px",children:[b.jsxs(yt,{fontSize:"xl",children:[e.first_name," ",e.last_name]}),b.jsx(Pt,{fontSize:"sm",children:"Your Profile"})]})]}),b.jsxs(gY,{orientation:"vertical",colorScheme:"teal",children:[b.jsxs(_Y,{alignItems:"start",minW:"200px",children:[b.jsxs(NT,{children:["    ",b.jsx(jr,{as:Axe}),"  Profile"]}),b.jsxs(NT,{children:["    ",b.jsx(jr,{as:sLe}),"  Account"]}),b.jsxs(NT,{children:["    ",b.jsx(jr,{as:aLe}),"  Email"]})]}),b.jsxs(vY,{children:[b.jsx(OT,{children:b.jsx(cLe,{})}),b.jsx(OT,{children:b.jsx(lLe,{})}),b.jsx(OT,{children:b.jsx(dLe,{})})]})]})]})})}var cq={exports:{}};(function(e,i){(function(a,l){e.exports=l()})(rn,function(){function a(o,n){return n.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(s){if(s!=="default"&&!(s in o)){var c=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(o,s,c.get?c:{enumerable:!0,get:function(){return r[s]}})}})}),Object.freeze(o)}var l=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof rn<"u"?rn:typeof self<"u"?self:{};function u(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var p=function(o){try{return!!o()}catch{return!0}},m=!p(function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")}),v=m,y=Function.prototype,S=y.call,C=v&&y.bind.bind(S,S),R=v?C:function(o){return function(){return S.apply(o,arguments)}},N=R({}.isPrototypeOf),x=function(o){return o&&o.Math==Math&&o},U=x(typeof globalThis=="object"&&globalThis)||x(typeof window=="object"&&window)||x(typeof self=="object"&&self)||x(typeof l=="object"&&l)||function(){return this}()||l||Function("return this")(),M=m,z=Function.prototype,V=z.apply,W=z.call,H=typeof Reflect=="object"&&Reflect.apply||(M?W.bind(V):function(){return W.apply(V,arguments)}),q=R,ee=q({}.toString),oe=q("".slice),se=function(o){return oe(ee(o),8,-1)},re=se,me=R,pe=function(o){if(re(o)==="Function")return me(o)},Re=typeof document=="object"&&document.all,Ze={all:Re,IS_HTMLDDA:Re===void 0&&Re!==void 0},Qe=Ze.all,Oe=Ze.IS_HTMLDDA?function(o){return typeof o=="function"||o===Qe}:function(o){return typeof o=="function"},Ie={},Te=!p(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),de=m,ue=Function.prototype.call,be=de?ue.bind(ue):function(){return ue.apply(ue,arguments)},xe={},He={}.propertyIsEnumerable,rt=Object.getOwnPropertyDescriptor,Ye=rt&&!He.call({1:2},1);xe.f=Ye?function(o){var n=rt(this,o);return!!n&&n.enumerable}:He;var Ge,_t,kt=function(o,n){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:n}},sn=p,cn=se,Gn=Object,vn=R("".split),St=sn(function(){return!Gn("z").propertyIsEnumerable(0)})?function(o){return cn(o)=="String"?vn(o,""):Gn(o)}:Gn,bt=function(o){return o==null},Qn=bt,Hn=TypeError,Ct=function(o){if(Qn(o))throw Hn("Can't call method on "+o);return o},Cn=St,$n=Ct,on=function(o){return Cn($n(o))},ji=Oe,ai=Ze.all,br=Ze.IS_HTMLDDA?function(o){return typeof o=="object"?o!==null:ji(o)||o===ai}:function(o){return typeof o=="object"?o!==null:ji(o)},Jr={},Oi=Jr,us=U,Fc=Oe,Vc=function(o){return Fc(o)?o:void 0},$r=function(o,n){return arguments.length<2?Vc(Oi[o])||Vc(us[o]):Oi[o]&&Oi[o][n]||us[o]&&us[o][n]},Fi=typeof navigator<"u"&&String(navigator.userAgent)||"",_u=U,jl=Fi,vu=_u.process,Eu=_u.Deno,qh=vu&&vu.versions||Eu&&Eu.version,Um=qh&&qh.v8;Um&&(_t=(Ge=Um.split("."))[0]>0&&Ge[0]<4?1:+(Ge[0]+Ge[1])),!_t&&jl&&(!(Ge=jl.match(/Edge\/(\d+)/))||Ge[1]>=74)&&(Ge=jl.match(/Chrome\/(\d+)/))&&(_t=+Ge[1]);var et=_t,At=et,Zt=p,Kt=U.String,Zn=!!Object.getOwnPropertySymbols&&!Zt(function(){var o=Symbol();return!Kt(o)||!(Object(o)instanceof Symbol)||!Symbol.sham&&At&&At<41}),Xi=Zn&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Si=$r,ba=Oe,hs=N,BC=Object,yu=Xi?function(o){return typeof o=="symbol"}:function(o){var n=Si("Symbol");return ba(n)&&hs(n.prototype,BC(o))},WC=String,Fl=function(o){try{return WC(o)}catch{return"Object"}},zC=Oe,Ca=Fl,GC=TypeError,Mo=function(o){if(zC(o))return o;throw GC(Ca(o)+" is not a function")},HC=Mo,$C=bt,jm=function(o,n){var r=o[n];return $C(r)?void 0:HC(r)},Bc=be,PE=Oe,kE=br,KC=TypeError,DE={exports:{}},xE=U,Vl=Object.defineProperty,YC=function(o,n){try{Vl(xE,o,{value:n,configurable:!0,writable:!0})}catch{xE[o]=n}return n},LE="__core-js_shared__",Fm=U[LE]||YC(LE,{}),ME=Fm;(DE.exports=function(o,n){return ME[o]||(ME[o]=n!==void 0?n:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Bl=DE.exports,qC=Ct,Vm=Object,Vs=function(o){return Vm(qC(o))},Jh=Vs,Bm=R({}.hasOwnProperty),ci=Object.hasOwn||function(o,n){return Bm(Jh(o),n)},Xh=R,UE=0,JC=Math.random(),XC=Xh(1 .toString),Wm=function(o){return"Symbol("+(o===void 0?"":o)+")_"+XC(++UE+JC,36)},jE=Bl,FE=ci,QC=Wm,ZC=Zn,ew=Xi,Wl=U.Symbol,zm=jE("wks"),tw=ew?Wl.for||Wl:Wl&&Wl.withoutSetter||QC,er=function(o){return FE(zm,o)||(zm[o]=ZC&&FE(Wl,o)?Wl[o]:tw("Symbol."+o)),zm[o]},nw=be,VE=br,Su=yu,Gm=jm,rw=function(o,n){var r,s;if(PE(r=o.toString)&&!kE(s=Bc(r,o))||PE(r=o.valueOf)&&!kE(s=Bc(r,o)))return s;throw KC("Can't convert object to primitive value")},iw=TypeError,BE=er("toPrimitive"),ow=function(o,n){if(!VE(o)||Su(o))return o;var r,s=Gm(o,BE);if(s){if(r=nw(s,o,n),!VE(r)||Su(r))return r;throw iw("Can't convert object to primitive value")}return rw(o)},sw=yu,Qh=function(o){var n=ow(o,"string");return sw(n)?n:n+""},Hm=br,$m=U.document,aw=Hm($m)&&Hm($m.createElement),Km=function(o){return aw?$m.createElement(o):{}},Ym=Km,WE=!Te&&!p(function(){return Object.defineProperty(Ym("div"),"a",{get:function(){return 7}}).a!=7}),cw=Te,lw=be,Zh=xe,qm=kt,Jm=on,Xm=Qh,dw=ci,zE=WE,ep=Object.getOwnPropertyDescriptor;Ie.f=cw?ep:function(o,n){if(o=Jm(o),n=Xm(n),zE)try{return ep(o,n)}catch{}if(dw(o,n))return qm(!lw(Zh.f,o,n),o[n])};var GE=p,Wc=Oe,Tu=/#|\.prototype\./,bu=function(o,n){var r=uw[HE(o)];return r==hw||r!=$E&&(Wc(n)?GE(n):!!n)},HE=bu.normalize=function(o){return String(o).replace(Tu,".").toLowerCase()},uw=bu.data={},$E=bu.NATIVE="N",hw=bu.POLYFILL="P",KE=bu,YE=Mo,pw=m,ne=pe(pe.bind),ge=function(o,n){return YE(o),n===void 0?o:pw?ne(o,n):function(){return o.apply(n,arguments)}},Ce={},lt=Te&&p(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),ln=br,Kn=String,hr=TypeError,Bt=function(o){if(ln(o))return o;throw hr(Kn(o)+" is not an object")},pr=Te,ps=WE,Eo=lt,Ya=Bt,tp=Qh,Qm=TypeError,np=Object.defineProperty,lq=Object.getOwnPropertyDescriptor,fw="enumerable",mw="configurable",gw="writable";Ce.f=pr?Eo?function(o,n,r){if(Ya(o),n=tp(n),Ya(r),typeof o=="function"&&n==="prototype"&&"value"in r&&gw in r&&!r[gw]){var s=lq(o,n);s&&s[gw]&&(o[n]=r.value,r={configurable:mw in r?r[mw]:s[mw],enumerable:fw in r?r[fw]:s[fw],writable:!1})}return np(o,n,r)}:np:function(o,n,r){if(Ya(o),n=tp(n),Ya(r),ps)try{return np(o,n,r)}catch{}if("get"in r||"set"in r)throw Qm("Accessors not supported");return"value"in r&&(o[n]=r.value),o};var dq=Ce,uq=kt,zl=Te?function(o,n,r){return dq.f(o,n,uq(1,r))}:function(o,n,r){return o[n]=r,o},qE=U,hq=H,pq=pe,fq=Oe,mq=Ie.f,gq=KE,rp=Jr,_q=ge,ip=zl,Kx=ci,vq=function(o){var n=function(r,s,c){if(this instanceof n){switch(arguments.length){case 0:return new o;case 1:return new o(r);case 2:return new o(r,s)}return new o(r,s,c)}return hq(o,this,arguments)};return n.prototype=o.prototype,n},En=function(o,n){var r,s,c,d,h,f,g,_,E,T=o.target,w=o.global,A=o.stat,L=o.proto,P=w?qE:A?qE[T]:(qE[T]||{}).prototype,D=w?rp:rp[T]||ip(rp,T,{})[T],G=D.prototype;for(d in n)s=!(r=gq(w?d:T+(A?".":"#")+d,o.forced))&&P&&Kx(P,d),f=D[d],s&&(g=o.dontCallGetSet?(E=mq(P,d))&&E.value:P[d]),h=s&&g?g:n[d],s&&typeof f==typeof h||(_=o.bind&&s?_q(h,qE):o.wrap&&s?vq(h):L&&fq(h)?pq(h):h,(o.sham||h&&h.sham||f&&f.sham)&&ip(_,"sham",!0),ip(D,d,_),L&&(Kx(rp,c=T+"Prototype")||ip(rp,c,{}),ip(rp[c],d,h),o.real&&G&&(r||!G[d])&&ip(G,d,h)))},Eq=Math.ceil,yq=Math.floor,Sq=Math.trunc||function(o){var n=+o;return(n>0?yq:Eq)(n)},_w=function(o){var n=+o;return n!=n||n===0?0:Sq(n)},Tq=_w,bq=Math.max,Cq=Math.min,Yx=function(o,n){var r=Tq(o);return r<0?bq(r+n,0):Cq(r,n)},wq=_w,Rq=Math.min,Iq=function(o){return o>0?Rq(wq(o),9007199254740991):0},Gl=function(o){return Iq(o.length)},Aq=on,Oq=Yx,Nq=Gl,qx=function(o){return function(n,r,s){var c,d=Aq(n),h=Nq(d),f=Oq(s,h);if(o&&r!=r){for(;h>f;)if((c=d[f++])!=c)return!0}else for(;h>f;f++)if((o||f in d)&&d[f]===r)return o||f||0;return!o&&-1}},vw={includes:qx(!0),indexOf:qx(!1)},Pq=vw.includes;En({target:"Array",proto:!0,forced:p(function(){return!Array(1).includes()})},{includes:function(o){return Pq(this,o,arguments.length>1?arguments[1]:void 0)}});var kq=Jr,Hl=function(o){return kq[o+"Prototype"]},Dq=Hl("Array").includes,xq=br,Lq=se,Mq=er("match"),Uq=function(o){var n;return xq(o)&&((n=o[Mq])!==void 0?!!n:Lq(o)=="RegExp")},jq=TypeError,Jx={};Jx[er("toStringTag")]="z";var Ew=String(Jx)==="[object z]",Fq=Ew,Vq=Oe,JE=se,Bq=er("toStringTag"),Wq=Object,zq=JE(function(){return arguments}())=="Arguments",$l=Fq?JE:function(o){var n,r,s;return o===void 0?"Undefined":o===null?"Null":typeof(r=function(c,d){try{return c[d]}catch{}}(n=Wq(o),Bq))=="string"?r:zq?JE(n):(s=JE(n))=="Object"&&Vq(n.callee)?"Arguments":s},Gq=$l,Hq=String,Bs=function(o){if(Gq(o)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Hq(o)},$q=er("match"),Kq=En,Yq=function(o){if(Uq(o))throw jq("The method doesn't accept regular expressions");return o},qq=Ct,Xx=Bs,Jq=function(o){var n=/./;try{"/./"[o](n)}catch{try{return n[$q]=!1,"/./"[o](n)}catch{}}return!1},Xq=R("".indexOf);Kq({target:"String",proto:!0,forced:!Jq("includes")},{includes:function(o){return!!~Xq(Xx(qq(this)),Xx(Yq(o)),arguments.length>1?arguments[1]:void 0)}});var Qq=Hl("String").includes,Qx=N,Zq=Dq,eJ=Qq,yw=Array.prototype,Sw=String.prototype,Le=u(function(o){var n=o.includes;return o===yw||Qx(yw,o)&&n===yw.includes?Zq:typeof o=="string"||o===Sw||Qx(Sw,o)&&n===Sw.includes?eJ:n});let Zx=!0,eL=!0;function XE(o,n,r){const s=o.match(n);return s&&s.length>=r&&parseInt(s[r],10)}function Cu(o,n,r){if(!o.RTCPeerConnection)return;const s=o.RTCPeerConnection.prototype,c=s.addEventListener;s.addEventListener=function(h,f){if(h!==n)return c.apply(this,arguments);const g=_=>{const E=r(_);E&&(f.handleEvent?f.handleEvent(E):f(E))};return this._eventMap=this._eventMap||{},this._eventMap[n]||(this._eventMap[n]=new Map),this._eventMap[n].set(f,g),c.apply(this,[h,g])};const d=s.removeEventListener;s.removeEventListener=function(h,f){if(h!==n||!this._eventMap||!this._eventMap[n])return d.apply(this,arguments);if(!this._eventMap[n].has(f))return d.apply(this,arguments);const g=this._eventMap[n].get(f);return this._eventMap[n].delete(f),this._eventMap[n].size===0&&delete this._eventMap[n],Object.keys(this._eventMap).length===0&&delete this._eventMap,d.apply(this,[h,g])},Object.defineProperty(s,"on"+n,{get(){return this["_on"+n]},set(h){this["_on"+n]&&(this.removeEventListener(n,this["_on"+n]),delete this["_on"+n]),h&&this.addEventListener(n,this["_on"+n]=h)},enumerable:!0,configurable:!0})}function tJ(o){return typeof o!="boolean"?new Error("Argument type: "+typeof o+". Please use a boolean."):(Zx=o,o?"adapter.js logging disabled":"adapter.js logging enabled")}function nJ(o){return typeof o!="boolean"?new Error("Argument type: "+typeof o+". Please use a boolean."):(eL=!o,"adapter.js deprecation warnings "+(o?"disabled":"enabled"))}function tL(){if(typeof window=="object"){if(Zx)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Tw(o,n){eL&&console.warn(o+" is deprecated, please use "+n+" instead.")}function nL(o){return Object.prototype.toString.call(o)==="[object Object]"}function rL(o){return nL(o)?Object.keys(o).reduce(function(n,r){const s=nL(o[r]),c=s?rL(o[r]):o[r],d=s&&!Object.keys(c).length;return c===void 0||d?n:Object.assign(n,{[r]:c})},{}):o}function bw(o,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach(s=>{s.endsWith("Id")?bw(o,o.get(n[s]),r):s.endsWith("Ids")&&n[s].forEach(c=>{bw(o,o.get(c),r)})}))}function iL(o,n,r){const s=r?"outbound-rtp":"inbound-rtp",c=new Map;if(n===null)return c;const d=[];return o.forEach(h=>{h.type==="track"&&h.trackIdentifier===n.id&&d.push(h)}),d.forEach(h=>{o.forEach(f=>{f.type===s&&f.trackId===h.id&&bw(o,f,c)})}),c}const oL=tL;function sL(o,n){const r=o&&o.navigator;if(!r.mediaDevices)return;const s=function(h){if(typeof h!="object"||h.mandatory||h.optional)return h;const f={};return Object.keys(h).forEach(g=>{if(g==="require"||g==="advanced"||g==="mediaSource")return;const _=typeof h[g]=="object"?h[g]:{ideal:h[g]};_.exact!==void 0&&typeof _.exact=="number"&&(_.min=_.max=_.exact);const E=function(T,w){return T?T+w.charAt(0).toUpperCase()+w.slice(1):w==="deviceId"?"sourceId":w};if(_.ideal!==void 0){f.optional=f.optional||[];let T={};typeof _.ideal=="number"?(T[E("min",g)]=_.ideal,f.optional.push(T),T={},T[E("max",g)]=_.ideal,f.optional.push(T)):(T[E("",g)]=_.ideal,f.optional.push(T))}_.exact!==void 0&&typeof _.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[E("",g)]=_.exact):["min","max"].forEach(T=>{_[T]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[E(T,g)]=_[T])})}),h.advanced&&(f.optional=(f.optional||[]).concat(h.advanced)),f},c=function(h,f){if(n.version>=61)return f(h);if((h=JSON.parse(JSON.stringify(h)))&&typeof h.audio=="object"){const g=function(_,E,T){E in _&&!(T in _)&&(_[T]=_[E],delete _[E])};g((h=JSON.parse(JSON.stringify(h))).audio,"autoGainControl","googAutoGainControl"),g(h.audio,"noiseSuppression","googNoiseSuppression"),h.audio=s(h.audio)}if(h&&typeof h.video=="object"){let g=h.video.facingMode;g=g&&(typeof g=="object"?g:{ideal:g});const _=n.version<66;if(g&&(g.exact==="user"||g.exact==="environment"||g.ideal==="user"||g.ideal==="environment")&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||_)){let E;if(delete h.video.facingMode,g.exact==="environment"||g.ideal==="environment"?E=["back","rear"]:g.exact!=="user"&&g.ideal!=="user"||(E=["front"]),E)return r.mediaDevices.enumerateDevices().then(T=>{let w=(T=T.filter(A=>A.kind==="videoinput")).find(A=>E.some(L=>A.label.toLowerCase().includes(L)));return!w&&T.length&&E.includes("back")&&(w=T[T.length-1]),w&&(h.video.deviceId=g.exact?{exact:w.deviceId}:{ideal:w.deviceId}),h.video=s(h.video),oL("chrome: "+JSON.stringify(h)),f(h)})}h.video=s(h.video)}return oL("chrome: "+JSON.stringify(h)),f(h)},d=function(h){return n.version>=64?h:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[h.name]||h.name,message:h.message,constraint:h.constraint||h.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=(function(h,f,g){c(h,_=>{r.webkitGetUserMedia(_,f,E=>{g&&g(d(E))})})}).bind(r),r.mediaDevices.getUserMedia){const h=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(f){return c(f,g=>h(g).then(_=>{if(g.audio&&!_.getAudioTracks().length||g.video&&!_.getVideoTracks().length)throw _.getTracks().forEach(E=>{E.stop()}),new DOMException("","NotFoundError");return _},_=>Promise.reject(d(_))))}}}function aL(o){o.MediaStream=o.MediaStream||o.webkitMediaStream}function cL(o){if(typeof o=="object"&&o.RTCPeerConnection&&!("ontrack"in o.RTCPeerConnection.prototype)){Object.defineProperty(o.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const n=o.RTCPeerConnection.prototype.setRemoteDescription;o.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",s=>{let c;c=o.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(h=>h.track&&h.track.id===s.track.id):{track:s.track};const d=new Event("track");d.track=s.track,d.receiver=c,d.transceiver={receiver:c},d.streams=[r.stream],this.dispatchEvent(d)}),r.stream.getTracks().forEach(s=>{let c;c=o.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(h=>h.track&&h.track.id===s.id):{track:s};const d=new Event("track");d.track=s,d.receiver=c,d.transceiver={receiver:c},d.streams=[r.stream],this.dispatchEvent(d)})},this.addEventListener("addstream",this._ontrackpoly)),n.apply(this,arguments)}}else Cu(o,"track",n=>(n.transceiver||Object.defineProperty(n,"transceiver",{value:{receiver:n.receiver}}),n))}function lL(o){if(typeof o=="object"&&o.RTCPeerConnection&&!("getSenders"in o.RTCPeerConnection.prototype)&&"createDTMFSender"in o.RTCPeerConnection.prototype){const n=function(c,d){return{track:d,get dtmf(){return this._dtmf===void 0&&(d.kind==="audio"?this._dtmf=c.createDTMFSender(d):this._dtmf=null),this._dtmf},_pc:c}};if(!o.RTCPeerConnection.prototype.getSenders){o.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const c=o.RTCPeerConnection.prototype.addTrack;o.RTCPeerConnection.prototype.addTrack=function(h,f){let g=c.apply(this,arguments);return g||(g=n(this,h),this._senders.push(g)),g};const d=o.RTCPeerConnection.prototype.removeTrack;o.RTCPeerConnection.prototype.removeTrack=function(h){d.apply(this,arguments);const f=this._senders.indexOf(h);f!==-1&&this._senders.splice(f,1)}}const r=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(c){this._senders=this._senders||[],r.apply(this,[c]),c.getTracks().forEach(d=>{this._senders.push(n(this,d))})};const s=o.RTCPeerConnection.prototype.removeStream;o.RTCPeerConnection.prototype.removeStream=function(c){this._senders=this._senders||[],s.apply(this,[c]),c.getTracks().forEach(d=>{const h=this._senders.find(f=>f.track===d);h&&this._senders.splice(this._senders.indexOf(h),1)})}}else if(typeof o=="object"&&o.RTCPeerConnection&&"getSenders"in o.RTCPeerConnection.prototype&&"createDTMFSender"in o.RTCPeerConnection.prototype&&o.RTCRtpSender&&!("dtmf"in o.RTCRtpSender.prototype)){const n=o.RTCPeerConnection.prototype.getSenders;o.RTCPeerConnection.prototype.getSenders=function(){const r=n.apply(this,[]);return r.forEach(s=>s._pc=this),r},Object.defineProperty(o.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function dL(o){if(!o.RTCPeerConnection)return;const n=o.RTCPeerConnection.prototype.getStats;o.RTCPeerConnection.prototype.getStats=function(){const[r,s,c]=arguments;if(arguments.length>0&&typeof r=="function")return n.apply(this,arguments);if(n.length===0&&(arguments.length===0||typeof r!="function"))return n.apply(this,[]);const d=function(f){const g={};return f.result().forEach(_=>{const E={id:_.id,timestamp:_.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[_.type]||_.type};_.names().forEach(T=>{E[T]=_.stat(T)}),g[E.id]=E}),g},h=function(f){return new Map(Object.keys(f).map(g=>[g,f[g]]))};if(arguments.length>=2){const f=function(g){s(h(d(g)))};return n.apply(this,[f,r])}return new Promise((f,g)=>{n.apply(this,[function(_){f(h(d(_)))},g])}).then(s,c)}}function uL(o){if(!(typeof o=="object"&&o.RTCPeerConnection&&o.RTCRtpSender&&o.RTCRtpReceiver))return;if(!("getStats"in o.RTCRtpSender.prototype)){const r=o.RTCPeerConnection.prototype.getSenders;r&&(o.RTCPeerConnection.prototype.getSenders=function(){const c=r.apply(this,[]);return c.forEach(d=>d._pc=this),c});const s=o.RTCPeerConnection.prototype.addTrack;s&&(o.RTCPeerConnection.prototype.addTrack=function(){const c=s.apply(this,arguments);return c._pc=this,c}),o.RTCRtpSender.prototype.getStats=function(){const c=this;return this._pc.getStats().then(d=>iL(d,c.track,!0))}}if(!("getStats"in o.RTCRtpReceiver.prototype)){const r=o.RTCPeerConnection.prototype.getReceivers;r&&(o.RTCPeerConnection.prototype.getReceivers=function(){const s=r.apply(this,[]);return s.forEach(c=>c._pc=this),s}),Cu(o,"track",s=>(s.receiver._pc=s.srcElement,s)),o.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(c=>iL(c,s.track,!1))}}if(!("getStats"in o.RTCRtpSender.prototype)||!("getStats"in o.RTCRtpReceiver.prototype))return;const n=o.RTCPeerConnection.prototype.getStats;o.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof o.MediaStreamTrack){const r=arguments[0];let s,c,d;return this.getSenders().forEach(h=>{h.track===r&&(s?d=!0:s=h)}),this.getReceivers().forEach(h=>(h.track===r&&(c?d=!0:c=h),h.track===r)),d||s&&c?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():c?c.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return n.apply(this,arguments)}}function hL(o){o.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(d=>this._shimmedLocalStreams[d][0])};const n=o.RTCPeerConnection.prototype.addTrack;o.RTCPeerConnection.prototype.addTrack=function(d,h){if(!h)return n.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=n.apply(this,arguments);return this._shimmedLocalStreams[h.id]?this._shimmedLocalStreams[h.id].indexOf(f)===-1&&this._shimmedLocalStreams[h.id].push(f):this._shimmedLocalStreams[h.id]=[h,f],f};const r=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(d){this._shimmedLocalStreams=this._shimmedLocalStreams||{},d.getTracks().forEach(g=>{if(this.getSenders().find(_=>_.track===g))throw new DOMException("Track already exists.","InvalidAccessError")});const h=this.getSenders();r.apply(this,arguments);const f=this.getSenders().filter(g=>h.indexOf(g)===-1);this._shimmedLocalStreams[d.id]=[d].concat(f)};const s=o.RTCPeerConnection.prototype.removeStream;o.RTCPeerConnection.prototype.removeStream=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[d.id],s.apply(this,arguments)};const c=o.RTCPeerConnection.prototype.removeTrack;o.RTCPeerConnection.prototype.removeTrack=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},d&&Object.keys(this._shimmedLocalStreams).forEach(h=>{const f=this._shimmedLocalStreams[h].indexOf(d);f!==-1&&this._shimmedLocalStreams[h].splice(f,1),this._shimmedLocalStreams[h].length===1&&delete this._shimmedLocalStreams[h]}),c.apply(this,arguments)}}function pL(o,n){if(!o.RTCPeerConnection)return;if(o.RTCPeerConnection.prototype.addTrack&&n.version>=65)return hL(o);const r=o.RTCPeerConnection.prototype.getLocalStreams;o.RTCPeerConnection.prototype.getLocalStreams=function(){const g=r.apply(this);return this._reverseStreams=this._reverseStreams||{},g.map(_=>this._reverseStreams[_.id])};const s=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(g){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},g.getTracks().forEach(_=>{if(this.getSenders().find(E=>E.track===_))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[g.id]){const _=new o.MediaStream(g.getTracks());this._streams[g.id]=_,this._reverseStreams[_.id]=g,g=_}s.apply(this,[g])};const c=o.RTCPeerConnection.prototype.removeStream;function d(g,_){let E=_.sdp;return Object.keys(g._reverseStreams||[]).forEach(T=>{const w=g._reverseStreams[T],A=g._streams[w.id];E=E.replace(new RegExp(A.id,"g"),w.id)}),new RTCSessionDescription({type:_.type,sdp:E})}o.RTCPeerConnection.prototype.removeStream=function(g){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.apply(this,[this._streams[g.id]||g]),delete this._reverseStreams[this._streams[g.id]?this._streams[g.id].id:g.id],delete this._streams[g.id]},o.RTCPeerConnection.prototype.addTrack=function(g,_){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const E=[].slice.call(arguments,1);if(E.length!==1||!E[0].getTracks().find(w=>w===g))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(w=>w.track===g))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const T=this._streams[_.id];if(T)T.addTrack(g),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const w=new o.MediaStream([g]);this._streams[_.id]=w,this._reverseStreams[w.id]=_,this.addStream(w)}return this.getSenders().find(w=>w.track===g)},["createOffer","createAnswer"].forEach(function(g){const _=o.RTCPeerConnection.prototype[g],E={[g](){const T=arguments;return arguments.length&&typeof arguments[0]=="function"?_.apply(this,[w=>{const A=d(this,w);T[0].apply(null,[A])},w=>{T[1]&&T[1].apply(null,w)},arguments[2]]):_.apply(this,arguments).then(w=>d(this,w))}};o.RTCPeerConnection.prototype[g]=E[g]});const h=o.RTCPeerConnection.prototype.setLocalDescription;o.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(g,_){let E=_.sdp;return Object.keys(g._reverseStreams||[]).forEach(T=>{const w=g._reverseStreams[T],A=g._streams[w.id];E=E.replace(new RegExp(w.id,"g"),A.id)}),new RTCSessionDescription({type:_.type,sdp:E})}(this,arguments[0]),h.apply(this,arguments)):h.apply(this,arguments)};const f=Object.getOwnPropertyDescriptor(o.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(o.RTCPeerConnection.prototype,"localDescription",{get(){const g=f.get.apply(this);return g.type===""?g:d(this,g)}}),o.RTCPeerConnection.prototype.removeTrack=function(g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!g._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(g._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let _;this._streams=this._streams||{},Object.keys(this._streams).forEach(E=>{this._streams[E].getTracks().find(T=>g.track===T)&&(_=this._streams[E])}),_&&(_.getTracks().length===1?this.removeStream(this._reverseStreams[_.id]):_.removeTrack(g.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Cw(o,n){!o.RTCPeerConnection&&o.webkitRTCPeerConnection&&(o.RTCPeerConnection=o.webkitRTCPeerConnection),o.RTCPeerConnection&&n.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const s=o.RTCPeerConnection.prototype[r],c={[r](){return arguments[0]=new(r==="addIceCandidate"?o.RTCIceCandidate:o.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};o.RTCPeerConnection.prototype[r]=c[r]})}function fL(o,n){Cu(o,"negotiationneeded",r=>{const s=r.target;if(!(n.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")||s.signalingState==="stable")return r})}var mL=Object.freeze({__proto__:null,fixNegotiationNeeded:fL,shimAddTrackRemoveTrack:pL,shimAddTrackRemoveTrackWithNative:hL,shimGetDisplayMedia:function(o,n){o.navigator.mediaDevices&&"getDisplayMedia"in o.navigator.mediaDevices||o.navigator.mediaDevices&&(typeof n=="function"?o.navigator.mediaDevices.getDisplayMedia=function(r){return n(r).then(s=>{const c=r.video&&r.video.width,d=r.video&&r.video.height,h=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxFrameRate:h||3}},c&&(r.video.mandatory.maxWidth=c),d&&(r.video.mandatory.maxHeight=d),o.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:lL,shimGetStats:dL,shimGetUserMedia:sL,shimMediaStream:aL,shimOnTrack:cL,shimPeerConnection:Cw,shimSenderReceiverGetStats:uL});function gL(o,n){const r=o&&o.navigator,s=o&&o.MediaStreamTrack;if(r.getUserMedia=function(c,d,h){Tw("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(c).then(d,h)},!(n.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const c=function(h,f,g){f in h&&!(g in h)&&(h[g]=h[f],delete h[f])},d=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(h){return typeof h=="object"&&typeof h.audio=="object"&&(h=JSON.parse(JSON.stringify(h)),c(h.audio,"autoGainControl","mozAutoGainControl"),c(h.audio,"noiseSuppression","mozNoiseSuppression")),d(h)},s&&s.prototype.getSettings){const h=s.prototype.getSettings;s.prototype.getSettings=function(){const f=h.apply(this,arguments);return c(f,"mozAutoGainControl","autoGainControl"),c(f,"mozNoiseSuppression","noiseSuppression"),f}}if(s&&s.prototype.applyConstraints){const h=s.prototype.applyConstraints;s.prototype.applyConstraints=function(f){return this.kind==="audio"&&typeof f=="object"&&(f=JSON.parse(JSON.stringify(f)),c(f,"autoGainControl","mozAutoGainControl"),c(f,"noiseSuppression","mozNoiseSuppression")),h.apply(this,[f])}}}}function _L(o){typeof o=="object"&&o.RTCTrackEvent&&"receiver"in o.RTCTrackEvent.prototype&&!("transceiver"in o.RTCTrackEvent.prototype)&&Object.defineProperty(o.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ww(o,n){if(typeof o!="object"||!o.RTCPeerConnection&&!o.mozRTCPeerConnection)return;!o.RTCPeerConnection&&o.mozRTCPeerConnection&&(o.RTCPeerConnection=o.mozRTCPeerConnection),n.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){const d=o.RTCPeerConnection.prototype[c],h={[c](){return arguments[0]=new(c==="addIceCandidate"?o.RTCIceCandidate:o.RTCSessionDescription)(arguments[0]),d.apply(this,arguments)}};o.RTCPeerConnection.prototype[c]=h[c]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=o.RTCPeerConnection.prototype.getStats;o.RTCPeerConnection.prototype.getStats=function(){const[c,d,h]=arguments;return s.apply(this,[c||null]).then(f=>{if(n.version<53&&!d)try{f.forEach(g=>{g.type=r[g.type]||g.type})}catch(g){if(g.name!=="TypeError")throw g;f.forEach((_,E)=>{f.set(E,Object.assign({},_,{type:r[_.type]||_.type}))})}return f}).then(d,h)}}function vL(o){if(typeof o!="object"||!o.RTCPeerConnection||!o.RTCRtpSender||o.RTCRtpSender&&"getStats"in o.RTCRtpSender.prototype)return;const n=o.RTCPeerConnection.prototype.getSenders;n&&(o.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(c=>c._pc=this),s});const r=o.RTCPeerConnection.prototype.addTrack;r&&(o.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),o.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function EL(o){if(typeof o!="object"||!o.RTCPeerConnection||!o.RTCRtpSender||o.RTCRtpSender&&"getStats"in o.RTCRtpReceiver.prototype)return;const n=o.RTCPeerConnection.prototype.getReceivers;n&&(o.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(s=>s._pc=this),r}),Cu(o,"track",r=>(r.receiver._pc=r.srcElement,r)),o.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function yL(o){o.RTCPeerConnection&&!("removeStream"in o.RTCPeerConnection.prototype)&&(o.RTCPeerConnection.prototype.removeStream=function(n){Tw("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function SL(o){o.DataChannel&&!o.RTCDataChannel&&(o.RTCDataChannel=o.DataChannel)}function TL(o){if(typeof o!="object"||!o.RTCPeerConnection)return;const n=o.RTCPeerConnection.prototype.addTransceiver;n&&(o.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const s=r.length>0;s&&r.forEach(d=>{if("rid"in d&&!/^[a-z0-9]{0,16}$/i.test(d.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in d&&!(parseFloat(d.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in d&&!(parseFloat(d.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const c=n.apply(this,arguments);if(s){const{sender:d}=c,h=d.getParameters();(!("encodings"in h)||h.encodings.length===1&&Object.keys(h.encodings[0]).length===0)&&(h.encodings=r,d.sendEncodings=r,this.setParametersPromises.push(d.setParameters(h).then(()=>{delete d.sendEncodings}).catch(()=>{delete d.sendEncodings})))}return c})}function bL(o){if(typeof o!="object"||!o.RTCRtpSender)return;const n=o.RTCRtpSender.prototype.getParameters;n&&(o.RTCRtpSender.prototype.getParameters=function(){const r=n.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function CL(o){if(typeof o!="object"||!o.RTCPeerConnection)return;const n=o.RTCPeerConnection.prototype.createOffer;o.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>n.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):n.apply(this,arguments)}}function wL(o){if(typeof o!="object"||!o.RTCPeerConnection)return;const n=o.RTCPeerConnection.prototype.createAnswer;o.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>n.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):n.apply(this,arguments)}}var RL=Object.freeze({__proto__:null,shimAddTransceiver:TL,shimCreateAnswer:wL,shimCreateOffer:CL,shimGetDisplayMedia:function(o,n){o.navigator.mediaDevices&&"getDisplayMedia"in o.navigator.mediaDevices||o.navigator.mediaDevices&&(o.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Promise.reject(s)}return r.video===!0?r.video={mediaSource:n}:r.video.mediaSource=n,o.navigator.mediaDevices.getUserMedia(r)})},shimGetParameters:bL,shimGetUserMedia:gL,shimOnTrack:_L,shimPeerConnection:ww,shimRTCDataChannel:SL,shimReceiverGetStats:EL,shimRemoveStream:yL,shimSenderGetStats:vL});function IL(o){if(typeof o=="object"&&o.RTCPeerConnection){if("getLocalStreams"in o.RTCPeerConnection.prototype||(o.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in o.RTCPeerConnection.prototype)){const n=o.RTCPeerConnection.prototype.addTrack;o.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(s=>n.call(this,s,r)),r.getVideoTracks().forEach(s=>n.call(this,s,r))},o.RTCPeerConnection.prototype.addTrack=function(r,...s){return s&&s.forEach(c=>{this._localStreams?this._localStreams.includes(c)||this._localStreams.push(c):this._localStreams=[c]}),n.apply(this,arguments)}}"removeStream"in o.RTCPeerConnection.prototype||(o.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const s=n.getTracks();this.getSenders().forEach(c=>{s.includes(c.track)&&this.removeTrack(c)})})}}function AL(o){if(typeof o=="object"&&o.RTCPeerConnection&&("getRemoteStreams"in o.RTCPeerConnection.prototype||(o.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in o.RTCPeerConnection.prototype))){Object.defineProperty(o.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(c=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(c))return;this._remoteStreams.push(c);const d=new Event("addstream");d.stream=c,this.dispatchEvent(d)})})}});const n=o.RTCPeerConnection.prototype.setRemoteDescription;o.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(c=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(c)>=0)return;r._remoteStreams.push(c);const d=new Event("addstream");d.stream=c,r.dispatchEvent(d)})}),n.apply(r,arguments)}}}function OL(o){if(typeof o!="object"||!o.RTCPeerConnection)return;const n=o.RTCPeerConnection.prototype,r=n.createOffer,s=n.createAnswer,c=n.setLocalDescription,d=n.setRemoteDescription,h=n.addIceCandidate;n.createOffer=function(g,_){const E=arguments.length>=2?arguments[2]:arguments[0],T=r.apply(this,[E]);return _?(T.then(g,_),Promise.resolve()):T},n.createAnswer=function(g,_){const E=arguments.length>=2?arguments[2]:arguments[0],T=s.apply(this,[E]);return _?(T.then(g,_),Promise.resolve()):T};let f=function(g,_,E){const T=c.apply(this,[g]);return E?(T.then(_,E),Promise.resolve()):T};n.setLocalDescription=f,f=function(g,_,E){const T=d.apply(this,[g]);return E?(T.then(_,E),Promise.resolve()):T},n.setRemoteDescription=f,f=function(g,_,E){const T=h.apply(this,[g]);return E?(T.then(_,E),Promise.resolve()):T},n.addIceCandidate=f}function NL(o){const n=o&&o.navigator;if(n.mediaDevices&&n.mediaDevices.getUserMedia){const r=n.mediaDevices,s=r.getUserMedia.bind(r);n.mediaDevices.getUserMedia=c=>s(PL(c))}!n.getUserMedia&&n.mediaDevices&&n.mediaDevices.getUserMedia&&(n.getUserMedia=(function(r,s,c){n.mediaDevices.getUserMedia(r).then(s,c)}).bind(n))}function PL(o){return o&&o.video!==void 0?Object.assign({},o,{video:rL(o.video)}):o}function kL(o){if(!o.RTCPeerConnection)return;const n=o.RTCPeerConnection;o.RTCPeerConnection=function(r,s){if(r&&r.iceServers){const c=[];for(let d=0;d<r.iceServers.length;d++){let h=r.iceServers[d];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(Tw("RTCIceServer.url","RTCIceServer.urls"),h=JSON.parse(JSON.stringify(h)),h.urls=h.url,delete h.url,c.push(h)):c.push(r.iceServers[d])}r.iceServers=c}return new n(r,s)},o.RTCPeerConnection.prototype=n.prototype,"generateCertificate"in n&&Object.defineProperty(o.RTCPeerConnection,"generateCertificate",{get:()=>n.generateCertificate})}function DL(o){typeof o=="object"&&o.RTCTrackEvent&&"receiver"in o.RTCTrackEvent.prototype&&!("transceiver"in o.RTCTrackEvent.prototype)&&Object.defineProperty(o.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function xL(o){const n=o.RTCPeerConnection.prototype.createOffer;o.RTCPeerConnection.prototype.createOffer=function(r){if(r){r.offerToReceiveAudio!==void 0&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const s=this.getTransceivers().find(d=>d.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveAudio!==!0||s||this.addTransceiver("audio",{direction:"recvonly"}),r.offerToReceiveVideo!==void 0&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const c=this.getTransceivers().find(d=>d.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):r.offerToReceiveVideo!==!0||c||this.addTransceiver("video",{direction:"recvonly"})}return n.apply(this,arguments)}}function LL(o){typeof o!="object"||o.AudioContext||(o.AudioContext=o.webkitAudioContext)}var ML=Object.freeze({__proto__:null,shimAudioContext:LL,shimCallbacksAPI:OL,shimConstraints:PL,shimCreateOfferLegacy:xL,shimGetUserMedia:NL,shimLocalStreamsAPI:IL,shimRTCIceServerUrls:kL,shimRemoteStreamsAPI:AL,shimTrackEventTransceiver:DL}),UL={exports:{}};(function(o){const n={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};n.localCName=n.generateIdentifier(),n.splitLines=function(r){return r.trim().split(`
`).map(s=>s.trim())},n.splitSections=function(r){return r.split(`
m=`).map((s,c)=>(c>0?"m="+s:s).trim()+`\r
`)},n.getDescription=function(r){const s=n.splitSections(r);return s&&s[0]},n.getMediaSections=function(r){const s=n.splitSections(r);return s.shift(),s},n.matchPrefix=function(r,s){return n.splitLines(r).filter(c=>c.indexOf(s)===0)},n.parseCandidate=function(r){let s;s=r.indexOf("a=candidate:")===0?r.substring(12).split(" "):r.substring(10).split(" ");const c={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let d=8;d<s.length;d+=2)switch(s[d]){case"raddr":c.relatedAddress=s[d+1];break;case"rport":c.relatedPort=parseInt(s[d+1],10);break;case"tcptype":c.tcpType=s[d+1];break;case"ufrag":c.ufrag=s[d+1],c.usernameFragment=s[d+1];break;default:c[s[d]]===void 0&&(c[s[d]]=s[d+1])}return c},n.writeCandidate=function(r){const s=[];s.push(r.foundation);const c=r.component;c==="rtp"?s.push(1):c==="rtcp"?s.push(2):s.push(c),s.push(r.protocol.toUpperCase()),s.push(r.priority),s.push(r.address||r.ip),s.push(r.port);const d=r.type;return s.push("typ"),s.push(d),d!=="host"&&r.relatedAddress&&r.relatedPort&&(s.push("raddr"),s.push(r.relatedAddress),s.push("rport"),s.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(s.push("ufrag"),s.push(r.usernameFragment||r.ufrag)),"candidate:"+s.join(" ")},n.parseIceOptions=function(r){return r.substring(14).split(" ")},n.parseRtpMap=function(r){let s=r.substring(9).split(" ");const c={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),c.name=s[0],c.clockRate=parseInt(s[1],10),c.channels=s.length===3?parseInt(s[2],10):1,c.numChannels=c.channels,c},n.writeRtpMap=function(r){let s=r.payloadType;r.preferredPayloadType!==void 0&&(s=r.preferredPayloadType);const c=r.channels||r.numChannels||1;return"a=rtpmap:"+s+" "+r.name+"/"+r.clockRate+(c!==1?"/"+c:"")+`\r
`},n.parseExtmap=function(r){const s=r.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},n.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+(r.attributes?" "+r.attributes:"")+`\r
`},n.parseFmtp=function(r){const s={};let c;const d=r.substring(r.indexOf(" ")+1).split(";");for(let h=0;h<d.length;h++)c=d[h].trim().split("="),s[c[0].trim()]=c[1];return s},n.writeFmtp=function(r){let s="",c=r.payloadType;if(r.preferredPayloadType!==void 0&&(c=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){const d=[];Object.keys(r.parameters).forEach(h=>{r.parameters[h]!==void 0?d.push(h+"="+r.parameters[h]):d.push(h)}),s+="a=fmtp:"+c+" "+d.join(";")+`\r
`}return s},n.parseRtcpFb=function(r){const s=r.substring(r.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},n.writeRtcpFb=function(r){let s="",c=r.payloadType;return r.preferredPayloadType!==void 0&&(c=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(d=>{s+="a=rtcp-fb:"+c+" "+d.type+(d.parameter&&d.parameter.length?" "+d.parameter:"")+`\r
`}),s},n.parseSsrcMedia=function(r){const s=r.indexOf(" "),c={ssrc:parseInt(r.substring(7,s),10)},d=r.indexOf(":",s);return d>-1?(c.attribute=r.substring(s+1,d),c.value=r.substring(d+1)):c.attribute=r.substring(s+1),c},n.parseSsrcGroup=function(r){const s=r.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(c=>parseInt(c,10))}},n.getMid=function(r){const s=n.matchPrefix(r,"a=mid:")[0];if(s)return s.substring(6)},n.parseFingerprint=function(r){const s=r.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},n.getDtlsParameters=function(r,s){return{role:"auto",fingerprints:n.matchPrefix(r+s,"a=fingerprint:").map(n.parseFingerprint)}},n.writeDtlsParameters=function(r,s){let c="a=setup:"+s+`\r
`;return r.fingerprints.forEach(d=>{c+="a=fingerprint:"+d.algorithm+" "+d.value+`\r
`}),c},n.parseCryptoLine=function(r){const s=r.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},n.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?n.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},n.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;const s=r.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},n.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},n.getCryptoParameters=function(r,s){return n.matchPrefix(r+s,"a=crypto:").map(n.parseCryptoLine)},n.getIceParameters=function(r,s){const c=n.matchPrefix(r+s,"a=ice-ufrag:")[0],d=n.matchPrefix(r+s,"a=ice-pwd:")[0];return c&&d?{usernameFragment:c.substring(12),password:d.substring(10)}:null},n.writeIceParameters=function(r){let s="a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`;return r.iceLite&&(s+=`a=ice-lite\r
`),s},n.parseRtpParameters=function(r){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=n.splitLines(r)[0].split(" ");s.profile=c[2];for(let h=3;h<c.length;h++){const f=c[h],g=n.matchPrefix(r,"a=rtpmap:"+f+" ")[0];if(g){const _=n.parseRtpMap(g),E=n.matchPrefix(r,"a=fmtp:"+f+" ");switch(_.parameters=E.length?n.parseFmtp(E[0]):{},_.rtcpFeedback=n.matchPrefix(r,"a=rtcp-fb:"+f+" ").map(n.parseRtcpFb),s.codecs.push(_),_.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(_.name.toUpperCase())}}}n.matchPrefix(r,"a=extmap:").forEach(h=>{s.headerExtensions.push(n.parseExtmap(h))});const d=n.matchPrefix(r,"a=rtcp-fb:* ").map(n.parseRtcpFb);return s.codecs.forEach(h=>{d.forEach(f=>{h.rtcpFeedback.find(g=>g.type===f.type&&g.parameter===f.parameter)||h.rtcpFeedback.push(f)})}),s},n.writeRtpDescription=function(r,s){let c="";c+="m="+r+" ",c+=s.codecs.length>0?"9":"0",c+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",c+=s.codecs.map(h=>h.preferredPayloadType!==void 0?h.preferredPayloadType:h.payloadType).join(" ")+`\r
`,c+=`c=IN IP4 0.0.0.0\r
`,c+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(h=>{c+=n.writeRtpMap(h),c+=n.writeFmtp(h),c+=n.writeRtcpFb(h)});let d=0;return s.codecs.forEach(h=>{h.maxptime>d&&(d=h.maxptime)}),d>0&&(c+="a=maxptime:"+d+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(h=>{c+=n.writeExtmap(h)}),c},n.parseRtpEncodingParameters=function(r){const s=[],c=n.parseRtpParameters(r),d=c.fecMechanisms.indexOf("RED")!==-1,h=c.fecMechanisms.indexOf("ULPFEC")!==-1,f=n.matchPrefix(r,"a=ssrc:").map(w=>n.parseSsrcMedia(w)).filter(w=>w.attribute==="cname"),g=f.length>0&&f[0].ssrc;let _;const E=n.matchPrefix(r,"a=ssrc-group:FID").map(w=>w.substring(17).split(" ").map(A=>parseInt(A,10)));E.length>0&&E[0].length>1&&E[0][0]===g&&(_=E[0][1]),c.codecs.forEach(w=>{if(w.name.toUpperCase()==="RTX"&&w.parameters.apt){let A={ssrc:g,codecPayloadType:parseInt(w.parameters.apt,10)};g&&_&&(A.rtx={ssrc:_}),s.push(A),d&&(A=JSON.parse(JSON.stringify(A)),A.fec={ssrc:g,mechanism:h?"red+ulpfec":"red"},s.push(A))}}),s.length===0&&g&&s.push({ssrc:g});let T=n.matchPrefix(r,"b=");return T.length&&(T=T[0].indexOf("b=TIAS:")===0?parseInt(T[0].substring(7),10):T[0].indexOf("b=AS:")===0?1e3*parseInt(T[0].substring(5),10)*.95-16e3:void 0,s.forEach(w=>{w.maxBitrate=T})),s},n.parseRtcpParameters=function(r){const s={},c=n.matchPrefix(r,"a=ssrc:").map(f=>n.parseSsrcMedia(f)).filter(f=>f.attribute==="cname")[0];c&&(s.cname=c.value,s.ssrc=c.ssrc);const d=n.matchPrefix(r,"a=rtcp-rsize");s.reducedSize=d.length>0,s.compound=d.length===0;const h=n.matchPrefix(r,"a=rtcp-mux");return s.mux=h.length>0,s},n.writeRtcpParameters=function(r){let s="";return r.reducedSize&&(s+=`a=rtcp-rsize\r
`),r.mux&&(s+=`a=rtcp-mux\r
`),r.ssrc!==void 0&&r.cname&&(s+="a=ssrc:"+r.ssrc+" cname:"+r.cname+`\r
`),s},n.parseMsid=function(r){let s;const c=n.matchPrefix(r,"a=msid:");if(c.length===1)return s=c[0].substring(7).split(" "),{stream:s[0],track:s[1]};const d=n.matchPrefix(r,"a=ssrc:").map(h=>n.parseSsrcMedia(h)).filter(h=>h.attribute==="msid");return d.length>0?(s=d[0].value.split(" "),{stream:s[0],track:s[1]}):void 0},n.parseSctpDescription=function(r){const s=n.parseMLine(r),c=n.matchPrefix(r,"a=max-message-size:");let d;c.length>0&&(d=parseInt(c[0].substring(19),10)),isNaN(d)&&(d=65536);const h=n.matchPrefix(r,"a=sctp-port:");if(h.length>0)return{port:parseInt(h[0].substring(12),10),protocol:s.fmt,maxMessageSize:d};const f=n.matchPrefix(r,"a=sctpmap:");if(f.length>0){const g=f[0].substring(10).split(" ");return{port:parseInt(g[0],10),protocol:g[1],maxMessageSize:d}}},n.writeSctpDescription=function(r,s){let c=[];return c=r.protocol!=="DTLS/SCTP"?["m="+r.kind+" 9 "+r.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:["m="+r.kind+" 9 "+r.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&c.push("a=max-message-size:"+s.maxMessageSize+`\r
`),c.join("")},n.generateSessionId=function(){return Math.random().toString().substr(2,22)},n.writeSessionBoilerplate=function(r,s,c){let d;const h=s!==void 0?s:2;return d=r||n.generateSessionId(),`v=0\r
o=`+(c||"thisisadapterortc")+" "+d+" "+h+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},n.getDirection=function(r,s){const c=n.splitLines(r);for(let d=0;d<c.length;d++)switch(c[d]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[d].substring(2)}return s?n.getDirection(s):"sendrecv"},n.getKind=function(r){return n.splitLines(r)[0].split(" ")[0].substring(2)},n.isRejected=function(r){return r.split(" ",2)[1]==="0"},n.parseMLine=function(r){const s=n.splitLines(r)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},n.parseOLine=function(r){const s=n.matchPrefix(r,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},n.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;const s=n.splitLines(r);for(let c=0;c<s.length;c++)if(s[c].length<2||s[c].charAt(1)!=="=")return!1;return!0},o.exports=n})(UL);var jL=UL.exports,op=u(jL),rJ=a({__proto__:null,default:op},[jL]);function QE(o){if(!o.RTCIceCandidate||o.RTCIceCandidate&&"foundation"in o.RTCIceCandidate.prototype)return;const n=o.RTCIceCandidate;o.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&((r=JSON.parse(JSON.stringify(r))).candidate=r.candidate.substr(2)),r.candidate&&r.candidate.length){const s=new n(r),c=op.parseCandidate(r.candidate),d=Object.assign(s,c);return d.toJSON=function(){return{candidate:d.candidate,sdpMid:d.sdpMid,sdpMLineIndex:d.sdpMLineIndex,usernameFragment:d.usernameFragment}},d}return new n(r)},o.RTCIceCandidate.prototype=n.prototype,Cu(o,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new o.RTCIceCandidate(r.candidate),writable:"false"}),r))}function Rw(o){!o.RTCIceCandidate||o.RTCIceCandidate&&"relayProtocol"in o.RTCIceCandidate.prototype||Cu(o,"icecandidate",n=>{if(n.candidate){const r=op.parseCandidate(n.candidate.candidate);r.type==="relay"&&(n.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[r.priority>>24])}return n})}function ZE(o,n){if(!o.RTCPeerConnection)return;"sctp"in o.RTCPeerConnection.prototype||Object.defineProperty(o.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const r=function(f){if(!f||!f.sdp)return!1;const g=op.splitSections(f.sdp);return g.shift(),g.some(_=>{const E=op.parseMLine(_);return E&&E.kind==="application"&&E.protocol.indexOf("SCTP")!==-1})},s=function(f){const g=f.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(g===null||g.length<2)return-1;const _=parseInt(g[1],10);return _!=_?-1:_},c=function(f){let g=65536;return n.browser==="firefox"&&(g=n.version<57?f===-1?16384:2147483637:n.version<60?n.version===57?65535:65536:2147483637),g},d=function(f,g){let _=65536;n.browser==="firefox"&&n.version===57&&(_=65535);const E=op.matchPrefix(f.sdp,"a=max-message-size:");return E.length>0?_=parseInt(E[0].substr(19),10):n.browser==="firefox"&&g!==-1&&(_=2147483637),_},h=o.RTCPeerConnection.prototype.setRemoteDescription;o.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,n.browser==="chrome"&&n.version>=76){const{sdpSemantics:f}=this.getConfiguration();f==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const f=s(arguments[0]),g=c(f),_=d(arguments[0],f);let E;E=g===0&&_===0?Number.POSITIVE_INFINITY:g===0||_===0?Math.max(g,_):Math.min(g,_);const T={};Object.defineProperty(T,"maxMessageSize",{get:()=>E}),this._sctp=T}return h.apply(this,arguments)}}function ey(o){if(!o.RTCPeerConnection||!("createDataChannel"in o.RTCPeerConnection.prototype))return;function n(s,c){const d=s.send;s.send=function(){const h=arguments[0],f=h.length||h.size||h.byteLength;if(s.readyState==="open"&&c.sctp&&f>c.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+c.sctp.maxMessageSize+" bytes)");return d.apply(s,arguments)}}const r=o.RTCPeerConnection.prototype.createDataChannel;o.RTCPeerConnection.prototype.createDataChannel=function(){const s=r.apply(this,arguments);return n(s,this),s},Cu(o,"datachannel",s=>(n(s.channel,s.target),s))}function Iw(o){if(!o.RTCPeerConnection||"connectionState"in o.RTCPeerConnection.prototype)return;const n=o.RTCPeerConnection.prototype;Object.defineProperty(n,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(n,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const s=n[r];n[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=c=>{const d=c.target;if(d._lastConnectionState!==d.connectionState){d._lastConnectionState=d.connectionState;const h=new Event("connectionstatechange",c);d.dispatchEvent(h)}return c},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function Aw(o,n){if(!o.RTCPeerConnection||n.browser==="chrome"&&n.version>=71||n.browser==="safari"&&n.version>=605)return;const r=o.RTCPeerConnection.prototype.setRemoteDescription;o.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const c=s.sdp.split(`
`).filter(d=>d.trim()!=="a=extmap-allow-mixed").join(`
`);o.RTCSessionDescription&&s instanceof o.RTCSessionDescription?arguments[0]=new o.RTCSessionDescription({type:s.type,sdp:c}):s.sdp=c}return r.apply(this,arguments)}}function ty(o,n){if(!o.RTCPeerConnection||!o.RTCPeerConnection.prototype)return;const r=o.RTCPeerConnection.prototype.addIceCandidate;r&&r.length!==0&&(o.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(n.browser==="chrome"&&n.version<78||n.browser==="firefox"&&n.version<68||n.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function ny(o,n){if(!o.RTCPeerConnection||!o.RTCPeerConnection.prototype)return;const r=o.RTCPeerConnection.prototype.setLocalDescription;r&&r.length!==0&&(o.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return r.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer"}return s.sdp||s.type!=="offer"&&s.type!=="answer"?r.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(c=>r.apply(this,[c]))})}var iJ=Object.freeze({__proto__:null,removeExtmapAllowMixed:Aw,shimAddIceCandidateNullOrEmpty:ty,shimConnectionState:Iw,shimMaxMessageSize:ZE,shimParameterlessSetLocalDescription:ny,shimRTCIceCandidate:QE,shimRTCIceCandidateRelayProtocol:Rw,shimSendThrowTypeError:ey});(function({window:o}={},n={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const r=tL,s=function(d){const h={browser:null,version:null};if(d===void 0||!d.navigator)return h.browser="Not a browser.",h;const{navigator:f}=d;if(f.mozGetUserMedia)h.browser="firefox",h.version=XE(f.userAgent,/Firefox\/(\d+)\./,1);else if(f.webkitGetUserMedia||d.isSecureContext===!1&&d.webkitRTCPeerConnection)h.browser="chrome",h.version=XE(f.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!d.RTCPeerConnection||!f.userAgent.match(/AppleWebKit\/(\d+)\./))return h.browser="Not a supported browser.",h;h.browser="safari",h.version=XE(f.userAgent,/AppleWebKit\/(\d+)\./,1),h.supportsUnifiedPlan=d.RTCRtpTransceiver&&"currentDirection"in d.RTCRtpTransceiver.prototype}return h}(o),c={browserDetails:s,commonShim:iJ,extractVersion:XE,disableLog:tJ,disableWarnings:nJ,sdp:rJ};switch(s.browser){case"chrome":if(!mL||!Cw||!n.shimChrome)return r("Chrome shim is not included in this adapter release."),c;if(s.version===null)return r("Chrome shim can not determine version, not shimming."),c;r("adapter.js shimming chrome."),c.browserShim=mL,ty(o,s),ny(o),sL(o,s),aL(o),Cw(o,s),cL(o),pL(o,s),lL(o),dL(o),uL(o),fL(o,s),QE(o),Rw(o),Iw(o),ZE(o,s),ey(o),Aw(o,s);break;case"firefox":if(!RL||!ww||!n.shimFirefox)return r("Firefox shim is not included in this adapter release."),c;r("adapter.js shimming firefox."),c.browserShim=RL,ty(o,s),ny(o),gL(o,s),ww(o,s),_L(o),yL(o),vL(o),EL(o),SL(o),TL(o),bL(o),CL(o),wL(o),QE(o),Iw(o),ZE(o,s),ey(o);break;case"safari":if(!ML||!n.shimSafari)return r("Safari shim is not included in this adapter release."),c;r("adapter.js shimming safari."),c.browserShim=ML,ty(o,s),ny(o),kL(o),xL(o),OL(o),IL(o),AL(o),DL(o),NL(o),LL(o),QE(o),Rw(o),ZE(o,s),ey(o),Aw(o,s);break;default:r("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var FL={exports:{}},oJ=En,sJ=Te,VL=Ce.f;oJ({target:"Object",stat:!0,forced:Object.defineProperty!==VL,sham:!sJ},{defineProperty:VL});var BL=Jr.Object,aJ=FL.exports=function(o,n,r){return BL.defineProperty(o,n,r)};BL.defineProperty.sham&&(aJ.sham=!0);var cJ=u(FL.exports),lJ=se,Ow=Array.isArray||function(o){return lJ(o)=="Array"},dJ=TypeError,uJ=Qh,hJ=Ce,pJ=kt,Nw=function(o,n,r){var s=uJ(n);s in o?hJ.f(o,s,pJ(0,r)):o[s]=r},fJ=Oe,Pw=Fm,mJ=R(Function.toString);fJ(Pw.inspectSource)||(Pw.inspectSource=function(o){return mJ(o)});var WL=Pw.inspectSource,gJ=R,_J=p,zL=Oe,vJ=$l,EJ=WL,GL=function(){},yJ=[],HL=$r("Reflect","construct"),kw=/^\s*(?:class|function)\b/,SJ=gJ(kw.exec),TJ=!kw.exec(GL),Zm=function(o){if(!zL(o))return!1;try{return HL(GL,yJ,o),!0}catch{return!1}},$L=function(o){if(!zL(o))return!1;switch(vJ(o)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return TJ||!!SJ(kw,EJ(o))}catch{return!0}};$L.sham=!0;var Dw=!HL||_J(function(){var o;return Zm(Zm.call)||!Zm(Object)||!Zm(function(){o=!0})||o})?$L:Zm,KL=Ow,bJ=Dw,CJ=br,wJ=er("species"),YL=Array,RJ=function(o){var n;return KL(o)&&(n=o.constructor,(bJ(n)&&(n===YL||KL(n.prototype))||CJ(n)&&(n=n[wJ])===null)&&(n=void 0)),n===void 0?YL:n},qL=function(o,n){return new(RJ(o))(n===0?0:n)},IJ=p,AJ=et,OJ=er("species"),NJ=En,PJ=p,kJ=Ow,DJ=br,xJ=Vs,LJ=Gl,JL=function(o){if(o>9007199254740991)throw dJ("Maximum allowed index exceeded");return o},XL=Nw,MJ=qL,UJ=function(o){return AJ>=51||!IJ(function(){var n=[];return(n.constructor={})[OJ]=function(){return{foo:1}},n[o](Boolean).foo!==1})},jJ=et,QL=er("isConcatSpreadable"),FJ=jJ>=51||!PJ(function(){var o=[];return o[QL]=!1,o.concat()[0]!==o}),VJ=function(o){if(!DJ(o))return!1;var n=o[QL];return n!==void 0?!!n:kJ(o)};NJ({target:"Array",proto:!0,arity:1,forced:!FJ||!UJ("concat")},{concat:function(o){var n,r,s,c,d,h=xJ(this),f=MJ(h,0),g=0;for(n=-1,s=arguments.length;n<s;n++)if(VJ(d=n===-1?h:arguments[n]))for(c=LJ(d),JL(g+c),r=0;r<c;r++,g++)r in d&&XL(f,g,d[r]);else JL(g+1),XL(f,g++,d);return f.length=g,f}});var xw={},ry={},Lw=ci,BJ=on,WJ=vw.indexOf,zJ=ry,ZL=R([].push),e2=function(o,n){var r,s=BJ(o),c=0,d=[];for(r in s)!Lw(zJ,r)&&Lw(s,r)&&ZL(d,r);for(;n.length>c;)Lw(s,r=n[c++])&&(~WJ(d,r)||ZL(d,r));return d},Mw=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],GJ=e2,HJ=Mw,iy=Object.keys||function(o){return GJ(o,HJ)},$J=Te,KJ=lt,YJ=Ce,qJ=Bt,JJ=on,XJ=iy;xw.f=$J&&!KJ?Object.defineProperties:function(o,n){qJ(o);for(var r,s=JJ(n),c=XJ(n),d=c.length,h=0;d>h;)YJ.f(o,r=c[h++],s[r]);return o};var oy,t2=$r("document","documentElement"),QJ=Wm,n2=Bl("keys"),sy=function(o){return n2[o]||(n2[o]=QJ(o))},ZJ=Bt,eX=xw,r2=Mw,tX=ry,nX=t2,rX=Km,Uw="prototype",jw="script",i2=sy("IE_PROTO"),Fw=function(){},o2=function(o){return"<"+jw+">"+o+"</"+jw+">"},s2=function(o){o.write(o2("")),o.close();var n=o.parentWindow.Object;return o=null,n},ay=function(){try{oy=new ActiveXObject("htmlfile")}catch{}var o,n,r;ay=typeof document<"u"?document.domain&&oy?s2(oy):(n=rX("iframe"),r="java"+jw+":",n.style.display="none",nX.appendChild(n),n.src=String(r),(o=n.contentWindow.document).open(),o.write(o2("document.F=Object")),o.close(),o.F):s2(oy);for(var s=r2.length;s--;)delete ay[Uw][r2[s]];return ay()};tX[i2]=!0;var eg=Object.create||function(o,n){var r;return o!==null?(Fw[Uw]=ZJ(o),r=new Fw,Fw[Uw]=null,r[i2]=o):r=ay(),n===void 0?r:eX.f(r,n)},cy={},iX=e2,oX=Mw.concat("length","prototype");cy.f=Object.getOwnPropertyNames||function(o){return iX(o,oX)};var a2={},c2=Yx,sX=Gl,aX=Nw,cX=Array,lX=Math.max,Vw=function(o,n,r){for(var s=sX(o),c=c2(n,s),d=c2(r===void 0?s:r,s),h=cX(lX(d-c,0)),f=0;c<d;c++,f++)aX(h,f,o[c]);return h.length=f,h},dX=se,uX=on,l2=cy.f,hX=Vw,d2=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];a2.f=function(o){return d2&&dX(o)=="Window"?function(n){try{return l2(n)}catch{return hX(d2)}}(o):l2(uX(o))};var tg={};tg.f=Object.getOwnPropertySymbols;var pX=zl,Kl=function(o,n,r,s){return s&&s.enumerable?o[n]=r:pX(o,n,r),o},fX=Ce,ly=function(o,n,r){return fX.f(o,n,r)},sp={},mX=er;sp.f=mX;var dy,ng,uy,u2=Jr,gX=ci,_X=sp,vX=Ce.f,Kr=function(o){var n=u2.Symbol||(u2.Symbol={});gX(n,o)||vX(n,o,{value:_X.f(o)})},EX=be,yX=$r,SX=er,TX=Kl,h2=function(){var o=yX("Symbol"),n=o&&o.prototype,r=n&&n.valueOf,s=SX("toPrimitive");n&&!n[s]&&TX(n,s,function(c){return EX(r,this)},{arity:1})},bX=$l,CX=Ew?{}.toString:function(){return"[object "+bX(this)+"]"},wX=Ew,RX=Ce.f,IX=zl,AX=ci,OX=CX,p2=er("toStringTag"),Yl=function(o,n,r,s){if(o){var c=r?o:o.prototype;AX(c,p2)||RX(c,p2,{configurable:!0,value:n}),s&&!wX&&IX(c,"toString",OX)}},NX=Oe,f2=U.WeakMap,PX=NX(f2)&&/native code/.test(String(f2)),m2=U,kX=br,DX=zl,Bw=ci,Ww=Fm,xX=sy,LX=ry,g2="Object already initialized",zw=m2.TypeError,MX=m2.WeakMap;if(PX||Ww.state){var qa=Ww.state||(Ww.state=new MX);qa.get=qa.get,qa.has=qa.has,qa.set=qa.set,dy=function(o,n){if(qa.has(o))throw zw(g2);return n.facade=o,qa.set(o,n),n},ng=function(o){return qa.get(o)||{}},uy=function(o){return qa.has(o)}}else{var ap=xX("state");LX[ap]=!0,dy=function(o,n){if(Bw(o,ap))throw zw(g2);return n.facade=o,DX(o,ap,n),n},ng=function(o){return Bw(o,ap)?o[ap]:{}},uy=function(o){return Bw(o,ap)}}var cp={set:dy,get:ng,has:uy,enforce:function(o){return uy(o)?ng(o):dy(o,{})},getterFor:function(o){return function(n){var r;if(!kX(n)||(r=ng(n)).type!==o)throw zw("Incompatible receiver, "+o+" required");return r}}},UX=ge,jX=St,FX=Vs,VX=Gl,BX=qL,_2=R([].push),ql=function(o){var n=o==1,r=o==2,s=o==3,c=o==4,d=o==6,h=o==7,f=o==5||d;return function(g,_,E,T){for(var w,A,L=FX(g),P=jX(L),D=UX(_,E),G=VX(P),$=0,X=T||BX,ie=n?X(g,G):r||h?X(g,0):void 0;G>$;$++)if((f||$ in P)&&(A=D(w=P[$],$,L),o))if(n)ie[$]=A;else if(A)switch(o){case 3:return!0;case 5:return w;case 6:return $;case 2:_2(ie,w)}else switch(o){case 4:return!1;case 7:_2(ie,w)}return d?-1:s||c?c:ie}},WX={forEach:ql(0),map:ql(1),filter:ql(2),some:ql(3),every:ql(4),find:ql(5),findIndex:ql(6),filterReject:ql(7)},hy=En,Gw=U,Hw=be,zX=R,lp=Te,dp=Zn,GX=p,Ni=ci,HX=N,$w=Bt,py=on,Kw=Qh,$X=Bs,Yw=kt,rg=eg,v2=iy,KX=cy,E2=a2,YX=tg,y2=Ie,S2=Ce,qX=xw,T2=xe,b2=Kl,JX=ly,qw=Bl,C2=ry,w2=Wm,XX=er,QX=sp,ZX=Kr,eQ=h2,tQ=Yl,R2=cp,fy=WX.forEach,Uo=sy("hidden"),my="Symbol",ig="prototype",nQ=R2.set,I2=R2.getterFor(my),wa=Object[ig],wu=Gw.Symbol,gy=wu&&wu[ig],rQ=Gw.TypeError,Jw=Gw.QObject,A2=y2.f,Ru=S2.f,O2=E2.f,iQ=T2.f,N2=zX([].push),zc=qw("symbols"),og=qw("op-symbols"),oQ=qw("wks"),Xw=!Jw||!Jw[ig]||!Jw[ig].findChild,Qw=lp&&GX(function(){return rg(Ru({},"a",{get:function(){return Ru(this,"a",{value:7}).a}})).a!=7})?function(o,n,r){var s=A2(wa,n);s&&delete wa[n],Ru(o,n,r),s&&o!==wa&&Ru(wa,n,s)}:Ru,Zw=function(o,n){var r=zc[o]=rg(gy);return nQ(r,{type:my,tag:o,description:n}),lp||(r.description=n),r},_y=function(o,n,r){o===wa&&_y(og,n,r),$w(o);var s=Kw(n);return $w(r),Ni(zc,s)?(r.enumerable?(Ni(o,Uo)&&o[Uo][s]&&(o[Uo][s]=!1),r=rg(r,{enumerable:Yw(0,!1)})):(Ni(o,Uo)||Ru(o,Uo,Yw(1,{})),o[Uo][s]=!0),Qw(o,s,r)):Ru(o,s,r)},eR=function(o,n){$w(o);var r=py(n),s=v2(r).concat(x2(r));return fy(s,function(c){lp&&!Hw(P2,r,c)||_y(o,c,r[c])}),o},P2=function(o){var n=Kw(o),r=Hw(iQ,this,n);return!(this===wa&&Ni(zc,n)&&!Ni(og,n))&&(!(r||!Ni(this,n)||!Ni(zc,n)||Ni(this,Uo)&&this[Uo][n])||r)},k2=function(o,n){var r=py(o),s=Kw(n);if(r!==wa||!Ni(zc,s)||Ni(og,s)){var c=A2(r,s);return!c||!Ni(zc,s)||Ni(r,Uo)&&r[Uo][s]||(c.enumerable=!0),c}},D2=function(o){var n=O2(py(o)),r=[];return fy(n,function(s){Ni(zc,s)||Ni(C2,s)||N2(r,s)}),r},x2=function(o){var n=o===wa,r=O2(n?og:py(o)),s=[];return fy(r,function(c){!Ni(zc,c)||n&&!Ni(wa,c)||N2(s,zc[c])}),s};dp||(wu=function(){if(HX(gy,this))throw rQ("Symbol is not a constructor");var o=arguments.length&&arguments[0]!==void 0?$X(arguments[0]):void 0,n=w2(o),r=function(s){this===wa&&Hw(r,og,s),Ni(this,Uo)&&Ni(this[Uo],n)&&(this[Uo][n]=!1),Qw(this,n,Yw(1,s))};return lp&&Xw&&Qw(wa,n,{configurable:!0,set:r}),Zw(n,o)},b2(gy=wu[ig],"toString",function(){return I2(this).tag}),b2(wu,"withoutSetter",function(o){return Zw(w2(o),o)}),T2.f=P2,S2.f=_y,qX.f=eR,y2.f=k2,KX.f=E2.f=D2,YX.f=x2,QX.f=function(o){return Zw(XX(o),o)},lp&&JX(gy,"description",{configurable:!0,get:function(){return I2(this).description}})),hy({global:!0,constructor:!0,wrap:!0,forced:!dp,sham:!dp},{Symbol:wu}),fy(v2(oQ),function(o){ZX(o)}),hy({target:my,stat:!0,forced:!dp},{useSetter:function(){Xw=!0},useSimple:function(){Xw=!1}}),hy({target:"Object",stat:!0,forced:!dp,sham:!lp},{create:function(o,n){return n===void 0?rg(o):eR(rg(o),n)},defineProperty:_y,defineProperties:eR,getOwnPropertyDescriptor:k2}),hy({target:"Object",stat:!0,forced:!dp},{getOwnPropertyNames:D2}),eQ(),tQ(wu,my),C2[Uo]=!0;var L2=Zn&&!!Symbol.for&&!!Symbol.keyFor,sQ=En,aQ=$r,cQ=ci,lQ=Bs,M2=Bl,dQ=L2,tR=M2("string-to-symbol-registry"),uQ=M2("symbol-to-string-registry");sQ({target:"Symbol",stat:!0,forced:!dQ},{for:function(o){var n=lQ(o);if(cQ(tR,n))return tR[n];var r=aQ("Symbol")(n);return tR[n]=r,uQ[r]=n,r}});var hQ=En,pQ=ci,fQ=yu,mQ=Fl,gQ=L2,U2=Bl("symbol-to-string-registry");hQ({target:"Symbol",stat:!0,forced:!gQ},{keyFor:function(o){if(!fQ(o))throw TypeError(mQ(o)+" is not a symbol");if(pQ(U2,o))return U2[o]}});var j2=R([].slice),F2=Ow,_Q=Oe,V2=se,vQ=Bs,B2=R([].push),EQ=En,W2=$r,z2=H,yQ=be,sg=R,G2=p,H2=Oe,$2=yu,K2=j2,SQ=function(o){if(_Q(o))return o;if(F2(o)){for(var n=o.length,r=[],s=0;s<n;s++){var c=o[s];typeof c=="string"?B2(r,c):typeof c!="number"&&V2(c)!="Number"&&V2(c)!="String"||B2(r,vQ(c))}var d=r.length,h=!0;return function(f,g){if(h)return h=!1,g;if(F2(this))return g;for(var _=0;_<d;_++)if(r[_]===f)return g}}},TQ=Zn,bQ=String,Jl=W2("JSON","stringify"),vy=sg(/./.exec),Y2=sg("".charAt),CQ=sg("".charCodeAt),wQ=sg("".replace),RQ=sg(1 .toString),IQ=/[\uD800-\uDFFF]/g,q2=/^[\uD800-\uDBFF]$/,J2=/^[\uDC00-\uDFFF]$/,X2=!TQ||G2(function(){var o=W2("Symbol")();return Jl([o])!="[null]"||Jl({a:o})!="{}"||Jl(Object(o))!="{}"}),Q2=G2(function(){return Jl("\uDF06\uD834")!=='"\\udf06\\ud834"'||Jl("\uDEAD")!=='"\\udead"'}),AQ=function(o,n){var r=K2(arguments),s=SQ(n);if(H2(s)||o!==void 0&&!$2(o))return r[1]=function(c,d){if(H2(s)&&(d=yQ(s,this,bQ(c),d)),!$2(d))return d},z2(Jl,null,r)},OQ=function(o,n,r){var s=Y2(r,n-1),c=Y2(r,n+1);return vy(q2,o)&&!vy(J2,c)||vy(J2,o)&&!vy(q2,s)?"\\u"+RQ(CQ(o,0),16):o};Jl&&EQ({target:"JSON",stat:!0,arity:3,forced:X2||Q2},{stringify:function(o,n,r){var s=K2(arguments),c=z2(X2?AQ:Jl,null,s);return Q2&&typeof c=="string"?wQ(c,IQ,OQ):c}});var Z2=tg,NQ=Vs;En({target:"Object",stat:!0,forced:!Zn||p(function(){Z2.f(1)})},{getOwnPropertySymbols:function(o){var n=Z2.f;return n?n(NQ(o)):[]}}),Kr("asyncIterator"),Kr("hasInstance"),Kr("isConcatSpreadable"),Kr("iterator"),Kr("match"),Kr("matchAll"),Kr("replace"),Kr("search"),Kr("species"),Kr("split");var PQ=h2;Kr("toPrimitive"),PQ();var kQ=$r,DQ=Yl;Kr("toStringTag"),DQ(kQ("Symbol"),"Symbol"),Kr("unscopables"),Yl(U.JSON,"JSON",!0);var Iu,eM,tM,xQ=Jr.Symbol,up={},nR=Te,LQ=ci,nM=Function.prototype,MQ=nR&&Object.getOwnPropertyDescriptor,rR=LQ(nM,"name"),rM={EXISTS:rR,PROPER:rR&&(function(){}).name==="something",CONFIGURABLE:rR&&(!nR||nR&&MQ(nM,"name").configurable)},UQ=!p(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}),jQ=ci,FQ=Oe,VQ=Vs,BQ=UQ,iM=sy("IE_PROTO"),iR=Object,WQ=iR.prototype,oR=BQ?iR.getPrototypeOf:function(o){var n=VQ(o);if(jQ(n,iM))return n[iM];var r=n.constructor;return FQ(r)&&n instanceof r?r.prototype:n instanceof iR?WQ:null},zQ=p,GQ=Oe,HQ=br,$Q=eg,oM=oR,KQ=Kl,sR=er("iterator"),sM=!1;[].keys&&("next"in(tM=[].keys())?(eM=oM(oM(tM)))!==Object.prototype&&(Iu=eM):sM=!0);var YQ=!HQ(Iu)||zQ(function(){var o={};return Iu[sR].call(o)!==o});GQ((Iu=YQ?{}:$Q(Iu))[sR])||KQ(Iu,sR,function(){return this});var aM={IteratorPrototype:Iu,BUGGY_SAFARI_ITERATORS:sM},qQ=aM.IteratorPrototype,JQ=eg,XQ=kt,QQ=Yl,ZQ=up,eZ=function(){return this},cM=function(o,n,r,s){var c=n+" Iterator";return o.prototype=JQ(qQ,{next:XQ(+!s,r)}),QQ(o,c,!1,!0),ZQ[c]=eZ,o},tZ=R,nZ=Mo,rZ=Oe,iZ=String,oZ=TypeError,sZ=function(o,n,r){try{return tZ(nZ(Object.getOwnPropertyDescriptor(o,n)[r]))}catch{}},aZ=Bt,cZ=function(o){if(typeof o=="object"||rZ(o))return o;throw oZ("Can't set "+iZ(o)+" as a prototype")},lZ=Object.setPrototypeOf||("__proto__"in{}?function(){var o,n=!1,r={};try{(o=sZ(Object.prototype,"__proto__","set"))(r,[]),n=r instanceof Array}catch{}return function(s,c){return aZ(s),cZ(c),n?o(s,c):s.__proto__=c,s}}():void 0),dZ=En,uZ=be,hZ=rM,pZ=cM,fZ=oR,mZ=Yl,lM=Kl,dM=up,gZ=aM,_Z=hZ.PROPER,Ey=gZ.BUGGY_SAFARI_ITERATORS,aR=er("iterator"),uM="keys",yy="values",hM="entries",vZ=function(){return this},pM=function(o,n,r,s,c,d,h){pZ(r,n,s);var f,g,_,E=function(G){if(G===c&&P)return P;if(!Ey&&G in A)return A[G];switch(G){case uM:case yy:case hM:return function(){return new r(this,G)}}return function(){return new r(this)}},T=n+" Iterator",w=!1,A=o.prototype,L=A[aR]||A["@@iterator"]||c&&A[c],P=!Ey&&L||E(c),D=n=="Array"&&A.entries||L;if(D&&(f=fZ(D.call(new o)))!==Object.prototype&&f.next&&(mZ(f,T,!0,!0),dM[T]=vZ),_Z&&c==yy&&L&&L.name!==yy&&(w=!0,P=function(){return uZ(L,this)}),c)if(g={values:E(yy),keys:d?P:E(uM),entries:E(hM)},h)for(_ in g)(Ey||w||!(_ in A))&&lM(A,_,g[_]);else dZ({target:n,proto:!0,forced:Ey||w},g);return h&&A[aR]!==P&&lM(A,aR,P,{name:c}),dM[n]=P,g},fM=function(o,n){return{value:o,done:n}},EZ=on,mM=up,gM=cp;Ce.f;var yZ=pM,_M=fM,vM="Array Iterator",SZ=gM.set,TZ=gM.getterFor(vM);yZ(Array,"Array",function(o,n){SZ(this,{type:vM,target:EZ(o),index:0,kind:n})},function(){var o=TZ(this),n=o.target,r=o.kind,s=o.index++;return!n||s>=n.length?(o.target=void 0,_M(void 0,!0)):_M(r=="keys"?s:r=="values"?n[s]:[s,n[s]],!1)},"values"),mM.Arguments=mM.Array;var bZ={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},CZ=U,wZ=$l,RZ=zl,EM=up,yM=er("toStringTag");for(var cR in bZ){var SM=CZ[cR],lR=SM&&SM.prototype;lR&&wZ(lR)!==yM&&RZ(lR,yM,cR),EM[cR]=EM.Array}var IZ=xQ,AZ=er,OZ=Ce.f,TM=AZ("metadata"),bM=Function.prototype;bM[TM]===void 0&&OZ(bM,TM,{value:null}),Kr("dispose"),Kr("metadata");var NZ=IZ;Kr("asyncDispose");var PZ=R,dR=$r("Symbol"),kZ=dR.keyFor,DZ=PZ(dR.prototype.valueOf),CM=dR.isRegisteredSymbol||function(o){try{return kZ(DZ(o))!==void 0}catch{return!1}};En({target:"Symbol",stat:!0},{isRegisteredSymbol:CM});for(var xZ=Bl,wM=$r,LZ=R,MZ=yu,UZ=er,Sy=wM("Symbol"),RM=Sy.isWellKnownSymbol,IM=wM("Object","getOwnPropertyNames"),jZ=LZ(Sy.prototype.valueOf),AM=xZ("wks"),uR=0,OM=IM(Sy),FZ=OM.length;uR<FZ;uR++)try{var NM=OM[uR];MZ(Sy[NM])&&UZ(NM)}catch{}var PM=function(o){if(RM&&RM(o))return!0;try{for(var n=jZ(o),r=0,s=IM(AM),c=s.length;r<c;r++)if(AM[s[r]]==n)return!0}catch{}return!1};En({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:PM}),Kr("matcher"),Kr("observable"),En({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:CM}),En({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:PM}),Kr("metadataKey"),Kr("patternMatch"),Kr("replaceAll");var hp=u(NZ),hR=R,VZ=_w,BZ=Bs,WZ=Ct,zZ=hR("".charAt),kM=hR("".charCodeAt),GZ=hR("".slice),DM=function(o){return function(n,r){var s,c,d=BZ(WZ(n)),h=VZ(r),f=d.length;return h<0||h>=f?o?"":void 0:(s=kM(d,h))<55296||s>56319||h+1===f||(c=kM(d,h+1))<56320||c>57343?o?zZ(d,h):s:o?GZ(d,h,h+2):c-56320+(s-55296<<10)+65536}},xM={codeAt:DM(!1),charAt:DM(!0)},HZ=xM.charAt,$Z=Bs,LM=cp,KZ=pM,MM=fM,UM="String Iterator",YZ=LM.set,qZ=LM.getterFor(UM);KZ(String,"String",function(o){YZ(this,{type:UM,string:$Z(o),index:0})},function(){var o,n=qZ(this),r=n.string,s=n.index;return s>=r.length?MM(void 0,!0):(o=HZ(r,s),n.index+=o.length,MM(o,!1))});var jM=u(sp.f("iterator"));function ag(o){return ag=typeof hp=="function"&&typeof jM=="symbol"?function(n){return typeof n}:function(n){return n&&typeof hp=="function"&&n.constructor===hp&&n!==hp.prototype?"symbol":typeof n},ag(o)}var JZ=u(sp.f("toPrimitive"));function XZ(o){var n=function(r,s){if(ag(r)!=="object"||r===null)return r;var c=r[JZ];if(c!==void 0){var d=c.call(r,s);if(ag(d)!=="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}(o,"string");return ag(n)==="symbol"?n:String(n)}function I(o,n,r){return(n=XZ(n))in o?cJ(o,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[n]=r,o}var QZ=Hl("Array").keys,ZZ=$l,eee=ci,tee=N,nee=QZ,pR=Array.prototype,ree={DOMTokenList:!0,NodeList:!0},jo=u(function(o){var n=o.keys;return o===pR||tee(pR,o)&&n===pR.keys||eee(ree,ZZ(o))?nee:n}),FM=Fl,iee=TypeError,VM=Vw,oee=Math.floor,fR=function(o,n){var r=o.length,s=oee(r/2);return r<8?see(o,n):aee(o,fR(VM(o,0,s),n),fR(VM(o,s),n),n)},see=function(o,n){for(var r,s,c=o.length,d=1;d<c;){for(s=d,r=o[d];s&&n(o[s-1],r)>0;)o[s]=o[--s];s!==d++&&(o[s]=r)}return o},aee=function(o,n,r,s){for(var c=n.length,d=r.length,h=0,f=0;h<c||f<d;)o[h+f]=h<c&&f<d?s(n[h],r[f])<=0?n[h++]:r[f++]:h<c?n[h++]:r[f++];return o},BM=fR,cee=p,mR=function(o,n){var r=[][o];return!!r&&cee(function(){r.call(null,n||function(){return 1},1)})},WM=Fi.match(/firefox\/(\d+)/i),lee=!!WM&&+WM[1],dee=/MSIE|Trident/.test(Fi),zM=Fi.match(/AppleWebKit\/(\d+)\./),uee=!!zM&&+zM[1],hee=En,GM=R,pee=Mo,fee=Vs,HM=Gl,mee=function(o,n){if(!delete o[n])throw iee("Cannot delete property "+FM(n)+" of "+FM(o))},$M=Bs,gR=p,gee=BM,_ee=mR,KM=lee,vee=dee,YM=et,qM=uee,Xl=[],JM=GM(Xl.sort),Eee=GM(Xl.push),yee=gR(function(){Xl.sort(void 0)}),See=gR(function(){Xl.sort(null)}),Tee=_ee("sort"),XM=!gR(function(){if(YM)return YM<70;if(!(KM&&KM>3)){if(vee)return!0;if(qM)return qM<603;var o,n,r,s,c="";for(o=65;o<76;o++){switch(n=String.fromCharCode(o),o){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(s=0;s<47;s++)Xl.push({k:n+s,v:r})}for(Xl.sort(function(d,h){return h.v-d.v}),s=0;s<Xl.length;s++)n=Xl[s].k.charAt(0),c.charAt(c.length-1)!==n&&(c+=n);return c!=="DGBEFHACIJK"}});hee({target:"Array",proto:!0,forced:yee||!See||!Tee||!XM},{sort:function(o){o!==void 0&&pee(o);var n=fee(this);if(XM)return o===void 0?JM(n):JM(n,o);var r,s,c=[],d=HM(n);for(s=0;s<d;s++)s in n&&Eee(c,n[s]);for(gee(c,function(h){return function(f,g){return g===void 0?-1:f===void 0?1:h!==void 0?+h(f,g)||0:$M(f)>$M(g)?1:-1}}(o)),r=HM(c),s=0;s<r;)n[s]=c[s++];for(;s<d;)mee(n,s++);return n}});var bee=Hl("Array").sort,Cee=N,wee=bee,_R=Array.prototype,cg=u(function(o){var n=o.sort;return o===_R||Cee(_R,o)&&n===_R.sort?wee:n}),Ree=$r,Iee=cy,Aee=tg,Oee=Bt,Nee=R([].concat),Pee=Ree("Reflect","ownKeys")||function(o){var n=Iee.f(Oee(o)),r=Aee.f;return r?Nee(n,r(o)):n},QM=ci,kee=Pee,Dee=Ie,xee=Ce,Lee=br,Mee=zl,ZM=Error,Uee=R("".replace),jee=String(ZM("zxcasd").stack),eU=/\n\s*at [^:]*:[^\n]*/,Fee=eU.test(jee),Vee=kt,Bee=!p(function(){var o=Error("a");return!("stack"in o)||(Object.defineProperty(o,"stack",Vee(1,7)),o.stack!==7)}),Wee=zl,zee=function(o,n){if(Fee&&typeof o=="string"&&!ZM.prepareStackTrace)for(;n--;)o=Uee(o,eU,"");return o},Gee=Bee,tU=Error.captureStackTrace,Hee=up,$ee=er("iterator"),Kee=Array.prototype,nU=function(o){return o!==void 0&&(Hee.Array===o||Kee[$ee]===o)},Yee=$l,rU=jm,qee=bt,Jee=up,Xee=er("iterator"),Ty=function(o){if(!qee(o))return rU(o,Xee)||rU(o,"@@iterator")||Jee[Yee(o)]},Qee=be,Zee=Mo,ete=Bt,tte=Fl,nte=Ty,rte=TypeError,vR=function(o,n){var r=arguments.length<2?nte(o):n;if(Zee(r))return ete(Qee(r,o));throw rte(tte(o)+" is not iterable")},ite=be,iU=Bt,ote=jm,oU=function(o,n,r){var s,c;iU(o);try{if(!(s=ote(o,"return"))){if(n==="throw")throw r;return r}s=ite(s,o)}catch(d){c=!0,s=d}if(n==="throw")throw r;if(c)throw s;return iU(s),r},ste=ge,ate=be,cte=Bt,lte=Fl,dte=nU,ute=Gl,sU=N,hte=vR,pte=Ty,aU=oU,fte=TypeError,by=function(o,n){this.stopped=o,this.result=n},cU=by.prototype,lg=function(o,n,r){var s,c,d,h,f,g,_,E=r&&r.that,T=!(!r||!r.AS_ENTRIES),w=!(!r||!r.IS_RECORD),A=!(!r||!r.IS_ITERATOR),L=!(!r||!r.INTERRUPTED),P=ste(n,E),D=function($){return s&&aU(s,"normal",$),new by(!0,$)},G=function($){return T?(cte($),L?P($[0],$[1],D):P($[0],$[1])):L?P($,D):P($)};if(w)s=o.iterator;else if(A)s=o;else{if(!(c=pte(o)))throw fte(lte(o)+" is not iterable");if(dte(c)){for(d=0,h=ute(o);h>d;d++)if((f=G(o[d]))&&sU(cU,f))return f;return new by(!1)}s=hte(o,c)}for(g=w?o.next:s.next;!(_=ate(g,s)).done;){try{f=G(_.value)}catch($){aU(s,"throw",$)}if(typeof f=="object"&&f&&sU(cU,f))return f}return new by(!1)},mte=Bs,gte=En,_te=N,vte=oR,Cy=lZ,Ete=function(o,n,r){for(var s=kee(n),c=xee.f,d=Dee.f,h=0;h<s.length;h++){var f=s[h];QM(o,f)||r&&QM(r,f)||c(o,f,d(n,f))}},lU=eg,ER=zl,yR=kt,yte=function(o,n){Lee(n)&&"cause"in n&&Mee(o,"cause",n.cause)},Ste=function(o,n,r,s){Gee&&(tU?tU(o,n):Wee(o,"stack",zee(r,s)))},Tte=lg,bte=function(o,n){return o===void 0?arguments.length<2?"":n:mte(o)},Cte=er("toStringTag"),wy=Error,wte=[].push,pp=function(o,n){var r,s=_te(SR,this);Cy?r=Cy(wy(),s?vte(this):SR):(r=s?this:lU(SR),ER(r,Cte,"Error")),n!==void 0&&ER(r,"message",bte(n)),Ste(r,pp,r.stack,1),arguments.length>2&&yte(r,arguments[2]);var c=[];return Tte(o,wte,{that:c}),ER(r,"errors",c),r};Cy?Cy(pp,wy):Ete(pp,wy,{name:!0});var SR=pp.prototype=lU(wy.prototype,{constructor:yR(1,pp),message:yR(1,""),name:yR(1,"AggregateError")});gte({global:!0,constructor:!0,arity:2},{AggregateError:pp});var dg,fp,dU,TR,ug=typeof process<"u"&&se(process)=="process",Rte=$r,Ite=ly,Ate=Te,uU=er("species"),Ote=N,Nte=TypeError,bR=function(o,n){if(Ote(n,o))return o;throw Nte("Incorrect invocation")},Pte=Dw,kte=Fl,Dte=TypeError,hU=Bt,xte=function(o){if(Pte(o))return o;throw Dte(kte(o)+" is not a constructor")},Lte=bt,Mte=er("species"),pU=function(o,n){var r,s=hU(o).constructor;return s===void 0||Lte(r=hU(s)[Mte])?n:xte(r)},Ute=TypeError,Ry=function(o,n){if(o<n)throw Ute("Not enough arguments");return o},fU=/(?:ipad|iphone|ipod).*applewebkit/i.test(Fi),fs=U,jte=H,Fte=ge,mU=Oe,Vte=ci,gU=p,_U=t2,Bte=j2,vU=Km,Wte=Ry,zte=fU,Gte=ug,CR=fs.setImmediate,wR=fs.clearImmediate,Hte=fs.process,RR=fs.Dispatch,$te=fs.Function,EU=fs.MessageChannel,Kte=fs.String,IR=0,hg={},yU="onreadystatechange";gU(function(){dg=fs.location});var AR=function(o){if(Vte(hg,o)){var n=hg[o];delete hg[o],n()}},OR=function(o){return function(){AR(o)}},SU=function(o){AR(o.data)},TU=function(o){fs.postMessage(Kte(o),dg.protocol+"//"+dg.host)};CR&&wR||(CR=function(o){Wte(arguments.length,1);var n=mU(o)?o:$te(o),r=Bte(arguments,1);return hg[++IR]=function(){jte(n,void 0,r)},fp(IR),IR},wR=function(o){delete hg[o]},Gte?fp=function(o){Hte.nextTick(OR(o))}:RR&&RR.now?fp=function(o){RR.now(OR(o))}:EU&&!zte?(TR=(dU=new EU).port2,dU.port1.onmessage=SU,fp=Fte(TR.postMessage,TR)):fs.addEventListener&&mU(fs.postMessage)&&!fs.importScripts&&dg&&dg.protocol!=="file:"&&!gU(TU)?(fp=TU,fs.addEventListener("message",SU,!1)):fp=yU in vU("script")?function(o){_U.appendChild(vU("script"))[yU]=function(){_U.removeChild(this),AR(o)}}:function(o){setTimeout(OR(o),0)});var bU={set:CR,clear:wR},CU=function(){this.head=null,this.tail=null};CU.prototype={add:function(o){var n={item:o,next:null},r=this.tail;r?r.next=n:this.head=n,this.tail=n},get:function(){var o=this.head;if(o)return(this.head=o.next)===null&&(this.tail=null),o.item}};var mp,NR,PR,kR,wU,RU=CU,Yte=/ipad|iphone|ipod/i.test(Fi)&&typeof Pebble<"u",qte=/web0s(?!.*chrome)/i.test(Fi),Au=U,IU=ge,Jte=Ie.f,DR=bU.set,Xte=RU,Qte=fU,Zte=Yte,ene=qte,xR=ug,AU=Au.MutationObserver||Au.WebKitMutationObserver,OU=Au.document,NU=Au.process,Iy=Au.Promise,PU=Jte(Au,"queueMicrotask"),LR=PU&&PU.value;if(!LR){var Ay=new Xte,Oy=function(){var o,n;for(xR&&(o=NU.domain)&&o.exit();n=Ay.get();)try{n()}catch(r){throw Ay.head&&mp(),r}o&&o.enter()};Qte||xR||ene||!AU||!OU?!Zte&&Iy&&Iy.resolve?((kR=Iy.resolve(void 0)).constructor=Iy,wU=IU(kR.then,kR),mp=function(){wU(Oy)}):xR?mp=function(){NU.nextTick(Oy)}:(DR=IU(DR,Au),mp=function(){DR(Oy)}):(NR=!0,PR=OU.createTextNode(""),new AU(Oy).observe(PR,{characterData:!0}),mp=function(){PR.data=NR=!NR}),LR=function(o){Ay.head||mp(),Ay.add(o)}}var tne=LR,gp=function(o){try{return{error:!1,value:o()}}catch(n){return{error:!0,value:n}}},Ou=U.Promise,kU=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",nne=!kU&&!ug&&typeof window=="object"&&typeof document=="object",rne=U,pg=Ou,ine=Oe,one=KE,sne=WL,ane=er,cne=nne,lne=kU,MR=et,DU=pg&&pg.prototype,dne=ane("species"),xU=!1,LU=ine(rne.PromiseRejectionEvent),une=one("Promise",function(){var o=sne(pg),n=o!==String(pg);if(!n&&MR===66||!DU.catch||!DU.finally)return!0;if(!MR||MR<51||!/native code/.test(o)){var r=new pg(function(c){c(1)}),s=function(c){c(function(){},function(){})};if((r.constructor={})[dne]=s,!(xU=r.then(function(){})instanceof s))return!0}return!n&&(cne||lne)&&!LU}),fg={CONSTRUCTOR:une,REJECTION_EVENT:LU,SUBCLASSING:xU},Ja={},MU=Mo,hne=TypeError,pne=function(o){var n,r;this.promise=new o(function(s,c){if(n!==void 0||r!==void 0)throw hne("Bad Promise constructor");n=s,r=c}),this.resolve=MU(n),this.reject=MU(r)};Ja.f=function(o){return new pne(o)};var UR,UU,fne=En,Ny=ug,Ql=U,mg=be,mne=Kl,gne=Yl,_ne=function(o){var n=Rte(o);Ate&&n&&!n[uU]&&Ite(n,uU,{configurable:!0,get:function(){return this}})},vne=Mo,jR=Oe,Ene=br,yne=bR,Sne=pU,jU=bU.set,FR=tne,Tne=function(o,n){try{arguments.length==1?console.error(o):console.error(o,n)}catch{}},bne=gp,Cne=RU,FU=cp,VR=Ou,VU=fg,BU=Ja,Py="Promise",WU=VU.CONSTRUCTOR,wne=VU.REJECTION_EVENT,BR=FU.getterFor(Py),Rne=FU.set,Ine=VR&&VR.prototype,gg=VR,WR=Ine,zU=Ql.TypeError,zR=Ql.document,GR=Ql.process,HR=BU.f,Ane=HR,One=!!(zR&&zR.createEvent&&Ql.dispatchEvent),GU="unhandledrejection",HU=function(o){var n;return!(!Ene(o)||!jR(n=o.then))&&n},$U=function(o,n){var r,s,c,d=n.value,h=n.state==1,f=h?o.ok:o.fail,g=o.resolve,_=o.reject,E=o.domain;try{f?(h||(n.rejection===2&&Pne(n),n.rejection=1),f===!0?r=d:(E&&E.enter(),r=f(d),E&&(E.exit(),c=!0)),r===o.promise?_(zU("Promise-chain cycle")):(s=HU(r))?mg(s,r,g,_):g(r)):_(d)}catch(T){E&&!c&&E.exit(),_(T)}},KU=function(o,n){o.notified||(o.notified=!0,FR(function(){for(var r,s=o.reactions;r=s.get();)$U(r,o);o.notified=!1,n&&!o.rejection&&Nne(o)}))},YU=function(o,n,r){var s,c;One?((s=zR.createEvent("Event")).promise=n,s.reason=r,s.initEvent(o,!1,!0),Ql.dispatchEvent(s)):s={promise:n,reason:r},!wne&&(c=Ql["on"+o])?c(s):o===GU&&Tne("Unhandled promise rejection",r)},Nne=function(o){mg(jU,Ql,function(){var n,r=o.facade,s=o.value;if(qU(o)&&(n=bne(function(){Ny?GR.emit("unhandledRejection",s,r):YU(GU,r,s)}),o.rejection=Ny||qU(o)?2:1,n.error))throw n.value})},qU=function(o){return o.rejection!==1&&!o.parent},Pne=function(o){mg(jU,Ql,function(){var n=o.facade;Ny?GR.emit("rejectionHandled",n):YU("rejectionhandled",n,o.value)})},_p=function(o,n,r){return function(s){o(n,s,r)}},vp=function(o,n,r){o.done||(o.done=!0,r&&(o=r),o.value=n,o.state=2,KU(o,!0))},$R=function(o,n,r){if(!o.done){o.done=!0,r&&(o=r);try{if(o.facade===n)throw zU("Promise can't be resolved itself");var s=HU(n);s?FR(function(){var c={done:!1};try{mg(s,n,_p($R,c,o),_p(vp,c,o))}catch(d){vp(c,d,o)}}):(o.value=n,o.state=1,KU(o,!1))}catch(c){vp({done:!1},c,o)}}};WU&&(WR=(gg=function(o){yne(this,WR),vne(o),mg(UR,this);var n=BR(this);try{o(_p($R,n),_p(vp,n))}catch(r){vp(n,r)}}).prototype,(UR=function(o){Rne(this,{type:Py,done:!1,notified:!1,parent:!1,reactions:new Cne,rejection:!1,state:0,value:void 0})}).prototype=mne(WR,"then",function(o,n){var r=BR(this),s=HR(Sne(this,gg));return r.parent=!0,s.ok=!jR(o)||o,s.fail=jR(n)&&n,s.domain=Ny?GR.domain:void 0,r.state==0?r.reactions.add(s):FR(function(){$U(s,r)}),s.promise}),UU=function(){var o=new UR,n=BR(o);this.promise=o,this.resolve=_p($R,n),this.reject=_p(vp,n)},BU.f=HR=function(o){return o===gg||o===void 0?new UU(o):Ane(o)}),fne({global:!0,constructor:!0,wrap:!0,forced:WU},{Promise:gg}),gne(gg,Py,!1,!0),_ne(Py);var JU=er("iterator"),XU=!1;try{var kne=0,QU={next:function(){return{done:!!kne++}},return:function(){XU=!0}};QU[JU]=function(){return this},Array.from(QU,function(){throw 2})}catch{}var Dne=Ou,xne=function(o,n){if(!XU)return!1;var r=!1;try{var s={};s[JU]=function(){return{next:function(){return{done:r=!0}}}},o(s)}catch{}return r},ky=fg.CONSTRUCTOR||!xne(function(o){Dne.all(o).then(void 0,function(){})}),Lne=be,Mne=Mo,Une=Ja,jne=gp,Fne=lg;En({target:"Promise",stat:!0,forced:ky},{all:function(o){var n=this,r=Une.f(n),s=r.resolve,c=r.reject,d=jne(function(){var h=Mne(n.resolve),f=[],g=0,_=1;Fne(o,function(E){var T=g++,w=!1;_++,Lne(h,n,E).then(function(A){w||(w=!0,f[T]=A,--_||s(f))},c)}),--_||s(f)});return d.error&&c(d.value),r.promise}});var Vne=En,Bne=fg.CONSTRUCTOR;Ou&&Ou.prototype,Vne({target:"Promise",proto:!0,forced:Bne,real:!0},{catch:function(o){return this.then(void 0,o)}});var Wne=be,zne=Mo,Gne=Ja,Hne=gp,$ne=lg;En({target:"Promise",stat:!0,forced:ky},{race:function(o){var n=this,r=Gne.f(n),s=r.reject,c=Hne(function(){var d=zne(n.resolve);$ne(o,function(h){Wne(d,n,h).then(r.resolve,s)})});return c.error&&s(c.value),r.promise}});var Kne=be,Yne=Ja;En({target:"Promise",stat:!0,forced:fg.CONSTRUCTOR},{reject:function(o){var n=Yne.f(this);return Kne(n.reject,void 0,o),n.promise}});var qne=Bt,Jne=br,Xne=Ja,ZU=function(o,n){if(qne(o),Jne(n)&&n.constructor===o)return n;var r=Xne.f(o);return(0,r.resolve)(n),r.promise},Qne=En,Zne=Ou,ere=fg.CONSTRUCTOR,tre=ZU,nre=$r("Promise"),rre=!ere;Qne({target:"Promise",stat:!0,forced:!0},{resolve:function(o){return tre(rre&&this===nre?Zne:this,o)}});var ire=be,ore=Mo,sre=Ja,are=gp,cre=lg;En({target:"Promise",stat:!0,forced:ky},{allSettled:function(o){var n=this,r=sre.f(n),s=r.resolve,c=r.reject,d=are(function(){var h=ore(n.resolve),f=[],g=0,_=1;cre(o,function(E){var T=g++,w=!1;_++,ire(h,n,E).then(function(A){w||(w=!0,f[T]={status:"fulfilled",value:A},--_||s(f))},function(A){w||(w=!0,f[T]={status:"rejected",reason:A},--_||s(f))})}),--_||s(f)});return d.error&&c(d.value),r.promise}});var lre=be,dre=Mo,ure=$r,hre=Ja,pre=gp,fre=lg,ej="No one promise resolved";En({target:"Promise",stat:!0,forced:ky},{any:function(o){var n=this,r=ure("AggregateError"),s=hre.f(n),c=s.resolve,d=s.reject,h=pre(function(){var f=dre(n.resolve),g=[],_=0,E=1,T=!1;fre(o,function(w){var A=_++,L=!1;E++,lre(f,n,w).then(function(P){L||T||(T=!0,c(P))},function(P){L||T||(L=!0,g[A]=P,--E||d(new r(g,ej)))})}),--E||d(new r(g,ej))});return h.error&&d(h.value),s.promise}});var mre=En,KR=Ou,gre=p,_re=$r,vre=Oe,Ere=pU,tj=ZU,yre=KR&&KR.prototype;mre({target:"Promise",proto:!0,real:!0,forced:!!KR&&gre(function(){yre.finally.call({then:function(){}},function(){})})},{finally:function(o){var n=Ere(this,_re("Promise")),r=vre(o);return this.then(r?function(s){return tj(n,o()).then(function(){return s})}:o,r?function(s){return tj(n,o()).then(function(){throw s})}:o)}});var nj=Jr.Promise,ae=u(nj);const Sre=()=>{};function _g(){const o={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:Sre};return o.promise=new ae((n,r)=>{o.resolve=s=>{o.isFinished||(o.isResolved=!0,o.isFinished=!0,n(s),o.value=s)},o.reject=s=>{o.isFinished||(o.isRejected=!0,o.isFinished=!0,r(s))}}),o}const Dy=new Map,xy=new Map,Xa=new Map;var fr,Ft;(function(o){o.WIN_10="Windows 10",o.WIN_81="Windows 8.1",o.WIN_8="Windows 8",o.WIN_7="Windows 7",o.WIN_VISTA="Windows Vista",o.WIN_SERVER_2003="Windows Server 2003",o.WIN_XP="Windows XP",o.WIN_2000="Windows 2000",o.ANDROID="Android",o.HARMONY_OS="HarmonyOS",o.OPEN_BSD="Open BSD",o.SUN_OS="Sun OS",o.LINUX="Linux",o.IOS="iOS",o.MAC_OS="Mac OS",o.CHROMIUM_OS="Chromium OS",o.QNX="QNX",o.UNIX="UNIX",o.BEOS="BeOS",o.OS_2="OS/2",o.SEARCH_BOT="Search Bot"})(fr||(fr={})),function(o){o.CHROME="Chrome",o.SAFARI="Safari",o.EDGE="Edge",o.FIREFOX="Firefox",o.OPERA="OPR",o.QQ="QQBrowser",o.WECHAT="MicroMessenger"}(Ft||(Ft={}));var YR={exports:{}};(function(o,n){(function(r,s){var c="function",d="undefined",h="object",f="string",g="major",_="model",E="name",T="type",w="vendor",A="version",L="architecture",P="console",D="mobile",G="tablet",$="smarttv",X="wearable",ie="embedded",Q="Amazon",te="Apple",ce="ASUS",le="BlackBerry",Se="Browser",Ae="Chrome",st="Firefox",gt="Google",nn="Huawei",dr="LG",un="Microsoft",Ro="Motorola",ve="Opera",we="Samsung",Ve="Sharp",it="Sony",Mt="Xiaomi",Ne="Zebra",k="Facebook",K="Chromium OS",J="Mac OS",ye=function(Vn){for(var ur={},hn=0;hn<Vn.length;hn++)ur[Vn[hn].toUpperCase()]=Vn[hn];return ur},at=function(Vn,ur){return typeof Vn===f&&an(ur).indexOf(an(Vn))!==-1},an=function(Vn){return Vn.toLowerCase()},ri=function(Vn,ur){if(typeof Vn===f)return Vn=Vn.replace(/^\s\s*/,""),typeof ur===d?Vn:Vn.substring(0,350)},Io=function(Vn,ur){for(var hn,Ao,mc,Bn,Ut,oo,Pd=0;Pd<ur.length&&!Ut;){var Ma=ur[Pd],X4=ur[Pd+1];for(hn=Ao=0;hn<Ma.length&&!Ut&&Ma[hn];)if(Ut=Ma[hn++].exec(Vn))for(mc=0;mc<X4.length;mc++)oo=Ut[++Ao],typeof(Bn=X4[mc])===h&&Bn.length>0?Bn.length===2?typeof Bn[1]==c?this[Bn[0]]=Bn[1].call(this,oo):this[Bn[0]]=Bn[1]:Bn.length===3?typeof Bn[1]!==c||Bn[1].exec&&Bn[1].test?this[Bn[0]]=oo?oo.replace(Bn[1],Bn[2]):s:this[Bn[0]]=oo?Bn[1].call(this,oo,Bn[2]):s:Bn.length===4&&(this[Bn[0]]=oo?Bn[3].call(this,oo.replace(Bn[1],Bn[2])):s):this[Bn]=oo||s;Pd+=2}},dl=function(Vn,ur){for(var hn in ur)if(typeof ur[hn]===h&&ur[hn].length>0){for(var Ao=0;Ao<ur[hn].length;Ao++)if(at(ur[hn][Ao],Vn))return hn==="?"?s:hn}else if(at(ur[hn],Vn))return hn==="?"?s:hn;return Vn},cS={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},lS={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[A,[E,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[A,[E,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[E,A],[/opios[\/ ]+([\w\.]+)/i],[A,[E,ve+" Mini"]],[/\bopr\/([\w\.]+)/i],[A,[E,ve]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[E,A],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[A,[E,"UC"+Se]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[A,[E,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[A,[E,"WeChat"]],[/konqueror\/([\w\.]+)/i],[A,[E,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[A,[E,"IE"]],[/yabrowser\/([\w\.]+)/i],[A,[E,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[E,/(.+)/,"$1 Secure "+Se],A],[/\bfocus\/([\w\.]+)/i],[A,[E,st+" Focus"]],[/\bopt\/([\w\.]+)/i],[A,[E,ve+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[A,[E,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[A,[E,"Dolphin"]],[/coast\/([\w\.]+)/i],[A,[E,ve+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[A,[E,"MIUI "+Se]],[/fxios\/([-\w\.]+)/i],[A,[E,st]],[/\bqihu|(qi?ho?o?|360)browser/i],[[E,"360 "+Se]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[E,/(.+)/,"$1 "+Se],A],[/(comodo_dragon)\/([\w\.]+)/i],[[E,/_/g," "],A],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[E,A],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[E],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[E,k],A],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[E,A],[/\bgsa\/([\w\.]+) .*safari\//i],[A,[E,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[A,[E,Ae+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[E,Ae+" WebView"],A],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[A,[E,"Android "+Se]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[E,A],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[A,[E,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[A,E],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[E,[A,dl,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[E,A],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[E,"Netscape"],A],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[A,[E,st+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[E,A],[/(cobalt)\/([\w\.]+)/i],[E,[A,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[L,"amd64"]],[/(ia32(?=;))/i],[[L,an]],[/((?:i[346]|x)86)[;\)]/i],[[L,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[L,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[L,"armhf"]],[/windows (ce|mobile); ppc;/i],[[L,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[L,/ower/,"",an]],[/(sun4\w)[;\)]/i],[[L,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[L,an]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[_,[w,we],[T,G]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[_,[w,we],[T,D]],[/\((ip(?:hone|od)[\w ]*);/i],[_,[w,te],[T,D]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[_,[w,te],[T,G]],[/(macintosh);/i],[_,[w,te]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[_,[w,Ve],[T,D]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[_,[w,nn],[T,G]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[_,[w,nn],[T,D]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[_,/_/g," "],[w,Mt],[T,D]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[_,/_/g," "],[w,Mt],[T,G]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[_,[w,"OPPO"],[T,D]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[_,[w,"Vivo"],[T,D]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[_,[w,"Realme"],[T,D]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[_,[w,Ro],[T,D]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[_,[w,Ro],[T,G]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[_,[w,dr],[T,G]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[_,[w,dr],[T,D]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[_,[w,"Lenovo"],[T,G]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[_,/_/g," "],[w,"Nokia"],[T,D]],[/(pixel c)\b/i],[_,[w,gt],[T,G]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[_,[w,gt],[T,D]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[_,[w,it],[T,D]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[_,"Xperia Tablet"],[w,it],[T,G]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[_,[w,"OnePlus"],[T,D]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[_,[w,Q],[T,G]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[_,/(.+)/g,"Fire Phone $1"],[w,Q],[T,D]],[/(playbook);[-\w\),; ]+(rim)/i],[_,w,[T,G]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[_,[w,le],[T,D]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[_,[w,ce],[T,G]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[_,[w,ce],[T,D]],[/(nexus 9)/i],[_,[w,"HTC"],[T,G]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[w,[_,/_/g," "],[T,D]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[_,[w,"Acer"],[T,G]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[_,[w,"Meizu"],[T,D]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[w,_,[T,D]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[w,_,[T,G]],[/(surface duo)/i],[_,[w,un],[T,G]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[_,[w,"Fairphone"],[T,D]],[/(u304aa)/i],[_,[w,"AT&T"],[T,D]],[/\bsie-(\w*)/i],[_,[w,"Siemens"],[T,D]],[/\b(rct\w+) b/i],[_,[w,"RCA"],[T,G]],[/\b(venue[\d ]{2,7}) b/i],[_,[w,"Dell"],[T,G]],[/\b(q(?:mv|ta)\w+) b/i],[_,[w,"Verizon"],[T,G]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[_,[w,"Barnes & Noble"],[T,G]],[/\b(tm\d{3}\w+) b/i],[_,[w,"NuVision"],[T,G]],[/\b(k88) b/i],[_,[w,"ZTE"],[T,G]],[/\b(nx\d{3}j) b/i],[_,[w,"ZTE"],[T,D]],[/\b(gen\d{3}) b.+49h/i],[_,[w,"Swiss"],[T,D]],[/\b(zur\d{3}) b/i],[_,[w,"Swiss"],[T,G]],[/\b((zeki)?tb.*\b) b/i],[_,[w,"Zeki"],[T,G]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[w,"Dragon Touch"],_,[T,G]],[/\b(ns-?\w{0,9}) b/i],[_,[w,"Insignia"],[T,G]],[/\b((nxa|next)-?\w{0,9}) b/i],[_,[w,"NextBook"],[T,G]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[w,"Voice"],_,[T,D]],[/\b(lvtel\-)?(v1[12]) b/i],[[w,"LvTel"],_,[T,D]],[/\b(ph-1) /i],[_,[w,"Essential"],[T,D]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[_,[w,"Envizen"],[T,G]],[/\b(trio[-\w\. ]+) b/i],[_,[w,"MachSpeed"],[T,G]],[/\btu_(1491) b/i],[_,[w,"Rotor"],[T,G]],[/(shield[\w ]+) b/i],[_,[w,"Nvidia"],[T,G]],[/(sprint) (\w+)/i],[w,_,[T,D]],[/(kin\.[onetw]{3})/i],[[_,/\./g," "],[w,un],[T,D]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[_,[w,Ne],[T,G]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[_,[w,Ne],[T,D]],[/smart-tv.+(samsung)/i],[w,[T,$]],[/hbbtv.+maple;(\d+)/i],[[_,/^/,"SmartTV"],[w,we],[T,$]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[w,dr],[T,$]],[/(apple) ?tv/i],[w,[_,te+" TV"],[T,$]],[/crkey/i],[[_,Ae+"cast"],[w,gt],[T,$]],[/droid.+aft(\w)( bui|\))/i],[_,[w,Q],[T,$]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[_,[w,Ve],[T,$]],[/(bravia[\w ]+)( bui|\))/i],[_,[w,it],[T,$]],[/(mitv-\w{5}) bui/i],[_,[w,Mt],[T,$]],[/Hbbtv.*(technisat) (.*);/i],[w,_,[T,$]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[w,ri],[_,ri],[T,$]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[T,$]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[w,_,[T,P]],[/droid.+; (shield) bui/i],[_,[w,"Nvidia"],[T,P]],[/(playstation [345portablevi]+)/i],[_,[w,it],[T,P]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[_,[w,un],[T,P]],[/((pebble))app/i],[w,_,[T,X]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[_,[w,te],[T,X]],[/droid.+; (glass) \d/i],[_,[w,gt],[T,X]],[/droid.+; (wt63?0{2,3})\)/i],[_,[w,Ne],[T,X]],[/(quest( 2| pro)?)/i],[_,[w,k],[T,X]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[w,[T,ie]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[_,[T,D]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[_,[T,G]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[T,G]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[T,D]],[/(android[-\w\. ]{0,9});.+buil/i],[_,[w,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[A,[E,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[A,[E,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[E,A],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[A,E]],os:[[/microsoft (windows) (vista|xp)/i],[E,A],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[E,[A,dl,cS]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[E,"Windows"],[A,dl,cS]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[A,/_/g,"."],[E,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[E,J],[A,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[A,E],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[E,A],[/\(bb(10);/i],[A,[E,le]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[A,[E,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[A,[E,st+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[A,[E,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[A,[E,"watchOS"]],[/crkey\/([\d\.]+)/i],[A,[E,Ae+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[E,K],A],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[E,A],[/(sunos) ?([\w\.\d]*)/i],[[E,"Solaris"],A],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[E,A]]},Cs=function(Vn,ur){if(typeof Vn===h&&(ur=Vn,Vn=s),!(this instanceof Cs))return new Cs(Vn,ur).getResult();var hn=typeof r!==d&&r.navigator?r.navigator:s,Ao=Vn||(hn&&hn.userAgent?hn.userAgent:""),mc=hn&&hn.userAgentData?hn.userAgentData:s,Bn=ur?function(Ut,oo){var Pd={};for(var Ma in Ut)oo[Ma]&&oo[Ma].length%2==0?Pd[Ma]=oo[Ma].concat(Ut[Ma]):Pd[Ma]=Ut[Ma];return Pd}(lS,ur):lS;return this.getBrowser=function(){var Ut={};return Ut[E]=s,Ut[A]=s,Io.call(Ut,Ao,Bn.browser),Ut[g]=function(oo){return typeof oo===f?oo.replace(/[^\d\.]/g,"").split(".")[0]:s}(Ut[A]),hn&&hn.brave&&typeof hn.brave.isBrave==c&&(Ut[E]="Brave"),Ut},this.getCPU=function(){var Ut={};return Ut[L]=s,Io.call(Ut,Ao,Bn.cpu),Ut},this.getDevice=function(){var Ut={};return Ut[w]=s,Ut[_]=s,Ut[T]=s,Io.call(Ut,Ao,Bn.device),!Ut[T]&&mc&&mc.mobile&&(Ut[T]=D),Ut[_]=="Macintosh"&&hn&&typeof hn.standalone!==d&&hn.maxTouchPoints&&hn.maxTouchPoints>2&&(Ut[_]="iPad",Ut[T]=G),Ut},this.getEngine=function(){var Ut={};return Ut[E]=s,Ut[A]=s,Io.call(Ut,Ao,Bn.engine),Ut},this.getOS=function(){var Ut={};return Ut[E]=s,Ut[A]=s,Io.call(Ut,Ao,Bn.os),!Ut[E]&&mc&&mc.platform!="Unknown"&&(Ut[E]=mc.platform.replace(/chrome os/i,K).replace(/macos/i,J)),Ut},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Ao},this.setUA=function(Ut){return Ao=typeof Ut===f&&Ut.length>350?ri(Ut,350):Ut,this},this.setUA(Ao),this};Cs.VERSION="0.7.34",Cs.BROWSER=ye([E,A,g]),Cs.CPU=ye([L]),Cs.DEVICE=ye([_,w,T,P,D,$,G,X,ie]),Cs.ENGINE=Cs.OS=ye([E,A]),o.exports&&(n=o.exports=Cs),n.UAParser=Cs;var Nd=typeof r!==d&&(r.jQuery||r.Zepto);if(Nd&&!Nd.ua){var af=new Cs;Nd.ua=af.getResult(),Nd.ua.get=function(){return af.getUA()},Nd.ua.set=function(Vn){af.setUA(Vn);var ur=af.getResult();for(var hn in ur)Nd.ua[hn]=ur[hn]}}})(typeof window=="object"?window:l)})(YR,YR.exports);const rj=new(u(YR.exports));let Gc=rj.getResult(),qR=null;function xt(o){if(!qR){Gc=rj.getResult();const n=function(d){if(d.engine.name==="Blink"&&d.browser.name!=="WeChat")return Ft.CHROME;switch(d.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return Ft.CHROME;case"Safari":case"Mobile Safari":return Ft.SAFARI;case"Edge":return Ft.EDGE;case"Firefox":return Ft.FIREFOX;case"QQBrowser":return Ft.QQ;case"Opera":return Ft.OPERA;case"WeChat":return Ft.WECHAT;default:return d.browser.name||""}}(Gc),r=function(d){let h;return h=d.engine.name==="Blink"?d.engine.version||"":d.browser.version||"",h.split(".")[0]}(Gc),s=function(d){return d.os.name==="Windows"?d.os.version?d.os.name+" "+d.os.version:d.os.name:d.os.name||""}(Gc),c=Gc.os.version;if(!(n&&r&&s&&c))return{name:n,version:r,os:s,osVersion:c};qR={name:n,version:r,os:s,osVersion:c}}return qR}function Ly(){return xt().os}function ij(){const o=xt();return"".concat(o.os," ").concat(o.osVersion)}function My(){const o=xt();return!!(Gc.engine.name==="WebKit"&&o.os===fr.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&o.name!==Ft.SAFARI||Ti()&&o.name!==Ft.SAFARI)}function Tre(){const o=xt();if(My()){if(o.os===fr.MAC_OS)return!0;if(o.os===fr.IOS){const n=Gc.os.version&&Gc.os.version.split(".");if(n&&Number(n[0])===14&&n[1]&&Number(n[1])>=3||n&&Number(n[0])>14)return!0}}return!1}function bre(){return Gc.engine.name==="WebKit"}function Hc(){return xt().name===Ft.CHROME}function Fr(){return xt().name===Ft.SAFARI}function Jt(){return xt().name===Ft.FIREFOX}function Ti(){return xt().os===fr.IOS}function JR(o){const n=xt();return!(n.name!==Ft.CHROME||!n.osVersion)&&Number(n.version)>=o}function oj(o){const n=xt();return!(n.name!==Ft.EDGE||!n.osVersion)&&Number(n.version)>=o}function sj(o){const n=xt();return!(n.name!==Ft.OPERA||!n.osVersion)&&Number(n.version)>=o}function aj(){const o=xt();return!(o.name!==Ft.CHROME||!o.osVersion)&&Number(o.version)<=90}function cj(){const o=xt();if(o.os!==fr.IOS||!o.osVersion)return!1;const n=o.osVersion.split(".");return Number(n[0])<14||Number(n[0])===14&&Number(n[1])<=6}function Ep(){const o=xt();if(o.os!==fr.IOS||!o.osVersion)return!1;const n=o.osVersion.split(".");return Number(n[0])===15}function XR(){const o=xt();if(o.os!==fr.IOS||!o.osVersion)return!1;const n=o.osVersion.split(".");return Number(n[0])===16}function lj(){const o=xt();if(o.os!==fr.IOS||!o.osVersion)return!1;const n=o.osVersion.split(".");return Number(n[0])===15&&Number(n[1])>=1}function Qa(){return Fr()&&navigator.maxTouchPoints>0}function dj(){return xt().name===Ft.WECHAT}function uj(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function Zl(){const o=xt();return o.name===Ft.EDGE||o.name===Ft.SAFARI?!1:!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function Uy(){return Ly()===fr.ANDROID}function vg(){const o=xt();return Uy()&&(o.name===Ft.CHROME||o.name===Ft.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}var B;(function(o){o.UNEXPECTED_ERROR="UNEXPECTED_ERROR",o.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",o.TIMEOUT="TIMEOUT",o.INVALID_PARAMS="INVALID_PARAMS",o.NOT_READABLE="NOT_READABLE",o.NOT_SUPPORTED="NOT_SUPPORTED",o.INVALID_OPERATION="INVALID_OPERATION",o.OPERATION_ABORTED="OPERATION_ABORTED",o.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",o.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",o.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",o.DATACHANNEL_FAILED="DATACHANNEL_FAILED",o.NETWORK_ERROR="NETWORK_ERROR",o.NETWORK_TIMEOUT="NETWORK_TIMEOUT",o.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",o.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",o.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",o.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",o.ELECTRON_IS_NULL="ELECTRON_IS_NULL",o.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",o.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",o.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",o.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",o.PERMISSION_DENIED="PERMISSION_DENIED",o.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",o.TRACK_IS_DISABLED="TRACK_IS_DISABLED",o.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",o.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",o.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",o.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",o.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",o.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",o.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",o.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",o.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",o.UID_CONFLICT="UID_CONFLICT",o.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",o.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",o.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",o.INVALID_TRACK="INVALID_TRACK",o.SENDER_NOT_FOUND="SENDER_NOT_FOUND",o.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",o.SET_ANSWER_FAILED="SET_ANSWER_FAILED",o.ICE_FAILED="ICE_FAILED",o.PC_CLOSED="PC_CLOSED",o.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",o.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",o.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",o.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",o.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",o.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",o.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",o.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",o.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",o.INVALID_REMOTE_USER="INVALID_REMOTE_USER",o.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",o.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",o.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",o.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",o.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",o.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",o.WS_ABORT="WS_ABORT",o.WS_DISCONNECT="WS_DISCONNECT",o.WS_ERR="WS_ERR",o.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",o.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",o.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",o.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",o.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",o.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",o.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",o.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",o.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",o.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",o.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",o.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",o.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",o.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",o.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",o.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",o.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",o.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",o.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",o.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",o.INVALID_PLUGIN="INVALID_PLUGIN",o.DISCONNECT_P2P="DISCONNECT_P2P",o.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",o.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",o.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",o.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",o.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",o.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",o.PROHIBITED_OPERATION="PROHIBITED_OPERATION",o.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",o.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED"})(B||(B={}));let he=class extends Error{constructor(o){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;super(n),I(this,"code",void 0),I(this,"message",void 0),I(this,"data",void 0),I(this,"name","AgoraRTCException"),this.code=o,this.message="AgoraRTCError ".concat(this.code,": ").concat(n),this.data=r}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",n=arguments.length>1?arguments[1]:void 0;return o==="error"&&(n||console).error(this.toString()),o==="warning"&&(n||console).warn(this.toString()),this}throw(o){throw this.print("error",o),this}};function $c(o,n){if(typeof o!="boolean")throw new he(B.INVALID_PARAMS,"Invalid ".concat(n,": The value is of the boolean type."))}function mr(o,n,r){if(!Le(r).call(r,o))throw new he(B.INVALID_PARAMS,"".concat(n," can only be set as ").concat(JSON.stringify(r)))}function Yt(o,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(o<r||o>s||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(c){return typeof c=="number"&&c%1==0}(o))throw new he(B.INVALID_PARAMS,"invalid ".concat(n,": the value range is [").concat(r,", ").concat(s,"]. integer only"))}function QR(o,n){if(typeof o!="number"){if(!(o.min||o.max||o.ideal||o.exact))throw new he(B.INVALID_PARAMS,"".concat(n," is not a valid ConstrainLong"));o.min!==void 0&&Yt(o.min,"".concat(n,".min"),0,1/0),o.max!==void 0&&Yt(o.max,"".concat(n,".max"),1,1/0),o.exact!==void 0&&Yt(o.exact,"".concat(n,".exact"),1,1/0),o.ideal!==void 0&&Yt(o.ideal,"".concat(n,".ideal"),1,1/0)}else Yt(o,n,1,1/0)}function Xr(o,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,c=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(o==null)throw new he(B.INVALID_PARAMS,"".concat(n||"param"," cannot be empty"));if(!hj(o,r,s,c))throw new he(B.INVALID_PARAMS,"Invalid ".concat(n||"string param",": Length of the string: [").concat(r,",").concat(s,"].").concat(c?" ASCII characters only.":""))}function Kc(o,n){if(!Array.isArray(o))throw new he(B.INVALID_PARAMS,"".concat(n," should be an array"))}function wn(o){return o==null}function hj(o){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof o=="string"&&o.length<=r&&o.length>=n&&(!s||function(c){if(typeof c!="string")return!1;for(let d=0;d<c.length;d+=1){const h=c.charCodeAt(d);if(h<0||h>255)return!1}return!0}(o))}function pj(o,n,r){if("getBigUint64"in DataView.prototype)return o.getBigUint64(n,r);const s=o.getUint32(n,r),c=o.getUint32(n+4,r),d=+!!r,h=+!r;return BigInt(s*h+c*d)<<BigInt(32)|BigInt(s*d+c*h)}function fj(o,n,r,s){if("setBigUint64"in DataView.prototype)return o.setBigUint64(n,r,s);const c=Number(r>>BigInt(32)),d=Number(r&BigInt(4294967295));o.setUint32(n,c,s),o.setUint32(n+4,d,s)}var yp,jy;(function(o){o.COVERED="COVERED",o.POSITION="POSITION",o.SIZE="SIZE",o.STYLE="STYLE"})(yp||(yp={})),function(o){o.UNMOUNTED="UNMOUNTED",o.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(jy||(jy={}));const mj=new class{constructor(){I(this,"_clientSize",null),I(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),I(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),I(this,"getStyle",o=>window.getComputedStyle(o,null)),I(this,"checkCssVisibleProperty",o=>{var n;let r=!0;const s=this.getStyle(o),{display:c,visibility:d,opacity:h,filter:f}=s;return(c==="none"||Le(n=["hidden","collapse"]).call(n,d)||Number(h)<.1)&&(r=!1),r?(f&&f.split(" ").filter(g=>{var _;const E=g.split("(")[0];return Le(_=["brightness","blur","opacity"]).call(_,E)}).map(g=>{const[_,E]=g.split(/\(|\)/);return[_,Number(E.match(/^[0-9\.]+/))]}).forEach(g=>{const[_,E]=g;switch(_){case"brightness":(E<.1||E>3)&&(r=!1);break;case"blur":E>3&&(r=!1);break;case"opacity":E<.1&&(r=!1)}}),r):!1}),I(this,"checkPropertyUpToAllParentNodes",(o,n)=>{let r=!0,s=!0;const c=h=>n(h);let d=o;for(;d&&s;)c(d)||(r=!1,s=!1),d=d.parentElement,d||(s=!1);return r}),I(this,"checkActualCssVisibleIncludeInherit",o=>this.checkPropertyUpToAllParentNodes(o,this.checkCssVisibleProperty)),I(this,"getSizeAboutClient",o=>{const{width:n,height:r,left:s,right:c,top:d,bottom:h}=o.getBoundingClientRect(),f=this.getClientWidth(),g=this.getClientHeight();return{width:n,height:r,left:s,right:c,top:d,bottom:h,clientWidth:f,clientHeight:g,clientMin:Math.min(f,g)}}),I(this,"checkActualSize",()=>{const{width:o,height:n,clientMin:r}=this._clientSize;return this.checkSizeIsVisible(o,n,r)}),I(this,"elementFromPoint",(o,n)=>document.elementFromPoint?document.elementFromPoint(o,n):null),I(this,"checkCoverForAPoint",(o,n,r)=>{const s=this.elementFromPoint(o,n);return s!==null&&s!==r}),I(this,"getPointPositionList",()=>{const{width:o,height:n,left:r,top:s}=this._clientSize,c=o/6,d=n/6,h=[],f=10**6;for(let g=0;g<5;g++)for(let _=0;_<5;_++){const E=(r*f+(g===0?.1:g===4?(c*g*f-1e5)/f:c*g)*f)/f,T=(s*f+(_===0?.1:_===4?(d*_*f-1e5)/f:d*_)*f)/f;h.push({x:E,y:T})}return[...h]}),I(this,"checkElementCover",o=>this.getPointPositionList().map(n=>this.checkCoverForAPoint(n.x,n.y,o)).filter(n=>!!n).length>6),I(this,"checkSizeIsVisible",(o,n,r)=>(o>50||r/o<=10)&&(n>50||r/n<=10)),I(this,"checkSizeOfPartInClient",()=>{const{left:o,right:n,top:r,bottom:s,clientHeight:c,clientWidth:d,clientMin:h}=this._clientSize;let f,g,_,E;if(o<0)f=0;else{if(!(o<d))return!1;f=o}if(n<0)return!1;if(g=n<d?n:d,r<0)_=0;else{if(!(r<c))return!1;_=r}if(s<0)return!1;E=s<c?s:c;const T=g-f,w=E-_;return this.checkSizeIsVisible(T,w,h)}),I(this,"returnHiddenResult",o=>(this._clientSize=null,{visible:!1,reason:o})),I(this,"checkOneElementVisible",o=>{if(o instanceof HTMLElement){if(this.checkElementIsMountedOnDom(o)){if(this.checkActualCssVisibleIncludeInherit(o)){if(this._clientSize=this.getSizeAboutClient(o),this.checkElementCover(o))return this.returnHiddenResult(yp.COVERED);{const n=this.checkActualSize(),r=this.checkSizeOfPartInClient();return n&&!r?this.returnHiddenResult(yp.POSITION):n?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(yp.SIZE)}}return this.returnHiddenResult(yp.STYLE)}return this.returnHiddenResult(jy.UNMOUNTED)}return this.returnHiddenResult(jy.INVALID_HTML_ELEMENT)}),I(this,"checkElementIsMountedOnDom",o=>this.checkPropertyUpToAllParentNodes(o,n=>n.nodeName.toUpperCase()!=="HTML"?n.parentElement!==null:!!document.documentElement))}};function ZR(o){return new TextEncoder().encode(o)}const gj=function(o,n){const r=new Uint8Array(o.byteLength+n.byteLength);return r.set(new Uint8Array(o),0),r.set(new Uint8Array(n),o.byteLength),r},Cre=async o=>{const n=function(d){const h=window.atob(d),f=new Uint8Array(new ArrayBuffer(h.length));for(let g=0;g<h.length;g+=1)f[g]=h.charCodeAt(g);return f}(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),r=await window.crypto.subtle.importKey("spki",n,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),s=ZR(o),c=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},r,s);return function(d){let h="";for(let f=0;f<d.length;f+=1)h+=String.fromCharCode(d[f]);return window.btoa(h)}(new Uint8Array(c))},eI=async o=>function(n,r){let s="";return new Uint8Array(n).forEach(c=>{s+=c.toString(r).padStart(2,"0")}),s}(await crypto.subtle.digest("SHA-256",ZR(o)),16);class mn{constructor(){I(this,"_events",{}),I(this,"addListener",this.on)}getListeners(n){return this._events[n]?this._events[n].map(r=>r.listener):[]}on(n,r){this._events[n]||(this._events[n]=[]);const s=this._events[n];this._indexOfListener(s,r)===-1&&s.push({listener:r,once:!1})}once(n,r){this._events[n]||(this._events[n]=[]);const s=this._events[n];this._indexOfListener(s,r)===-1&&s.push({listener:r,once:!0})}off(n,r){if(!this._events[n])return;const s=this._events[n],c=this._indexOfListener(s,r);c!==-1&&s.splice(c,1),this._events[n].length===0&&delete this._events[n]}removeAllListeners(n){n?delete this._events[n]:this._events={}}emit(n){this._events[n]||(this._events[n]=[]);const r=this._events[n].map(h=>h);for(var s=arguments.length,c=new Array(s>1?s-1:0),d=1;d<s;d++)c[d-1]=arguments[d];for(let h=0;h<r.length;h+=1){const f=r[h];f.once&&this.off(n,f.listener),f.listener.apply(this,c||[])}}safeEmit(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),c=1;c<r;c++)s[c-1]=arguments[c];[...this._events[n]||[]].forEach(d=>{d.once&&this.off(n,d.listener);try{d.listener.apply(this,s)}catch(h){console.error("safeEmit event:".concat(n," error ").concat(h==null?void 0:h.toString()))}})}_indexOfListener(n,r){let s=n.length;for(;s--;)if(n[s].listener===r)return s;return-1}}let Eg=null;function _j(){if(Eg)return Eg;if(window.electron)return Eg=window.electron;if(!window.require)return null;try{return Eg=window.require("electron"),Eg}catch{return null}}var tr,yn,tI,vt,Et,Or,bi,Yc;function vj(o){return Yt(o.timeout,"config.timeout",0,1e5),Yt(o.timeoutFactor,"config.timeoutFactor",0,100,!1),Yt(o.maxRetryCount,"config.maxRetryConfig",0,1/0),Yt(o.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function Sp(o){if(!Array.isArray(o)||o.length<1)return!1;try{o.forEach(n=>{if(!n.urls)throw Error()})}catch{return!1}return!0}function Ej(o){return Xr(o.turnServerURL,"turnServerURL"),Xr(o.username,"username"),Xr(o.password,"password"),o.udpport&&Yt(o.udpport,"udpport",1,99999,!0),o.forceturn&&$c(o.forceturn,"forceturn"),o.security&&$c(o.security,"security"),o.tcpport&&Yt(o.tcpport,"tcpport",1,99999,!0),!0}function yj(o){return o.level!==void 0&&mr(o.level,"level",[1,2,3]),o.delay!==void 0&&Yt(o.delay,"delay",0,3e3,!0),!0}function nr(o,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),c=2;c<r;c++)s[c-2]=arguments[c];return o.getListeners(n).length===0?ae.reject(new he(B.UNEXPECTED_ERROR,"can not emit promise")):new ae((d,h)=>{o.emit(n,...s,d,h)})}function Xt(o,n){if(o.getListeners(n).length===0)return ae.resolve();for(var r=arguments.length,s=new Array(r>2?r-2:0),c=2;c<r;c++)s[c-2]=arguments[c];return nr(o,n,...s)}function yo(o,n){if(o.getListeners(n).length===0)return null;for(var r=arguments.length,s=new Array(r>2?r-2:0),c=2;c<r;c++)s[c-2]=arguments[c];return Nu(o,n,...s)}function Nu(o,n){let r=null,s=null;for(var c=arguments.length,d=new Array(c>2?c-2:0),h=2;h<c;h++)d[h-2]=arguments[h];if(o.emit(n,...d,f=>{r=f},f=>{s=f}),s!==null)throw s;if(r===null)throw new he(B.UNEXPECTED_ERROR,"handler is not sync");return r}(function(o){o.CREATE_CLIENT="createClient",o.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",o.SET_AREA="setArea",o.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",o.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",o.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",o.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",o.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",o.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",o.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",o.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",o.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",o.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",o.START_PROXY_SERVER="Client.startProxyServer",o.STOP_PROXY_SERVER="Client.stopProxyServer",o.SET_PROXY_SERVER="Client.setProxyServer",o.SET_TURN_SERVER="Client.setTurnServer",o.SET_CLIENT_ROLE="Client.setClientRole",o.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",o.ENABLE_DUAL_STREAM="Client.enableDualStream",o.DISABLE_DUAL_STREAM="Client.disableDualStream",o.JOIN="Client.join",o.LEAVE="Client.leave",o.PUBLISH="Client.publish",o.UNPUBLISH="Client.unpublish",o.SUBSCRIBE="Client.subscribe",o.MASS_SUBSCRIBE="Client.massSubscribe",o.MASS_UNSUBSCRIBE="Client.massUnsubscribe",o.UNSUBSCRIBE="Client.unsubscribe",o.RENEW_TOKEN="Client.renewToken",o.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",o.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",o.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",o.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",o.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",o.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",o.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",o.DATACHANNEL_FAILBACK="Client._datachannelFailback",o.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",o.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",o.START_LIVE_STREAMING="Client.startLiveStreaming",o.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",o.STOP_LIVE_STREAMING="Client.stopLiveStreaming",o.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",o.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",o.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",o.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",o.SET_CONFIG_DISTRIBUTE="_configDistribute",o.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",o.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",o.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",o.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",o.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",o.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",o.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",o.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",o.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",o.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",o.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",o.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",o.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",o.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",o.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",o.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",o.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",o.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",o.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",o.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",o.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",o.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",o.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",o.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",o.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",o.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",o.STREAM_TYPE_CHANGE="streamTypeChange",o.CONNECTION_STATE_CHANGE="connectionStateChange",o.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",o.IMAGE_MODERATION_UPLOAD="imageModerationUpload"})(tr||(tr={})),function(o){o.TRACER="tracer"}(yn||(yn={})),function(o){o[o.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",o[o.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",o[o.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(tI||(tI={})),function(o){o.LEAVE="LEAVE",o.NETWORK_ERROR="NETWORK_ERROR",o.SERVER_ERROR="SERVER_ERROR",o.UID_BANNED="UID_BANNED",o.IP_BANNED="IP_BANNED",o.CHANNEL_BANNED="CHANNEL_BANNED",o.FALLBACK="FALLBACK",o.LICENSE_MISSING="LICENSE_MISSING",o.LICENSE_EXPIRED="LICENSE_EXPIRED",o.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",o.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",o.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",o.LICENSE_ILLEGAL="LICENSE_ILLEGAL",o.TOKEN_EXPIRE="TOKEN_EXPIRE"}(vt||(vt={})),function(o){o.CONNECTION_STATE_CHANGE="connection-state-change",o.MEDIA_RECONNECT_START="media-reconnect-start",o.MEDIA_RECONNECT_END="media-reconnect-end",o.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",o.USER_JOINED="user-joined",o.USER_LEAVED="user-left",o.USER_PUBLISHED="user-published",o.USER_UNPUBLISHED="user-unpublished",o.USER_INFO_UPDATED="user-info-updated",o.CLIENT_BANNED="client-banned",o.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",o.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",o.VOLUME_INDICATOR="volume-indicator",o.CRYPT_ERROR="crypt-error",o.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",o.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",o.NETWORK_QUALITY="network-quality",o.STREAM_TYPE_CHANGED="stream-type-changed",o.STREAM_FALLBACK="stream-fallback",o.RECEIVE_METADATA="receive-metadata",o.STREAM_MESSAGE="stream-message",o.LIVE_STREAMING_ERROR="live-streaming-error",o.LIVE_STREAMING_WARNING="live-streaming-warning",o.INJECT_STREAM_STATUS="stream-inject-status",o.EXCEPTION="exception",o.ERROR="error",o.P2P_LOST="p2p_lost",o.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",o.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",o.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",o.PUBLISHED_USER_LIST="published-user-list",o.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",o.CONTENT_INSPECT_ERROR="content-inspect-error",o.CONTENT_INSPECT_RESULT="content-inspect-result",o.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change"}(Et||(Et={})),function(o){o.NETWORK_ERROR="NETWORK_ERROR",o.SERVER_ERROR="SERVER_ERROR",o.MULTI_IP="MULTI_IP",o.TIMEOUT="TIMEOUT",o.OFFLINE="OFFLINE",o.LEAVE="LEAVE",o.P2P_FAILED="P2P_FAILED",o.FALLBACK="FALLBACK"}(Or||(Or={})),function(o){o.ONLINE="ONLINE",o.OFFLINE="OFFLINE"}(bi||(bi={})),function(o){o.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",o.ONLINE="ONLINE",o.OFFLINE="OFFLINE"}(Yc||(Yc={}));const rr=new class extends mn{set networkState(o){this.emit(Yc.NETWORK_STATE_CHANGE,o,this._networkState),o===bi.ONLINE?this.emit(Yc.ONLINE):o===bi.OFFLINE&&(this.onlineWaiter=new ae(n=>{this.once(Yc.ONLINE,()=>{this.onlineWaiter=void 0,n(bi.ONLINE)})}),this.emit(Yc.OFFLINE)),this._networkState=o}get networkState(){return this._networkState}get isOnline(){return this._networkState===bi.ONLINE}constructor(){super(),I(this,"_moduleName","network-indicator"),I(this,"_networkState",bi.ONLINE),I(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=bi.ONLINE}),window.addEventListener("offline",()=>{this.networkState=bi.OFFLINE})}};var wre=Mo,Rre=Vs,Ire=St,Are=Gl,Ore=TypeError,Sj=function(o){return function(n,r,s,c){wre(r);var d=Rre(n),h=Ire(d),f=Are(d),g=o?f-1:0,_=o?-1:1;if(s<2)for(;;){if(g in h){c=h[g],g+=_;break}if(g+=_,o?g<0:f<=g)throw Ore("Reduce of empty array with no initial value")}for(;o?g>=0:f>g;g+=_)g in h&&(c=r(c,h[g],g,d));return c}},Nre={left:Sj(!1),right:Sj(!0)}.left;En({target:"Array",proto:!0,forced:!ug&&et>79&&et<83||!mR("reduce")},{reduce:function(o){var n=arguments.length;return Nre(this,o,n,n>1?arguments[1]:void 0)}});var Pre=Hl("Array").reduce,kre=N,Dre=Pre,nI=Array.prototype,qc=u(function(o){var n=o.reduce;return o===nI||kre(nI,o)&&n===nI.reduce?Dre:n});function Tj(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function Pu(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Tj(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):Tj(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}function Fy(o,n){const r=o.indexOf(n);r!==-1&&o.splice(r,1)}function Tp(o){const n=[];return o.forEach(r=>{n.indexOf(r)===-1&&n.push(r)}),n}function Vy(o){ae!==void 0?ae.resolve().then(o):setTimeout(o,0)}function en(o){return JSON.parse(JSON.stringify(o))}function ku(o){try{return en(o)}catch{return o}}const bj={};function bp(o,n){bj[n]||(bj[n]=!0,o())}function yg(o){const n=window.atob(o),r=new Uint8Array(new ArrayBuffer(n.length));for(let s=0;s<n.length;s+=1)r[s]=n.charCodeAt(s);return r}function Cp(o){let n="";for(let r=0;r<o.length;r+=1)n+=String.fromCharCode(o[r]);return window.btoa(n)}function Cj(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];const s=qc(n).call(n,(h,f)=>h+f.length,0),c=new Uint8Array(new ArrayBuffer(s));let d=0;return n.forEach(h=>{c.set(h,d),d+=h.length}),c}function Za(o){return window.TextEncoder?new TextEncoder().encode(o).length:o.length}function wj(o){let n=0;return/DingTalk/i.test(navigator.userAgent)&&o.realFormData&&(o=o.realFormData),o.forEach(r=>{n+=typeof r=="string"?Za(r):r.size}),n+138}function xre(o){const n=new he(B.TIMEOUT,"timeout");return new ae((r,s)=>{window.setTimeout(()=>s(n),o)})}function Nr(o){return new ae(n=>{window.setTimeout(n,o)})}function Qt(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,n=arguments.length>1?arguments[1]:void 0;const r=Math.random().toString(16).substr(2,o).toLowerCase();return r.length===o?"".concat(n).concat(r):"".concat(n).concat(r)+Qt(o-r.length,"")}function rI(){return Qt(32,"").toUpperCase()}const By=()=>{},Rj=new class{constructor(){I(this,"fnMap",new Map)}throttleByKey(o,n,r,s){for(var c=arguments.length,d=new Array(c>4?c-4:0),h=4;h<c;h++)d[h-4]=arguments[h];if(this.fnMap.has(n)){const f=this.fnMap.get(n);if(f.threshold!==r){f.fn(...f.args),clearTimeout(f.timer);const g=window.setTimeout(()=>{const _=this.fnMap.get(n);_&&_.fn(..._.args),this.fnMap.delete(n)},r);this.fnMap.set(n,{fn:o,threshold:r,timer:g,args:d,skipFn:s})}else f.skipFn&&f.skipFn(...f.args),this.fnMap.set(n,Pu(Pu({},f),{},{fn:o,args:d,skipFn:s}))}else{const f=window.setTimeout(()=>{const g=this.fnMap.get(n);g&&g.fn(...g.args),this.fnMap.delete(n)},r);this.fnMap.set(n,{fn:o,threshold:r,timer:f,args:d,skipFn:s})}}},Ij=Rj.throttleByKey.bind(Rj);function Aj(o){return typeof o=="object"&&o!==null&&!(o instanceof RegExp)}function iI(o,n){if(!Aj(o)||!Aj(n)||Array.isArray(o)&&!Array.isArray(n)||!Array.isArray(o)&&Array.isArray(n))return n;if(Array.isArray(n)&&Array.isArray(o)){const r=[...o];for(let s=0;s<n.length;s++)r[s]=iI(o[s],n[s]);return r}{const r=Pu({},o);for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(Object.prototype.hasOwnProperty.call(o,s)?r[s]=iI(o[s],n[s]):r[s]=n[s]);return r}}function Oj(o,n){let r=[0];if(r=new Array(n).fill(0),o===0)return r;let s=0;for(;o>0&&(r[s]=255&o,o>>=8,s++,s!==n););return r}let Lre=1,Wy=console;class Pr{static setLogger(n){Wy=n}constructor(n){I(this,"lockingPromise",ae.resolve()),I(this,"locks",0),I(this,"name",""),I(this,"lockId",void 0),this.lockId=Lre++,n&&(this.name=n),Wy.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(n){let r;this.locks+=1,Wy.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof n=="string"?n:""));const s=new ae(d=>{r=()=>{this.locks-=1,Wy.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof n=="string"?n:"")),d()}}),c=this.lockingPromise.then(()=>r);return this.lockingPromise=this.lockingPromise.then(()=>s),c}}function wp(o,n){return function(r,s,c){const d=c.value;if(typeof d!="function")throw new Error("Cannot use mutex on object property.");return c.value=async function(){const h=this[n];if(!h)throw new Error("mutex property key ".concat(n," doesn't exist on ").concat(o));const f=await h.lock("From ".concat(o,".").concat(s));try{for(var g=arguments.length,_=new Array(g),E=0;E<g;E++)_[E]=arguments[E];return await d.apply(this,_)}finally{f()}},c}}const ir={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function zy(o,n){const r=Math.floor(n.timeout*Math.pow(n.timeoutFactor,o));return Math.min(n.maxRetryTimeout,r)}function Ra(o,n,r,s){const c=Object.assign({},ir,s);let d=c.timeout;const h=async()=>{await function(_){return new ae(E=>{window.setTimeout(E,_)})}(d),d*=c.timeoutFactor,d=Math.min(c.maxRetryTimeout,d)};let f=!1;const g=new ae(async(_,E)=>{n=n||(()=>!1),r=r||(()=>!0);for(let T=0;T<c.maxRetryCount;T+=1){if(f)return E(new he(B.OPERATION_ABORTED));try{const w=await o();if(!n(w,T)||T+1===c.maxRetryCount)return _(w);await h()}catch(w){if(!r(w,T)||T+1===c.maxRetryCount)return E(w);await h()}}});return g.cancel=()=>f=!0,g}let oI=class{constructor(o){I(this,"input",[]),I(this,"size",void 0),this.size=o}add(o){this.input.push(o),this.input.length>this.size&&this.input.splice(0,1)}mean(){var o;return this.input.length===0?0:qc(o=this.input).call(o,(n,r)=>n+r)/this.input.length}};function Nj(o,n){return function(){return o.apply(n,arguments)}}const{toString:Mre}=Object.prototype,{getPrototypeOf:sI}=Object,Gy=(aI=Object.create(null),o=>{const n=Mre.call(o);return aI[n]||(aI[n]=n.slice(8,-1).toLowerCase())});var aI;const ec=o=>(o=o.toLowerCase(),n=>Gy(n)===o),Hy=o=>n=>typeof n===o,{isArray:Rp}=Array,Sg=Hy("undefined"),Pj=ec("ArrayBuffer"),Ure=Hy("string"),Ws=Hy("function"),kj=Hy("number"),$y=o=>o!==null&&typeof o=="object",Ky=o=>{if(Gy(o)!=="object")return!1;const n=sI(o);return!(n!==null&&n!==Object.prototype&&Object.getPrototypeOf(n)!==null||Symbol.toStringTag in o||Symbol.iterator in o)},jre=ec("Date"),Fre=ec("File"),Vre=ec("Blob"),Bre=ec("FileList"),Wre=ec("URLSearchParams");function Tg(o,n,{allOwnKeys:r=!1}={}){if(o==null)return;let s,c;if(typeof o!="object"&&(o=[o]),Rp(o))for(s=0,c=o.length;s<c;s++)n.call(null,o[s],s,o);else{const d=r?Object.getOwnPropertyNames(o):Object.keys(o),h=d.length;let f;for(s=0;s<h;s++)f=d[s],n.call(null,o[f],f,o)}}function Dj(o,n){n=n.toLowerCase();const r=Object.keys(o);let s,c=r.length;for(;c-- >0;)if(s=r[c],n===s.toLowerCase())return s;return null}const xj=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:rn,Lj=o=>!Sg(o)&&o!==xj,zre=(cI=typeof Uint8Array<"u"&&sI(Uint8Array),o=>cI&&o instanceof cI);var cI;const Gre=ec("HTMLFormElement"),Mj=(({hasOwnProperty:o})=>(n,r)=>o.call(n,r))(Object.prototype),Hre=ec("RegExp"),Uj=(o,n)=>{const r=Object.getOwnPropertyDescriptors(o),s={};Tg(r,(c,d)=>{let h;(h=n(c,d,o))!==!1&&(s[d]=h||c)}),Object.defineProperties(o,s)},lI="abcdefghijklmnopqrstuvwxyz",jj="0123456789",Fj={DIGIT:jj,ALPHA:lI,ALPHA_DIGIT:lI+lI.toUpperCase()+jj},$re=ec("AsyncFunction");var Me={isArray:Rp,isArrayBuffer:Pj,isBuffer:function(o){return o!==null&&!Sg(o)&&o.constructor!==null&&!Sg(o.constructor)&&Ws(o.constructor.isBuffer)&&o.constructor.isBuffer(o)},isFormData:o=>{let n;return o&&(typeof FormData=="function"&&o instanceof FormData||Ws(o.append)&&((n=Gy(o))==="formdata"||n==="object"&&Ws(o.toString)&&o.toString()==="[object FormData]"))},isArrayBufferView:function(o){let n;return n=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(o):o&&o.buffer&&Pj(o.buffer),n},isString:Ure,isNumber:kj,isBoolean:o=>o===!0||o===!1,isObject:$y,isPlainObject:Ky,isUndefined:Sg,isDate:jre,isFile:Fre,isBlob:Vre,isRegExp:Hre,isFunction:Ws,isStream:o=>$y(o)&&Ws(o.pipe),isURLSearchParams:Wre,isTypedArray:zre,isFileList:Bre,forEach:Tg,merge:function o(){const{caseless:n}=Lj(this)&&this||{},r={},s=(c,d)=>{const h=n&&Dj(r,d)||d;Ky(r[h])&&Ky(c)?r[h]=o(r[h],c):Ky(c)?r[h]=o({},c):Rp(c)?r[h]=c.slice():r[h]=c};for(let c=0,d=arguments.length;c<d;c++)arguments[c]&&Tg(arguments[c],s);return r},extend:(o,n,r,{allOwnKeys:s}={})=>(Tg(n,(c,d)=>{r&&Ws(c)?o[d]=Nj(c,r):o[d]=c},{allOwnKeys:s}),o),trim:o=>o.trim?o.trim():o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:o=>(o.charCodeAt(0)===65279&&(o=o.slice(1)),o),inherits:(o,n,r,s)=>{o.prototype=Object.create(n.prototype,s),o.prototype.constructor=o,Object.defineProperty(o,"super",{value:n.prototype}),r&&Object.assign(o.prototype,r)},toFlatObject:(o,n,r,s)=>{let c,d,h;const f={};if(n=n||{},o==null)return n;do{for(c=Object.getOwnPropertyNames(o),d=c.length;d-- >0;)h=c[d],s&&!s(h,o,n)||f[h]||(n[h]=o[h],f[h]=!0);o=r!==!1&&sI(o)}while(o&&(!r||r(o,n))&&o!==Object.prototype);return n},kindOf:Gy,kindOfTest:ec,endsWith:(o,n,r)=>{o=String(o),(r===void 0||r>o.length)&&(r=o.length),r-=n.length;const s=o.indexOf(n,r);return s!==-1&&s===r},toArray:o=>{if(!o)return null;if(Rp(o))return o;let n=o.length;if(!kj(n))return null;const r=new Array(n);for(;n-- >0;)r[n]=o[n];return r},forEachEntry:(o,n)=>{const r=(o&&o[Symbol.iterator]).call(o);let s;for(;(s=r.next())&&!s.done;){const c=s.value;n.call(o,c[0],c[1])}},matchAll:(o,n)=>{let r;const s=[];for(;(r=o.exec(n))!==null;)s.push(r);return s},isHTMLForm:Gre,hasOwnProperty:Mj,hasOwnProp:Mj,reduceDescriptors:Uj,freezeMethods:o=>{Uj(o,(n,r)=>{if(Ws(o)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=o[r];Ws(s)&&(n.enumerable=!1,"writable"in n?n.writable=!1:n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(o,n)=>{const r={},s=c=>{c.forEach(d=>{r[d]=!0})};return Rp(o)?s(o):s(String(o).split(n)),r},toCamelCase:o=>o.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),noop:()=>{},toFiniteNumber:(o,n)=>(o=+o,Number.isFinite(o)?o:n),findKey:Dj,global:xj,isContextDefined:Lj,ALPHABET:Fj,generateString:(o=16,n=Fj.ALPHA_DIGIT)=>{let r="";const{length:s}=n;for(;o--;)r+=n[Math.random()*s|0];return r},isSpecCompliantForm:function(o){return!!(o&&Ws(o.append)&&o[Symbol.toStringTag]==="FormData"&&o[Symbol.iterator])},toJSONObject:o=>{const n=new Array(10),r=(s,c)=>{if($y(s)){if(n.indexOf(s)>=0)return;if(!("toJSON"in s)){n[c]=s;const d=Rp(s)?[]:{};return Tg(s,(h,f)=>{const g=r(h,c+1);!Sg(g)&&(d[f]=g)}),n[c]=void 0,d}}return s};return r(o,0)},isAsyncFn:$re,isThenable:o=>o&&($y(o)||Ws(o))&&Ws(o.then)&&Ws(o.catch)};function Sn(o,n,r,s,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=o,this.name="AxiosError",n&&(this.code=n),r&&(this.config=r),s&&(this.request=s),c&&(this.response=c)}Me.inherits(Sn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Me.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Vj=Sn.prototype,Bj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(o=>{Bj[o]={value:o}}),Object.defineProperties(Sn,Bj),Object.defineProperty(Vj,"isAxiosError",{value:!0}),Sn.from=(o,n,r,s,c,d)=>{const h=Object.create(Vj);return Me.toFlatObject(o,h,function(f){return f!==Error.prototype},f=>f!=="isAxiosError"),Sn.call(h,o.message,n,r,s,c),h.cause=o,h.name=o.name,d&&Object.assign(h,d),h};function dI(o){return Me.isPlainObject(o)||Me.isArray(o)}function Wj(o){return Me.endsWith(o,"[]")?o.slice(0,-2):o}function zj(o,n,r){return o?o.concat(n).map(function(s,c){return s=Wj(s),!r&&c?"["+s+"]":s}).join(r?".":""):n}const Kre=Me.toFlatObject(Me,{},null,function(o){return/^is[A-Z]/.test(o)});function Yy(o,n,r){if(!Me.isObject(o))throw new TypeError("target must be an object");n=n||new FormData;const s=(r=Me.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,A){return!Me.isUndefined(A[w])})).metaTokens,c=r.visitor||_,d=r.dots,h=r.indexes,f=(r.Blob||typeof Blob<"u"&&Blob)&&Me.isSpecCompliantForm(n);if(!Me.isFunction(c))throw new TypeError("visitor must be a function");function g(w){if(w===null)return"";if(Me.isDate(w))return w.toISOString();if(!f&&Me.isBlob(w))throw new Sn("Blob is not supported. Use a Buffer instead.");return Me.isArrayBuffer(w)||Me.isTypedArray(w)?f&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function _(w,A,L){let P=w;if(w&&!L&&typeof w=="object"){if(Me.endsWith(A,"{}"))A=s?A:A.slice(0,-2),w=JSON.stringify(w);else if(Me.isArray(w)&&function(D){return Me.isArray(D)&&!D.some(dI)}(w)||(Me.isFileList(w)||Me.endsWith(A,"[]"))&&(P=Me.toArray(w)))return A=Wj(A),P.forEach(function(D,G){!Me.isUndefined(D)&&D!==null&&n.append(h===!0?zj([A],G,d):h===null?A:A+"[]",g(D))}),!1}return!!dI(w)||(n.append(zj(L,A,d),g(w)),!1)}const E=[],T=Object.assign(Kre,{defaultVisitor:_,convertValue:g,isVisitable:dI});if(!Me.isObject(o))throw new TypeError("data must be an object");return function w(A,L){if(!Me.isUndefined(A)){if(E.indexOf(A)!==-1)throw Error("Circular reference detected in "+L.join("."));E.push(A),Me.forEach(A,function(P,D){(!(Me.isUndefined(P)||P===null)&&c.call(n,P,Me.isString(D)?D.trim():D,L,T))===!0&&w(P,L?L.concat(D):[D])}),E.pop()}}(o),n}function Gj(o){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(o).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function uI(o,n){this._pairs=[],o&&Yy(o,this,n)}const Hj=uI.prototype;function Yre(o){return encodeURIComponent(o).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function $j(o,n,r){if(!n)return o;const s=r&&r.encode||Yre,c=r&&r.serialize;let d;if(d=c?c(n,r):Me.isURLSearchParams(n)?n.toString():new uI(n,r).toString(s),d){const h=o.indexOf("#");h!==-1&&(o=o.slice(0,h)),o+=(o.indexOf("?")===-1?"?":"&")+d}return o}Hj.append=function(o,n){this._pairs.push([o,n])},Hj.toString=function(o){const n=o?function(r){return o.call(this,r,Gj)}:Gj;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};var Kj=class{constructor(){this.handlers=[]}use(o,n,r){return this.handlers.push({fulfilled:o,rejected:n,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(o){this.handlers[o]&&(this.handlers[o]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(o){Me.forEach(this.handlers,function(n){n!==null&&o(n)})}},Yj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},qre={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:uI,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const qj=typeof window<"u"&&typeof document<"u",Jre=(Jj=typeof navigator<"u"&&navigator.product,qj&&["ReactNative","NativeScript","NS"].indexOf(Jj)<0);var Jj;const Xre=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";var tc={...Object.freeze({__proto__:null,hasBrowserEnv:qj,hasStandardBrowserEnv:Jre,hasStandardBrowserWebWorkerEnv:Xre}),...qre};function Xj(o){function n(r,s,c,d){let h=r[d++];if(h==="__proto__")return!0;const f=Number.isFinite(+h),g=d>=r.length;return h=!h&&Me.isArray(c)?c.length:h,g?(Me.hasOwnProp(c,h)?c[h]=[c[h],s]:c[h]=s,!f):(c[h]&&Me.isObject(c[h])||(c[h]=[]),n(r,s,c[h],d)&&Me.isArray(c[h])&&(c[h]=function(_){const E={},T=Object.keys(_);let w;const A=T.length;let L;for(w=0;w<A;w++)L=T[w],E[L]=_[L];return E}(c[h])),!f)}if(Me.isFormData(o)&&Me.isFunction(o.entries)){const r={};return Me.forEachEntry(o,(s,c)=>{n(function(d){return Me.matchAll(/\w+|\[(\w*)]/g,d).map(h=>h[0]==="[]"?"":h[1]||h[0])}(s),c,r,0)}),r}return null}const hI={transitional:Yj,adapter:["xhr","http"],transformRequest:[function(o,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,c=Me.isObject(o);if(c&&Me.isHTMLForm(o)&&(o=new FormData(o)),Me.isFormData(o))return s?JSON.stringify(Xj(o)):o;if(Me.isArrayBuffer(o)||Me.isBuffer(o)||Me.isStream(o)||Me.isFile(o)||Me.isBlob(o))return o;if(Me.isArrayBufferView(o))return o.buffer;if(Me.isURLSearchParams(o))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),o.toString();let d;if(c){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(h,f){return Yy(h,new tc.classes.URLSearchParams,Object.assign({visitor:function(g,_,E,T){return tc.isNode&&Me.isBuffer(g)?(this.append(_,g.toString("base64")),!1):T.defaultVisitor.apply(this,arguments)}},f))}(o,this.formSerializer).toString();if((d=Me.isFileList(o))||r.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return Yy(d?{"files[]":o}:o,h&&new h,this.formSerializer)}}return c||s?(n.setContentType("application/json",!1),function(h,f,g){if(Me.isString(h))try{return(f||JSON.parse)(h),Me.trim(h)}catch(_){if(_.name!=="SyntaxError")throw _}return(0,JSON.stringify)(h)}(o)):o}],transformResponse:[function(o){const n=this.transitional||hI.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(o&&Me.isString(o)&&(r&&!this.responseType||s)){const c=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(o)}catch(d){if(c)throw d.name==="SyntaxError"?Sn.from(d,Sn.ERR_BAD_RESPONSE,this,null,this.response):d}}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tc.classes.FormData,Blob:tc.classes.Blob},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Me.forEach(["delete","get","head","post","put","patch"],o=>{hI.headers[o]={}});var pI=hI;const Qre=Me.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Qj=Symbol("internals");function bg(o){return o&&String(o).trim().toLowerCase()}function qy(o){return o===!1||o==null?o:Me.isArray(o)?o.map(qy):String(o)}function fI(o,n,r,s,c){return Me.isFunction(s)?s.call(this,n,r):(c&&(n=r),Me.isString(n)?Me.isString(s)?n.indexOf(s)!==-1:Me.isRegExp(s)?s.test(n):void 0:void 0)}class Jy{constructor(n){n&&this.set(n)}set(n,r,s){const c=this;function d(f,g,_){const E=bg(g);if(!E)throw new Error("header name must be a non-empty string");const T=Me.findKey(c,E);(!T||c[T]===void 0||_===!0||_===void 0&&c[T]!==!1)&&(c[T||g]=qy(f))}const h=(f,g)=>Me.forEach(f,(_,E)=>d(_,E,g));return Me.isPlainObject(n)||n instanceof this.constructor?h(n,r):Me.isString(n)&&(n=n.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim())?h((f=>{const g={};let _,E,T;return f&&f.split(`
`).forEach(function(w){T=w.indexOf(":"),_=w.substring(0,T).trim().toLowerCase(),E=w.substring(T+1).trim(),!_||g[_]&&Qre[_]||(_==="set-cookie"?g[_]?g[_].push(E):g[_]=[E]:g[_]=g[_]?g[_]+", "+E:E)}),g})(n),r):n!=null&&d(r,n,s),this}get(n,r){if(n=bg(n)){const s=Me.findKey(this,n);if(s){const c=this[s];if(!r)return c;if(r===!0)return function(d){const h=Object.create(null),f=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let g;for(;g=f.exec(d);)h[g[1]]=g[2];return h}(c);if(Me.isFunction(r))return r.call(this,c,s);if(Me.isRegExp(r))return r.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,r){if(n=bg(n)){const s=Me.findKey(this,n);return!(!s||this[s]===void 0||r&&!fI(0,this[s],s,r))}return!1}delete(n,r){const s=this;let c=!1;function d(h){if(h=bg(h)){const f=Me.findKey(s,h);!f||r&&!fI(0,s[f],f,r)||(delete s[f],c=!0)}}return Me.isArray(n)?n.forEach(d):d(n),c}clear(n){const r=Object.keys(this);let s=r.length,c=!1;for(;s--;){const d=r[s];n&&!fI(0,this[d],d,n,!0)||(delete this[d],c=!0)}return c}normalize(n){const r=this,s={};return Me.forEach(this,(c,d)=>{const h=Me.findKey(s,d);if(h)return r[h]=qy(c),void delete r[d];const f=n?function(g){return g.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(_,E,T)=>E.toUpperCase()+T)}(d):String(d).trim();f!==d&&delete r[d],r[f]=qy(c),s[f]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const r=Object.create(null);return Me.forEach(this,(s,c)=>{s!=null&&s!==!1&&(r[c]=n&&Me.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,r])=>n+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...r){const s=new this(n);return r.forEach(c=>s.set(c)),s}static accessor(n){const r=(this[Qj]=this[Qj]={accessors:{}}).accessors,s=this.prototype;function c(d){const h=bg(d);r[h]||(function(f,g){const _=Me.toCamelCase(" "+g);["get","set","has"].forEach(E=>{Object.defineProperty(f,E+_,{value:function(T,w,A){return this[E].call(this,g,T,w,A)},configurable:!0})})}(s,d),r[h]=!0)}return Me.isArray(n)?n.forEach(c):c(n),this}}Jy.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Me.reduceDescriptors(Jy.prototype,({value:o},n)=>{let r=n[0].toUpperCase()+n.slice(1);return{get:()=>o,set(s){this[r]=s}}}),Me.freezeMethods(Jy);var Jc=Jy;function mI(o,n){const r=this||pI,s=n||r,c=Jc.from(s.headers);let d=s.data;return Me.forEach(o,function(h){d=h.call(r,d,c.normalize(),n?n.status:void 0)}),c.normalize(),d}function Zj(o){return!(!o||!o.__CANCEL__)}function Cg(o,n,r){Sn.call(this,o??"canceled",Sn.ERR_CANCELED,n,r),this.name="CanceledError"}Me.inherits(Cg,Sn,{__CANCEL__:!0});var Zre=tc.hasStandardBrowserEnv?{write(o,n,r,s,c,d){const h=[o+"="+encodeURIComponent(n)];Me.isNumber(r)&&h.push("expires="+new Date(r).toGMTString()),Me.isString(s)&&h.push("path="+s),Me.isString(c)&&h.push("domain="+c),d===!0&&h.push("secure"),document.cookie=h.join("; ")},read(o){const n=document.cookie.match(new RegExp("(^|;\\s*)("+o+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(o){this.write(o,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function eF(o,n){return o&&!function(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}(n)?function(r,s){return s?r.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):r}(o,n):n}var eie=tc.hasStandardBrowserEnv?function(){const o=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function s(c){let d=c;return o&&(n.setAttribute("href",d),d=n.href),n.setAttribute("href",d),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=s(window.location.href),function(c){const d=Me.isString(c)?s(c):c;return d.protocol===r.protocol&&d.host===r.host}}():function(){return!0};function tF(o,n){let r=0;const s=function(c,d){c=c||10;const h=new Array(c),f=new Array(c);let g,_=0,E=0;return d=d!==void 0?d:1e3,function(T){const w=Date.now(),A=f[E];g||(g=w),h[_]=T,f[_]=w;let L=E,P=0;for(;L!==_;)P+=h[L++],L%=c;if(_=(_+1)%c,_===E&&(E=(E+1)%c),w-g<d)return;const D=A&&w-A;return D?Math.round(1e3*P/D):void 0}}(50,250);return c=>{const d=c.loaded,h=c.lengthComputable?c.total:void 0,f=d-r,g=s(f);r=d;const _={loaded:d,total:h,progress:h?d/h:void 0,bytes:f,rate:g||void 0,estimated:g&&h&&d<=h?(h-d)/g:void 0,event:c};_[n?"download":"upload"]=!0,o(_)}}var tie=typeof XMLHttpRequest<"u"&&function(o){return new Promise(function(n,r){let s=o.data;const c=Jc.from(o.headers).normalize();let d,h,{responseType:f,withXSRFToken:g}=o;function _(){o.cancelToken&&o.cancelToken.unsubscribe(d),o.signal&&o.signal.removeEventListener("abort",d)}if(Me.isFormData(s)){if(tc.hasStandardBrowserEnv||tc.hasStandardBrowserWebWorkerEnv)c.setContentType(!1);else if((h=c.getContentType())!==!1){const[L,...P]=h?h.split(";").map(D=>D.trim()).filter(Boolean):[];c.setContentType([L||"multipart/form-data",...P].join("; "))}}let E=new XMLHttpRequest;if(o.auth){const L=o.auth.username||"",P=o.auth.password?unescape(encodeURIComponent(o.auth.password)):"";c.set("Authorization","Basic "+btoa(L+":"+P))}const T=eF(o.baseURL,o.url);function w(){if(!E)return;const L=Jc.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders());(function(P,D,G){const $=G.config.validateStatus;G.status&&$&&!$(G.status)?D(new Sn("Request failed with status code "+G.status,[Sn.ERR_BAD_REQUEST,Sn.ERR_BAD_RESPONSE][Math.floor(G.status/100)-4],G.config,G.request,G)):P(G)})(function(P){n(P),_()},function(P){r(P),_()},{data:f&&f!=="text"&&f!=="json"?E.response:E.responseText,status:E.status,statusText:E.statusText,headers:L,config:o,request:E}),E=null}if(E.open(o.method.toUpperCase(),$j(T,o.params,o.paramsSerializer),!0),E.timeout=o.timeout,"onloadend"in E?E.onloadend=w:E.onreadystatechange=function(){E&&E.readyState===4&&(E.status!==0||E.responseURL&&E.responseURL.indexOf("file:")===0)&&setTimeout(w)},E.onabort=function(){E&&(r(new Sn("Request aborted",Sn.ECONNABORTED,o,E)),E=null)},E.onerror=function(){r(new Sn("Network Error",Sn.ERR_NETWORK,o,E)),E=null},E.ontimeout=function(){let L=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const P=o.transitional||Yj;o.timeoutErrorMessage&&(L=o.timeoutErrorMessage),r(new Sn(L,P.clarifyTimeoutError?Sn.ETIMEDOUT:Sn.ECONNABORTED,o,E)),E=null},tc.hasStandardBrowserEnv&&(g&&Me.isFunction(g)&&(g=g(o)),g||g!==!1&&eie(T))){const L=o.xsrfHeaderName&&o.xsrfCookieName&&Zre.read(o.xsrfCookieName);L&&c.set(o.xsrfHeaderName,L)}s===void 0&&c.setContentType(null),"setRequestHeader"in E&&Me.forEach(c.toJSON(),function(L,P){E.setRequestHeader(P,L)}),Me.isUndefined(o.withCredentials)||(E.withCredentials=!!o.withCredentials),f&&f!=="json"&&(E.responseType=o.responseType),typeof o.onDownloadProgress=="function"&&E.addEventListener("progress",tF(o.onDownloadProgress,!0)),typeof o.onUploadProgress=="function"&&E.upload&&E.upload.addEventListener("progress",tF(o.onUploadProgress)),(o.cancelToken||o.signal)&&(d=L=>{E&&(r(!L||L.type?new Cg(null,o,E):L),E.abort(),E=null)},o.cancelToken&&o.cancelToken.subscribe(d),o.signal&&(o.signal.aborted?d():o.signal.addEventListener("abort",d)));const A=function(L){const P=/^([-+\w]{1,25})(:?\/\/|:)/.exec(L);return P&&P[1]||""}(T);A&&tc.protocols.indexOf(A)===-1?r(new Sn("Unsupported protocol "+A+":",Sn.ERR_BAD_REQUEST,o)):E.send(s||null)})};const gI={http:null,xhr:tie};Me.forEach(gI,(o,n)=>{if(o){try{Object.defineProperty(o,"name",{value:n})}catch{}Object.defineProperty(o,"adapterName",{value:n})}});const nF=o=>`- ${o}`,nie=o=>Me.isFunction(o)||o===null||o===!1;var rF={getAdapter:o=>{o=Me.isArray(o)?o:[o];const{length:n}=o;let r,s;const c={};for(let d=0;d<n;d++){let h;if(r=o[d],s=r,!nie(r)&&(s=gI[(h=String(r)).toLowerCase()],s===void 0))throw new Sn(`Unknown adapter '${h}'`);if(s)break;c[h||"#"+d]=s}if(!s){const d=Object.entries(c).map(([h,f])=>`adapter ${h} `+(f===!1?"is not supported by the environment":"is not available in the build"));throw new Sn("There is no suitable adapter to dispatch the request "+(n?d.length>1?`since :
`+d.map(nF).join(`
`):" "+nF(d[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return s},adapters:gI};function _I(o){if(o.cancelToken&&o.cancelToken.throwIfRequested(),o.signal&&o.signal.aborted)throw new Cg(null,o)}function iF(o){return _I(o),o.headers=Jc.from(o.headers),o.data=mI.call(o,o.transformRequest),["post","put","patch"].indexOf(o.method)!==-1&&o.headers.setContentType("application/x-www-form-urlencoded",!1),rF.getAdapter(o.adapter||pI.adapter)(o).then(function(n){return _I(o),n.data=mI.call(o,o.transformResponse,n),n.headers=Jc.from(n.headers),n},function(n){return Zj(n)||(_I(o),n&&n.response&&(n.response.data=mI.call(o,o.transformResponse,n.response),n.response.headers=Jc.from(n.response.headers))),Promise.reject(n)})}const oF=o=>o instanceof Jc?o.toJSON():o;function Ip(o,n){n=n||{};const r={};function s(_,E,T){return Me.isPlainObject(_)&&Me.isPlainObject(E)?Me.merge.call({caseless:T},_,E):Me.isPlainObject(E)?Me.merge({},E):Me.isArray(E)?E.slice():E}function c(_,E,T){return Me.isUndefined(E)?Me.isUndefined(_)?void 0:s(void 0,_,T):s(_,E,T)}function d(_,E){if(!Me.isUndefined(E))return s(void 0,E)}function h(_,E){return Me.isUndefined(E)?Me.isUndefined(_)?void 0:s(void 0,_):s(void 0,E)}function f(_,E,T){return T in n?s(_,E):T in o?s(void 0,_):void 0}const g={url:d,method:d,data:d,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,withXSRFToken:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:f,headers:(_,E)=>c(oF(_),oF(E),!0)};return Me.forEach(Object.keys(Object.assign({},o,n)),function(_){const E=g[_]||c,T=E(o[_],n[_],_);Me.isUndefined(T)&&E!==f||(r[_]=T)}),r}const sF="1.6.7",vI={};["object","boolean","number","function","string","symbol"].forEach((o,n)=>{vI[o]=function(r){return typeof r===o||"a"+(n<1?"n ":" ")+o}});const aF={};vI.transitional=function(o,n,r){function s(c,d){return"[Axios v"+sF+"] Transitional option '"+c+"'"+d+(r?". "+r:"")}return(c,d,h)=>{if(o===!1)throw new Sn(s(d," has been removed"+(n?" in "+n:"")),Sn.ERR_DEPRECATED);return n&&!aF[d]&&(aF[d]=!0,console.warn(s(d," has been deprecated since v"+n+" and will be removed in the near future"))),!o||o(c,d,h)}};var EI={assertOptions:function(o,n,r){if(typeof o!="object")throw new Sn("options must be an object",Sn.ERR_BAD_OPTION_VALUE);const s=Object.keys(o);let c=s.length;for(;c-- >0;){const d=s[c],h=n[d];if(h){const f=o[d],g=f===void 0||h(f,d,o);if(g!==!0)throw new Sn("option "+d+" must be "+g,Sn.ERR_BAD_OPTION_VALUE)}else if(r!==!0)throw new Sn("Unknown option "+d,Sn.ERR_BAD_OPTION)}},validators:vI};const ed=EI.validators;let Xy=class{constructor(o){this.defaults=o,this.interceptors={request:new Kj,response:new Kj}}async request(o,n){try{return await this._request(o,n)}catch(r){if(r instanceof Error){let s;Error.captureStackTrace?Error.captureStackTrace(s={}):s=new Error;const c=s.stack?s.stack.replace(/^.+\n/,""):"";r.stack?c&&!String(r.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+c):r.stack=c}throw r}}_request(o,n){typeof o=="string"?(n=n||{}).url=o:n=o||{},n=Ip(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:c}=n;r!==void 0&&EI.assertOptions(r,{silentJSONParsing:ed.transitional(ed.boolean),forcedJSONParsing:ed.transitional(ed.boolean),clarifyTimeoutError:ed.transitional(ed.boolean)},!1),s!=null&&(Me.isFunction(s)?n.paramsSerializer={serialize:s}:EI.assertOptions(s,{encode:ed.function,serialize:ed.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let d=c&&Me.merge(c.common,c[n.method]);c&&Me.forEach(["delete","get","head","post","put","patch","common"],A=>{delete c[A]}),n.headers=Jc.concat(d,c);const h=[];let f=!0;this.interceptors.request.forEach(function(A){typeof A.runWhen=="function"&&A.runWhen(n)===!1||(f=f&&A.synchronous,h.unshift(A.fulfilled,A.rejected))});const g=[];let _;this.interceptors.response.forEach(function(A){g.push(A.fulfilled,A.rejected)});let E,T=0;if(!f){const A=[iF.bind(this),void 0];for(A.unshift.apply(A,h),A.push.apply(A,g),E=A.length,_=Promise.resolve(n);T<E;)_=_.then(A[T++],A[T++]);return _}E=h.length;let w=n;for(T=0;T<E;){const A=h[T++],L=h[T++];try{w=A(w)}catch(P){L.call(this,P);break}}try{_=iF.call(this,w)}catch(A){return Promise.reject(A)}for(T=0,E=g.length;T<E;)_=_.then(g[T++],g[T++]);return _}getUri(o){return $j(eF((o=Ip(this.defaults,o)).baseURL,o.url),o.params,o.paramsSerializer)}};Me.forEach(["delete","get","head","options"],function(o){Xy.prototype[o]=function(n,r){return this.request(Ip(r||{},{method:o,url:n,data:(r||{}).data}))}}),Me.forEach(["post","put","patch"],function(o){function n(r){return function(s,c,d){return this.request(Ip(d||{},{method:o,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:c}))}}Xy.prototype[o]=n(),Xy.prototype[o+"Form"]=n(!0)});var Qy=Xy;class yI{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(c){r=c});const s=this;this.promise.then(c=>{if(!s._listeners)return;let d=s._listeners.length;for(;d-- >0;)s._listeners[d](c);s._listeners=null}),this.promise.then=c=>{let d;const h=new Promise(f=>{s.subscribe(f),d=f}).then(c);return h.cancel=function(){s.unsubscribe(d)},h},n(function(c,d,h){s.reason||(s.reason=new Cg(c,d,h),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){this.reason?n(this.reason):this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const r=this._listeners.indexOf(n);r!==-1&&this._listeners.splice(r,1)}static source(){let n;return{token:new yI(function(r){n=r}),cancel:n}}}var rie=yI;const SI={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(SI).forEach(([o,n])=>{SI[n]=o});var iie=SI;const li=function o(n){const r=new Qy(n),s=Nj(Qy.prototype.request,r);return Me.extend(s,Qy.prototype,r,{allOwnKeys:!0}),Me.extend(s,r,null,{allOwnKeys:!0}),s.create=function(c){return o(Ip(n,c))},s}(pI);li.Axios=Qy,li.CanceledError=Cg,li.CancelToken=rie,li.isCancel=Zj,li.VERSION=sF,li.toFormData=Yy,li.AxiosError=Sn,li.Cancel=li.CanceledError,li.all=function(o){return Promise.all(o)},li.spread=function(o){return function(n){return o.apply(null,n)}},li.isAxiosError=function(o){return Me.isObject(o)&&o.isAxiosError===!0},li.mergeConfig=Ip,li.AxiosHeaders=Jc,li.formToJSON=o=>Xj(Me.isHTMLForm(o)?new FormData(o):o),li.getAdapter=rF.getAdapter,li.HttpStatusCode=iie,li.default=li;var Qi=li;function cF(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function lF(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?cF(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):cF(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}let Zy,e0=0,TI=0;function bI(o,n,r,s){return new ae((c,d)=>{n.responseType=n.responseType||"json",n.data&&!r?(n.data=JSON.stringify(n.data),e0+=Za(n.data)):r&&(n.data.size?e0+=n.data.size:n.data instanceof FormData?e0+=wj(n.data):e0+=Za(JSON.stringify(n.data))),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json",n.method="POST",n.url=o,Qi.request(n).then(h=>{typeof h.data=="string"?TI+=Za(h.data):h.data instanceof ArrayBuffer||h.data instanceof Uint8Array?TI+=h.data.byteLength:TI+=Za(JSON.stringify(h.data)),c(h.data)}).catch(h=>{Qi.isCancel(h)?d(new he(B.OPERATION_ABORTED,"cancel token canceled")):h.code==="ECONNABORTED"?d(new he(B.NETWORK_TIMEOUT,h.message)):h.response?d(new he(B.NETWORK_RESPONSE_ERROR,h.response.status)):d(new he(B.NETWORK_ERROR,h.message))})})}async function oie(o,n){const r=new Blob([n.data],{type:"buffer"});return await bI(o,lF(lF({},n),{},{data:r,headers:{"Content-Type":"application/octet-stream"}}),!0)}const sie=()=>(Zy||Zy||(Zy=(window.location.protocol.split(":")[0]||"").toUpperCase(),Zy))==="HTTPS",dF=()=>window.isSecureContext!==void 0,ms=function(o){if(o.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return o;const n=o.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(n&&n[1]&&n[2]){const s=n[1],c=n[2];return"".concat(s,".").concat(c)}const r=o.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(r&&r[1]&&r[2]){const s=r[1],c=r[2];return"".concat(s,".").concat(100*(Number(c)+1))}return"4.0.0.999"}("4.20.2"),CI=function(){try{return JSON.parse("true")===!0}catch{return!0}}();var Xc;(function(o){o.Default="default",o.Auto="auto",o.Relay="relay",o.SdRtn="sd-rtn"})(Xc||(Xc={}));const wI="v4.20.2-0-g8ae7fdad(3/20/2024, 4:48:46 PM)",Ci={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TWCC:!1,PUBLISH_TWCC:!1,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_PUB_RTX:!1,USE_SUB_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:100,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,DISABLE_FEC:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,SVC:[],ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,ENABLE_DATASTREAM_2:!1,DATASTREAM_MAX_RETRANSMITS:10,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_INSTANT_VIDEO:!1,ENABLE_NTP_REPORT:!1,USE_XR:!1,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],PLUGIN_INFO:[]};function qt(o,n,r){var s,c;Le(s=Object.keys(Ci)).call(s,o)&&(!r&&Le(c=Object.keys(td)).call(c,o)||(Ci[o]=n,o==="ENABLE_VIDEO_SEI"&&n===!0&&(Ci.ENABLE_ENCODED_TRANSFORM=!0)))}function Y(o){return Ci[o]}const td={};function uF(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function ze(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?uF(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):uF(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}var ft;(function(o){o.SET_SESSION_ID="SET_SESSION_ID",o.SET_P2P_ID="SET_P2P_id",o.SET_DC_ID="SET_DC_id",o.SET_UID="SET_UID",o.SET_INT_UID="SET_INT_UID",o.SET_PUB_ID="SET_PUB_ID",o.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",o.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",o.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",o.AVOID_JOIN_START="AVOID_JOIN_START",o.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",o.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",o.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",o.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",o.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",o.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",o.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",o.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",o.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",o.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",o.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",o.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",o.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",o.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",o.RESET_KEY_METRICS="RESET_KEY_METRICS",o.SET_USE_DATACHANNEL="SET_USE_DATACHANNEL",o.SET_USE_P2P="SET_USE_P2P",o.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE"})(ft||(ft={}));class aie{constructor(n,r,s,c){I(this,"state",void 0),this.state={codec:n,audioCodec:r,mode:s,clientId:c,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useDataChannel:!1,useP2P:!1,p2pTransport:Xc.Default}}dispatch(n){this.state=function(r,s){switch(s.type){case ft.SET_SESSION_ID:return ze(ze({},r),{},{sessionId:s.sessionId});case ft.SET_P2P_ID:return ze(ze({},r),{},{p2pId:s.p2pId});case ft.SET_UID:return ze(ze({},r),{},{uid:s.uid});case ft.SET_INT_UID:return ze(ze({},r),{},{intUid:s.intUid});case ft.SET_PUB_ID:return ze(ze({},r),{},{pubId:s.pubId});case ft.KEY_METRIC_CLIENT_CREATED:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{clientCreated:s.metric})});case ft.KEY_METRIC_JOIN_START:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{joinStart:s.metric})});case ft.AVOID_JOIN_START:return ze(ze({},r),{},{avoidJoinStart:s.avoidJoinStart});case ft.KEY_METRIC_JOIN_END:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{joinEnd:s.metric})});case ft.KEY_METRIC_REQUEST_AP_START:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{requestAPStart:s.metric})});case ft.KEY_METRIC_REQUEST_AP_END:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{requestAPEnd:s.metric})});case ft.KEY_METRIC_JOIN_GATEWAY_START:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{joinGatewayStart:s.metric})});case ft.KEY_METRIC_JOIN_GATEWAY_END:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{joinGatewayEnd:s.metric})});case ft.KEY_METRIC_PEER_CONNECTION_START:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{peerConnectionStart:s.metric})});case ft.KEY_METRIC_PEER_CONNECTION_END:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{peerConnectionEnd:s.metric})});case ft.KEY_METRIC_DESCRIPTION_START:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{descriptionStart:s.metric})});case ft.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{signalChannelOpen:s.metric})});case ft.KEY_METRIC_ICE_CONNECTION_END:return ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{iceConnectionEnd:s.metric})});case ft.KEY_METRIC_PUBLISH:{const c=r.keyMetrics.publish,d=c.findIndex(h=>h.trackId===s.metric.trackId);return d!==-1?(c[d]=ze(ze({},c[d]),s.metric),ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{publish:[...c]})})):ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{publish:[...r.keyMetrics.publish,s.metric]})})}case ft.KEY_METRIC_SUBSCRIBE:{const c=r.keyMetrics.subscribe,d=c.findIndex(h=>h.userId===s.metric.userId&&h.type===s.metric.type);return d!==-1?(c[d]=ze(ze({},c[d]),s.metric),ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{subscribe:[...c]})})):ze(ze({},r),{},{keyMetrics:ze(ze({},r.keyMetrics),{},{subscribe:[...r.keyMetrics.subscribe,s.metric]})})}case ft.SET_CLOUD_PROXY_SERVER_MODE:return r.cloudProxyServerMode=s.mode,r;case ft.RECORD_JOIN_CHANNEL_SERVICE:return typeof s.index!="number"?r.joinChannelServiceRecords=[...r.joinChannelServiceRecords,s.record]:(r.joinChannelServiceRecords[s.index]=ze(ze({},r.joinChannelServiceRecords[s.index]),s.record),r.joinChannelServiceRecords=[...r.joinChannelServiceRecords]),r;case ft.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return r.joinChannelServiceRecords=[],r;case ft.RESET_KEY_METRICS:return r.keyMetrics={publish:[],subscribe:[]},r;case ft.SET_USE_DATACHANNEL:return ze(ze({},r),{},{useDataChannel:s.val});case ft.SET_USE_P2P:return ze(ze({},r),{},{useP2P:s.val});case ft.SET_TRANSPORT_TYPE:return ze(ze({},r),{},{p2pTransport:s.val});default:return r}}(this.state,n)}set sessionId(n){this.dispatch({type:ft.SET_SESSION_ID,sessionId:n})}get sessionId(){return this.state.sessionId}set codec(n){this.state.codec=n}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(n){this.dispatch({type:ft.SET_P2P_ID,p2pId:n})}get p2pId(){return this.state.p2pId}set dcId(n){this.dispatch({type:ft.SET_DC_ID,dcId:n})}get dcId(){return this.state.dcId}set uid(n){this.dispatch({type:ft.SET_UID,uid:n})}get uid(){return this.state.uid}set intUid(n){this.dispatch({type:ft.SET_INT_UID,intUid:n})}get intUid(){return this.state.intUid}set pubId(n){this.dispatch({type:ft.SET_PUB_ID,pubId:n})}get pubId(){return this.state.pubId}set cloudProxyServerMode(n){this.dispatch({type:ft.SET_CLOUD_PROXY_SERVER_MODE,mode:n})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useDataChannel(n){this.dispatch({type:ft.SET_USE_DATACHANNEL,val:n})}get useDataChannel(){return this.state.useDataChannel}set useP2P(n){this.dispatch({type:ft.SET_USE_P2P,val:n})}get useP2P(){return this.state.useP2P}set p2pTransport(n){this.dispatch({type:ft.SET_TRANSPORT_TYPE,val:n})}get p2pTransport(){return this.state.p2pTransport}clientCreated(){this.dispatch({type:ft.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:ft.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:ft.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:ft.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:ft.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:ft.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:ft.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:ft.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:ft.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:ft.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:ft.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:ft.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(n,r,s,c){this.dispatch({type:ft.KEY_METRIC_PUBLISH,metric:ze(ze({trackId:n,type:r},s&&{publishStart:s}),c&&{publishEnd:c})})}subscribe(n,r,s,c,d,h,f){this.dispatch({type:ft.KEY_METRIC_SUBSCRIBE,metric:ze(ze(ze(ze(ze({userId:n,type:r},s&&{subscribeStart:s}),c&&{subscribeEnd:c}),d&&{firstFrame:d}),h&&{streamAdded:h}),f&&{firstDecoded:f})})}massSubscribe(n,r,s,c){n.forEach(d=>{this.dispatch({type:ft.KEY_METRIC_SUBSCRIBE,metric:ze(ze(ze({userId:d.userId,type:d.type},r&&{subscribeStart:r}),s&&{subscribeEnd:s}),c&&{firstFrame:c})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(n,r){n.service==="gateway"&&Array.isArray(n.urls)&&(n.urls=n.urls.map(s=>s.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof r!="number"?(this.dispatch({type:ft.RECORD_JOIN_CHANNEL_SERVICE,record:ze(ze({},n),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(r<0||r>=this.state.joinChannelServiceRecords.length||this.dispatch({type:ft.RECORD_JOIN_CHANNEL_SERVICE,record:n,index:r}),r)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:ft.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:ft.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(n){this.dispatch({type:ft.AVOID_JOIN_START,avoidJoinStart:n})}}var nd,hF;(function(o){o.h264="h264",o.h265="h265",o.vp8="vp8",o.vp9="vp9",o.av1="av1"})(nd||(nd={})),function(o){o.opus="opus",o.pcma="pcma",o.pcmu="pcmu",o.g722="g722"}(hF||(hF={}));const pF=128,cie=96,fF=1e3,Ap=10;let lie=0;const t0=new class extends mn{reportLogUploadError(o){this.emit("REPORT_LOG_UPLOAD",o)}};class die{constructor(n){I(this,"logger",void 0),I(this,"prefixLists",[]),this.logger=n}debug(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];this.logger.debug(...this.prefixLists,...r)}info(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];this.logger.info(...this.prefixLists,...r)}warning(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];this.logger.warning(...this.prefixLists,...r)}error(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];this.logger.error(...this.prefixLists,...r)}prefix(n){return this.prefixLists.push(n),this}popPrefix(){return this.prefixLists.pop(),this}}function RI(){const o=new Date;return o.toTimeString().split(" ")[0]+":"+o.getMilliseconds()}function mF(){const o=new Date,n=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return n?(n==null?void 0:n[0])+":"+o.getUTCMilliseconds():o.toTimeString().split(" ")[0]+":"+o.getMilliseconds()}const gs={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},n0=Date.now(),wg=o=>{for(const n in gs)if(Object.prototype.hasOwnProperty.call(gs,n)&&gs[n]===o)return n;return"DEFAULT"},O=new class{constructor(){I(this,"proxyServerURL",void 0),I(this,"logLevel",gs.DEBUG),I(this,"uploadState","collecting"),I(this,"uploadLogWaitingList",[]),I(this,"uploadLogUploadingList",[]),I(this,"uploadErrorCount",0),I(this,"currentLogID",0),I(this,"url",void 0),I(this,"extLog",(o,n)=>{this.appendLogToWaitingList(o,...n)})}debug(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];const s=[gs.DEBUG].concat(n);this.log.apply(this,s)}info(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];const s=[gs.INFO].concat(n);this.log.apply(this,s)}warning(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];const s=[gs.WARNING].concat(n);this.log.apply(this,s)}warn(){this.warning(...arguments)}error(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];const s=[gs.ERROR].concat(n);this.log.apply(this,s)}upload(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];const s=[gs.DEBUG].concat(n);this.uploadLog.apply(this,s)}setLogLevel(o){o=Math.min(Math.max(0,o),4),this.logLevel=o}enableLogUpload(){qt("UPLOAD_LOG",!0)}disableLogUpload(){qt("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(o){this.proxyServerURL=o}prefix(o){return new die(this).prefix(o)}log(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];if(Date.now()-n0<100)return void setTimeout(()=>{this.log(...n)},Date.now()-n0);const s=Math.max(0,Math.min(4,n[0]));if(n[0]=RI()+" Agora-SDK [".concat(wg(s),"]:"),this.appendLogToWaitingList(s,...n),s<this.logLevel)return;const c=RI()+" %cAgora-SDK [".concat(wg(s),"]:");let d=[];if(!Y("USE_NEW_LOG"))switch(s){case gs.DEBUG:d=[c,"color: #64B5F6;"].concat(n.slice(1)),console.log.apply(console,d);break;case gs.INFO:d=[c,"color: #1E88E5; font-weight: bold;"].concat(n.slice(1)),console.log.apply(console,d);break;case gs.WARNING:d=[c,"color: #FB8C00; font-weight: bold;"].concat(n.slice(1)),console.warn.apply(console,d);break;case gs.ERROR:d=[c,"color: #B00020; font-weight: bold;"].concat(n.slice(1)),console.error.apply(console,d)}}uploadLog(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];if(Date.now()-n0<100)return void setTimeout(()=>{this.uploadLog(...n)},Date.now()-n0);const s=Math.max(0,Math.min(4,n[0]));n[0]=RI()+" Agora-SDK [".concat(wg(s),"]:"),this.appendLogToWaitingList(s,...n)}appendLogToWaitingList(o){if(!Y("UPLOAD_LOG"))return;for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];Array.isArray(r[0])?r[0][0]=mF()+" Agora-SDK [".concat(wg(o),"]:"):r[0]=mF()+" Agora-SDK [".concat(wg(o),"]:");let c="";r.forEach(d=>{typeof d=="object"&&(d=JSON.stringify(d)),c+="".concat(d," ")}),this.uploadLogWaitingList.push({payload_str:c,log_level:o,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const o=this.uploadLogUploadingList,n={sdk_version:ms,process_id:Y("PROCESS_ID"),payload:JSON.stringify(o)};return Ra(async()=>{const r=await Qi.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(Y("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(Y("LOG_UPLOAD_SERVER"),"/upload/v1")),n,{responseType:"text"});if(r.data!=="OK"){const s=new Error("unexpected upload log response");throw s.response=r,s}},()=>(this.uploadLogUploadingList=[],!1),r=>(r.response?t0.reportLogUploadError({status:r.response.status,data:r.response.data,headers:r.response.headers,message:r.message}):r.request?t0.reportLogUploadError({status:r.request.status,message:r.message}):t0.reportLogUploadError({status:-1,message:r.message}),!0),{timeout:Y("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:Y("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,Y("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),Y("UPLOAD_LOG_INTERVAL"))}).catch(o=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),Y("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),Y("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var gF,_F;function uie(o){return Xr(o.reportId,"params.reportId",0,100,!1),Xr(o.category,"params.category",0,100,!1),Xr(o.event,"params.event",0,100,!1),Xr(o.label,"params.label",0,100,!1),Yt(o.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(function(o){o.FREE="free",o.UPLOADING="uploading"})(gF||(gF={})),function(o){o[o.MISC=0]="MISC",o[o.INTERNAL_EVENT=1]="INTERNAL_EVENT",o[o.PUBLIC_EVENT=2]="PUBLIC_EVENT",o[o.WEB_EVENT=3]="WEB_EVENT",o[o.INTERNAL_API=4]="INTERNAL_API",o[o.WEB_API=5]="WEB_API",o[o.PUBLIC_API=6]="PUBLIC_API"}(_F||(_F={}));const hie={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var gr,dn,vF,EF;function yF(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function dt(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?yF(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):yF(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}(function(o){o.PUBLISH="publish",o.SUBSCRIBE="subscribe",o.WS_COMPRESSOR_INIT="ws_compressor_init",o.SESSION_INIT="session_init",o.JOIN_CHOOSE_SERVER="join_choose_server",o.REQ_USER_ACCOUNT="req_user_account",o.JOIN_GATEWAY="join_gateway",o.REJOIN_GATEWAY="rejoin_gateway",o.STREAM_SWITCH="stream_switch",o.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",o.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",o.FIRST_VIDEO_RECEIVED="first_video_received",o.FIRST_AUDIO_RECEIVED="first_audio_received",o.FIRST_VIDEO_DECODE="first_video_decode",o.FIRST_AUDIO_DECODE="first_audio_decode",o.ON_ADD_AUDIO_STREAM="on_add_audio_stream",o.ON_ADD_VIDEO_STREAM="on_add_video_stream",o.ON_UPDATE_STREAM="on_update_stream",o.ON_REMOVE_STREAM="on_remove_stream",o.USER_ANALYTICS="req_user_analytics",o.PC_STATS="pc_stats",o.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities"})(gr||(gr={})),function(o){o.SESSION="io.agora.pb.Wrtc.Session",o.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",o.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",o.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",o.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",o.PUBLISH="io.agora.pb.Wrtc.Publish",o.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",o.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",o.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",o.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",o.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",o.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",o.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",o.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",o.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",o.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",o.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",o.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",o.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",o.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",o.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",o.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",o.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",o.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",o.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",o.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",o.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",o.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",o.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",o.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",o.PC_STATS="io.agora.pb.Wrtc.PCStats",o.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities"}(dn||(dn={})),function(o){o[o.WORKER_EVENT=156]="WORKER_EVENT",o[o.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(vF||(vF={})),function(o){o[o.SESSION=26]="SESSION",o[o.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",o[o.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",o[o.JOIN_GATEWAY=28]="JOIN_GATEWAY",o[o.PUBLISH=30]="PUBLISH",o[o.SUBSCRIBE=29]="SUBSCRIBE",o[o.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",o[o.STREAM_SWITCH=32]="STREAM_SWITCH",o[o.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",o[o.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",o[o.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",o[o.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",o[o.API_INVOKE=41]="API_INVOKE",o[o.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",o[o.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",o[o.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",o[o.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",o[o.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",o[o.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",o[o.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",o[o.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",o[o.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",o[o.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",o[o.WORKER_EVENT=156]="WORKER_EVENT",o[o.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",o[o.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",o[o.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",o[o.USER_ANALYTICS=1e4]="USER_ANALYTICS",o[o.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(EF||(EF={}));class Rg{constructor(){I(this,"baseInfoMap",new Map),I(this,"proxyServer",void 0),I(this,"eventUploadTimer",void 0),I(this,"setSessionIdTimer",void 0),I(this,"url",void 0),I(this,"backupUrl",void 0),I(this,"_appId",void 0),I(this,"keyEventUploadPendingItems",[]),I(this,"normalEventUploadPendingItems",[]),I(this,"apiInvokeUploadPendingItems",[]),I(this,"apiInvokeCount",0),I(this,"ltsList",[]),I(this,"lastSendNormalEventTime",Date.now()),I(this,"customReportCounterTimer",void 0),I(this,"customReportCount",0),I(this,"extApiInvoke",async n=>{for(const r of n){const s=dt(dt({},r),{},{sid:null,invokeId:++this.apiInvokeCount,tag:yn.TRACER});this.sendApiInvoke(s)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),Y("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),Y("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(n){return this.baseInfoMap.get(n)}adjustSessionStartTime(n){if(!this.baseInfoMap.has(n)&&!this.baseInfoMap.get(n))return void O.error("adjust session ".concat(n," start time, sid is not exist or info is undefined"));const r=this.baseInfoMap.get(n),s=Date.now(),c=r.startTime;r.startTime=s,O.debug("rewrite session ".concat(n," startTime: ").concat(s," , ").concat(s-c,"ms")),this.baseInfoMap.set(n,r)}setAppId(n){this._appId=n}reportApiInvoke(n,r,s){r.timeout=r.timeout||6e4,r.reportResult=r.reportResult===void 0||r.reportResult;const c=Date.now();this.apiInvokeCount+=1;const d=this.apiInvokeCount,h=()=>({tag:r.tag,invokeId:d,sid:n,name:r.name,apiInvokeTime:c,options:r.options,states:r.states||null}),f=!!Y("SHOW_REPORT_INVOKER_LOG");f&&O.info("".concat(r.name," start"),r.options);let g=!1;Nr(r.timeout).then(()=>{g||(this.sendApiInvoke(dt(dt({},h()),{},{error:B.API_INVOKE_TIMEOUT,success:!1})),O.debug("".concat(r.name," timeout")))});const _=new he(B.UNEXPECTED_ERROR,"".concat(r.name,": this api invoke is end"));return{onSuccess:E=>{const T=()=>{if(g)throw _;return g=!0,this.sendApiInvoke(dt(dt({},h()),{},{success:!0},r.reportResult&&{result:E})),f&&O.info("".concat(r.name," onSuccess")),E};return s?Ij(T,r.name+"Success",s,()=>g=!0):T()},onError:E=>{const T=()=>{if(g)throw E;g=!0,this.sendApiInvoke(dt(dt({},h()),{},{success:!1,error:E})),f&&O.info("".concat(r.name," onFailure"),E.toString())};return s?Ij(T,r.name+"Error",s,()=>g=!0):T()}}}sessionInit(n,r){if(this.baseInfoMap.has(n))return;const s=Date.now(),c=this.createBaseInfo(n,s);c.cname=r.cname;const d=Object.assign({},{willUploadConsoleLog:Y("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:CI?"global":"oversea",areas:Y("AREAS")&&Y("AREAS").join(",")},r.extend),{stringUid:h,channelProfile:f,channelMode:g,isABTestSuccess:_,lsid:E,clientRole:T}=r,w=Date.now(),A=dt(dt({},c),{},{eventType:gr.SESSION_INIT,appid:r.appid,browser:navigator.userAgent,build:wI,lts:w,elapse:w-s,extend:JSON.stringify(d),mode:r.mode,process:Y("PROCESS_ID"),appType:Y("APP_TYPE"),success:!0,version:ms,stringUid:h,channelProfile:f,channelMode:g,isABTestSuccess:_,lsid:E,clientType:20,clientRole:T,serviceId:Y("PROCESS_ID"),extensionID:Y("PLUGIN_INFO").join(",")||""});this.send({type:dn.SESSION,data:A},!0)}joinChooseServer(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt({},c),{},{eventType:gr.JOIN_CHOOSE_SERVER,lts:d,eventElapse:d-r.lts,chooseServerAddr:r.csAddr,errorCode:r.ec,elapse:d-s.startTime,success:r.succ,chooseServerAddrList:JSON.stringify(r.serverList),uid:r.uid?parseInt(r.uid):null,cid:r.cid?parseInt(r.cid):null,chooseServerIp:r.csIp||"",opid:r.opid,unilbsServerIds:r.unilbsServerIds,extend:r.extend||void 0,isHttp3:r.isHttp3});this.send({type:dn.JOIN_CHOOSE_SERVER,data:h},!0)}reqUserAccount(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt({},c),{},{eventType:gr.REQ_USER_ACCOUNT,lts:d,success:r.success,serverAddress:r.serverAddr,stringUid:r.stringUid,uid:r.uid,errorCode:r.errorCode,elapse:d-s.startTime,eventElapse:d-r.lts,extend:JSON.stringify(r.extend)});this.send({type:dn.REQ_USER_ACCOUNT,data:h},!0)}joinGateway(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info;r.vid&&(c.vid=r.vid),c.uid=r.uid,c.cid=r.cid;const d=Date.now(),{firstSuccess:h,avoidJoinStartTime:f,isProxy:g,addr:_}=r,E=d-(h&&f?f:s.startTime),T=dt(dt({},c),{},{eventType:gr.JOIN_GATEWAY,lts:d,gatewayAddr:r.addr,success:r.succ,errorCode:r.ec,elapse:E,eventElapse:d-r.lts,firstSuccess:h,signalChannel:r.signalChannel}),w=T.success?1:0;if(r.succ&&(s.lastJoinSuccessTime=d),h)this.send({type:dn.JOIN_GATEWAY,data:T},!0);else{let A;if(_)if(g){const P=_.match(/h=(\d{1,3}-){3}\d{1,3}/g),D=_.match(/p=[0-9]{1,6}/g);A={isSuccess:w,gatewayIp:P&&P.length?P[0].split("=")[1].replace(/-/g,"."):"",port:D&&D.length?D[0].split("=")[1]:"",isProxy:g?1:0}}else{const P=_.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),D=_.match(/(:|p=)[0-9]{1,6}/g);A={isSuccess:w,gatewayIp:P&&P.length?P[0].split("//")[1].replace(/-/g,"."):"",port:D&&D.length?D[0].split(/:|p=/g)[1]:"",isProxy:g?1:0}}else A={isSuccess:w,gatewayIp:"",port:"",isProxy:g?1:0};delete T.success,delete T.eventType,delete T.firstSuccess,T.vid=Number(T.vid);const L=Object.assign({},T,A,{eventType:gr.REJOIN_GATEWAY});this.send({type:dn.RE_JOIN_GATEWAY,data:L},!0)}}joinChannelTimeout(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=Date.now(),d=dt(dt({},s.info),{},{lts:c,timeout:r,elapse:c-s.startTime});this.send({type:dn.JOIN_CHANNEL_TIMEOUT,data:d},!0)}publish(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt({},c),{},{eventType:gr.PUBLISH,lts:d,eventElapse:r.eventElapse,elapse:d-s.startTime,success:r.succ,errorCode:r.ec,videoName:r.videoName,audioName:r.audioName,screenName:r.screenName,screenshare:r.screenshare,audio:r.audio,video:r.video,p2pid:r.p2pid,publishRequestid:r.publishRequestid});this.send({type:dn.PUBLISH,data:h},!0)}subscribe(n,r,s){const c=this.baseInfoMap.get(n);if(!c)return;const d=c.info,h=Date.now(),f=dt(dt({},d),{},{eventType:gr.SUBSCRIBE,lts:h,eventElapse:r.eventElapse,elapse:h-c.startTime,success:r.succ,errorCode:r.ec,video:r.video,audio:r.audio,subscribeRequestid:r.subscribeRequestid,p2pid:r.p2pid},s&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof r.peerid=="string"?f.peerSuid=r.peerid:f.peer=r.peerid,this.send({type:dn.SUBSCRIBE,data:f},!0)}wsCompressorInit(n){var r;const s=[...jo(r=this.baseInfoMap).call(r)],c=s.length?s[0]:"UnableToGetSid",d=this.baseInfoMap.get(c);if(!d)return;const h=d.info,f=Date.now(),g=dt(dt({},h),{},{eventType:gr.WS_COMPRESSOR_INIT,lts:f,eventElapse:n.eventElapse,elapse:f-d.startTime,status:n.status?1:2});this.send({type:dn.WS_COMPRESSOR_INIT,data:g},!0)}firstRemoteVideoDecode(n,r,s,c){const d=this.baseInfoMap.get(n);if(!d)return;const h=d.info,f=Date.now(),g=dt(dt(dt({},h),c),{},{elapse:f-d.startTime,eventType:r,lts:f,firstDecodeFrame:Math.max(f-d.startTime,0),apEnd:Math.max(c.apEnd-d.startTime,0),apStart:Math.max(c.apStart-d.startTime,0),joinGwEnd:Math.max(c.joinGwEnd-d.startTime,0),joinGwStart:Math.max(c.joinGwStart-d.startTime,0),pcEnd:Math.max(c.pcEnd-d.startTime,0),pcStart:Math.max(c.pcStart-d.startTime,0),subscriberEnd:Math.max(c.subscriberEnd-d.startTime,0),subscriberStart:Math.max(c.subscriberStart-d.startTime,0),videoAddNotify:Math.max(c.videoAddNotify-d.startTime,0)});this.send({type:s,data:g},!0)}firstRemoteFrame(n,r,s,c){const d=this.baseInfoMap.get(n);if(!d)return;const h=d.info,f=Date.now(),g=dt(dt(dt({},h),c),{},{elapse:f-d.startTime,eventType:r,lts:f});this.send({type:s,data:g},!0)}pcStats(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt(dt({},c),r),{},{vid:c.vid===void 0?0:Number(c.vid),elapse:d-s.startTime,eventType:gr.PC_STATS,lts:d});this.send({type:dn.PC_STATS,data:h},!0)}updateRemoteRTPCapabilities(n,r){if(n){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt(dt({},c),r),{},{vid:c.vid===void 0?0:Number(c.vid),eventType:gr.UPDATE_REMOTE_RTPCAPABILITIES,lts:d});this.send({type:dn.UPDATE_REMOTE_RTPCAPABILITIES,data:h},!0)}}onGatewayStream(n,r,s,c){const d=this.baseInfoMap.get(n);if(!d)return;const h=d.info,f=Date.now(),g=dt(dt(dt({},h),c),{},{eventType:r,lts:f});this.send({type:s,data:g},!0)}streamSwitch(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt({},c),{},{eventType:gr.STREAM_SWITCH,lts:d,isDual:r.isdual,elapse:d-s.startTime,success:r.succ});this.send({type:dn.STREAM_SWITCH,data:h},!0)}requestProxyAppCenter(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt({},c),{},{eventType:gr.REQUEST_PROXY_APPCENTER,lts:d,eventElapse:d-r.lts,elapse:d-s.startTime,APAddr:r.APAddr,workerManagerList:r.workerManagerList,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:dn.REQUEST_PROXY_APPCENTER,data:h},!0)}requestProxyWorkerManager(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt({},c),{},{eventType:gr.REQUEST_PROXY_WORKER_MANAGER,lts:d,eventElapse:d-r.lts,elapse:d-s.startTime,workerManagerAddr:r.workerManagerAddr,response:r.response,errorCode:r.ec,success:r.succ});this.send({type:dn.REQUEST_PROXY_WORKER_MANAGER,data:h},!0)}setProxyServer(n){this.proxyServer=n,n?O.debug("reportProxyServerurl: ".concat(n)):O.debug("disable reportProxyServerurl: ".concat(n))}peerPublishStatus(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt({},c),{},{subscribeElapse:r.subscribeElapse,peer:r.peer,peerPublishDuration:Math.max(r.audioPublishDuration,r.videoPublishDuration),audiotag:r.audioPublishDuration>0?1:-1,videotag:r.videoPublishDuration>0?1:-1,lts:d,elapse:d-s.startTime,joinChannelSuccessElapse:d-(s.lastJoinSuccessTime||d),peerPublishDurationVideo:r.videoPublishDuration,peerPublishDurationAudio:r.audioPublishDuration});this.send({type:dn.PEER_PUBLISH_STATUS,data:h},!0)}workerEvent(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now();(function(f,g,_){const E=f[g];if(!E||typeof E!="string")return[f];f[g]="";const T=Za(JSON.stringify(f));let w=0;const A=[];let L=0;for(let P=0;P<E.length;P++)L+=E.charCodeAt(P)<=127?1:3,L<=_-T||(A[A.length]=Pu(Pu({},f),{},{[g]:E.substring(w,P)}),w=P,L=E.charCodeAt(P)<=127?1:3);return w!==E.length-1&&(A[A.length]=Pu(Pu({},f),{},{[g]:E.substring(w)})),A})(dt(dt(dt({},c),r),{},{elapse:d-s.startTime,lts:d,productType:"WebRTC"}),"payload",1300).forEach(f=>this.send({type:dn.WORKER_EVENT,data:f},!0))}apworkerEvent(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt(dt({},c),r),{},{elapse:d-s.startTime,lts:d});this.send({type:dn.AP_WORKER_EVENT,data:h},!0)}joinWebProxyAP(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt(dt({},c),r),{},{elapse:d-s.startTime,lts:d,extend:r.extend||void 0});this.send({type:dn.JOIN_WEB_PROXY_AP,data:h},!0)}WebSocketQuit(n,r){const s=this.baseInfoMap.get(n);if(!s)return;const c=s.info,d=Date.now(),h=dt(dt(dt({},c),r),{},{elapse:d-s.startTime,lts:d});this.send({type:dn.WEBSOCKET_QUIT,data:h},!0)}async sendCustomReportMessage(n,r){if(this.customReportCount+=r.length,this.customReportCount>Y("CUSTOM_REPORT_LIMIT"))throw new he(B.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const s=Date.now(),c=r.map(d=>({type:dn.USER_ANALYTICS,data:dt(dt({sid:n},d),{},{lts:s})}));try{Y("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(c):await this.postDataToStatsCollector(c)}catch(d){throw O.error("send custom report message failed",d.toString()),new he(B.CUSTOM_REPORT_SEND_FAILED,d.message)}}sendApiInvoke(n){const r=Y("NOT_REPORT_EVENT");if(n.tag&&Le(r)&&Le(r).call(r,n.tag))return!1;if(n.sid===null)return this.apiInvokeUploadPendingItems.push(n),!1;const s=this.baseInfoMap.get(n.sid);if(!s)return this.apiInvokeUploadPendingItems.push(n),!1;const{cname:c,uid:d,cid:h}=s.info;let f;if(n.lts=n.lts||Date.now(),n.error)if(n.error instanceof he){const{code:_,message:E}=n.error;f=_||E||n.error.toString()}else f=n.error.toString();const g={invokeId:n.invokeId,sid:n.sid,cname:c,cid:h,uid:d,lts:n.lts,success:n.success,elapse:n.lts-s.startTime,execElapse:n.lts-n.apiInvokeTime,apiName:n.name,options:n.options?JSON.stringify(n.options):void 0,execStates:n.states?JSON.stringify(n.states):void 0,execResult:n.result?JSON.stringify(n.result):void 0,errorCode:n.error?f:void 0,errorMsg:n.error?JSON.stringify(n.error):void 0};return this.send({type:dn.API_INVOKE,data:g},!1),!0}appendSessionId(){Rg.__CLIENT_LIST__.forEach(n=>{if(n._sessionId){const r=this.apiInvokeUploadPendingItems.length;for(let s=0;s<r;s++){const c=this.apiInvokeUploadPendingItems.shift();c&&(c.sid=n._sessionId,this.sendApiInvoke(Object.assign({},c)))}}})}send(n,r){if(r)return this.keyEventUploadPendingItems.push(n),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(n),this.normalEventUploadPendingItems.length>Y("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(n,r){const s=[],c=[];for(;n.length;){const h=n.shift();s.length<20?s.push(h):c.push(h)}n.push(...c);for(const h of[...s]){var d;this.ltsList.indexOf(h.data.lts)!==-1?(h.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(h.data.lts)):(this.ltsList.push(h.data.lts),cg(d=this.ltsList).call(d,(f,g)=>f-g))}return r||(this.lastSendNormalEventTime=Date.now()),Y("ENABLE_EVENT_REPORT")&&s.length&&(Y("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(s):this.postDataToStatsCollector(s)).catch((h=>f=>{Y("EVENT_REPORT_RETRY")&&(r?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(h):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(h),this.normalEventUploadPendingItems.length>Y("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-Y("NORMAL_EVENT_QUEUE_CAPACITY")),O.warning("report: drop normal events"))))})(s)),n}async postDataToStatsCollector2(n){rr.networkState===bi.OFFLINE&&await ae.race([rr.onlineWaiter,Nr(2*ir.maxRetryTimeout)]);const r=d=>{let h=new Uint8Array;return d.forEach(f=>{const g=ZR(JSON.stringify(f.data)),_=new ArrayBuffer(5),E=(w=>{let A=0;return Object.entries(dn).forEach(L=>{let[P,D]=L;D===w.type&&(A=EventNameToID[P])}),A})(f),T=new DataView(_);T.setUint16(0,g.byteLength,!0),T.setUint8(2,255&E),T.setUint8(3,E>>>8&255),T.setUint8(4,E>>>16&255),h=gj(h,new Uint8Array(_)),h=gj(h,g)}),h},s="event";let c=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Y("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(s):"https://".concat(Y("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(s);for(let d=0;d<2;d+=1){d===1&&(c=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Y("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(s):"https://".concat(Y("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(s));try{await bI(c,{timeout:1e4,data:r(n),headers:dt(dt({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(h){if(d===1)throw h;continue}return}}async postDataToStatsCollector(n){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:n.map(h=>JSON.stringify(h)),vid:(h=>{const f=h&&h.data.sid&&this.baseInfoMap.get(h.data.sid);return f&&f.info.vid&&+f.info.vid||0})(n[0])};rr.networkState===bi.OFFLINE&&await ae.race([rr.onlineWaiter,Nr(2*ir.maxRetryTimeout)]);const c=r?"/events/proto-raws":"/events/messages";let d=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Y("EVENT_REPORT_DOMAIN"),"&p=").concat(Y("STATS_COLLECTOR_PORT"),"&d=").concat(c):"https://".concat(Y("EVENT_REPORT_DOMAIN"),":").concat(Y("STATS_COLLECTOR_PORT")).concat(c));for(let h=0;h<2;h+=1){h===1&&(d=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Y("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(Y("STATS_COLLECTOR_PORT"),"&d=").concat(c):"https://".concat(Y("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(Y("STATS_COLLECTOR_PORT")).concat(c)));try{r?await oie(d,{timeout:1e4,data:s}):await bI(d,{timeout:1e4,data:s})}catch(f){if(h===1)throw f;continue}return}}createBaseInfo(n,r){const s=Object.assign({},hie);return s.sid=n,this.baseInfoMap.set(n,{info:s,startTime:r}),s}reportResourceTiming(n,r){const s=performance.getEntriesByName(n),c=s[s.length-1];c&&this.reportApiInvoke(r,{name:"Client.resourceTiming",options:c,tag:yn.TRACER}).onSuccess()}}function Je(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(n,r,s){const c=s.value;if(typeof c=="function"){const d=o.className||n.__className__||(n.constructor.name==="AgoraRTCClient"?"Client":n.constructor.name);s.value=function(){for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];let _=f;if(o.argsMap)try{_=o.argsMap(this,...f)}catch(T){O.warning(T),_=[]}try{JSON.stringify(_)}catch{O.warning("arguments for method ".concat(d,".").concat(String(r)," not serializable for apiInvoke.")),_=[]}const E=(o.report||Be).reportApiInvoke(this._sessionId||null,{name:"".concat(d,".").concat(String(r)),options:_,tag:yn.TRACER,reportResult:o.reportResult},o.throttleTime);try{const T=c.apply(this,f);return T instanceof ae?T.then(w=>(E.onSuccess(o.reportResult&&w),w)).catch(w=>{throw E.onError(w),w}):(E.onSuccess(o.reportResult&&T),T)}catch(T){throw E.onError(T),T}}}return s}}I(Rg,"__CLIENT_LIST__",[]);const Be=new Rg;t0.on("REPORT_LOG_UPLOAD",o=>{o.networkState=rr.networkState,Be.reportApiInvoke(null,{name:"logUploadError",options:o,tag:yn.TRACER})});const pie=["CHINA","GLOBAL"],Pi=function(){const o="us".concat("erna","me"),n="pa".concat("sswo","rd"),r=["t","s","t"];r.splice(1,0,"e");const s=r.join(""),c=[];for(let f=0;f<6;f++)c.push("1");const d=c.join(""),h={};return h[o]=s,h[n]=d,Object.assign(h,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=Pi,CI||(Ci.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Ci.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Ci.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Ci.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Ci.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Ci.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Ci.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Ci.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Ci.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Ci.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Ci.AREAS=["NORTH_AMERICA","OVERSEA"]);const SF=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],rd=[];function Du(o,n){return!!n&&rd.some(r=>r.uid===o&&r.channelName===n)}Rg.__CLIENT_LIST__=rd;var II,Zi,Op,Ig,Fo,di,qe,pt,De,We,Qc,nt,TF,ui,tt,_r,id,fie=Hl("Array").values,mie=$l,gie=ci,_ie=N,vie=fie,AI=Array.prototype,Eie={DOMTokenList:!0,NodeList:!0},Ia=u(function(o){var n=o.values;return o===AI||_ie(AI,o)&&n===AI.values||gie(Eie,mie(o))?vie:n});function fe(o,n,r,s){var c,d=arguments.length,h=d<3?n:s===null?s=Object.getOwnPropertyDescriptor(n,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(o,n,r,s);else for(var f=o.length-1;f>=0;f--)(c=o[f])&&(h=(d<3?c(h):d>3?c(n,r,h):c(n,r))||h);return d>3&&h&&Object.defineProperty(n,r,h),h}function j(o,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,n)}(function(o){o.L1T1="L1T1",o.L1T2="L1T2",o.L1T3="L1T3",o.L2T1_KEY="L2T1_KEY",o.L2T2_KEY="L2T2_KEY",o.L2T3_KEY="L2T3_KEY",o.L3T1_KEY="L3T1_KEY",o.L3T2_KEY="L3T2_KEY",o.L3T3_KEY="L3T3_KEY"})(II||(II={})),function(o){o.CERTIFICATE="certificate",o.CODEC="codec",o.CANDIDATE_PAIR="candidate-pair",o.LOCAL_CANDIDATE="local-candidate",o.REMOTE_CANDIDATE="remote-candidate",o.INBOUND="inbound-rtp",o.TRACK="track",o.OUTBOUND="outbound-rtp",o.PC="peer-connection",o.REMOTE_INBOUND="remote-inbound-rtp",o.REMOTE_OUTBOUND="remote-outbound-rtp",o.TRANSPORT="transport",o.CSRC="csrc",o.DATA_CHANNEL="data-channel",o.STREAM="stream",o.SENDER="sender",o.RECEIVER="receiver"}(Zi||(Zi={})),function(o){o[o.ACCESS_POINT=101]="ACCESS_POINT",o[o.UNILBS=201]="UNILBS",o[o.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(Op||(Op={})),function(o){o[o.IIIEGAL_APPID=1]="IIIEGAL_APPID",o[o.IIIEGAL_UID=2]="IIIEGAL_UID",o[o.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(Ig||(Ig={})),function(o){o[o.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",o[o.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",o[o.INTERNAL_ERROR=8]="INTERNAL_ERROR",o[o.NO_AUTHORIZED=9]="NO_AUTHORIZED",o[o.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",o[o.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",o[o.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",o[o.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",o[o.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",o[o.USER_OVERLOAD=16]="USER_OVERLOAD",o[o.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",o[o.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(Fo||(Fo={})),function(o){o[o.NO_FLAG_SET=100]="NO_FLAG_SET",o[o.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",o[o.INVALID_FALG_SET=102]="INVALID_FALG_SET",o[o.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",o[o.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",o[o.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",o[o.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",o[o.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",o[o.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",o[o.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",o[o.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",o[o.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",o[o.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",o[o.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",o[o.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",o[o.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",o[o.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",o[o.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",o[o.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(di||(di={})),function(o){o[o.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",o[o.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",o[o.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",o[o.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",o[o.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",o[o.K_TICKET_INVALID=7]="K_TICKET_INVALID",o[o.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",o[o.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",o[o.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",o[o.K_UID_BANNED=14]="K_UID_BANNED",o[o.K_IP_BANNED=15]="K_IP_BANNED",o[o.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",o[o.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",o[o.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",o[o.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",o[o.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",o[o.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",o[o.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",o[o.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",o[o.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",o[o.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",o[o.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",o[o.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",o[o.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",o[o.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",o[o.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",o[o.ERR_INVALID_UID=117]="ERR_INVALID_UID",o[o.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",o[o.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",o[o.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",o[o.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",o[o.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",o[o.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",o[o.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",o[o.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",o[o.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",o[o.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",o[o.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",o[o.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",o[o.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",o[o.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",o[o.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",o[o.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",o[o.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",o[o.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",o[o.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",o[o.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",o[o.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",o[o.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",o[o.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",o[o.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",o[o.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",o[o.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",o[o.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",o[o.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",o[o.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",o[o.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",o[o.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",o[o.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",o[o.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",o[o.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",o[o.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",o[o.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",o[o.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(qe||(qe={})),function(o){o.CONNECTING="connecting",o.CONNECTED="connected",o.RECONNECTING="reconnecting",o.CLOSED="closed"}(pt||(pt={})),function(o){o.WS_CONNECTED="ws_connected",o.WS_RECONNECTING="ws_reconnecting",o.WS_CLOSED="ws_closed",o.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",o.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",o.ON_BINARY_DATA="on_binary_data",o.REQUEST_RECOVER="request_recover",o.REQUEST_JOIN_INFO="request_join_info",o.REQUEST_REJOIN_INFO="req_rejoin_info",o.IS_P2P_DISCONNECTED="is_p2p_dis",o.DISCONNECT_P2P="dis_p2p",o.ABORT_P2P_EXECUTION="abort_p2p_execution",o.NEED_RENEW_SESSION="need-sid",o.REPORT_JOIN_GATEWAY="report_join_gateway",o.REQUEST_TIMEOUT="request_timeout",o.REQUEST_SUCCESS="request_success",o.JOIN_RESPONSE="join_response",o.DATACHANNEL_PRECONNECT="datachannel_preconnect",o.DATACHANNEL_CONNECTING="datachannel_connecting",o.DATACHANNEL_FAILBACK="datachannel_failback",o.P2P_CONNECTION="p2p_connection",o.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",o.P2P_SUBSCRIBE="p2p_subscribe",o.P2P_UNSUBSCRIBE="p2p_unsubscribe",o.P2P_EXCHANGE_SDP="p2p_exchange_sdp",o.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",o.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream"}(De||(De={})),function(o){o.PING="ping",o.PING_BACK="ping_back",o.JOIN="join_v3",o.REJOIN="rejoin_v3",o.LEAVE="leave",o.SET_CLIENT_ROLE="set_client_role",o.PUBLISH="publish",o.PUBLISH_DATASTREAM="publish_datastream",o.UNPUBLISH="unpublish",o.UNPUBLISH_DATASTREAM="unpublish_datastream",o.SUBSCRIBE="subscribe",o.PRE_SUBSCRIBE="pre_subscribe",o.SUBSCRIBE_DATASTREAM="subscribe_datastream",o.SUBSCRIBE_STREAMS="subscribe_streams",o.UNSUBSCRIBE="unsubscribe",o.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",o.UNSUBSCRIBE_STREAMS="unsubscribe_streams",o.SUBSCRIBE_CHANGE="subscribe_change",o.TRAFFIC_STATS="traffic_stats",o.RENEW_TOKEN="renew_token",o.SWITCH_VIDEO_STREAM="switch_video_stream",o.DEFAULT_VIDEO_STREAM="default_video_stream",o.SET_FALLBACK_OPTION="set_fallback_option",o.GATEWAY_INFO="gateway_info",o.CONTROL="control",o.SEND_METADATA="send_metadata",o.DATA_STREAM="data_stream",o.PICK_SVC_LAYER="pick_svc_layer",o.RESTART_ICE="restart_ice",o.CONNECT_PC="connect_pc",o.SET_VIDEO_PROFILE="set_video_profile",o.SET_PARAMETER="set_parameter",o.SET_RTM2_FLAG="set_rtm2_flag"}(We||(We={})),function(o){o.WRTC_STATS="wrtc_stats",o.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",o.DENOISER_STATS="denoiser_stats",o.EXTENSION_USAGE_STATS="extension_usage_stats"}(Qc||(Qc={})),function(o){o.ON_USER_ONLINE="on_user_online",o.ON_USER_OFFLINE="on_user_offline",o.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",o.ON_PUBLISH_STREAM="on_publish_stream",o.ON_UPLINK_STATS="on_uplink_stats",o.ON_P2P_LOST="on_p2p_lost",o.ON_REMOVE_STREAM="on_remove_stream",o.ON_ADD_AUDIO_STREAM="on_add_audio_stream",o.ON_ADD_VIDEO_STREAM="on_add_video_stream",o.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",o.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",o.ON_USER_BANNED="on_user_banned",o.ON_USER_LICENSE_BANNED="on_user_license_banned",o.ON_NOTIFICATION="on_notification",o.ON_CRYPT_ERROR="on_crypt_error",o.MUTE_AUDIO="mute_audio",o.MUTE_VIDEO="mute_video",o.UNMUTE_AUDIO="unmute_audio",o.UNMUTE_VIDEO="unmute_video",o.ON_P2P_OK="on_p2p_ok",o.RECEIVE_METADATA="receive_metadata",o.ON_DATA_STREAM="on_data_stream",o.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",o.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",o.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",o.ENABLE_LOCAL_VIDEO="enable_local_video",o.DISABLE_LOCAL_VIDEO="disable_local_video",o.ENABLE_LOCAL_AUDIO="enable_local_audio",o.DISABLE_LOCAL_AUDIO="disable_local_audio",o.ON_PUBLISHED_USER_LIST="on_published_user_list"}(nt||(nt={})),function(o){o.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",o.NEED_ANSWER="NEED_ANSWER",o.NEED_RENEGOTIATE="NEED_RENEGOTIATE",o.P2P_LOST="P2P_LOST",o.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",o.NEED_UNPUB="NEED_UNPUB",o.NEED_UNSUB="NEED_UNSUB",o.NEED_UPLOAD="NEED_UPLOAD",o.NEED_CONTROL="NEED_CONTROL",o.START_RECONNECT="START_RECONNECT",o.END_RECONNECT="END_RECONNECT",o.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(TF||(TF={})),function(o){o.SEND_ONLY="SEND_ONLY",o.RECEIVE_ONLY="RECEIVE_ONLY"}(ui||(ui={})),function(o){o.CONNECTED="websocket:connected",o.RECONNECTING="websocket:reconnecting",o.WILL_RECONNECT="websocket:will_reconnect",o.CLOSED="websocket:closed",o.FAILED="websocket:failed",o.ON_MESSAGE="websocket:on_message",o.REQUEST_NEW_URLS="websocket:request_new_urls",o.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",o.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",o.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"}(tt||(tt={}));class Z extends he{constructor(n){super(n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),I(this,"name","AgoraRTCException")}print(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(n,O)}throw(){super.throw(O)}}function OI(o){if(typeof o!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(o))throw O.error("Invalid Channel Name ".concat(o)),new Z(B.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function NI(o){if(n=o,!(typeof n=="number"&&Math.floor(n)===n&&0<=n&&n<=4294967295||hj(o,1,255)))throw new Z(B.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var n;typeof o=="string"&&O.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}(function(o){o.TRANSCODE="mix_streaming",o.RAW="raw_streaming",o.INJECT="inject_streaming"})(_r||(_r={})),function(o){o[o.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",o[o.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",o[o.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",o[o.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",o[o.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",o[o.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",o[o.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",o[o.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",o[o.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",o[o.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",o[o.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(id||(id={}));const yie={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},PI={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function kI(o,n){Xr(o.url,"".concat(n,".url"),1,1e3,!1),wn(o.x)||Yt(o.x,"".concat(n,".x"),0,1e4),wn(o.y)||Yt(o.y,"".concat(n,".y"),0,1e4),wn(o.width)||Yt(o.width,"".concat(n,".width"),0,1e4),wn(o.height)||Yt(o.height,"".concat(n,".height"),0,1e4),wn(o.zOrder)||Yt(o.zOrder,"".concat(n,".zOrder"),0,255),wn(o.alpha)||Yt(o.alpha,"".concat(n,".alpha"),0,1,!1)}const Sie={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},Tie={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};var zs,Np,Yn,bF,hi,Aa,ki,od,jt,In,xu,cr,r0,Ot;function CF(o){if(!o.channelName)throw new Z(B.INVALID_PARAMS,"invalid channelName in info");if(typeof o.uid!="number")throw new Z(B.INVALID_PARAMS,"invalid uid in info, uid must be a number");return o.token&&Xr(o.token,"info.token",1,2047),NI(o.uid),OI(o.channelName),!0}(function(o){o.WARNING="@live_uap-warning",o.ERROR="@line_uap-error",o.PUBLISH_STREAM_STATUS="@live_uap-publish-status",o.INJECT_STREAM_STATUS="@live_uap-inject-status",o.WORKER_STATUS="@live_uap-worker-status",o.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(zs||(zs={})),function(o){o.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(Np||(Np={})),function(o){o[o.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",o[o.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",o[o.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",o[o.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",o[o.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",o[o.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",o[o.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",o[o.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",o[o.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",o[o.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",o[o.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",o[o.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",o[o.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",o[o.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",o[o.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",o[o.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",o[o.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",o[o.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",o[o.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",o[o.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",o[o.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(Yn||(Yn={})),function(o){o.CONNECT_FAILED="connect failed",o.CONNECT_TIMEOUT="connect timeout",o.WS_DISCONNECTED="websocket disconnected",o.REQUEST_TIMEOUT="request timeout",o.REQUEST_FAILED="request failed",o.WAIT_STATUS_TIMEOUT="wait status timeout",o.WAIT_STATUS_ERROR="wait status error",o.BAD_STATE="bad state",o.WS_ABORT="ws abort",o.AP_REQUEST_TIMEOUT="AP request timeout",o.AP_JSON_PARSE_ERROR="AP json parse error",o.AP_REQUEST_ERROR="AP request error",o.AP_REQUEST_ABORT="AP request abort"}(bF||(bF={})),function(o){o[o.SetSdkProfile=0]="SetSdkProfile",o[o.SetSourceChannel=1]="SetSourceChannel",o[o.SetSourceUserId=2]="SetSourceUserId",o[o.SetDestChannel=3]="SetDestChannel",o[o.StartPacketTransfer=4]="StartPacketTransfer",o[o.StopPacketTransfer=5]="StopPacketTransfer",o[o.UpdateDestChannel=6]="UpdateDestChannel",o[o.Reconnect=7]="Reconnect",o[o.SetVideoProfile=8]="SetVideoProfile"}(hi||(hi={})),function(o){o.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",o.NETWORK_CONNECTED="NETWORK_CONNECTED",o.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",o.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",o.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",o.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",o.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",o.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",o.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",o.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(Aa||(Aa={})),function(o){o.RELAY_STATE_IDLE="RELAY_STATE_IDLE",o.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",o.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",o.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(ki||(ki={})),function(o){o.RELAY_OK="RELAY_OK",o.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",o.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",o.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(od||(od={})),function(o){o.High="high",o.Low="low",o.Audio="audio",o.Screen="screen",o.ScreenLow="screen_low"}(jt||(jt={})),function(o){o.DISCONNECT="disconnect",o.CONNECTION_STATE_CHANGE="connection-state-change",o.NETWORK_QUALITY="network-quality",o.STREAM_TYPE_CHANGE="stream-type-change",o.IS_P2P_DISCONNECTED="is-p2p-dis",o.DISCONNECT_P2P="dis-p2p",o.REQUEST_NEW_GATEWAY_LIST="req-gate-url",o.NEED_RENEW_SESSION="need-sid",o.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",o.JOIN_RESPONSE="join-response",o.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",o.RESET_CONNECTION_EVENTS="reset-connection-events",o.DATACHANNEL_PRECONNECT="datachannel_preconnect",o.DATACHANNEL_FAILBACK="datachannel_failback",o.RESET_SIGNAL="reset-signal"}(In||(In={})),function(o){o.P2P_DISCONNECTED="P2P_DISCONNECTED",o.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",o.TIMEOUT="TIMEOUT",o.UNKNOWN_REASON="UNKNOWN_REASON"}(xu||(xu={})),function(o){o[o.Nothing=0]="Nothing",o[o.Audio=1]="Audio",o[o.LwoVideo=2]="LwoVideo",o[o.Video=4]="Video",o[o.Data=8]="Data",o[o.DataStream0=256]="DataStream0",o[o.DataStream1=512]="DataStream1",o[o.DataStream2=1024]="DataStream2",o[o.DataStream3=2048]="DataStream3",o[o.DataStream4=4096]="DataStream4",o[o.DataStream5=8192]="DataStream5",o[o.DataStream6=16384]="DataStream6",o[o.DataStream7=32768]="DataStream7"}(cr||(cr={})),function(o){o[o.websocket=0]="websocket",o[o.datachannel=1]="datachannel"}(r0||(r0={})),function(o){o.CHINA="CHINA",o.ASIA="ASIA",o.NORTH_AMERICA="NORTH_AMERICA",o.EUROPE="EUROPE",o.JAPAN="JAPAN",o.INDIA="INDIA",o.KOREA="KOREA",o.HKMC="HKMC",o.US="US",o.OCEANIA="OCEANIA",o.SOUTH_AMERICA="SOUTH_AMERICA",o.AFRICA="AFRICA",o.OVERSEA="OVERSEA",o.GLOBAL="GLOBAL",o.EXTENSIONS="EXTENSIONS"}(Ot||(Ot={}));const wF=[Ot.AFRICA,Ot.ASIA,Ot.CHINA,Ot.EUROPE,Ot.GLOBAL,Ot.INDIA,Ot.JAPAN,Ot.NORTH_AMERICA,Ot.OCEANIA,Ot.OVERSEA,Ot.SOUTH_AMERICA];var Vr;(function(o){o.CHINA="CN",o.ASIA="AS",o.NORTH_AMERICA="NA",o.EUROPE="EU",o.JAPAN="JP",o.INDIA="IN",o.KOREA="KR",o.HKMC="HK",o.US="US",o.OCEANIA="OC",o.SOUTH_AMERICA="SA",o.AFRICA="AF",o.OVERSEA="OVERSEA",o.GLOBAL="GLOBAL",o.EXTENSIONS="GLOBAL"})(Vr||(Vr={}));const i0={CHINA:{},ASIA:{CODE:Vr.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Vr.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Vr.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Vr.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Vr.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Vr.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:Vr.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:Vr.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Vr.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Vr.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Vr.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Vr.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Vr.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};var Ag,RF,Fe,Qr,Oa,Ee,Vt,Xe,IF,Vo,Bo,vr,nc,jn,Gs,AF,So,_s,sd,An,ad,rc,OF,DI;CI&&(i0.CHINA={CODE:Vr.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(o){o.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(Ag||(Ag={}));class NF extends mn{constructor(n,r){super(),I(this,"onICEConnectionStateChange",void 0),I(this,"onConnectionStateChange",void 0),I(this,"onDTLSTransportStateChange",void 0),I(this,"onDTLSTransportError",void 0),I(this,"onICETransportStateChange",void 0),I(this,"onFirstAudioReceived",void 0),I(this,"onFirstVideoReceived",void 0),I(this,"onFirstAudioDecoded",void 0),I(this,"onFirstVideoDecoded",void 0),I(this,"onFirstVideoDecodedTimeout",void 0),I(this,"onSelectedLocalCandidateChanged",void 0),I(this,"onSelectedRemoteCandidateChanged",void 0)}}class o0 extends NF{constructor(n,r){super(n,r)}}(function(o){o.SEND="sendonly",o.RECV="recvonly",o.SENDRECV="sendrecv",o.INACTIVE="inactive"})(RF||(RF={})),function(o){o.VIDEO="video",o.AUDIO="audio"}(Fe||(Fe={})),function(o){o[o.UDP=0]="UDP",o[o.TCP=1]="TCP",o[o.RELAY=2]="RELAY"}(Qr||(Qr={})),function(o){o[o.FIRST_CONNECTION=0]="FIRST_CONNECTION",o[o.TCP_RESTART=1]="TCP_RESTART",o[o.RELAY_RESTART=2]="RELAY_RESTART",o[o.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",o[o.OLD_RESTART=11]="OLD_RESTART",o[o.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED"}(Oa||(Oa={})),function(o){o.LocalVideoTrack="videoTrack",o.LocalAudioTrack="audioTrack",o.LocalVideoLowTrack="videoLowTrack"}(Ee||(Ee={})),function(o){o.New="new",o.Connected="connected",o.Reconnecting="reconnecting",o.Disconnected="disconnected"}(Vt||(Vt={})),function(o){o.StateChange="stateChange",o.IceConnectionStateChange="iceConnectionStateChange",o.RequestMuteLocal="requestMuteLocal",o.RequestUnmuteLocal="requestUnmuteLocal",o.RequestRePublish="requestRePublish",o.RequestRePublishDataChannel="requestRePublishDataChannel",o.RequestReSubscribe="requestReSubscribe",o.RequestUploadStats="requestUploadStats",o.RequestUpload="requestUpload",o.MediaReconnectStart="MediaReconnectStart",o.MediaReconnectEnd="MediaReconnectEnd",o.NeedSignalRTT="NeedSignalRTT",o.RequestRestartICE="RequestRestartIce",o.PeerConnectionStateChange="PeerConnectionStateChange",o.RequestReconnect="RequestReconnect",o.RequestReconnectPC="RequestReconnectPC",o.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",o.P2PLost="P2PLost",o.UpdateVideoEncoder="UpdateVideoEncoder",o.ConnectionTypeChange="ConnectionTypeChange",o.RequestLowStreamParameter="RequestLowStreamParameter",o.QueryClientConnectionState="QueryClientConnectionState",o.LocalCandidate="LocalCandidate",o.RequestP2PMuteLocal="requestP2PMuteLocal",o.RequestP2PUnPublish="RequestP2PUnPublish",o.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",o.RequestP2PMuteRemote="RequestP2PMuteRemote",o.RequestP2PRestartICE="RequestP2PRestartICE"}(Xe||(Xe={})),function(o){o.MUTE_LOCAL_VIDEO="mute_local_video",o.MUTE_LOCAL_AUDIO="mute_local_audio",o.UNMUTE_LOCAL_VIDEO="unmute_local_video",o.UNMUTE_LOCAL_AUDIO="unmute_local_audio",o.MUTE_REMOTE_VIDEO="mute_remote_video",o.MUTE_REMOTE_AUDIO="mute_remote_audio",o.UNMUTE_REMOTE_VIDEO="unmute_remote_video",o.UNMUTE_REMOTE_AUDIO="unmute_remote_audio"}(IF||(IF={})),function(o){o.CONNECTING="CONNECTING",o.RECONNECTING="RECONNECTING",o.CONNECTED="CONNECTED",o.CLOSED="CLOSED"}(Vo||(Vo={})),function(o){o[o.CONNECT_AP=0]="CONNECT_AP",o[o.AP_CONNECTED=1]="AP_CONNECTED",o[o.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",o[o.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",o[o.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",o[o.CONNECT_WORKER=5]="CONNECT_WORKER",o[o.WORKER_CONNECTED=6]="WORKER_CONNECTED",o[o.CLOSED=7]="CLOSED"}(Bo||(Bo={})),function(o){o.CONNECTION_STATE_CHANGE="connection-state-change",o.STATE_CHANGE="state-change",o.INSPECT_RESULT="inspect-result",o.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",o.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(vr||(vr={})),function(o){o.NETWORK_ERROR="NETWORK_ERROR",o.SERVER_ERROR="SERVER_ERROR",o.MULTI_IP="MULTI_IP",o.TIMEOUT="TIMEOUT",o.OFFLINE="OFFLINE",o.LEAVE="LEAVE",o.P2P_FAILED="P2P_FAILED",o.FALLBACK="FALLBACK"}(nc||(nc={})),function(o){o.CONNECTED="transmitter:connected",o.RECONNECTING="transmitter:reconnecting",o.WILL_RECONNECT="transmitter:will_reconnect",o.CLOSED="transmitter:closed",o.FAILED="transmitter:failed",o.ON_MESSAGE="transmitter:on_message",o.REQUEST_NEW_URLS="transmitter:request_new_urls",o.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",o.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",o.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",o.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",o.FAILBACK="transmitter:failback"}(jn||(jn={})),function(o){o.CAMERA_CHANGED="camera-changed",o.MICROPHONE_CHANGED="microphone-changed",o.PLAYBACK_DEVICE_CHANGED="playback-device-changed",o.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",o.AUTOPLAY_FAILED="autoplay-failed",o.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",o.SECURITY_POLICY_VIOLATION="security-policy-violation"}(Gs||(Gs={})),function(o){o[o.APP_TYPE_INVALID_VALUE=-1]="APP_TYPE_INVALID_VALUE",o[o.APP_TYPE_NATIVE=0]="APP_TYPE_NATIVE",o[o.APP_TYPE_NATIVE_COCOS=1]="APP_TYPE_NATIVE_COCOS",o[o.APP_TYPE_NATIVE_UNITY=2]="APP_TYPE_NATIVE_UNITY",o[o.APP_TYPE_NATIVE_ELECTRON=3]="APP_TYPE_NATIVE_ELECTRON",o[o.APP_TYPE_NATIVE_FLUTTER=4]="APP_TYPE_NATIVE_FLUTTER",o[o.APP_TYPE_NATIVE_UNREAL=5]="APP_TYPE_NATIVE_UNREAL",o[o.APP_TYPE_NATIVE_XAMARIN=6]="APP_TYPE_NATIVE_XAMARIN",o[o.APP_TYPE_NATIVE_API_CLOUD=7]="APP_TYPE_NATIVE_API_CLOUD",o[o.APP_TYPE_NATIVE_REACT_NATIVE=8]="APP_TYPE_NATIVE_REACT_NATIVE",o[o.APP_TYPE_NATIVE_PYTHON=9]="APP_TYPE_NATIVE_PYTHON",o[o.APP_TYPE_NATIVE_COCOS_CREATOR=10]="APP_TYPE_NATIVE_COCOS_CREATOR",o[o.APP_TYPE_NATIVE_RUST=11]="APP_TYPE_NATIVE_RUST",o[o.APP_TYPE_NATIVE_C_SHARP=12]="APP_TYPE_NATIVE_C_SHARP",o[o.APP_TYPE_NATIVE_CEF=13]="APP_TYPE_NATIVE_CEF",o[o.APP_TYPE_NATIVE_UNI_APP=14]="APP_TYPE_NATIVE_UNI_APP",o[o.APP_TYPE_WEBRTC=1e3]="APP_TYPE_WEBRTC",o[o.APP_TYPE_WEBRTC_REACT=1001]="APP_TYPE_WEBRTC_REACT",o[o.APP_TYPE_WEBRTC_VUE=1002]="APP_TYPE_WEBRTC_VUE",o[o.APP_TYPE_WEBRTC_ANGULAR=1003]="APP_TYPE_WEBRTC_ANGULAR"}(AF||(AF={})),function(o){o.CONNECTING="CONNECTING",o.RECONNECTING="RECONNECTING",o.CONNECTED="CONNECTED",o.CLOSED="CLOSED"}(So||(So={})),function(o){o.CONNECTION_STATE_CHANGE="connection-state-change",o.STATE_CHANGE="state-change",o.INSPECT_RESULT="inspect-result",o.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",o.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(_s||(_s={})),function(o){o[o.CONNECT_AP=0]="CONNECT_AP",o[o.AP_CONNECTED=1]="AP_CONNECTED",o[o.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",o[o.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",o[o.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",o[o.CONNECT_WORKER=5]="CONNECT_WORKER",o[o.WORKER_CONNECTED=6]="WORKER_CONNECTED",o[o.CLOSED=7]="CLOSED"}(sd||(sd={})),function(o){o.CALL="call",o.CANDIDATE="candidate",o.PUBLISH="publish",o.UNPUBLISH="unpublish",o.CONTROL="control",o.RESTART_ICE="restart_ice",o.ACK="ack",o.RESPONSE="response",o.JOIN="join",o.CHECK="check"}(An||(An={})),function(o){o.ABORT="abort"}(ad||(ad={})),function(o){o.MUTE_LOCAL_AUDIO="mute_local_audio",o.MUTE_LOCAL_VIDEO="mute_local_video",o.UNMUTE_LOCAL_AUDIO="unmute_local_audio",o.UNMUTE_LOCAL_VIDEO="unmute_local_video"}(rc||(rc={})),function(o){o[o.SUCCESS=1]="SUCCESS",o[o.FAILED=0]="FAILED"}(OF||(OF={})),function(o){o.P2P_TOKEN_TIMEOUT="p2p_token_timeout",o.P2P_TOKEN_CHANGED="p2p_token_changed"}(DI||(DI={}));const bie={[Op.ACCESS_POINT]:{[di.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[di.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[di.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[di.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[di.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[di.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[di.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[di.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[di.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[di.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[di.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[di.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[di.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[di.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[di.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[di.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[di.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[di.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[Op.UNILBS]:{[Fo.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[Fo.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[Fo.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[Fo.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[Fo.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[Fo.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[Fo.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[Fo.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[Fo.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[Fo.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[Fo.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[Fo.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[Op.STRING_UID_ALLOCATOR]:{[Ig.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[Ig.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[Ig.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function s0(o){const n=bie[Math.floor(o/1e4)];if(!n)return{desc:"unkonw error",retry:!1};const r=n[o%1e4];if(!r){if(Math.floor(o/1e4)===Op.ACCESS_POINT){const s=o%1e4;if(s.toString()[0]==="1")return{desc:o.toString(),retry:!1};if(s.toString()[0]==="2")return{desc:o.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return r}const Cie={[qe.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[qe.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[qe.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[qe.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[qe.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[qe.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[qe.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[qe.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[qe.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[qe.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[qe.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[qe.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[qe.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[qe.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[qe.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[qe.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[qe.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[qe.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[qe.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[qe.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[qe.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[qe.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[qe.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[qe.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[qe.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[qe.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[qe.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[qe.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[qe.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[qe.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[qe.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[qe.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[qe.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[qe.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[qe.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[qe.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[qe.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[qe.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[qe.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[qe.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[qe.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[qe.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[qe.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[qe.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[qe.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[qe.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[qe.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[qe.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[qe.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[qe.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[qe.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[qe.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[qe.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[qe.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[qe.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[qe.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[qe.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[qe.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[qe.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[qe.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[qe.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[qe.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[qe.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function Lu(o){return Cie[o]||{desc:"UNKNOW_ERROR_".concat(o),action:"failed"}}function PF(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function xI(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?PF(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):PF(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}function kF(o){return o.every(n=>n.readyState===WebSocket.CLOSED||n.readyState===WebSocket.CLOSING)}function DF(o,n){if(typeof o=="string")return o;const{proxy:r,host:s,port:c}=o;if(n){const d=Y("JOIN_GATEWAY_FALLBACK_PORT")||443;return d===443?"wss://".concat(s,"/ws/?p=").concat(Number(c)+150):"wss://".concat(s,":").concat(d,"/ws/?p=").concat(Number(c)+150)}return r?"wss://".concat(r,"/ws/?h=").concat(s,"&p=").concat(c):"wss://".concat(s,":").concat(c)}const wie=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,Rie=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,Iie=/wss:\/\/(.+):([0-9]+)\/?/,Aie=/wss:\/\/(.[^\/]+)\/?/;let Oie=0;class Nie{constructor(n,r){I(this,"id",0),I(this,"store",void 0),I(this,"recordIndex",void 0),I(this,"websockets",[]),I(this,"try443PortDuration",2e3),I(this,"forceCloseWSDuration",5e3),I(this,"try443PortTimeout",null),I(this,"forceCloseTimeout",null),I(this,"isTry443PortFailed",!1),I(this,"isNormalPortFailed",!1),I(this,"useDoubleDomain",!1),I(this,"useProxy",!1),I(this,"startTime",Date.now()),this.id=++Oie,this.try443PortDuration=Y("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=n||5e3,this.store=r}closeAllWebsockets(){this.websockets.forEach(n=>{n.onopen=null,n.onclose=null,n.onmessage=null,n.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var n;const r=Date.now()-this.startTime;for(var s=arguments.length,c=new Array(s),d=0;d<s;d++)c[d]=arguments[d];O.debug("[choose-best-ws ".concat((n=this.store)===null||n===void 0?void 0:n.clientId," ").concat(this.id,"] ").concat(r,"ms:"),...c)}createWebSocket(n,r,s){this.logger("createWebSocket:",n,{isTry443Port:r,hasTimeoutDetection:s});const c=Y("GATEWAY_DOMAINS"),d=Date.now(),h=[],f=c.find(E=>{var T;return Le(T=n.host).call(T,E)});f||(this.useDoubleDomain=!1);const g=[];if(this.useDoubleDomain)c.forEach(E=>{g.push(DF(xI(xI({},n),{},{host:n.host.replace(f,E)}),r))});else{const E=xI({},n);if(r&&f){const T=c.find(w=>w!==f);T&&(E.host=E.host.replace(f,T))}g.push(DF(E,r))}try{g.forEach(E=>{const T=new WebSocket(E);T.binaryType="arraybuffer",h.push(T),this.logger("ws is connecting:",T.url)})}catch(E){if(this.logger("ws create failed"),h.forEach(T=>T.close()),h.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(n,r,s);if(!r&&Number(n.port)!==443)return this.createWebSocket(n,!0,s);throw new Z(B.WS_ERR,"init websocket failed! Error: ".concat(E.toString()))}const _=_g();return this.store&&this.store.recordJoinChannelService({urls:h.map(E=>E.url),service:"gateway"},this.recordIndex),h.forEach(E=>{E.onopen=()=>{this.logger("onopen: ws ".concat(E.url," open cost ").concat(Date.now()-d,"ms")),this.websockets.forEach(T=>{T!==E&&(T.onopen=null,T.onclose=null,T.onmessage=null,T.close(),this.logger("close backup websocket: ".concat(T.url)))}),this.websockets.length=0,_.resolve(E)},E.onclose=T=>{this.logger("onclose: ws ".concat(E.url," closed cost ").concat(Date.now()-d,"ms state: ").concat(E.readyState)),r?this.isTry443PortFailed=kF(h):this.isNormalPortFailed=kF(h),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(r&&this.isTry443PortFailed||!r&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(T.reason)),_.reject({code:T.code,reason:xu.A_ROUND_WS_FAILED}))},E.onmessage=T=>this.logger("".concat(E.url," onmessage: ").concat(T.data))}),this.websockets.push(...h),s||(()=>{const E=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",_.isResolved),this.websockets.forEach(T=>T.readyState!==WebSocket.OPEN&&T.close())};if(r||this.useProxy)return this.logger("add 5s timeout at ".concat(r?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(E,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{if(this.logger("2s timeout, isWebsocket created: ",_.isResolved),_.isResolved)return E();xt().os===fr.MAC_OS&&Jt()&&E(),this.createWebSocket(n,!0,!0).then(T=>_.resolve(T)).catch(T=>{this.isNormalPortFailed&&_.reject(T),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(E,this.forceCloseWSDuration)},this.try443PortDuration)})(),_.promise}chooseBestWebsocket(n,r,s,c){return this.useDoubleDomain=!!r,typeof n=="string"&&(n=function(d){let h,f,g;return[,h,f,g]=d.match(wie)||[],h||([,f,g]=d.match(Rie)||[]),f&&g||([,f,g]=d.match(Iie)||[]),f&&g||([,f]=d.match(Aie)||[]),f||O.warning("un-destructible url: ",d),{proxy:h,host:f,port:g||"443"}}(n)),this.recordIndex=c,this.useProxy=!!n.proxy,s&&this.useProxy&&(O.warn("cannot use 443 only when use proxy"),s=!1),this.createWebSocket(n,!!s,!1).finally(()=>this.clearTimeout())}}function xF(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}class LF extends mn{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(n){var r;Le(r=["tryNext","recover"]).call(r,n)&&this.resetReconnectCount(n),this._reconnectMode=n}get state(){return this._state}set state(n){n!==this._state&&(this._state=n,this._state==="reconnecting"?this.emit(tt.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(tt.CONNECTED):this._state==="closed"?this.emit(tt.CLOSED):this._state==="failed"&&this.emit(tt.FAILED))}resetReconnectCount(n){O.debug("websocket reset reconnect count, reason: "+n),this.reconnectCount=0}constructor(n,r){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2],c=arguments.length>3&&arguments[3]!==void 0&&arguments[3],d=arguments.length>4&&arguments[4]!==void 0&&arguments[4],h=arguments.length>5?arguments[5]:void 0;super(),I(this,"connectionID",0),I(this,"currentURLIndex",0),I(this,"urls",[]),I(this,"_reconnectMode","tryNext"),I(this,"reconnectReason",void 0),I(this,"_initMutex",new Pr("websocket")),I(this,"name",void 0),I(this,"_state","closed"),I(this,"reconnectInterrupter",void 0),I(this,"websocket",void 0),I(this,"retryConfig",void 0),I(this,"reconnectCount",0),I(this,"forceCloseTimeout",5e3),I(this,"onlineReconnectListener",void 0),I(this,"useCompress",void 0),I(this,"tryDoubleDomain",!1),I(this,"use443PortOnly",!1),I(this,"wsInflateLength",0),I(this,"wsDeflateLength",0),I(this,"closeEstablishingWs",()=>{}),I(this,"store",void 0),I(this,"joinGatewayRecordIndex",void 0),this.store=h,this.name=n,this.retryConfig=function(T){for(var w=1;w<arguments.length;w++){var A=arguments[w]!=null?arguments[w]:{};w%2?xF(Object(A),!0).forEach(function(L){I(T,L,A[L])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(A)):xF(Object(A)).forEach(function(L){Object.defineProperty(T,L,Object.getOwnPropertyDescriptor(A,L))})}return T}({},r),this.useCompress=s,this.tryDoubleDomain=c,this.use443PortOnly=d;const{timeout:f,timeoutFactor:g}=r,_=Math.max(300,Math.floor(3*f/5)),E=Math.max(1.2,Math.floor(8*g)/10);bi.ONLINE&&(this.retryConfig.timeout=_,this.retryConfig.timeoutFactor=E),rr.on(Yc.NETWORK_STATE_CHANGE,(T,w)=>{T!==w&&(this.resetReconnectCount("network state change: ".concat(w," -> ").concat(T)),T===bi.ONLINE?(this.retryConfig.timeout=_,this.retryConfig.timeoutFactor=E):(this.retryConfig.timeout=f,this.retryConfig.timeoutFactor=g))})}getConnection(){return this.websocket||void 0}async init(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=await this._initMutex.lock();this.forceCloseTimeout=r,this.urls=n,this.state="connecting";try{const c=_g(),d=this.urls[this.currentURLIndex];this.createWebSocketConnection(d).then(c.resolve).catch(c.reject),this.once(tt.CLOSED,()=>{c.reject(new he(B.WS_DISCONNECT))}),this.once(tt.CONNECTED,c.resolve),await c.promise}catch{}finally{s()}}close(n,r){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const s=this.websocket;r?setTimeout(()=>s.close(),500):s.close(),this.websocket=void 0}this.state=n?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(n,r){if(!this.websocket)return void O.warning("[".concat(this.name,"] can not reconnect, no websocket"));n!==void 0&&(this.reconnectMode=n),O.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(r)]},this.joinGatewayRecordIndex);const s=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),s&&s.bind(this.websocket)({code:9999,reason:r})}sendMessage(n){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new he(B.WS_ABORT,"websocket is not ready");try{r||(n=JSON.stringify(n)),this.websocket.send(n)}catch(s){throw new he(B.WS_ERR,"send websocket message error"+s.toString())}}setWsInflateData(n){this.wsDeflateLength=this.wsDeflateLength+n.originLength,this.wsInflateLength=this.wsInflateLength+n.compressedLength}getWsInflateData(){const n=this.wsInflateLength,r=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:n,wsDeflateLength:r}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(n){var r;const s=_g();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const c=E=>{var T;(T=this.store)===null||T===void 0||T.signalChannelOpen(),O.debug("[".concat(this.name,"] websocket opened:"),E),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),s.resolve()},d=async E=>{var T;if(O.debug("[".concat(this.name,"] websocket close ").concat((T=this.websocket)===null||T===void 0?void 0:T.url,", code: ").concat(E.code,", reason: ").concat(E.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)s.reject(new he(B.WS_DISCONNECT,"websocket close: ".concat(E.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=E.reason,this.state="reconnecting");const w=yo(this,tt.WILL_RECONNECT,this.reconnectMode,E.reason)||this.reconnectMode,A=await this.reconnectWithAction(w);if(this.state==="closed")return void O.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!A)return s.reject(new he(B.WS_DISCONNECT,"websocket reconnect failed: ".concat(E.code))),this.close(!0);s.resolve()}},h=E=>{this.emit(tt.ON_MESSAGE,E)},f=E=>{O.warn("[".concat(this.connectionID,"] ws open error ").concat(E))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),Y("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(n=Y("GATEWAY_WSS_ADDRESS")),O.debug("[".concat(this.name,"] start connect, url:"),n);const g=(r=this.store)===null||r===void 0?void 0:r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var _;const E=await this.chooseBestWebsocketConnection(n);this.websocket=E,c&&c(this.websocket.url),this.websocket.onclose=d,this.websocket.onmessage=h,this.websocket.onerror=f,(_=this.store)===null||_===void 0||_.recordJoinChannelService({endTs:Date.now(),status:"success"},g),this.joinGatewayRecordIndex=g}catch(E){const T=this.state==="closed",w=E instanceof he,A=w&&E.code===B.WS_ABORT,L=w&&E.code===B.WS_ERR,P=w?E.message:E&&(E.reason||E.toString());O.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(P)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:A?"aborted":"error",errors:[E]},g),T||L?(s.reject(T?new he(B.WS_DISCONNECT,"websocket is closed: ".concat(P)):new he(B.WS_ERR,"init websocket failed: ".concat(P))),L&&O.error("[".concat(this.name,"] init websocket failed: ").concat(P))):d&&d(E)}return s.promise}async reconnectWithAction(n){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;O.warning("[choose-best-ws] action: =>",n),this.onlineReconnectListener||rr.isOnline||!rr.onlineWaiter||(this.onlineReconnectListener=rr.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let s=!0;if(this.reconnectInterrupter=()=>s=!1,r){const h=zy(this.reconnectCount,this.retryConfig);O.debug("[".concat(this.name,"] wait ").concat(h,"ms to reconnect websocket, mode: ").concat(n)),await ae.race([Nr(h),this.onlineReconnectListener||new ae(()=>{})])}if(this._state==="closed"||!s)return!1;this.reconnectCount+=1;const c=async(h,f)=>{this.emit(tt.RECONNECT_CREATE_CONNECTION,f),await this.createWebSocketConnection(h)};try{if(n==="retry")this.emit(tt.RECONNECT_WAITTING_FINISH,n),await c(this.urls[this.currentURLIndex],n);else if(n==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);O.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),this.emit(tt.RECONNECT_WAITTING_FINISH,n),await c(this.urls[this.currentURLIndex],n)}else n==="recover"&&(O.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(tt.RECONNECT_WAITTING_FINISH,n),this.urls=await nr(this,tt.REQUEST_NEW_URLS),this.currentURLIndex=0,await c(this.urls[this.currentURLIndex],n))}catch(h){var d;O.error("[".concat(this.name,"] reconnect failed ").concat(h&&h.toString()));const f=h==null||(d=h.data)===null||d===void 0?void 0:d.desc;return Array.isArray(f)&&Le(f).call(f,"dynamic key expired")?(this.emit(tt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(n,r)}return!0}}class Og extends LF{constructor(n,r){super(n,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(n,r){const s=_g(),c=function(h,f){return new Nie(h,f)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{O.debug("[choose-best-ws] close establishing websockets"),c.closeAllWebsockets(),s.reject(new he(B.WS_ABORT,"choose best websocket aborted"))};const d=Y("GATEWAY_DOMAINS");return O.debug("[choose-best-ws] currentDomain: ",n,", domains: ",d,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),c.chooseBestWebsocket(n,this.tryDoubleDomain,this.use443PortOnly,r).then(s.resolve).catch(s.reject),s.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class Ng extends LF{constructor(n,r){super(n,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(n,r){return new ae((s,c)=>{let d=!1;const h=[];this.closeEstablishingWs=()=>{O.debug("[choose-best-ws] close establishing websockets"),h.forEach(L=>{L.onclose=null,L.onopen=null,L.onmessage=null,L.close()}),c(new he(B.WS_ABORT,"choose best websocket aborted"))};const f=Y("GATEWAY_DOMAINS");let g;const _=n.indexOf("?h="),E=f.find(L=>_!==-1?Le(n).call(n,L,_):Le(n).call(n,L));O.debug("[choose-best-ws] currentDomain: ",E,", domains: ",f);let T=!this.tryDoubleDomain||!E;if(!T&&E){var w;const L=Date.now();try{f.forEach(P=>{const D=_===-1?n.replace(E,P):n.substr(0,_)+n.substr(_).replace(E,P),G=new WebSocket(D);G.binaryType="arraybuffer",h.push(G),O.debug("[choose-best-ws] ws is connecting:",G.url)})}catch{for(O.debug("[choose-best-ws] ws create failed, fallback to single url"),h.forEach(D=>D.close());h.length;)h.pop();T=!0}(w=this.store)===null||w===void 0||w.recordJoinChannelService({urls:h.map(P=>P.url),service:"gateway"},r),h.forEach(P=>{P.onopen=()=>{if(d)return;const D=Date.now()-L;O.debug("[choose-best-ws] ws open cost ".concat(D,"ms")),h.filter(G=>G!==P).forEach(G=>{O.debug("[choose-best-ws]close backup websocket: ".concat(G.url)),G.close()}),d=!0,s(P)},P.onclose=D=>{g=D,!d&&(h.find(G=>!(G.readyState===WebSocket.CLOSED||G.readyState===WebSocket.CLOSING))||(O.debug("[choose-best-ws] all websocket is closed"),d=!0,c(g)))},P.onmessage=D=>{O.debug("[choose-best-ws]".concat(P.url," onmessage: ").concat(D.data))}}),Nr(this.forceCloseTimeout).then(()=>{h.forEach(P=>{P.readyState!==WebSocket.OPEN&&P.close()})})}if(T){var A;let L;O.debug("[choose-best-ws] use single url: ",n),(A=this.store)===null||A===void 0||A.recordJoinChannelService({urls:[n],service:"gateway"},r);try{L=new WebSocket(n),h.push(L),L.binaryType="arraybuffer"}catch(P){const D=new he(B.WS_ERR,"init websocket failed! Error: ".concat(P.toString()));return O.error("[".concat(this.name,"]").concat(D)),void c(D)}L.onopen=()=>{s(L)},L.onclose=P=>{c(P)},L.onmessage=P=>{O.debug("[choose-best-ws]".concat(L.url," onmessage: ").concat(P.data))},Nr(this.forceCloseTimeout).then(()=>{L&&L.readyState!==WebSocket.OPEN&&L.close()})}}).then(s=>(this.closeEstablishingWs=void 0,s)).catch(s=>{throw this.closeEstablishingWs=void 0,s})}}class MF extends mn{get connectionState(){return this._connectionState}set connectionState(n){n!==this._connectionState&&(this._connectionState=n,n===pt.CONNECTED?this.emit(De.WS_CONNECTED):n===pt.RECONNECTING?this.emit(De.WS_RECONNECTING,this._websocketReconnectReason):n===pt.CLOSED&&this.emit(De.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(n,r){super(),I(this,"_disconnectedReason",void 0),I(this,"_websocketReconnectReason",void 0),I(this,"_connectionState",pt.CLOSED),I(this,"reconnectToken",void 0),I(this,"websocket",void 0),I(this,"openConnectionTime",void 0),I(this,"clientId",void 0),I(this,"lastMsgTime",Date.now()),I(this,"uploadCache",[]),I(this,"uploadCacheInterval",void 0),I(this,"rttRolling",new oI(5)),I(this,"pingpongTimer",void 0),I(this,"wsInflateDataTimer",void 0),I(this,"pingpongTimeoutCount",0),I(this,"joinResponse",void 0),I(this,"multiIpOption",void 0),I(this,"initError",void 0),I(this,"spec",void 0),I(this,"store",void 0),I(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(De.ON_BINARY_DATA,s.data);const c=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(c,"_id")){const d="res-@".concat(c._id);this.emit(d,c._result,c._message)}else if(Object.prototype.hasOwnProperty.call(c,"_type")){if(this.emit(c._type,c._message),c._type===nt.ON_NOTIFICATION&&this.handleNotification(c._message),c._type===nt.ON_USER_BANNED)switch(c._message.error_code){case 14:this.close(vt.UID_BANNED);break;case 15:this.close(vt.IP_BANNED);break;case 16:this.close(vt.CHANNEL_BANNED)}if(c._type===nt.ON_USER_LICENSE_BANNED)switch(c._message.error_code){case qe.ERR_LICENSE_MISSING:this.close(vt.LICENSE_MISSING);break;case qe.ERR_LICENSE_EXPIRED:this.close(vt.LICENSE_EXPIRED);break;case qe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(vt.LICENSE_MINUTES_EXCEEDED);break;case qe.ERR_LICENSE_PERIOD_INVALID:this.close(vt.LICENSE_PERIOD_INVALID);break;case qe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(vt.LICENSE_MULTIPLE_SDK_SERVICE);break;case qe.ERR_LICENSE_ILLEGAL:this.close(vt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=n.clientId,this.spec=n,this.store=r,this.websocket=new Og("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Y("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Y("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===pt.CONNECTED&&this.reconnect("retry",Or.OFFLINE)})}async request(n,r,s,c){const d=Qt(6,""),h={_id:d,_type:n,_message:r},f=this.websocket.connectionID,g=()=>new ae((L,P)=>{if(this.connectionState===pt.CONNECTED)return L();const D=()=>{this.off(De.WS_CLOSED,G),L()},G=()=>{this.off(De.WS_CONNECTED,D),P(new Z(B.WS_ABORT))};this.once(De.WS_CONNECTED,D),this.once(De.WS_CLOSED,G),n!==We.PUBLISH&&n!==We.PUBLISH_DATASTREAM&&n!==We.SUBSCRIBE&&n!==We.SUBSCRIBE_DATASTREAM&&n!==We.UNSUBSCRIBE&&n!==We.UNSUBSCRIBE_DATASTREAM&&n!==We.UNPUBLISH&&n!==We.UNPUBLISH_DATASTREAM&&n!==We.CONTROL&&n!==We.RESTART_ICE||this.once(De.DISCONNECT_P2P,()=>{P(new Z(B.DISCONNECT_P2P))}),n!==We.PUBLISH&&n!==We.RESTART_ICE||this.once(De.ABORT_P2P_EXECUTION,()=>{P(new Z(B.DISCONNECT_P2P))})});if(this.connectionState!==pt.CONNECTING&&this.connectionState!==pt.RECONNECTING||n===We.JOIN||n===We.REJOIN||await g(),this.websocket.sendMessage(h,!0),c)return;const _=new ae((L,P)=>{let D=!1;const G=(X,ie)=>{D=!0,L({isSuccess:X==="success",message:ie||{}}),this.off(De.WS_CLOSED,$),this.off(De.WS_RECONNECTING,$),this.emit(De.REQUEST_SUCCESS,n,r)};this.once("res-@".concat(d),G);const $=()=>{P(new Z(B.WS_ABORT,"type: ".concat(n))),this.off(De.WS_CLOSED,$),this.off(De.WS_RECONNECTING,$),this.off("res-@".concat(d),G)};this.once(De.WS_CLOSED,$),this.once(De.WS_RECONNECTING,$),Nr(Y("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==f||D||(O.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(n)),this.emit(De.REQUEST_TIMEOUT,n,r))})});let E=null;try{E=await _}catch(L){if(this.connectionState===pt.CLOSED||n===We.LEAVE)throw new Z(B.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?L.throw():n===We.JOIN||n===We.REJOIN?null:(await g(),await this.request(n,r))}if(E.isSuccess)return E.message;const T=Number(E.message.error_code||E.message.code),w=Lu(T),A=new Z(B.UNEXPECTED_RESPONSE,"".concat(w.desc,": ").concat(E.message.error_str),{code:T,data:E.message});return w.action==="success"?E.message:(O.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(n,", error_code: ").concat(T,", message: ").concat(w.desc,", action: ").concat(w.action)),T===qe.ERR_TOO_MANY_BROADCASTERS?((n===We.JOIN||n===We.REJOIN)&&(this.initError=A,this.close()),A.throw()):w.action==="failed"?A.throw():w.action==="quit"?(this.initError=A,this.close(),A.throw()):(T===qe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=E.message.option,O.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Or.MULTI_IP)):this.reconnect(w.action,Or.SERVER_ERROR),n===We.JOIN||n===We.REJOIN?null:await this.request(n,r)))}waitMessage(n,r){return new ae(s=>{const c=d=>{(!r||r(d))&&(this.off(n,c),s(d))};this.on(n,c)})}uploadWRTCStats(n){if(!this.store.sessionId)return void O.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const r={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:n};this.upload(Qc.WRTC_STATS,r)}upload(n,r){const s={_type:n,_message:r};try{this.websocket.sendMessage(s)}catch{const d=Y("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>d&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==pt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},Y("UPLOAD_CACHE_INTERVAL")||2e3))}}send(n,r){const s={_type:n,_message:r};this.websocket.sendMessage(s)}init(n,r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new ae((s,c)=>{this.once(De.WS_CONNECTED,()=>s(this.joinResponse)),this.once(De.WS_CLOSED,()=>c(this.initError||new Z(B.WS_ABORT))),this.connectionState=pt.CONNECTING,this.websocket.init(n).catch(c),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=n||vt.LEAVE,this.connectionState=pt.CLOSED,O.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),n===vt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new Og("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Y("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Y("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(De.ABORT_P2P_EXECUTION);const n=await nr(this,De.REQUEST_JOIN_INFO),r=await this.request(We.JOIN,n);if(!r)return this.emit(De.REPORT_JOIN_GATEWAY,xu.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(De.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=pt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new Z(B.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const n=Nu(this,De.REQUEST_REJOIN_INFO);n.token=this.reconnectToken;const r=await this.request(We.REJOIN,n);return!!r&&(this.connectionState=pt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),r.peers&&r.peers.forEach(s=>{this.emit(nt.ON_USER_ONLINE,{uid:s.uid}),s.audio&&this.emit(nt.ON_ADD_AUDIO_STREAM,{uid:s.uid,uint_id:s.uint_id,audio:!0,ssrcId:s.audio_ssrc}),s.video&&this.emit(nt.ON_ADD_VIDEO_STREAM,{uid:s.uid,uint_id:s.uint_id,video:!0,ssrcId:s.video_ssrc}),s.audio_mute?this.emit(nt.MUTE_AUDIO,{uid:s.uid}):this.emit(nt.UNMUTE_AUDIO,{uid:s.uid}),s.video_mute?this.emit(nt.MUTE_VIDEO,{uid:s.uid}):this.emit(nt.UNMUTE_VIDEO,{uid:s.uid}),s.audio_enable_local?this.emit(nt.ENABLE_LOCAL_AUDIO,{uid:s.uid}):this.emit(nt.DISABLE_LOCAL_AUDIO,{uid:s.uid}),s.video_enable_local?this.emit(nt.ENABLE_LOCAL_VIDEO,{uid:s.uid}):this.emit(nt.DISABLE_LOCAL_VIDEO,{uid:s.uid}),s.audio||s.video||this.emit(nt.ON_REMOVE_STREAM,{uid:s.uid,uint_id:s.uint_id})}),!0)}reconnect(n,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(n,r)}handleNotification(n){O.debug("[".concat(this.clientId,"] receive notification: "),n);const r=Lu(n.code);if(r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(vt.UID_BANNED),void this.close()):void this.reconnect(r.action,Or.SERVER_ERROR);O.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const n=Y("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=n&&(O.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>Y("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Or.TIMEOUT):this.request(We.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-r;this.rttRolling.add(s),Y("REPORT_STATS")&&this.send(We.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWsInflateData(){const{wsInflateLength:n,wsDeflateLength:r}=this.websocket.getWsInflateData();n!==0&&r!==0&&this.upload(Qc.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:r,ws_inflate_length:n})}handleWebsocketEvents(){this.websocket.on(tt.RECONNECT_WAITTING_FINISH,n=>{this.emit(De.WS_RECONNECT_WAITTING_FINISH,n)}),this.websocket.on(tt.RECONNECT_CREATE_CONNECTION,n=>{this.emit(De.WS_RECONNECT_CREATE_CONNECTION,n)}),this.websocket.on(tt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(tt.CLOSED,()=>{this.connectionState=pt.CLOSED}),this.websocket.on(tt.FAILED,()=>{this._disconnectedReason=vt.NETWORK_ERROR,this.connectionState=pt.CLOSED}),this.websocket.on(tt.RECONNECTING,n=>{this._websocketReconnectReason=n,this.joinResponse=void 0,this.connectionState===pt.CONNECTED?this.connectionState=pt.RECONNECTING:this.connectionState=pt.CONNECTING}),this.websocket.on(tt.WILL_RECONNECT,(n,r,s)=>{const c=Nu(this,De.IS_P2P_DISCONNECTED),d=c||n!=="retry";c&&n==="retry"&&(O.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),n="tryNext",r=xu.P2P_DISCONNECTED),d&&(O.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(n)),this.emit(De.REPORT_JOIN_GATEWAY,r||xu.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(De.NEED_RENEW_SESSION),this.emit(De.DISCONNECT_P2P)),s(n)}),this.websocket.on(tt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(n=>{O.warning("[".concat(this.clientId,"] rejoin failed ").concat(n)),this.reconnect("tryNext",Or.SERVER_ERROR)}):this.join().catch(n=>{if(this.emit(De.REPORT_JOIN_GATEWAY,n.message||n.code||xu.UNKNOWN_REASON,this.url||""),n instanceof Z&&n.code===B.UNEXPECTED_RESPONSE&&n.data.code===qe.ERR_NO_AUTHORIZED)return O.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Or.SERVER_ERROR);O.error("[".concat(this.clientId,"] join gateway request failed"),n.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Or.SERVER_ERROR):(this.initError=n,this.close())})}),this.websocket.on(tt.REQUEST_NEW_URLS,(n,r)=>{nr(this,De.REQUEST_RECOVER,this.multiIpOption).then(n).catch(r)}),this.websocket.on(tt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(nt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}var UF=`	
\v\f\r                　\u2028\u2029\uFEFF`,Pie=Ct,kie=Bs,LI=UF,jF=R("".replace),Die=RegExp("^["+LI+"]+"),xie=RegExp("(^|[^"+LI+"])["+LI+"]+$"),MI=function(o){return function(n){var r=kie(Pie(n));return 1&o&&(r=jF(r,Die,"")),2&o&&(r=jF(r,xie,"$1")),r}},Lie={start:MI(1),end:MI(2),trim:MI(3)},Mie=rM.PROPER,Uie=p,FF=UF,jie=Lie.trim;En({target:"String",proto:!0,forced:function(o){return Uie(function(){return!!FF[o]()||"​᠎"[o]()!=="​᠎"||Mie&&FF[o].name!==o})}("trim")},{trim:function(){return jie(this)}});var kr,vs,Fie=Hl("String").trim,Vie=N,Bie=Fie,UI=String.prototype,jI=u(function(o){var n=o.trim;return typeof o=="string"||o===UI||Vie(UI,o)&&n===UI.trim?Bie:n});function VF(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function a0(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?VF(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):VF(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}function cd(o){return o.match(/^[\.\:\d]+$/)?"".concat(o.replace(/[^\d]/g,"-"),".").concat(Y("TURN_DOMAIN")):(O.info("Unidentified as ip: ".concat(o,", use as host")),o)}function BF(o,n){o.addresses||(o.addresses=[]);const r=function(d,h){if(Y("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return d.map(_=>{let{ip:E,port:T}=_;return{address:"".concat(E,":").concat(T)}});const f=Y("GATEWAY_DOMAINS");let g=f[1]&&Le(h).call(h,f[1])?1:0;return d.map(_=>{let{domain_prefix:E,port:T,ip:w}=_;if(E)return{address:"".concat(E,".").concat(f[g++%f.length],":").concat(T)};const A=/^[\.\:\d]+$/.test(w),L=A?"".concat(w.replace(/[^\d]/g,"-"),".").concat(f[g++%f.length],":").concat(T):"".concat(w,":").concat(T);return A||O.info("Unidentified as ip: ".concat(w,", use as host")),{ip:w,port:T,address:L}})}(o.addresses,n),s=Array.isArray(o.detail)&&o.detail[18];if(s&&typeof s=="string"){const d=s.split(";");for(let h=0;h<d.length;h++){var c;const f=jI(c=d[h]).call(c);r[h]&&f&&(r[h].ip6=f)}}return{gatewayAddrs:r,uid:o.uid,cid:o.cid,cert:o.cert,vid:o.detail&&o.detail[8],uni_lbs_ip:o.detail&&o.detail[1],res:o,csIp:o.detail&&o.detail[502]}}function Wo(o){return typeof o=="number"?o:o.exact||o.ideal||o.max||o.min||0}function WF(o){const n=o._encoderConfig;if(!n)return{};const r={resolution:n.width&&n.height?"".concat(Wo(n.width),"x").concat(Wo(n.height)):void 0,maxVideoBW:n.bitrateMax,minVideoBW:n.bitrateMin};return typeof n.frameRate=="number"?(r.maxFrameRate=n.frameRate,r.minFrameRate=n.frameRate):n.frameRate&&(r.maxFrameRate=n.frameRate.max||n.frameRate.ideal||n.frameRate.exact||n.frameRate.min,r.minFrameRate=n.frameRate.min||n.frameRate.ideal||n.frameRate.exact||n.frameRate.max),r}function zF(o){return o>=0&&o<.17?1:o>=.17&&o<.36?2:o>=.36&&o<.59?3:o>=.59&&o<=1?4:o>1?5:0}function FI(o,n){let r,s,c;switch(n){case kr.CHOOSE_SERVER:s=4096,c="choose server";break;case kr.CLOUD_PROXY:s=1048576,c="proxy";break;case kr.CLOUD_PROXY_5:s=4194304,c="proxy5";break;case kr.CLOUD_PROXY_FALLBACK:s=4194310,c="proxy fallback";break;default:throw new Z(B.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:o.detail&&o.detail[502],retry:!1})}if(o.response_body.forEach(d=>{d.buffer&&d.buffer.flag===s&&(r={code:d.buffer.code,addresses:(d.buffer.edges_services||[]).map(h=>a0(a0({},h),{},{ticket:d.buffer.cert})),server_ts:o.enter_ts,uid:d.buffer.uid,cid:d.buffer.cid,cname:d.buffer.cname,detail:a0(a0({},d.buffer.detail),o.detail),flag:d.buffer.flag,opid:o.opid,cert:d.buffer.cert})}),!r)throw new Z(B.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(c," from multi unilbs response"),{csIp:o.detail&&o.detail[502]});return r}async function Wie(o,n){return await ae.all(o.addresses.map(async r=>({address:cd(r.ip),tcpport:r.port,udpport:r.port,username:n&&Y("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?n.toString():Pi.username,password:n&&Y("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await eI(n.toString()):Pi.password})))}function VI(o,n){const r=n._videoHeight||n.getMediaStreamTrack(!0).getSettings().height;return r?Math.max(r/Wo(o.height),1):(O.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function ld(o){let{candidateType:n,relayProtocol:r,type:s,address:c,port:d,protocol:h}=o;return s==="local-candidate"?{candidateType:n,relayProtocol:r,protocol:h}:{candidateType:n,relayProtocol:r,address:c,port:d,protocol:h}}function GF(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}(function(o){o[o.CHOOSE_SERVER=11]="CHOOSE_SERVER",o[o.CLOUD_PROXY=18]="CLOUD_PROXY",o[o.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",o[o.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"})(kr||(kr={}));class zie extends mn{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(n){var r;Le(r=["tryNext","recover"]).call(r,n)&&this.resetReconnectCount(n),this._reconnectMode=n}get state(){return this._state}set state(n){n!==this._state&&(this._state=n,this._state==="reconnecting"?this.emit(jn.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(jn.CONNECTED):this._state==="closed"?this.emit(jn.CLOSED):this._state==="failed"&&this.emit(jn.FAILED))}constructor(n,r,s,c){super(),I(this,"connectionID",0),I(this,"currentURLIndex",0),I(this,"reconnectReason",void 0),I(this,"_reconnectMode","tryNext"),I(this,"_name",void 0),I(this,"_state","closed"),I(this,"_retryConfig",void 0),I(this,"_reconnectCount",0),I(this,"_forceCloseTimeout",5e3),I(this,"_onlineReconnectListener",void 0),I(this,"_closeEstablishingTransmitter",()=>{}),I(this,"_store",void 0),I(this,"_joinChannelServiceRecordIndex",void 0),I(this,"_useCompress",void 0),I(this,"_inflateLength",0),I(this,"_deflateLength",0),this._store=c,this._name=n,this._retryConfig=function(d){for(var h=1;h<arguments.length;h++){var f=arguments[h]!=null?arguments[h]:{};h%2?GF(Object(f),!0).forEach(function(g){I(d,g,f[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(f)):GF(Object(f)).forEach(function(g){Object.defineProperty(d,g,Object.getOwnPropertyDescriptor(f,g))})}return d}({},r),this._useCompress=s}resetReconnectCount(n){O.debug("".concat(this._name," reset reconnect count, reason: ").concat(n)),this._reconnectCount=0}close(n,r){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const s=this._transmitter;r?setTimeout(()=>s.close(),500):s.close(),this._transmitter=void 0}this.state=n?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(n,r){if(!this._transmitter)return void O.warning("[".concat(this._name,"] can not reconnect, no websocket"));var s;n!==void 0&&(this.reconnectMode=n),O.debug("[".concat(this._name,"] reconnect is triggered initiative")),typeof this._joinChannelServiceRecordIndex=="number"&&((s=this._store)===null||s===void 0||s.recordJoinChannelService({status:"error",errors:[new Error(r)]},this._joinChannelServiceRecordIndex));const c=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),c&&c.bind(this._transmitter)({code:9999,reason:r})}getInflateData(){const n=this._inflateLength,r=this._deflateLength;return this.clearInflateData(),{inflateLength:n,deflateLength:r}}setInflateData(n){this._deflateLength=this._deflateLength+n.originLength,this._inflateLength=this._inflateLength+n.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}(function(o){o[o.Default=0]="Default",o[o.Ack=1]="Ack"})(vs||(vs={}));class Gie{constructor(n,r,s){I(this,"version",1),I(this,"initialRTO",void 0),I(this,"maxBatchAckCount",void 0),I(this,"maxRTO",void 0),I(this,"initialRTT",void 0),I(this,"ID",void 0),I(this,"rtt",void 0),I(this,"packetNumber",1),I(this,"rtoRatioMap",new Map),I(this,"timeoutMap",new Map),I(this,"unorderedPacketQueue",[]),I(this,"batchAckPacketQueue",[]),I(this,"lastOrderedPacketNumber",0),I(this,"batchAckTimer",void 0),I(this,"sendImpl",void 0),I(this,"receiveImpl",void 0),this.sendImpl=n,this.receiveImpl=r,this.ID=Qt(7,"transmitter-"),this.initialRTO=(s==null?void 0:s.initialRTO)!==void 0?s.initialRTO:Y("TRANSMITTER_INITIAL_RTO"),this.initialRTT=(s==null?void 0:s.initialRTT)!==void 0?s.initialRTT:Y("TRANSMITTER_INITIAL_RTT"),this.rtt=(s==null?void 0:s.initialRTT)!==void 0?s.initialRTT:Y("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=(s==null?void 0:s.maxBatchAckCount)!==void 0?s.maxBatchAckCount:Y("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=(s==null?void 0:s.maxRTO)!==void 0?s.maxRTO:Y("TRANSMITTER_MAX_RTO")}packetize(n,r){return{type:vs.Default,version:this.version,packetNumber:r,payload:n}}serialize(n){switch(n.type){case vs.Default:{let r;typeof n.payload=="string"?r=new TextEncoder().encode(n.payload):r=n.payload;const s=new ArrayBuffer(r.length+15),c=new DataView(s);return c.setUint16(0,n.version),c.setUint8(2,n.type),c.setUint32(3,n.packetNumber),fj(c,7,BigInt(n.sendTs)),new Uint8Array(c.buffer).set(r,15),s}case vs.Ack:{const r=new ArrayBuffer(16),s=new DataView(r);return s.setUint16(0,n.version),s.setUint8(2,n.type),s.setUint32(3,n.maxAckPacketNumber),s.setUint8(7,n.shift),fj(s,8,BigInt(n.ackSendTs)),r}}}deserialize(n){const r=new DataView(n),s=r.getUint16(0),c=r.getUint8(2);switch(c){case vs.Default:{const d=r.getUint32(3),h=pj(r,7),f=n.slice(15),g=new TextDecoder().decode(f);return{version:s,type:c,packetNumber:d,sendTs:Number(h),payload:g}}case vs.Ack:{const d=r.getUint32(3),h=r.getUint8(7),f=pj(r,8);return{version:s,type:c,maxAckPacketNumber:d,shift:h,ackSendTs:Number(f)}}default:throw O.error("[".concat(this.ID,"] Unrecognized packet type ").concat(c)),new Error("Unrecognized packet type ".concat(c))}}sendMessage(n){const r=this.packetize(n,this.packetNumber);this.packetNumber=this.packetNumber===4294967295?1:this.packetNumber+1;const s=this.calculateRTO(r),c=window.setTimeout(()=>{this.resendMessage(r)},s);this.timeoutMap.set(r.packetNumber,c),this.sendPacket(r)}onData(n){const r=this.deserialize(n);r.type===vs.Default?this.ack(r):r.type===vs.Ack&&(this.updateRTT(r,Math.round(performance.now())),this.clearRTO(r))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(n=>{let[r,s]=n;window.clearTimeout(s)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,this.batchAckTimer!==void 0&&window.clearTimeout(this.batchAckTimer)}resendMessage(n){const r=this.calculateRTO(n),s=window.setTimeout(()=>{this.resendMessage(n)},r);this.timeoutMap.set(n.packetNumber,s),this.sendPacket(n)}calculateRTO(n){const r=this.rtoRatioMap.get(n.packetNumber);if(r===void 0)return this.rtoRatioMap.set(n.packetNumber,1),this.initialRTO;{const s=9*this.rtt/8*r;return this.rtoRatioMap.set(n.packetNumber,r+1),s>this.maxRTO?this.maxRTO:s}}updateRTT(n,r){const s=n.ackSendTs;this.rtt=this.rtt*(7/8)+(r-s-this.rtt)/8}ack(n){if(n.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(n):(this.batchAckPacketQueue.push(n),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(n.payload);;){const r=this.unorderedPacketQueue[0];if(!r){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(r.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(n.packetNumber<=this.lastOrderedPacketNumber){const r={ackSendTs:n.sendTs,maxAckPacketNumber:n.packetNumber,shift:0,type:vs.Ack,version:this.version};this.sendPacket(r)}else if(n.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[n.packetNumber-this.lastOrderedPacketNumber-2]=n;const r={ackSendTs:n.sendTs,maxAckPacketNumber:n.packetNumber,shift:0,type:vs.Ack,version:this.version};this.sendPacket(r)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const n={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:vs.Ack,version:this.version};this.sendPacket(n),this.batchAckPacketQueue=[]}sendPacket(n){n.type===vs.Default&&(n.sendTs=Math.round(performance.now()));const r=this.serialize(n);this.sendImpl(r)}clearRTO(n){for(let r=n.maxAckPacketNumber-n.shift;r<=n.maxAckPacketNumber;r++){const s=this.timeoutMap.get(r);s!==void 0&&window.clearTimeout(s),this.timeoutMap.delete(r),this.rtoRatioMap.delete(r)}}}class HF extends zie{constructor(n,r){super(n,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),I(this,"_initMutex",void 0),I(this,"_reconnectInterrupter",void 0),I(this,"_url",void 0),I(this,"_transmitter",void 0),I(this,"_addresses",void 0),I(this,"_reliableTransmission",void 0),this._initMutex=new Pr("datachannel");const{timeout:s,timeoutFactor:c}=r,d=Math.max(300,Math.floor(3*s/5)),h=Math.max(1.2,Math.floor(8*c)/10);bi.ONLINE&&(this._retryConfig.timeout=d,this._retryConfig.timeoutFactor=h),rr.on(Yc.NETWORK_STATE_CHANGE,(f,g)=>{f!==g&&(this.resetReconnectCount("network state change: ".concat(g," -> ").concat(f)),f===bi.ONLINE?(this._retryConfig.timeout=d,this._retryConfig.timeoutFactor=h):(this._retryConfig.timeout=s,this._retryConfig.timeoutFactor=c))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this._forceCloseTimeout=r;const s=(c,d)=>{this._addresses=n,this.currentURLIndex=this._addresses.findIndex(f=>f.fingerprint||Y("FINGERPRINT"));const h=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(h).then(c).catch(d),this.once(jn.CLOSED,()=>d(new Z(B.WS_DISCONNECT))),this.once(jn.CONNECTED,()=>c())};return this._initMutex.lock().then(c=>new ae((d,h)=>{s(d,h)}).then(()=>{c()}).catch(()=>{c()}))}sendMessage(n){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new Z(B.WS_ABORT,"datachannel is not ready");try{r||(n=JSON.stringify(n)),this._reliableTransmission.sendMessage(n)}catch(s){throw new Z(B.WS_ERR,"send datachannel signal message error"+s.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(n){const r=JSON.stringify(n);return{compressed:r,compressedLength:r.length,origin:n}}sendMessageWithUint8Array(n){return{compressed:n,compressedLength:n.byteLength,origin:n}}createTransmitterConnection(n){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(n.ip,":").concat(n.port),new ae((r,s)=>{var c;const d=()=>{O.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),r()},h=async E=>{var T;if((T=this._closeEstablishingTransmitter)===null||T===void 0||T.call(this),O.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(E.code,", reason: ").concat(E.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=E.reason,this.state="reconnecting");const w=yo(this,jn.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,A=await this.reconnectWithAction(w);if(this.state==="closed")return void O.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!A)return s(new Z(B.WS_DISCONNECT,"datachannel reconnect failed: ".concat(E.code))),void this.close(!0);r()}else s(new Z(B.WS_DISCONNECT,"datachannel close: ".concat(E.code))),this.close()},f=E=>{var T;(T=this._reliableTransmission)===null||T===void 0||T.onData(E.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),O.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(n)));const g=(c=this._store)===null||c===void 0?void 0:c.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),_=Date.now();nr(this,jn.TO_CONNECT_DATACHANNEL,n).then(E=>{var T,w;if(!E)throw new Error("transmissonInfo not exist yet");const{transmitter:A,close:L}=E;this._transmitter=A,(T=this._store)===null||T===void 0||T.signalChannelOpen();const P=Date.now()-_;O.debug("[choose dc] dc open cost ".concat(P,"ms")),this._reliableTransmission=new Gie(D=>{var G;this._transmitter&&this._transmitter.readyState==="open"&&((G=this._transmitter)===null||G===void 0||G.send(D))},D=>{typeof D=="string"&&this.emit(jn.ON_MESSAGE,D)}),this._closeEstablishingTransmitter=()=>{var D;(D=this._reliableTransmission)===null||D===void 0||D.close(),this._reliableTransmission=void 0,L()},d&&d(),A.onclose=h,A.onmessage=f,(w=this._store)===null||w===void 0||w.recordJoinChannelService({endTs:Date.now(),status:"success"},g),this._joinChannelServiceRecordIndex=g}).catch(E=>{var T;if((T=this._store)===null||T===void 0||T.recordJoinChannelService({endTs:Date.now(),status:E instanceof Z&&E.code===B.WS_ABORT?"aborted":"error",errors:[E]},g),this.state!=="closed"){if(E instanceof Z&&E.code===B.WS_ERR){const w=new Z(B.WS_ERR,"init datachannel failed! Error: ".concat(E.toString()));return O.error("[".concat(this._name,"]").concat(w)),void s(w)}h&&h(E)}else s(new Z(B.WS_DISCONNECT,"datachannel is closed: ".concat(E.toString())))})})}async reconnectWithAction(n){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount||!this._addresses||this.state==="closed")return!1;this._onlineReconnectListener||rr.networkState!==bi.OFFLINE||(this._onlineReconnectListener=rr.onlineWaiter&&rr.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let s=!0;if(this._reconnectInterrupter=()=>{s=!1},r){const f=zy(this._reconnectCount,this._retryConfig);O.debug("[".concat(this._name,"] wait ").concat(f,"ms to reconnect datachannel, mode: ").concat(n)),await ae.race([Nr(f),this._onlineReconnectListener||new ae(()=>{})])}if(this.state==="closed"||!s)return!1;this._reconnectCount+=1;const c=async(f,g)=>{this.emit(jn.RECONNECT_CREATE_CONNECTION,g),await this.createTransmitterConnection(f)};try{if(n==="retry"){const f=this._addresses[this.currentURLIndex];this.emit(jn.RECONNECT_WAITTING_FINISH,n),await c(f,n)}else if(n==="tryNext"){this.currentURLIndex+=1;for(let g=this.currentURLIndex;g<this._addresses.length;g++){if(this._addresses[g].fingerprint||Y("FINGERPRINT")){this.currentURLIndex=g;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return O.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);O.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const f=this._addresses[this.currentURLIndex];this.emit(jn.RECONNECT_WAITTING_FINISH,n),await c(f,n)}else n==="recover"&&(O.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(jn.RECONNECT_WAITTING_FINISH,n),this.emit(jn.FAILBACK));return!0}catch(f){var d,h;return O.error("[".concat(this._name,"] reconnect failed"),f.toString()),f!=null&&(d=f.data)!==null&&d!==void 0&&d.desc&&Array.isArray(f.data.desc)&&f.data.desc.length&&Le(h=f.data.desc).call(h,"dynamic key expired")?(this.emit(jn.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(n,r)}}}class Zc extends mn{get connectionState(){return this._connectionState}set connectionState(n){n!==this._connectionState&&(this._connectionState=n,n===pt.CONNECTED?this.emit(De.WS_CONNECTED):n===pt.RECONNECTING?this.emit(De.WS_RECONNECTING,this._websocketReconnectReason):n===pt.CLOSED&&this.emit(De.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(n,r){super(),I(this,"_disconnectedReason",void 0),I(this,"_websocketReconnectReason",void 0),I(this,"_connectionState",pt.CLOSED),I(this,"reconnectToken",void 0),I(this,"websocket",void 0),I(this,"openConnectionTime",void 0),I(this,"clientId",void 0),I(this,"lastMsgTime",Date.now()),I(this,"uploadCache",[]),I(this,"uploadCacheInterval",void 0),I(this,"rttRolling",new oI(5)),I(this,"pingpongTimer",void 0),I(this,"inflateDataTimer",void 0),I(this,"pingpongTimeoutCount",0),I(this,"joinResponse",void 0),I(this,"multiIpOption",void 0),I(this,"initError",void 0),I(this,"spec",void 0),I(this,"store",void 0),I(this,"onWebsocketMessage",s=>{if(s instanceof ArrayBuffer)return void this.emit(De.ON_BINARY_DATA,s);const c=JSON.parse(s);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(c,"_id")){const d="res-@".concat(c._id);this.emit(d,c._result,c._message)}else if(Object.prototype.hasOwnProperty.call(c,"_type")&&(this.emit(c._type,c._message),c._type===nt.ON_NOTIFICATION&&this.handleNotification(c._message),c._type===nt.ON_USER_BANNED))switch(c._message.error_code){case 14:this.close(vt.UID_BANNED);break;case 15:this.close(vt.IP_BANNED);break;case 16:this.close(vt.CHANNEL_BANNED)}}),this.clientId=n.clientId,this.spec=n,this.store=r,this.websocket=new HF("gateway-".concat(this.clientId),this.spec.retryConfig,!0,r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===pt.CONNECTED&&this.reconnect("retry",nc.OFFLINE)})}async request(n,r,s,c){const d=Qt(6,""),h={_id:d,_type:n,_message:r},f=this.websocket.connectionID,g=()=>new ae((L,P)=>{if(this.connectionState===pt.CONNECTED)return L();const D=()=>{this.off(De.WS_CLOSED,G),L()},G=()=>{this.off(De.WS_CONNECTED,D),P(new Z(B.WS_ABORT))};this.once(De.WS_CONNECTED,D),this.once(De.WS_CLOSED,G),n!==We.PUBLISH&&n!==We.SUBSCRIBE&&n!==We.UNSUBSCRIBE&&n!==We.UNPUBLISH&&n!==We.CONTROL&&n!==We.RESTART_ICE||this.once(De.DISCONNECT_P2P,()=>{P(new Z(B.DISCONNECT_P2P))}),n!==We.PUBLISH&&n!==We.RESTART_ICE||this.once(De.ABORT_P2P_EXECUTION,()=>{P(new Z(B.DISCONNECT_P2P))})});if(this.connectionState!==pt.CONNECTING&&this.connectionState!==pt.RECONNECTING||n===We.JOIN||n===We.REJOIN||await g(),n===We.LEAVE&&(this.websocket.unbindDcCloseEventListener(),c=!0),this.websocket.sendMessage(h,!0,!1),c)return;const _=new ae((L,P)=>{let D=!1;const G=(X,ie)=>{D=!0,L({isSuccess:X==="success",message:ie||{}}),this.off(De.WS_CLOSED,$),this.off(De.WS_RECONNECTING,$),this.emit(De.REQUEST_SUCCESS,n,r)};this.once("res-@".concat(d),G);const $=()=>{P(new Z(B.WS_ABORT,"type: ".concat(n))),this.off(De.WS_CLOSED,$),this.off(De.WS_RECONNECTING,$),this.off("res-@".concat(d),G)};this.once(De.WS_CLOSED,$),this.once(De.WS_RECONNECTING,$),Nr(Y("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==f||D||(O.warning("dc request timeout, type: ".concat(n)),this.emit(De.REQUEST_TIMEOUT,n,r))})});let E=null;try{E=await _}catch(L){if(this.connectionState===pt.CLOSED||n===We.LEAVE)throw new Z(B.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?L.throw():n===We.JOIN||n===We.REJOIN?null:(await g(),await this.request(n,r))}if(E.isSuccess)return E.message;const T=Number(E.message.error_code||E.message.code),w=Lu(T),A=new Z(B.UNEXPECTED_RESPONSE,"".concat(w.desc,": ").concat(E.message.error_str),{code:T,data:E.message});return w.action==="success"?E.message:(O.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(n,", error_code: ").concat(T,", message: ").concat(w.desc,", action: ").concat(w.action)),T===qe.ERR_TOO_MANY_BROADCASTERS?((n===We.JOIN||n===We.REJOIN)&&(this.initError=A,this.close()),A.throw()):w.action==="failed"?A.throw():w.action==="quit"?(this.initError=A,this.close(),A.throw()):(T===qe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=E.message.option,O.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",nc.MULTI_IP)):this.reconnect(w.action,nc.SERVER_ERROR),n===We.JOIN||n===We.REJOIN?null:await this.request(n,r)))}waitMessage(n,r){return new ae(s=>{const c=d=>{(!r||r(d))&&(this.off(n,c),s(d))};this.on(n,c)})}uploadWRTCStats(n){if(!this.store.sessionId)return void O.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const r={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:n};this.upload(Qc.WRTC_STATS,r)}upload(n,r){const s={_type:n,_message:r};try{this.websocket.sendMessage(s)}catch{const d=Y("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>d&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==pt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},Y("UPLOAD_CACHE_INTERVAL")||2e3))}}send(n,r){const s={_type:n,_message:r};this.websocket.sendMessage(s)}init(n,r){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new ae((s,c)=>{this.once(De.WS_CONNECTED,()=>s(this.joinResponse)),this.once(De.WS_CLOSED,()=>c(this.initError||new Z(B.WS_ABORT))),this.connectionState=pt.CONNECTING,this.websocket.init(n).catch(c),this.websocket.once(jn.FAILBACK,()=>{this.openConnectionTime===void 0&&c(new Z(B.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{r&&this.openConnectionTime===void 0&&(O.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),c(new Z(B.INIT_DATACHANNEL_TIMEOUT)))},Y("DC_JOIN_WITH_FAILBACK"))})}close(n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=n||vt.LEAVE,this.connectionState=pt.CLOSED,O.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),n===vt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new HF("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(De.ABORT_P2P_EXECUTION);const n=await nr(this,De.DATACHANNEL_CONNECTING),r=await this.request(We.JOIN,n);if(!r)return this.emit(De.REPORT_JOIN_GATEWAY,B.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(De.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=pt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new Z(B.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const n=Nu(this,De.REQUEST_REJOIN_INFO);n.token=this.reconnectToken;const r=await this.request(We.REJOIN,n);return!!r&&(this.connectionState=pt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),r.peers&&r.peers.forEach(s=>{this.emit(nt.ON_USER_ONLINE,{uid:s.uid}),s.audio&&this.emit(nt.ON_ADD_AUDIO_STREAM,{uid:s.uid,uint_id:s.uint_id,audio:!0,ssrcId:s.audio_ssrc}),s.video&&this.emit(nt.ON_ADD_VIDEO_STREAM,{uid:s.uid,uint_id:s.uint_id,video:!0,ssrcId:s.video_ssrc}),s.audio_mute?this.emit(nt.MUTE_AUDIO,{uid:s.uid}):this.emit(nt.UNMUTE_AUDIO,{uid:s.uid}),s.video_mute?this.emit(nt.MUTE_VIDEO,{uid:s.uid}):this.emit(nt.UNMUTE_VIDEO,{uid:s.uid}),s.audio_enable_local?this.emit(nt.ENABLE_LOCAL_AUDIO,{uid:s.uid}):this.emit(nt.DISABLE_LOCAL_AUDIO,{uid:s.uid}),s.video_enable_local?this.emit(nt.ENABLE_LOCAL_VIDEO,{uid:s.uid}):this.emit(nt.DISABLE_LOCAL_VIDEO,{uid:s.uid}),s.audio||s.video||this.emit(nt.ON_REMOVE_STREAM,{uid:s.uid,uint_id:s.uint_id})}),!0)}reconnect(n,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(n,r)}handleNotification(n){O.debug("[".concat(this.clientId,"] receive notification: "),n);const r=Lu(n.code);if(r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(vt.UID_BANNED),void this.close()):void this.reconnect(r.action,nc.SERVER_ERROR);O.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const n=Y("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=n&&(O.warning("PINGPONG Timeout. Last Socket Message: ".concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>Y("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",nc.TIMEOUT):this.request(We.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-r;this.rttRolling.add(s),Y("REPORT_STATS")&&this.send(We.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleInflateData(){const{inflateLength:n,deflateLength:r}=this.websocket.getInflateData();n!==0&&r!==0&&this.upload(Qc.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:r,ws_inflate_length:n})}handleWebsocketEvents(){this.websocket.on(jn.RECONNECT_WAITTING_FINISH,n=>{this.emit(De.WS_RECONNECT_WAITTING_FINISH,n)}),this.websocket.on(jn.RECONNECT_CREATE_CONNECTION,n=>{this.emit(De.WS_RECONNECT_CREATE_CONNECTION,n)}),this.websocket.on(jn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(jn.CLOSED,()=>{this.connectionState=pt.CLOSED}),this.websocket.on(jn.FAILED,()=>{this._disconnectedReason=vt.NETWORK_ERROR,this.connectionState=pt.CLOSED}),this.websocket.on(jn.RECONNECTING,n=>{this._websocketReconnectReason=n,this.joinResponse=void 0,this.connectionState===pt.CONNECTED?this.connectionState=pt.RECONNECTING:this.connectionState=pt.CONNECTING}),this.websocket.on(jn.WILL_RECONNECT,(n,r)=>{if(Nu(this,De.IS_P2P_DISCONNECTED)&&n==="retry")return O.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(De.NEED_RENEW_SESSION),this.emit(De.DISCONNECT_P2P),r("tryNext");n!=="retry"&&(O.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(n)),this.reconnectToken=void 0,this.emit(De.NEED_RENEW_SESSION),this.emit(De.DISCONNECT_P2P)),r(n)}),this.websocket.on(jn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(n=>{O.warning("[".concat(this.clientId,"] rejoin failed ").concat(n)),this.reconnect("tryNext",nc.SERVER_ERROR)}):this.join().catch(n=>{if(this.emit(De.REPORT_JOIN_GATEWAY,n.message||n.code,this.url||""),n instanceof Z&&n.code===B.UNEXPECTED_RESPONSE&&n.data.code===qe.ERR_NO_AUTHORIZED)return O.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",nc.SERVER_ERROR);O.error("[".concat(this.clientId,"] join gateway request failed"),n.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",nc.SERVER_ERROR):(this.initError=n,this.close())})}),this.websocket.on(jn.REQUEST_NEW_URLS,(n,r)=>{nr(this,De.REQUEST_RECOVER,this.multiIpOption).then(n).catch(r)}),this.websocket.on(jn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(nt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(jn.TO_CONNECT_DATACHANNEL,async(n,r,s)=>nr(this,De.DATACHANNEL_PRECONNECT,n).then(r).catch(s)),this.websocket.on(jn.FAILBACK,()=>{this.openConnectionTime!==void 0&&this.emit(De.DATACHANNEL_FAILBACK)})}}class Mu extends mn{constructor(n,r){super(),I(this,"signal",void 0),I(this,"token",void 0),I(this,"tokenTimeout",void 0),I(this,"tokenInterval",void 0),I(this,"_sequence",0),I(this,"userMap",new Map),I(this,"encoder",new TextEncoder),this.signal=n,this.token=r;const s=()=>{this.signal.connectionState===pt.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(s,1e3):this.tokenInterval=window.setTimeout(s,3*Y("P2P_TOKEN_INTERVAL"))};s()}async send(n,r,s,c,d){var h,f,g;if(this.userMap.size===0)return;const _=Array.from(Ia(h=this.userMap).call(h))[0].token;typeof r!="string"&&(r=JSON.stringify(r)),c=(f=c)!==null&&f!==void 0?f:Qt(6,""),d=(g=d)!==null&&g!==void 0?g:this._sequence++;const E={_id:c,_type:n,_seq:d,_message:r,token:"".concat(this.token,"_").concat(_)};Y("SHOW_P2P_LOG")&&O.debug("send message",E,"noNeedResponse : ".concat(s)),this.splitMessage(JSON.stringify(E)).forEach(w=>{this.signal.request(We.DATA_STREAM,{payload:Cp(this.encoder.encode(w))})});const T=new ae((w,A)=>{const L=window.setTimeout(()=>{this.off("res-@".concat(c,"_ack"),P),this.off("res-@".concat(c),G),this.off(ad.ABORT,D),O.debug("[external-signal] request timeout, type: ".concat(n,", requestId: ").concat(c)),this.userMap.size===0?A(new he(B.INVALID_REMOTE_USER)):A(new he(B.TIMEOUT))},Y("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),P=()=>{L&&window.clearTimeout(L),this.off(ad.ABORT,D),s&&w()},D=()=>{L&&window.clearTimeout(L),this.off("res-@".concat(c,"_ack"),P),this.off("res-@".concat(c),G),A(new he(B.EXTERNAL_SIGNAL_ABORT,"type: ".concat(n,", requestId: ").concat(c)))};this.once(ad.ABORT,D),this.once("res-@".concat(c,"_ack"),P);const G=(X,ie)=>{$=!0,L&&window.clearTimeout(L),this.off("res-@".concat(c,"_ack"),P),this.off(ad.ABORT,D),X==="success"?w(ie):A(new he(B.P2P_MESSAGE_FAILED,"request ".concat(n," failed, requestId: ").concat(c)))};let $=!1;s||(this.once("res-@".concat(c),G),Nr(Y("SIGNAL_REQUEST_TIMEOUT")).then(()=>{$||O.warning("external_signal request timeout, type: ".concat(n,", requestId: ").concat(c,", ").concat(E))}))});try{return await T}catch(w){if(w.code===B.TIMEOUT)return await this.send(n,r,s,c,d);throw w}}onMessage(n){var r;const{_uid:s}=n;let c,d=this.userMap.get(s);if(d)c=d.splitMessageMap;else{if(this.userMap.size>0||!("_type"in n)||n._type!==An.CHECK)return;const{token:_}=n;c=new Map,d={uid:s,isStart:!0,token:_,splitMessageMap:c,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(s,d),this.signal.emit(nt.ON_USER_ONLINE,{uid:s}),this.handleUserOnline()}if("id"in n&&"total"in n){var h;const{id:_,total:E}=n,T=(h=c.get(_))!==null&&h!==void 0?h:[];if(T.push(n),c.has(_)||c.set(_,T),T.length!==E)return;{const w=cg(T).call(T,(A,L)=>A.index-L.index).map(A=>A.payload).join("");c.delete(_),(n=JSON.parse(w))._uid=s}}const{_type:f,token:g}=n;if(Le(r=[An.ACK,An.CHECK]).call(r,f))return f===An.CHECK&&this.handleCheckToken(d,g),void this.receiveMessage(n);g==="".concat(d.token,"_").concat(this.token)?this.handleReceivedMessage(n):O.debug('Receive unexpected message", '.concat(g,", cur_token: ").concat(d.token,"_").concat(this.token),n)}check(){const n={_id:Qt(6,""),token:this.token,_type:An.CHECK};Y("SHOW_P2P_LOG")&&O.debug("send message",n),this.signal.request(We.DATA_STREAM,{payload:Cp(this.encoder.encode(JSON.stringify(n)))})}ack(n){const r={_id:n,_type:An.ACK,token:this.token};Y("SHOW_P2P_LOG")&&O.debug("send message",r),this.signal.request(We.DATA_STREAM,{payload:Cp(this.encoder.encode(JSON.stringify(r)))})}response(n,r,s){this.send(An.RESPONSE,JSON.stringify({success:!s,message:r}),!0,n)}handleReceivedMessage(n){const r=()=>{this.userMap.forEach(_=>{const{receivedMessagesMap:E,nextExpectedSequenceNumber:T}=_;for(;E.has(T);){const w=E.get(T);E.delete(T),this.receiveMessage(w),_.nextExpectedSequenceNumber++}})};if(!n)return void r();const{_uid:s,_seq:c}=n,d=this.userMap.get(s),{receivedMessagesMap:h,isStart:f,nextExpectedSequenceNumber:g}=d;if(c<g)return this.ack(n._id),void O.debug("[external-signal] receive old message, seq: ".concat(c,", ").concat(n._message));h.set(c,n),f&&c===g&&(this.receiveMessage(n),h.delete(g),d.nextExpectedSequenceNumber++,r())}receiveMessage(n){const{_id:r,_type:s,_message:c,_uid:d}=n;if(Y("SHOW_P2P_LOG")&&O.debug("receive message",n),r){let h;switch(n._type!==An.ACK&&(c&&(h=JSON.parse(c)),this.ack(n._id)),n._type){case An.CANDIDATE:case An.CONTROL:this.signal.emit(s,h,d);break;case An.PUBLISH:case An.UNPUBLISH:case An.RESTART_ICE:case An.CALL:h.uid=d,nr(this.signal,s,h).then(f=>{this.response(n._id,f)}).catch(()=>{this.response(n._id,void 0,!0)});break;case An.ACK:this.getListeners("res-@".concat(r,"_ack")).length>0&&this.emit("res-@".concat(r,"_ack"));break;case An.RESPONSE:{const{success:f,message:g}=h;this.emit("res-@".concat(r),f?"success":"failed",g);break}}}}splitMessage(n){if(n.length<Mu.MAX_MESSAGE_SIZE)return[n];const r=[],{remoteToken:s}=JSON.parse(n),c=Qt(6,"");let d=0,h=800;const f=Math.ceil(n.length/h);for(;n.length>0;){d++;const g={id:c,index:d,total:f,payload:n.slice(0,h),token:"".concat(this.token,"_").concat(s)};JSON.stringify(g).length>Mu.MAX_MESSAGE_SIZE?h-=50:(r.push(g),n=n.slice(h))}return r.map(g=>JSON.stringify(g))}handleCheckToken(n,r){return n.token!==r?(O.debug("token changed, from ".concat(n.token," to ").concat(r)),this.reset(n.uid,r),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{O.debug("token timeout, ".concat(r)),this.reset(n.uid)},Y("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const n=await nr(this.signal,An.CALL,void 0),r=await this.send(An.CALL,n);this.signal.emit(De.P2P_CONNECTION,r,!0)}async reset(n,r){const s=this.userMap.get(n);s&&(this.emit(ad.ABORT),this.signal.emit(nt.ON_USER_OFFLINE,{uid:s.uid,reason:DI.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),r||(O.debug("change local token from ".concat(r," to ").concat(r)),this.token=Qt(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(ad.ABORT)}}I(Mu,"MAX_SIZE",1),I(Mu,"MAX_MESSAGE_SIZE",1024);class $F extends mn{get connectionState(){return this._connectionState}set connectionState(n){n!==this._connectionState&&(this._connectionState=n,n===pt.CONNECTED?this.emit(De.WS_CONNECTED):n===pt.RECONNECTING?this.emit(De.WS_RECONNECTING,this._websocketReconnectReason):n===pt.CLOSED&&this.emit(De.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(n,r){super(),I(this,"_disconnectedReason",void 0),I(this,"_websocketReconnectReason",void 0),I(this,"_connectionState",pt.CLOSED),I(this,"reconnectToken",void 0),I(this,"p2pToken",void 0),I(this,"websocket",void 0),I(this,"openConnectionTime",void 0),I(this,"clientId",void 0),I(this,"lastMsgTime",Date.now()),I(this,"uploadCache",[]),I(this,"uploadCacheInterval",void 0),I(this,"rttRolling",new oI(5)),I(this,"pingpongTimer",void 0),I(this,"pingpongTimeoutCount",0),I(this,"joinResponse",void 0),I(this,"multiIpOption",void 0),I(this,"initError",void 0),I(this,"spec",void 0),I(this,"store",void 0),I(this,"_external_signal",void 0),I(this,"onWebsocketMessage",s=>{if(s.data instanceof ArrayBuffer)return void this.emit(De.ON_BINARY_DATA,s.data);const c=JSON.parse(s.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(c,"_id")){const d="res-@".concat(c._id);this.emit(d,c._result,c._message)}else if(Object.prototype.hasOwnProperty.call(c,"_type")){switch(c._type){case nt.ON_DATA_STREAM:return void this.handleDataStream(c._message);case nt.MUTE_AUDIO:case nt.MUTE_VIDEO:case nt.ON_P2P_LOST:case nt.ON_USER_ONLINE:return;case nt.ON_USER_OFFLINE:const{uid:d}=c._message;return O.debug("[".concat(this.clientId,"] user-offline uid: ").concat(d)),void this._external_signal.reset(d)}if(this.emit(c._type,c._message),c._type===nt.ON_NOTIFICATION&&this.handleNotification(c._message),c._type===nt.ON_USER_BANNED)switch(c._message.error_code){case 14:this.close(vt.UID_BANNED);break;case 15:this.close(vt.IP_BANNED);break;case 16:this.close(vt.CHANNEL_BANNED)}if(c._type===nt.ON_USER_LICENSE_BANNED)switch(c._message.error_code){case qe.ERR_LICENSE_MISSING:this.close(vt.LICENSE_MISSING);break;case qe.ERR_LICENSE_EXPIRED:this.close(vt.LICENSE_EXPIRED);break;case qe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(vt.LICENSE_MINUTES_EXCEEDED);break;case qe.ERR_LICENSE_PERIOD_INVALID:this.close(vt.LICENSE_PERIOD_INVALID);break;case qe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(vt.LICENSE_MULTIPLE_SDK_SERVICE);break;case qe.ERR_LICENSE_ILLEGAL:this.close(vt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=n.clientId,this.spec=n,this.store=r,this.websocket=new Og("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Y("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Y("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===pt.CONNECTED&&this.reconnect("retry",Or.OFFLINE)}),this.p2pToken=Qt(6,""),this._external_signal=new Mu(this,this.p2pToken)}async request(n,r,s,c){const d=Qt(6,""),h={_id:d,_type:n,_message:r},f=this.websocket.connectionID,g=()=>new ae((L,P)=>{if(this.connectionState===pt.CONNECTED)return L();const D=()=>{this.off(De.WS_CLOSED,G),L()},G=()=>{this.off(De.WS_CONNECTED,D),P(new he(B.WS_ABORT))};this.once(De.WS_CONNECTED,D),this.once(De.WS_CLOSED,G)});if(this.connectionState!==pt.CONNECTING&&this.connectionState!==pt.RECONNECTING||n===We.JOIN||n===We.REJOIN||await g(),this.websocket.sendMessage(h,!0),c)return;const _=new ae((L,P)=>{let D=!1;const G=(X,ie)=>{D=!0,L({isSuccess:X==="success",message:ie||{}}),this.off(De.WS_CLOSED,$),this.off(De.WS_RECONNECTING,$),this.emit(De.REQUEST_SUCCESS,n,r)};this.once("res-@".concat(d),G);const $=()=>{P(new he(B.WS_ABORT,"type: ".concat(n))),this.off(De.WS_CLOSED,$),this.off(De.WS_RECONNECTING,$),this.off("res-@".concat(d),G)};this.once(De.WS_CLOSED,$),this.once(De.WS_RECONNECTING,$),Nr(Y("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==f||D||(O.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(n)),this.emit(De.REQUEST_TIMEOUT,n,r))})});let E=null;try{E=await _}catch(L){if(this.connectionState===pt.CLOSED||n===We.LEAVE)throw new he(B.WS_ABORT);return!this.spec.forceWaitGatewayResponse||s?L.throw():n===We.JOIN||n===We.REJOIN?null:(await g(),await this.request(n,r))}if(E.isSuccess)return E.message;const T=Number(E.message.error_code||E.message.code),w=Lu(T),A=new he(B.UNEXPECTED_RESPONSE,"".concat(w.desc,": ").concat(E.message.error_str),{code:T,data:E.message});return w.action==="success"?E.message:(O.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(n,", error_code: ").concat(T,", message: ").concat(w.desc,", action: ").concat(w.action)),T===qe.ERR_TOO_MANY_BROADCASTERS?((n===We.JOIN||n===We.REJOIN)&&(this.initError=A,this.close()),A.throw()):w.action==="failed"?A.throw():w.action==="quit"?(this.initError=A,this.close(),A.throw()):(T===qe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=E.message.option,O.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Or.MULTI_IP)):this.reconnect(w.action,Or.SERVER_ERROR),n===We.JOIN||n===We.REJOIN?null:await this.request(n,r)))}waitMessage(n,r){return new ae(s=>{const c=d=>{(!r||r(d))&&(this.off(n,c),s(d))};this.on(n,c)})}uploadWRTCStats(n){if(!this.store.sessionId)return void O.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const r={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:n};this.upload(Qc.WRTC_STATS,r)}upload(n,r){const s={_type:n,_message:r};try{this.websocket.sendMessage(s)}catch{const d=Y("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(s),this.uploadCache.length>d&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==pt.CONNECTED)return;const h=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(h._type,h._message)},Y("UPLOAD_CACHE_INTERVAL")||2e3))}}send(n,r){const s={_type:n,_message:r};this.websocket.sendMessage(s)}async sendExtensionMessage(n,r,s){return await this._external_signal.send(n,r,s)}init(n){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new ae((r,s)=>{this.once(De.WS_CONNECTED,()=>r(this.joinResponse)),this.once(De.WS_CLOSED,()=>s(this.initError||new he(B.WS_ABORT))),this.connectionState=pt.CONNECTING,this.websocket.init(n).catch(s)})}close(n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=n||vt.LEAVE,this.connectionState=pt.CLOSED,O.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),n===vt.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new Og("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Y("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Y("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents()),this.p2pToken=Qt(6,""),this._external_signal.clear(),this._external_signal=new Mu(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(De.ABORT_P2P_EXECUTION);const n=await nr(this,De.REQUEST_JOIN_INFO),r=await this.request(We.JOIN,n);if(!r)return this.emit(De.REPORT_JOIN_GATEWAY,B.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(De.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=pt.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(n,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(n,r)}handleDataStream(n){try{var r;const s=yg(n.payload),c=new TextDecoder().decode(s),d=JSON.parse(c);"total"in d&&"id"in d||Le(r=Object.values(An)).call(r,d._type)?(d._uid=n.uid,this._external_signal.onMessage(d)):this.emit(nt.ON_DATA_STREAM,n)}catch{this.emit(nt.ON_DATA_STREAM,n)}}handleNotification(n){O.debug("[".concat(this.clientId,"] receive notification: "),n);const r=Lu(n.code);if(r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(vt.UID_BANNED),void this.close()):void this.reconnect(r.action,Or.SERVER_ERROR);O.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const n=Y("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=n&&(O.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>Y("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Or.TIMEOUT):this.request(We.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const s=Date.now()-r;this.rttRolling.add(s),Y("REPORT_STATS")&&this.send(We.PING_BACK,{pingpongElapse:s})}).catch(s=>{})}handleWebsocketEvents(){this.websocket.on(tt.RECONNECT_WAITTING_FINISH,n=>{this.emit(De.WS_RECONNECT_WAITTING_FINISH,n)}),this.websocket.on(tt.RECONNECT_CREATE_CONNECTION,n=>{this.emit(De.WS_RECONNECT_CREATE_CONNECTION,n)}),this.websocket.on(tt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(tt.CLOSED,()=>{this.connectionState=pt.CLOSED}),this.websocket.on(tt.FAILED,()=>{this._disconnectedReason=vt.NETWORK_ERROR,this.connectionState=pt.CLOSED}),this.websocket.on(tt.RECONNECTING,n=>{this._websocketReconnectReason=n,this.joinResponse=void 0,this.connectionState===pt.CONNECTED?this.connectionState=pt.RECONNECTING:this.connectionState=pt.CONNECTING}),this.websocket.on(tt.WILL_RECONNECT,(n,r,s)=>{n!=="retry"?(O.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(n)),this.reconnectToken=void 0,this.emit(De.NEED_RENEW_SESSION)):O.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),s(n)}),this.websocket.on(tt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(n=>{if(this.emit(De.REPORT_JOIN_GATEWAY,n.message||n.code,this.url||""),n instanceof he&&n.code===B.UNEXPECTED_RESPONSE&&n.data.code===qe.ERR_NO_AUTHORIZED)return O.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Or.SERVER_ERROR);O.error("[".concat(this.clientId,"] join gateway request failed"),n.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Or.SERVER_ERROR):(this.initError=n,this.close())})}),this.websocket.on(tt.REQUEST_NEW_URLS,(n,r)=>{nr(this,De.REQUEST_RECOVER,this.multiIpOption).then(n).catch(r)}),this.websocket.on(tt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(nt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}function KF(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function Hs(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?KF(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):KF(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}const BI=new Map;class Hie extends mn{get state(){return this._state}set state(n){if(n===this._state)return;const r=this._state;this._state=n,n==="DISCONNECTED"&&this._disconnectedReason?this.emit(In.CONNECTION_STATE_CHANGE,n,r,this._disconnectedReason):this.emit(In.CONNECTION_STATE_CHANGE,n,r)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(n){O.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(n)),this._joinGatewayStartTime=n}constructor(n,r){super(),I(this,"store",void 0),I(this,"joinInfo",void 0),I(this,"key",void 0),I(this,"ntpOffset",0),I(this,"signal",void 0),I(this,"role",void 0),I(this,"inChannelInfo",{joinAt:null,duration:0}),I(this,"spec",void 0),I(this,"_state","DISCONNECTED"),I(this,"_statsCollector",void 0),I(this,"_disconnectedReason",void 0),I(this,"isSignalRecover",!1),I(this,"hasChangeBGPAddress",!1),I(this,"trafficStatsInterval",void 0),I(this,"networkQualityInterval",void 0),I(this,"_joinGatewayStartTime",0),I(this,"_signalTimeout",!1),I(this,"_clientRoleOptions",void 0),I(this,"_isProactiveJoin",!1),this.store=n,this.spec=r,this.signal=this.store.useP2P?new $F(Hs(Hs({},r),{},{retryConfig:r.websocketRetryConfig}),n):this.store.useDataChannel?new Zc(Hs(Hs({},r),{},{retryConfig:r.websocketRetryConfig}),n):new MF(Hs(Hs({},r),{},{retryConfig:r.websocketRetryConfig}),n),this._statsCollector=r.statsCollector,this.role=r.role||"audience",this._clientRoleOptions=r.clientRoleOptions,this.handleSignalEvents()}async join(n,r,s){if(this.signal instanceof Zc){let g=!1;n.cloudProxyServer!=="disabled"?(O.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(n.cloudProxyServer,")")),g=!0):"".concat(n.apResponse.cid,"_").concat(n.apResponse.cert).length>255||"".concat(n.apResponse.cid,"_").concat(n.apResponse.cert).length<22?(O.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),g=!0):n.apResponse.addresses.some(_=>_.fingerprint)||Y("FINGERPRINT")||(O.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),g=!0),g&&this.resetSignal()}this.store.joinGatewayStart(),n.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const c=Date.now();let d=BI.get(n.cname);if(d||(d=new Map,BI.set(n.cname,d)),this._isProactiveJoin=!0,d.has(n.uid)){const g=new Z(B.UID_CONFLICT);throw Be.joinGateway(n.sid,{lts:c,succ:!1,ec:g.message,addr:null,uid:n.uid,cid:n.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!n.proxyServer,signalChannel:this.signal instanceof Zc?"1":"0"}),this._isProactiveJoin=!1,g}d.set(n.uid,!0),this.joinInfo=n,this.key=r;let h=0;this.joinGatewayStartTime=c;const f=n.proxyServer;try{let g;if(O.debug("[".concat(this.store.clientId,"] use ").concat(this.signal instanceof Zc?"datachannel":"websocket"," join uid ").concat(h)),this.signal instanceof Zc)g=await this.signal.init(n.apResponse.addresses,s);else{const _=n.gatewayAddrs.map(E=>{let{address:T}=E;const[w,A]=T.split(":"),L={host:w,port:A};return n.proxyServer&&(L.proxy=n.proxyServer),L});g=await this.signal.init(_,s)}h=g.uid,O.debug("[".concat(this.store.clientId,"] ").concat(this.signal instanceof Zc?"datachannel":"websocket"," join uid ").concat(h," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(g){throw g&&g.code===B.INIT_WEBSOCKET_TIMEOUT?(O.warning("[".concat(this.store.clientId,"] User join failed"),g.toString()),g):g&&g.code===B.INIT_DATACHANNEL_TIMEOUT?(O.warning("[".concat(this.store.clientId,"] User join datachannel failed"),g.toString()),this.resetSignal(),g):(O.error("[".concat(this.store.clientId,"] User join failed"),g.toString()),Be.joinGateway(n.sid,{lts:c,succ:!1,ec:g.message,addr:this.signal.url,uid:n.uid,cid:n.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!f,signalChannel:this.signal instanceof Zc?"1":"0"}),this._isProactiveJoin=!1,d.delete(n.uid),this.signal.close(),g)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),O.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(g=>{O.warning("[".concat(this.store.clientId,"] get traffic stats error"),g.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(In.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(In.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(In.NETWORK_QUALITY,{uplinkNetworkQuality:zF(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:zF(this._statsCollector.trafficStats.B_dnq)}):this.emit(In.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),h}async leave(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){r!==vt.FALLBACK&&(this.state="DISCONNECTING");try{n||this.signal.connectionState!==pt.CONNECTED||await function(s,c){return c===1/0?s:ae.race([s,xre(c)])}(this.signal.request(We.LEAVE,void 0,!0),3e3)}catch(s){O.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),s)}this.signal.close(r),r!==vt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(n,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const c={state:"offer",p2p_id:this.store.p2pId,ortc:r,mode:this.spec.mode,extend:Y("PUB_EXTEND"),twcc:!!Y("PUBLISH_TWCC"),rtx:!!Y("USE_PUB_RTX")};try{return(await this.signal.request(We.PUBLISH,c,!0))._message}catch(d){if(s&&d.data&&d.data.code===qe.ERR_PUBLISH_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),d.toString()),await this.tryUnpubBeforeRepub(n,r),this.publish(n,r,!1);throw d}}async publishDataChannel(n,r,s){var c;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const d={stream_id:r.streamId,ordered:r.ordered?1:0,max_retrans_times:(c=r.maxRetransmits)!==null&&c!==void 0?c:10,channel_id:r.channelId,metadata:r.metadata};try{await this.signal.request(We.PUBLISH_DATASTREAM,d,!0)}catch(h){if(s&&h.data&&h.data.code===qe.ERR_PUBLISH_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),h.toString()),await this.tryUnpubDataChannelBeforeRepub(n,r),this.publishDataChannel(n,r,!1);throw h}}async unpublish(n,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(We.UNPUBLISH,{stream_id:r,ortc:n},!0)}catch(s){O.warning("[".concat(this.store.clientId,"] unpublish warning: "),s)}}async unpublishDataChannel(n){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await ae.all(n.map(r=>this.signal.request(We.UNPUBLISH_DATASTREAM,{channel_id:r},!0)))}catch(r){O.warning("unpublish datachannels warning: ",r)}}async presubscribe(n,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const c={stream_id:n,stream_type:r,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Y("SUBSCRIBE_TWCC"),rtx:!!Y("USE_SUB_RTX")||void 0,extend:Y("SUB_EXTEND"),svc:Array.isArray(Y("SVC"))&&Y("SVC").length!==0?Y("SVC"):void 0};try{return await this.signal.request(We.PRE_SUBSCRIBE,c,!0)}catch(d){if(s&&d.data&&d.data.code===qe.ERR_SUBSCRIBE_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),d.toString()),this.presubscribe(n,r,!1);throw d}}async subscribe(n,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const c={stream_id:n,stream_type:r.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Y("SUBSCRIBE_TWCC"),rtx:!!Y("USE_SUB_RTX"),extend:Y("SUB_EXTEND"),ssrcId:r.ssrcId,svc:Array.isArray(Y("SVC"))&&Y("SVC").length!==0?Y("SVC"):void 0};try{return(await this.signal.request(We.SUBSCRIBE,c,!0))._message}catch(d){if(s&&d.data&&d.data.code===qe.ERR_SUBSCRIBE_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),d.toString()),await this.tryUnsubBeforeResub(n,r),await this.subscribe(n,r,!1);throw d}}async subscribeDataChannel(n,r,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const c={uid:n,stream_id:r.id,channel_id:r.datachannelId};try{return void await this.signal.request(We.SUBSCRIBE_DATASTREAM,c,!0)}catch(d){if(s&&d.data&&d.data.code===qe.ERR_SUBSCRIBE_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),d.toString()),await this.tryUnsubDataChannelBeforeResub(n,r),await this.subscribeDataChannel(n,r,!1);throw d}}async subscribeAll(n,r){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const s={p2p_id:this.store.p2pId,users:n,dtx:!1,rtx:!!Y("USE_SUB_RTX")};try{return await this.signal.request(We.SUBSCRIBE_STREAMS,s,!0)}catch(c){if(r&&c.data&&c.data.code===qe.ERR_SUBSCRIBE_REQUEST_INVALID)return O.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),c.toString()),await this.tryMassUnsubBeforeResub(n),await this.subscribeAll(n,!1);throw c}}async setVideoProfile(n){const r=function(s){if(!(s.bitrateMax&&s.bitrateMin&&s.frameRate&&s.height&&s.width))return;let c=s.frameRate,d=s.width,h=s.height,f=!0;return typeof c!="number"&&(c=c.exact||c.ideal||c.max||c.min||0,c||(f=!1)),typeof d!="number"&&(d=d.exact||d.ideal||d.max||d.min||0,d||(f=!1)),typeof h!="number"&&(h=h.exact||h.ideal||h.max||h.min||0,c||(f=!1)),f?{stream_type:0,width:d,height:h,fps:c,start_bps:1e3*s.bitrateMax,min_bps:1e3*s.bitrateMin,target_bps:1e3*s.bitrateMax}:void 0}(n);if(r)return this.signal.request(We.SET_VIDEO_PROFILE,r);O.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(n,r){try{await this.signal.request(We.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:n,stream_id:r},!0)}catch(s){O.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),s)}}async unsubscribeDataChannel(n,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await ae.all(n.map(s=>this.signal.request(We.UNSUBSCRIBE_DATASTREAM,{stream_id:s,uid:r},!0)))}catch(s){O.warning("unsubscribeDataChannel warning: ",s)}}async massUnsubscribe(n){try{await this.signal.request(We.UNSUBSCRIBE_STREAMS,n,!0)}catch(r){O.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),r)}}async reconnectPC(n){const{iceParameters:r,dtlsParameters:s,rtpCapabilities:c}=n;return{gatewayEstablishParams:await this.signal.request(We.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:r,dtlsParameters:s,rtpCapabilities:c}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(We.GATEWAY_INFO)}async renewToken(n){await this.signal.request(We.RENEW_TOKEN,n),this.key=n.token}async setClientRole(n,r){if(r&&(this._clientRoleOptions=Object.assign({},r)),this.state!=="CONNECTED")return void(this.role=n);let s,c=0;n==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(s=this._clientRoleOptions.delay,c=1):c=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:c=0,await this.signal.request(We.SET_CLIENT_ROLE,{role:n,level:c,delay:s,client_ts:Date.now()}),this.role=n}async setRemoteVideoStreamType(n,r){await this.signal.request(We.SWITCH_VIDEO_STREAM,{stream_id:n,stream_type:r})}async setDefaultRemoteVideoStreamType(n){await this.signal.request(We.DEFAULT_VIDEO_STREAM,{stream_type:n})}async setStreamFallbackOption(n,r){await this.signal.request(We.SET_FALLBACK_OPTION,{stream_id:n,fallback_type:r})}async pickSVCLayer(n,r){await this.signal.request(We.PICK_SVC_LAYER,{stream_id:n,spatial_layer:r.spatialLayer,temporal_layer:r.temporalLayer})}async setRTM2Flag(n){await this.signal.request(We.SET_RTM2_FLAG,{rtm2_flag:n})}async sendExtensionMessage(n,r,s){if(this.signal instanceof $F)return this.signal.sendExtensionMessage(n,r,s)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),Hs({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(We.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const n=BI.get(this.joinInfo.cname);n&&n.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const n=function(r){let s;return s=r.startsWith("dc")?r.match(/(dc\:\/\/)?([^:]+):(\d+)/):r.match(/(wss\:\/\/)?([^:]+):(\d+)/),s?{username:Pi.username,password:Pi.password,turnServerURL:s[2],tcpport:parseInt(s[3])+30,udpport:parseInt(s[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],n&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(Hs(Hs({},Pi),{},{turnServerURL:n.turnServerURL,tcpport:n.tcpport,udpport:n.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const n=await this.signal.request(We.TRAFFIC_STATS,void 0,!0);n.timestamp=Date.now(),n.ntp_offset!=null&&(this.ntpOffset=n.ntp_offset),n.peer_delay.forEach(r=>{const s=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(c=>c.peer_uid===r.peer_uid);s&&s.B_st!==r.B_st&&Vy(()=>{this.emit(In.STREAM_TYPE_CHANGE,r.peer_uid,r.B_st)})}),this._statsCollector.updateTrafficStats(n)}getJoinMessage(n){if(!this.joinInfo||!this.key)throw new Z(B.UNEXPECTED_ERROR,"can not generate join message, no join info");const r=Object.assign({},this.joinInfo.apResponse);let s=Y("REPORT_APP_SCENARIO");if(typeof s!="string")try{s=JSON.stringify(s)}catch{s=void 0}s&&s.length>128&&(s=void 0);const c=Hs({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:ms,browser:navigator.userAgent,process_id:Y("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:r,extend:Y("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:s,attributes:{userAttributes:{enablePublishedUserList:Y("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:Y("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:typeof Y("SUBSCRIBE_AUDIO_FILTER_TOPN")=="number"?Y("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:typeof Y("ENABLE_PUBLISH_AUDIO_FILTER")=="boolean"?Y("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:typeof Y("ENABLE_USER_LICENSE_CHECK")=="boolean"?Y("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:Y("USE_PUB_RTX")===!0||Y("USE_SUB_RTX")===!0||void 0,disableFEC:Y("DISABLE_FEC"),enableNTPReport:!!Y("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!Y("ENABLE_INSTANT_VIDEO")||void 0,enableDataStream2:typeof Y("ENABLE_DATASTREAM_2")=="boolean"?Y("ENABLE_DATASTREAM_2"):void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!Y("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:typeof Y("USE_XR")=="boolean"?Y("USE_XR"):void 0}},join_ts:this.joinGatewayStartTime},n);return this.joinInfo.stringUid&&(c.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(c.aes_mode=this.joinInfo.aesmode,Y("ENCRYPT_AES")?(c.aes_secret=this.joinInfo.aespassword,c.aes_encrypt=!0):c.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(c.aes_salt=this.joinInfo.aessalt)),r.addresses[this.signal.websocket.currentURLIndex]&&(c.ap_response.ticket=r.addresses[this.signal.websocket.currentURLIndex].ticket,delete r.addresses),this.joinInfo.defaultVideoStream!==void 0&&(c.default_video_stream=this.joinInfo.defaultVideoStream),c}getRejoinMessage(){if(!this.joinInfo)throw new Z(B.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(De.WS_RECONNECT_WAITTING_FINISH,n=>{var r;Le(r=["tryNext","recover"]).call(r,n)&&this.joinInfo&&Be.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(De.WS_RECONNECT_CREATE_CONNECTION,n=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(De.WS_RECONNECTING,n=>{this.joinInfo&&Be.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:n||Or.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",Be.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(De.WS_CLOSED,n=>{let r;switch(n){case vt.LEAVE:r=Or.LEAVE;break;case vt.UID_BANNED:case vt.IP_BANNED:case vt.CHANNEL_BANNED:case vt.SERVER_ERROR:r=Or.SERVER_ERROR;break;case vt.FALLBACK:r=Or.FALLBACK;break;case vt.LICENSE_MISSING:case vt.LICENSE_EXPIRED:case vt.LICENSE_MINUTES_EXCEEDED:case vt.LICENSE_PERIOD_INVALID:case vt.LICENSE_MULTIPLE_SDK_SERVICE:case vt.LICENSE_ILLEGAL:case vt.TOKEN_EXPIRE:r=n;break;default:r=Or.NETWORK_ERROR}O.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(r||"undefined -> "+Or.NETWORK_ERROR)),this.joinInfo&&Be.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:n===vt.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:r}),this._disconnectedReason=n,n!==vt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(De.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(O.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),Be.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof Zc?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1)){const n=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!n)return void O.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(n));qt("EVENT_REPORT_DOMAIN",n[1]),qt("EVENT_REPORT_BACKUP_DOMAIN",n[1]),qt("LOG_UPLOAD_SERVER","".concat(n[1],":6444"))}}),this.signal.on(nt.ON_UPLINK_STATS,n=>{this._statsCollector.updateUplinkStats(n)}),this.signal.on(De.REQUEST_RECOVER,(n,r,s)=>{if(!this.joinInfo)return s(new Z(B.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));n&&(this.joinInfo.multiIP=n,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,nr(this,In.REQUEST_NEW_GATEWAY_LIST).then(r).catch(s)}),this.signal.on(De.REQUEST_JOIN_INFO,async n=>{var r;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void n(this.getJoinMessage({ortc:{}}));const{iceParameters:s,dtlsParameters:c,rtpCapabilities:d}=await nr(this,In.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(r=this.joinInfo)===null||r===void 0?void 0:r.turnServer});n(this.getJoinMessage({ortc:{iceParameters:s,dtlsParameters:c,rtpCapabilities:d,version:"2"}}))}),this.signal.on(De.REQUEST_REJOIN_INFO,n=>{n(this.getRejoinMessage())}),this.signal.on(De.REPORT_JOIN_GATEWAY,(n,r)=>{this.joinInfo&&(Be.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:n,addr:r,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof Zc?"1":"0"}),this._isProactiveJoin=!1)}),this.signal.on(De.IS_P2P_DISCONNECTED,n=>{n(Nu(this,In.IS_P2P_DISCONNECTED))}),this.signal.on(De.DISCONNECT_P2P,()=>{this.emit(In.DISCONNECT_P2P)}),this.signal.on(De.NEED_RENEW_SESSION,()=>{this.emit(In.NEED_RENEW_SESSION)}),this.signal.on(De.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(De.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(De.JOIN_RESPONSE,n=>{const r=this.getCurrentGatewayAddress();this.emit(In.JOIN_RESPONSE,n,r)}),this.signal.on(De.DATACHANNEL_PRECONNECT,async(n,r,s)=>{this.updateTurnConfigFromSignal();const c=this.getCurrentGatewayAddress();return nr(this,In.DATACHANNEL_PRECONNECT,n,c).then(r).catch(s)}),this.signal.on(De.DATACHANNEL_CONNECTING,async n=>{const{iceParameters:r,dtlsParameters:s,rtpCapabilities:c}=await nr(this,In.REQUEST_DC_CONNECTION_PARAMS);n(this.getJoinMessage({ortc:{iceParameters:r,dtlsParameters:s,rtpCapabilities:c,version:"2"}}))}),this.signal.on(De.DATACHANNEL_FAILBACK,()=>{O.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(In.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(n,r){try{await this.signal.request(We.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:n,ortc:[r]},!0)}catch(s){throw O.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),s),s}}async tryUnsubDataChannelBeforeResub(n,r){try{await this.signal.request(We.UNSUBSCRIBE,{stream_id:r.id},!0)}catch(s){throw O.warning("unsubscribe datachannel warning",s),s}}async tryUnpubBeforeRepub(n,r){try{await this.signal.request(We.UNPUBLISH,{stream_id:n,ortc:r},!0)}catch(s){throw O.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),s),s}}async tryUnpubDataChannelBeforeRepub(n,r){try{await this.signal.request(We.UNPUBLISH_DATASTREAM,{channnel_id:r.channelId},!0)}catch(s){throw O.warning("unpublish datastream warning: ",s),s}}async tryMassUnsubBeforeResub(n){const r={users:n.map(s=>({stream_id:s.stream_id,stream_type:s.stream_type}))};try{await this.signal.request(We.UNSUBSCRIBE_STREAMS,r,!0)}catch(s){throw O.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),s),s}}async muteLocal(n,r){const s={action:n.find(c=>c.stream_type===jt.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:n,stream_id:r};try{await this.signal.request(We.CONTROL,s,!0,!0)}catch(c){throw O.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),c),c}}async unmuteLocal(n,r){const s={action:n.find(c=>c.stream_type===jt.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:n,stream_id:r};try{await this.signal.request(We.CONTROL,s,!0,!0)}catch(c){throw O.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),c),c}}async muteRemote(n,r){const s={action:n===Fe.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request(We.CONTROL,s,!0,!0)}catch(c){throw O.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),c),c}}async unmuteRemote(n,r){const s={action:n===Fe.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request(We.CONTROL,s,!0,!0)}catch(c){throw O.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),c),c}}uploadWRTCStats(n){this.signal.uploadWRTCStats(n)}upload(n,r){this.signal.upload(n,r)}getSignalRTT(){return this.signal.rtt}async restartICE(n){const r={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:n};try{return await this.signal.request(We.RESTART_ICE,r,!0)}catch(s){throw O.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),s),s}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,Or.P2P_FAILED)}getCurrentGatewayAddress(){var n;if(!Y("GATEWAY_WSS_ADDRESS"))return(n=this.joinInfo)!==null&&n!==void 0&&n.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(n){await this.signal.request(We.SET_PARAMETER,{enablePublishAudioFilter:n})}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(vt.FALLBACK)),this.store.useDataChannel=!1,this.signal=new MF(Hs(Hs({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(In.RESET_SIGNAL,r0.websocket)}}let c0=0,WI=0;function el(o,n,r,s){return new ae((c,d)=>{n.timeout=n.timeout||Y("HTTP_CONNECT_TIMEOUT"),n.responseType=n.responseType||"json",n.data&&!r?(n.data=JSON.stringify(n.data),c0+=Za(n.data)):r&&(n.data.size?c0+=n.data.size:n.data instanceof FormData?c0+=wj(n.data):c0+=Za(JSON.stringify(n.data))),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json",n.method="POST",n.url=o,Qi.request(n).then(h=>{typeof h.data=="string"?WI+=Za(h.data):h.data instanceof ArrayBuffer||h.data instanceof Uint8Array?WI+=h.data.byteLength:WI+=Za(JSON.stringify(h.data)),s&&c({data:h.data,headers:h.headers}),c(h.data)}).catch(h=>{Qi.isCancel(h)?d(new Z(B.OPERATION_ABORTED,"cancel token canceled")):h.code==="ECONNABORTED"?d(new Z(B.NETWORK_TIMEOUT,h.message)):h.response?d(new Z(B.NETWORK_RESPONSE_ERROR,h.response.status)):d(new Z(B.NETWORK_ERROR,h.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var o;function n(ve){var we=0;return function(){return we<ve.length?{done:!1,value:ve[we++]}:{done:!0}}}var r=typeof Object.defineProperties=="function"?Object.defineProperty:function(ve,we,Ve){return ve==Array.prototype||ve==Object.prototype||(ve[we]=Ve.value),ve},s,c=function(ve){ve=[typeof globalThis=="object"&&globalThis,ve,typeof window=="object"&&window,typeof self=="object"&&self,typeof l=="object"&&l];for(var we=0;we<ve.length;++we){var Ve=ve[we];if(Ve&&Ve.Math==Math)return Ve}throw Error("Cannot find global object")}(this);function d(ve,we){if(we)e:{var Ve=c;ve=ve.split(".");for(var it=0;it<ve.length-1;it++){var Mt=ve[it];if(!(Mt in Ve))break e;Ve=Ve[Mt]}(we=we(it=Ve[ve=ve[ve.length-1]]))!=it&&we!=null&&r(Ve,ve,{configurable:!0,writable:!0,value:we})}}function h(ve){return(ve={next:ve})[Symbol.iterator]=function(){return this},ve}function f(ve){var we=typeof Symbol<"u"&&Symbol.iterator&&ve[Symbol.iterator];return we?we.call(ve):{next:n(ve)}}if(d("Symbol",function(ve){function we(Mt,Ne){this.A=Mt,r(this,"description",{configurable:!0,writable:!0,value:Ne})}if(ve)return ve;we.prototype.toString=function(){return this.A};var Ve="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",it=0;return function Mt(Ne){if(this instanceof Mt)throw new TypeError("Symbol is not a constructor");return new we(Ve+(Ne||"")+"_"+it++,Ne)}}),d("Symbol.iterator",function(ve){if(ve)return ve;ve=Symbol("Symbol.iterator");for(var we="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Ve=0;Ve<we.length;Ve++){var it=c[we[Ve]];typeof it=="function"&&typeof it.prototype[ve]!="function"&&r(it.prototype,ve,{configurable:!0,writable:!0,value:function(){return h(n(this))}})}return ve}),typeof Object.setPrototypeOf=="function")s=Object.setPrototypeOf;else{var g;e:{var _={};try{_.__proto__={a:!0},g=_.a;break e}catch{}g=!1}s=g?function(ve,we){if(ve.__proto__=we,ve.__proto__!==we)throw new TypeError(ve+" is not extensible");return ve}:null}var E=s;function T(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function w(ve){if(ve.m)throw new TypeError("Generator is already running");ve.m=!0}function A(ve,we){return ve.h=3,{value:we}}function L(ve){this.g=new T,this.G=ve}function P(ve,we,Ve,it){try{var Mt=we.call(ve.g.j,Ve);if(!(Mt instanceof Object))throw new TypeError("Iterator result "+Mt+" is not an object");if(!Mt.done)return ve.g.m=!1,Mt;var Ne=Mt.value}catch(k){return ve.g.j=null,ve.g.s(k),D(ve)}return ve.g.j=null,it.call(ve.g,Ne),D(ve)}function D(ve){for(;ve.g.h;)try{var we=ve.G(ve.g);if(we)return ve.g.m=!1,{value:we.value,done:!1}}catch(Ve){ve.g.v=void 0,ve.g.s(Ve)}if(ve.g.m=!1,ve.g.l){if(we=ve.g.l,ve.g.l=null,we.F)throw we.D;return{value:we.return,done:!0}}return{value:void 0,done:!0}}function G(ve){this.next=function(we){return ve.o(we)},this.throw=function(we){return ve.s(we)},this.return=function(we){return function(Ve,it){w(Ve.g);var Mt=Ve.g.j;return Mt?P(Ve,"return"in Mt?Mt.return:function(Ne){return{value:Ne,done:!0}},it,Ve.g.return):(Ve.g.return(it),D(Ve))}(ve,we)},this[Symbol.iterator]=function(){return this}}function $(ve,we){return we=new G(new L(we)),E&&ve.prototype&&E(we,ve.prototype),we}if(T.prototype.o=function(ve){this.v=ve},T.prototype.s=function(ve){this.l={D:ve,F:!0},this.h=this.C||this.u},T.prototype.return=function(ve){this.l={return:ve},this.h=this.u},L.prototype.o=function(ve){return w(this.g),this.g.j?P(this,this.g.j.next,ve,this.g.o):(this.g.o(ve),D(this))},L.prototype.s=function(ve){return w(this.g),this.g.j?P(this,this.g.j.throw,ve,this.g.o):(this.g.s(ve),D(this))},d("Array.prototype.entries",function(ve){return ve||function(){return function(we,Ve){we instanceof String&&(we+="");var it=0,Mt=!1,Ne={next:function(){if(!Mt&&it<we.length){var k=it++;return{value:Ve(k,we[k]),done:!1}}return Mt=!0,{done:!0,value:void 0}}};return Ne[Symbol.iterator]=function(){return Ne},Ne}(this,function(we,Ve){return[we,Ve]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var X=function(ve,we){for(var Ve=0;Ve<ve.length;Ve++)we(ve[Ve])},ie=function(ve){return ve.replace(/\r?\n|\r/g,`\r
`)},Q=function(ve,we,Ve){return we instanceof Blob?(Ve=Ve!==void 0?Ve+"":typeof we.name=="string"?we.name:"blob",we.name===Ve&&Object.prototype.toString.call(we)!=="[object Blob]"||(we=new File([we],Ve)),[String(ve),we]):[String(ve),String(we)]},te=function(ve,we){if(ve.length<we)throw new TypeError(we+" argument required, but only "+ve.length+" present.")},ce=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,le=ce.FormData,Se=ce.XMLHttpRequest&&ce.XMLHttpRequest.prototype.send,Ae=ce.Request&&ce.fetch,st=ce.navigator&&ce.navigator.sendBeacon,gt=ce.Element&&ce.Element.prototype,nn=ce.Symbol&&Symbol.toStringTag;nn&&(Blob.prototype[nn]||(Blob.prototype[nn]="Blob"),"File"in ce&&!File.prototype[nn]&&(File.prototype[nn]="File"));try{new File([],"")}catch{ce.File=function(we,Ve,it){return we=new Blob(we,it||{}),Object.defineProperties(we,{name:{value:Ve},lastModified:{value:+(it&&it.lastModified!==void 0?new Date(it.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),nn&&Object.defineProperty(we,nn,{value:"File"}),we}}var dr=function(ve){return ve.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},un=function(ve){this.i=[];var we=this;ve&&X(ve.elements,function(Ve){if(Ve.name&&!Ve.disabled&&Ve.type!=="submit"&&Ve.type!=="button"&&!Ve.matches("form fieldset[disabled] *"))if(Ve.type==="file"){var it=Ve.files&&Ve.files.length?Ve.files:[new File([],"",{type:"application/octet-stream"})];X(it,function(Mt){we.append(Ve.name,Mt)})}else Ve.type==="select-multiple"||Ve.type==="select-one"?X(Ve.options,function(Mt){!Mt.disabled&&Mt.selected&&we.append(Ve.name,Mt.value)}):Ve.type==="checkbox"||Ve.type==="radio"?Ve.checked&&we.append(Ve.name,Ve.value):(it=Ve.type==="textarea"?ie(Ve.value):Ve.value,we.append(Ve.name,it))})};if((o=un.prototype).append=function(ve,we,Ve){te(arguments,2),this.i.push(Q(ve,we,Ve))},o.delete=function(ve){te(arguments,1);var we=[];ve=String(ve),X(this.i,function(Ve){Ve[0]!==ve&&we.push(Ve)}),this.i=we},o.entries=function ve(){var we,Ve=this;return $(ve,function(it){if(it.h==1&&(we=0),it.h!=3)return we<Ve.i.length?it=A(it,Ve.i[we]):(it.h=0,it=void 0),it;we++,it.h=2})},o.forEach=function(ve,we){te(arguments,1);for(var Ve=f(this),it=Ve.next();!it.done;it=Ve.next()){var Mt=f(it.value);it=Mt.next().value,Mt=Mt.next().value,ve.call(we,Mt,it,this)}},o.get=function(ve){te(arguments,1);var we=this.i;ve=String(ve);for(var Ve=0;Ve<we.length;Ve++)if(we[Ve][0]===ve)return we[Ve][1];return null},o.getAll=function(ve){te(arguments,1);var we=[];return ve=String(ve),X(this.i,function(Ve){Ve[0]===ve&&we.push(Ve[1])}),we},o.has=function(ve){te(arguments,1),ve=String(ve);for(var we=0;we<this.i.length;we++)if(this.i[we][0]===ve)return!0;return!1},o.keys=function ve(){var we,Ve,it,Mt,Ne=this;return $(ve,function(k){if(k.h==1&&(we=f(Ne),Ve=we.next()),k.h!=3)return Ve.done?void(k.h=0):(it=Ve.value,Mt=f(it),A(k,Mt.next().value));Ve=we.next(),k.h=2})},o.set=function(ve,we,Ve){te(arguments,2),ve=String(ve);var it=[],Mt=Q(ve,we,Ve),Ne=!0;X(this.i,function(k){k[0]===ve?Ne&&(Ne=!it.push(Mt)):it.push(k)}),Ne&&it.push(Mt),this.i=it},o.values=function ve(){var we,Ve,it,Mt,Ne=this;return $(ve,function(k){if(k.h==1&&(we=f(Ne),Ve=we.next()),k.h!=3)return Ve.done?void(k.h=0):(it=Ve.value,(Mt=f(it)).next(),A(k,Mt.next().value));Ve=we.next(),k.h=2})},un.prototype._asNative=function(){for(var ve=new le,we=f(this),Ve=we.next();!Ve.done;Ve=we.next()){var it=f(Ve.value);Ve=it.next().value,it=it.next().value,ve.append(Ve,it)}return ve},un.prototype._blob=function(){var ve="----formdata-polyfill-"+Math.random(),we=[],Ve="--"+ve+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(it,Mt){return typeof it=="string"?we.push(Ve+dr(ie(Mt))+`"\r
\r
`+ie(it)+`\r
`):we.push(Ve+dr(ie(Mt))+'"; filename="'+dr(it.name)+`"\r
Content-Type: `+(it.type||"application/octet-stream")+`\r
\r
`,it,`\r
`)}),we.push("--"+ve+"--"),new Blob(we,{type:"multipart/form-data; boundary="+ve})},un.prototype[Symbol.iterator]=function(){return this.entries()},un.prototype.toString=function(){return"[object FormData]"},gt&&!gt.matches&&(gt.matches=gt.matchesSelector||gt.mozMatchesSelector||gt.msMatchesSelector||gt.oMatchesSelector||gt.webkitMatchesSelector||function(ve){for(var we=(ve=(this.document||this.ownerDocument).querySelectorAll(ve)).length;0<=--we&&ve.item(we)!==this;);return-1<we}),nn&&(un.prototype[nn]="FormData"),Se){var Ro=ce.XMLHttpRequest.prototype.setRequestHeader;ce.XMLHttpRequest.prototype.setRequestHeader=function(ve,we){Ro.call(this,ve,we),ve.toLowerCase()==="content-type"&&(this.B=!0)},ce.XMLHttpRequest.prototype.send=function(ve){ve instanceof un?(ve=ve._blob(),this.B||this.setRequestHeader("Content-Type",ve.type),Se.call(this,ve)):Se.call(this,ve)}}Ae&&(ce.fetch=function(ve,we){return we&&we.body&&we.body instanceof un&&(we.body=we.body._blob()),Ae.call(this,ve,we)}),st&&(ce.navigator.sendBeacon=function(ve,we){return we instanceof un&&(we=we._asNative()),st.call(this,ve,we)}),ce.FormData=un}})();const l0=()=>{const o=Y("AREAS");return o.length===0&&o.push(Ot.GLOBAL),qc(o).call(o,(n,r,s)=>{const c=YF(r);return c?s===0?c:"".concat(n,",").concat(c):n},"")},YF=o=>o===Ot.OVERSEA?"".concat(Vr.ASIA,",").concat(Vr.EUROPE,",").concat(Vr.AFRICA,",").concat(Vr.NORTH_AMERICA,",").concat(Vr.SOUTH_AMERICA,",").concat(Vr.OCEANIA):Vr[o],$ie=o=>{const n={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return o.map(r=>{const s=i0[r],c=Object.keys(s);c&&c.map(d=>{d!=="CODE"&&(n[d]=n[d].concat(s[d]))})}),n},d0={GLOBAL:{ASIA:[Ot.CHINA,Ot.JAPAN,Ot.INDIA,Ot.KOREA,Ot.HKMC],EUROPE:[],NORTH_AMERICA:[Ot.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},u0=Object.keys(d0[Ot.GLOBAL]),zI=[Ot.CHINA,Ot.NORTH_AMERICA,Ot.EUROPE,Ot.ASIA,Ot.JAPAN,Ot.INDIA,Ot.OCEANIA,Ot.SOUTH_AMERICA,Ot.AFRICA,Ot.KOREA,Ot.HKMC,Ot.US],Kie=function(o,n){let r=[];if(Le(o).call(o,Ot.GLOBAL)){const d=[Ot.GLOBAL,Ot.OVERSEA],h=Object.keys(i0);if(n===Ot.GLOBAL)throw new Z(B.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(n===Ot.CHINA)r=[Ot.OVERSEA];else if(c=n,Le(u0).call(u0,c)){const f=(s=n,d0[Ot.GLOBAL][s]||[]),g=[...d,n,...f];r=h.filter(_=>!Le(g).call(g,_))}else if(function(f){let g=!1;return u0.forEach(_=>{var E;Le(E=d0[Ot.GLOBAL][_]).call(E,f)&&(g=!0)}),g}(n)){const f=function(_){let E;return u0.forEach(T=>{var w;Le(w=d0[Ot.GLOBAL][T]).call(w,_)&&(E=T)}),E}(n),g=[...d,f,n];r=h.filter(_=>!Le(g).call(g,_))}else r=o;r=function(f){const g=[];return zI.forEach(_=>{Le(f).call(f,_)&&g.push(_)}),g.concat(f.filter(_=>!Le(zI).call(zI,_)))}(r)}else r=o;var s,c;return r};function qF(o){var n,r;if(!o&&Le(n=Y("AREAS")).call(n,Ot.EXTENSIONS))return O.debug("update area from ap : reset"),void GI(pie,!0);if(!Le(r=Y("AREAS")).call(r,Ot.GLOBAL)||!o)return;let s=i0.EXTENSIONS;s&&(s={CODE:YF(Ot.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(o,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(o,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(o,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(o,".agora.io"),"cds-ap-web-2-".concat(o,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(o,".agora.io"),"sua-ap-web-2-".concat(o,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(o,".agora.io"),"uap-ap-web-2-".concat(o,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(o,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(o,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(o,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(o,".agora.io")]},O.debug("update area from ap success: ".concat(o,",config is "),s),qt("AREAS",[Ot.EXTENSIONS],!0),Object.keys(s).map(c=>{c==="LOG_UPLOAD_SERVER"||c==="EVENT_REPORT_DOMAIN"||c==="EVENT_REPORT_BACKUP_DOMAIN"||c==="PROXY_SERVER_TYPE3"?qt(c,s[c][0]):qt(c,s[c])}))}function GI(o){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=Be.reportApiInvoke(null,{name:tr.SET_AREA,options:o,tag:yn.TRACER});try{let s=[];if(typeof o=="string"&&(s=[o]),Array.isArray(o)&&(o.forEach(d=>{if(!Le(wF).call(wF,d))throw new Z(B.INVALID_PARAMS,"invalid area code")}),s=o),Object.prototype.toString.call(o)==="[object Object]"){const{areaCode:d,excludedArea:h}=o;if(!d)throw new Z(B.INVALID_PARAMS,"area code is needed");let f=d;typeof d=="string"&&(f=[d]),s=h?Kie(f,h):f}if(!n){if(td.AREAS){const d=new Z(B.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return r.onError(d),void O.warning("setArea is prohibited because of config-distribute")}if(Le(s).call(s,Ot.GLOBAL)&&Y("AREAS")===Ot.EXTENSIONS){const d=new Z(B.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return r.onError(d),void O.warning("setArea is prohibited because of ap extensions")}}qt("AREAS",s,n);const c=$ie(s);Object.keys(c).map(d=>{d==="LOG_UPLOAD_SERVER"||d==="EVENT_REPORT_DOMAIN"||d==="EVENT_REPORT_BACKUP_DOMAIN"||d==="PROXY_SERVER_TYPE3"?qt(d,c[d][0]):qt(d,c[d])}),O.debug("set area success:",s.join(","))}catch(s){throw r.onError(s),s}r.onSuccess()}function JF(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function HI(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?JF(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):JF(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}let $I=1;function Yie(o,n,r,s,c){$I+=1;const d={sid:r.sid,command:"convergeAllocateEdge",uid:"666",appId:r.appId,ts:Math.floor(Date.now()/1e3),seq:$I,requestId:$I,version:ms,cname:r.cname},h={service_name:n,json_body:JSON.stringify(d)};let f,g,_=o[0];return Ra(async()=>{f=Date.now();const E=await el(_,{data:h,cancelToken:s,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(g=Date.now()-f,E.code!==0){const A=new Z(B.UNEXPECTED_RESPONSE,"live streaming ap error, code"+E.code,{retry:!0,responseTime:g});throw O.error(A.toString()),A}const T=JSON.parse(E.json_body);if(T.code!==200){const A=new Z(B.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(T.code,", reason: ").concat(T.reason),{code:T.code,responseTime:g});throw O.error(A.toString()),A}if(!T.servers||T.servers.length===0){const A=new Z(B.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:T.code,responseTime:g});throw O.error(A.toString()),A}const w=function(A,L){return{addressList:A.servers.map(P=>"wss://".concat(P.address.replace(/\./g,"-"),".").concat(Y("WORKER_DOMAIN"),":").concat(P.wss,"?serviceName=").concat(encodeURIComponent(L))),workerToken:A.workerToken,vid:A.vid}}(T,n);return Y("LIVE_STREAMING_ADDRESS")&&(w.addressList=Y("LIVE_STREAMING_ADDRESS")instanceof Array?Y("LIVE_STREAMING_ADDRESS"):[Y("LIVE_STREAMING_ADDRESS")]),HI(HI({},w),{},{responseTime:g})},(E,T)=>(Be.apworkerEvent(r.sid,{success:!0,sc:200,serviceName:n,responseDetail:JSON.stringify(E.addressList),firstSuccess:T===0,responseTime:g,serverIp:o[T%o.length]}),!1),(E,T)=>(Be.apworkerEvent(r.sid,{success:!1,sc:E.data&&E.data.code||200,serviceName:n,responseTime:g,serverIp:o[T%o.length]}),!!(E.code!==B.OPERATION_ABORTED&&E.code!==B.UNEXPECTED_RESPONSE||E.data&&E.data.retry)&&(_=o[(T+1)%o.length],!0)),c)}let KI=1;function XF(o,n,r,s){let{url:c,areaCode:d}=o;const h=Date.now();let f;const[g,_]=tV(n,d,[kr.CHOOSE_SERVER]);let E=rr.networkState;return Ra(async()=>{E&&rr.networkState===bi.OFFLINE&&rr.onlineWaiter&&await ae.race([rr.onlineWaiter,Nr(s&&s.maxRetryTimeout||ir.maxRetryTimeout)]),E=rr.networkState;const{data:T,headers:w}=await el(c,{data:g,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);f=w.http3==="1"?1:-1,Be.reportResourceTiming(c,n.sid),ZF(T,c,n,h,[kr.CHOOSE_SERVER],f);const A=FI(T,kr.CHOOSE_SERVER);return eV(A),BF(A,c)},T=>(T&&Be.joinChooseServer(n.sid,{lts:h,succ:!0,csAddr:c,opid:_,serverList:T.gatewayAddrs.map(w=>w.address),ec:null,cid:T.cid.toString(),uid:T.uid.toString(),csIp:T.csIp,unilbsServerIds:[kr.CHOOSE_SERVER].toString(),isHttp3:f}),!1),T=>T.code!==B.OPERATION_ABORTED&&(T.code===B.CAN_NOT_GET_GATEWAY_SERVER?T.data.retry:(Be.joinChooseServer(n.sid,{lts:h,succ:!1,csAddr:c,serverList:null,opid:_,ec:T.code,csIp:T.data&&T.data.csIp,unilbsServerIds:[kr.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:E}),isHttp3:f}),O.warning("[".concat(n.clientId,"] Choose server network error, retry"),T),!0)),s)}function QF(o,n,r,s){let c,{url:d,areaCode:h,serviceIds:f}=o;const g=Date.now(),[_,E]=tV(n,h,f);let T;return Ra(async()=>{T&&rr.networkState===bi.OFFLINE&&rr.onlineWaiter&&await ae.race([rr.onlineWaiter,Nr(s&&s.maxRetryTimeout||ir.maxRetryTimeout)]),T=rr.networkState;const{data:w,headers:A}=await el(d,{data:_,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);c=A.http3==="1"?1:-1,Be.reportResourceTiming(d,n.sid),ZF(w,d,n,g,f,c);const L=FI(w,kr.CHOOSE_SERVER),P=FI(w,n.cloudProxyServer==="proxy5"?kr.CLOUD_PROXY_5:n.cloudProxyServer==="proxy3"||n.cloudProxyServer==="proxy4"?kr.CLOUD_PROXY:kr.CLOUD_PROXY_FALLBACK);return eV(L),{gatewayInfo:BF(L,d),proxyInfo:P,url:d}},w=>(w.gatewayInfo&&Be.joinChooseServer(n.sid,{lts:g,succ:!0,csAddr:d,serverList:w.gatewayInfo.gatewayAddrs.map(A=>A.address),ec:null,opid:E,cid:w.gatewayInfo.cid.toString(),uid:w.gatewayInfo.uid.toString(),csIp:w.gatewayInfo.csIp,unilbsServerIds:f.toString(),isHttp3:c}),w.proxyInfo&&Be.joinWebProxyAP(n.sid,{lts:g,sucess:1,apServerAddr:d,turnServerAddrList:w.proxyInfo.addresses.map(A=>A.ip).join(","),errorCode:null,eventType:n.cloudProxyServer,unilbsServerIds:f.toString()}),!1),w=>w.code!==B.OPERATION_ABORTED&&(w.code===B.CAN_NOT_GET_GATEWAY_SERVER?w.data.retry:(Be.joinWebProxyAP(n.sid,{lts:g,sucess:0,apServerAddr:d,turnServerAddrList:null,errorCode:w.code,eventType:n.cloudProxyServer,unilbsServerIds:f.toString(),extend:JSON.stringify({networkState:T})}),O.warning("[".concat(n.clientId,"] multi unilbs network error, retry"),w),!0)),s)}const ZF=(o,n,r,s,c,d)=>{const h=[],f=g=>{g.flag===4096?Be.joinChooseServer(r.sid,{lts:s,succ:!1,csAddr:n,opid:o.opid,serverList:null,ec:g.error.message,csIp:g.error.data&&g.error.data.csIp,unilbsServerIds:c.toString(),isHttp3:d}):g.flag!==1048576&&g.flag!==4194304&&g.flag!==4194310||Be.joinWebProxyAP(r.sid,{lts:s,sucess:0,apServerAddr:n,turnServerAddrList:null,errorCode:g.error.code,eventType:r.cloudProxyServer,unilbsServerIds:c.toString()})};if(o.response_body.forEach(g=>{const _=g.buffer.code;if(g.uri===23&&_===0&&!g.buffer.edges_services)if(g.buffer.flag===4194310)O.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),g.buffer.edges_services=[];else{const E={error:new Z(B.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:o.detail[502]}),flag:g.buffer.flag};h.push(E),f(E)}if(_!==0){const E=s0(_),T={error:new Z(B.CAN_NOT_GET_GATEWAY_SERVER,E.desc,{desc:E.desc,retry:E.retry,csIp:o.detail[502]}),flag:g.buffer.flag};g.buffer.flag===4194310?O.warning(T.error.toString()):h.push(T),f(T)}}),h.length)throw O.warning("[".concat(r.clientId,"] multi unilbs ").concat(n," failed, ").concat(h.map(g=>"flag: ".concat(g.flag,", message: ").concat(g.error.message,", retry: ").concat(g.error.data.retry)).join(" | "))),new Z(B.CAN_NOT_GET_GATEWAY_SERVER,h.map(g=>"flag: ".concat(g.flag,", message: ").concat(g.error.message)).join(" | "),{retry:!!h.find(g=>g.error.data.retry),csIp:o.detail[502],desc:[...new Set(h.map(g=>{var _;return g==null||(_=g.error)===null||_===void 0||(_=_.data)===null||_===void 0?void 0:_.desc}).filter(g=>!!g))]})},eV=o=>{var n,r,s,c;if(o.addresses&&o.addresses.length===0&&o.code===0)throw new Z(B.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:o.detail&&o.detail[502]});if(Y("AP_AREA")&&((s=o.detail)!==null&&s!==void 0&&s[23]&&typeof((c=o.detail)===null||c===void 0?void 0:c[23])=="string"?qF(o.detail[23].toLowerCase()):qF()),(n=o.detail)!==null&&n!==void 0&&n[19]&&typeof((r=o.detail)===null||r===void 0?void 0:r[19])=="string"){const h=o.detail[19],f=h==null?void 0:h.split(";");for(let g=0;g<f.length;g++){var d;const _=jI(d=f[g]).call(d);o.addresses[g]&&f&&(o.addresses[g].fingerprint=_)}}if(Y("GATEWAY_ADDRESS")&&Y("GATEWAY_ADDRESS").length>0){O.debug("assign gateway address to",Y("GATEWAY_ADDRESS"));const h=Y("GATEWAY_ADDRESS").map(f=>{var g,_;const E=(g=(_=o.addresses.find(T=>T.ip===f.ip&&T.port===f.port))===null||_===void 0?void 0:_.fingerprint)!==null&&g!==void 0?g:"";return{ip:f.ip,port:f.port,ticket:o.addresses[0]&&o.addresses[0].ticket,fingerprint:E}});o.addresses=h}},qie=(o,n)=>{if(o.response_body&&o.response_body.length){const r=o.response_body[0];if(r.buffer.code!==0){const s=s0(r.buffer.code);throw new Z(B.UPDATE_TICKET_FAILED,"[".concat(r.buffer.code,"]: ").concat(s.desc),{retry:s.retry})}return r.buffer.ticket}throw O.debug("update ticket request received ap response without response body:",n),new Z(B.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},tV=(o,n,r)=>{const s=Math.floor(Math.random()*1e12),c={appid:o.appId,client_ts:Date.now(),opid:s,sid:o.sid,request_bodies:[{uri:22,buffer:{cname:o.cname,detail:HI({6:o.stringUid,11:n,12:Y("USE_NEW_TOKEN")?"1":void 0,22:n},o.apRTM?{26:"RTM2"}:{}),key:o.token,service_ids:r,uid:o.uid||0}}]};c.request_bodies.forEach(h=>{o.multiIP&&o.multiIP.gateway_ip&&(h.buffer.detail[5]=JSON.stringify({vocs_ip:[o.multiIP.uni_lbs_ip],vos_ip:[o.multiIP.gateway_ip]}))});const d=new FormData;return d.append("request",JSON.stringify(c)),[d,s]},Jie=(o,n)=>{const r=Math.floor(Math.random()*1e12),s={appid:o.appId,client_ts:Date.now(),opid:r,sid:o.sid,request_bodies:[{uri:28,buffer:{cname:o.cname,detail:{1:"",6:o.stringUid,12:"1"},token:o.token,service_ids:n,uid:o.uid||0,edges_services:o.apResponse.addresses.map(d=>({ip:d.ip,port:d.port}))}}]},c=new FormData;return c.append("request",JSON.stringify(s)),[c,r]};let Pp=0;function kp(o){return ae.all(o.map(n=>n.then(r=>{throw r},r=>r))).then(n=>{throw n},n=>n)}const Pg=async o=>{let{fragementLength:n,referenceList:r,asyncMapHandler:s,allFailedhandler:c,promisesCollector:d}=o,h=0;const f=n;let g,_=0;const E=async()=>{const T=(()=>{const w=h*f,A=w+f;return r.slice(w,A).map(s)})();d&&d.push(...T);try{g=await kp(T)}catch(w){if(_+=f,h++,!(_>=r.length))return void await E();c(w)}T.forEach(w=>w.cancel())};return await E(),g};async function YI(o,n,r,s){return{gatewayInfo:await async function(d,h,f,g){let _=null;const E=[],T=async()=>{const A=Y("WEBCS_DOMAIN").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map(D=>({url:d.proxyServer?"https://".concat(d.proxyServer,"/ap/?url=").concat(D+"/api/v2/transpond/webrtc?v=2"):"https://".concat(D,"/api/v2/transpond/webrtc?v=2"),areaCode:l0()})),L=g.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:A.map(D=>D.url)}),P=await Pg({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:A,asyncMapHandler:D=>(O.debug("[".concat(d.clientId,"] Connect to choose_server:"),D.url),XF(D,d,h,f)),allFailedhandler:D=>{throw g.recordJoinChannelService({endTs:Date.now(),status:"error",errors:D},L),D[0]},promisesCollector:E});return g.recordJoinChannelService({endTs:Date.now(),status:"success"},L),P},w=async()=>{if(await Nr(1e3),_!==null)return _;const A=Y("WEBCS_DOMAIN_BACKUP_LIST").map(D=>({url:d.proxyServer?"https://".concat(d.proxyServer,"/ap/?url=").concat(D+"/api/v2/transpond/webrtc?v=2"):"https://".concat(D,"/api/v2/transpond/webrtc?v=2"),areaCode:l0()})),L=g.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:A.map(D=>D.url)}),P=await Pg({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:A,asyncMapHandler:D=>(O.debug("[".concat(d.clientId,"] Connect to backup choose_server:"),D.url),XF(D,d,h,f)),allFailedhandler:D=>{throw g.recordJoinChannelService({endTs:Date.now(),status:"error",errors:D},L),D[0]},promisesCollector:E});return g.recordJoinChannelService({endTs:Date.now(),status:"success"},L),P};try{return _=await kp([T(),w()]),E.length&&E.forEach(A=>A.cancel&&typeof A.cancel=="function"&&A.cancel()),_}catch(A){throw A[0]}}(o,n,r,s)}}async function nV(o,n,r,s,c){const d=o.cloudProxyServer;if(d==="disabled"){if(o.useLocalAccessPoint)return await YI(o,n,r,c);if(Y("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:w,proxyInfo:A}=await iV(o,n,r,c);if(o.turnServer&&o.turnServer.mode!=="auto")return{gatewayInfo:w};const L=A.map(P=>({turnServerURL:P.address,tcpport:P.tcpport||Pi.tcpport,udpport:P.udpport||Pi.udpport,username:P.username||Pi.username,password:P.password||Pi.password,forceturn:!1,security:!0}));if(c.useP2P){var h;const P=(h=o.uid)!==null&&h!==void 0?h:w.uid,D="glb:".concat(P.toString()),G=await eI(D),$=A.map(X=>({turnServerURL:X.address,tcpport:X.tcpport||Pi.tcpport,udpport:X.udpport||Pi.udpport,username:D,password:G,forceturn:!1,security:!0}));L.push(...$)}return o.turnServer={mode:"manual",servers:L},{gatewayInfo:w}}return await YI(o,n,r,c)}const{proxyInfo:f,gatewayInfo:g}=await iV(o,n,r,c),_={gatewayInfo:g},E=f.map(w=>({turnServerURL:w.address,tcpport:d==="proxy3"?void 0:w.tcpport?w.tcpport:Pi.tcpport,udpport:d==="proxy4"?void 0:w.udpport?w.udpport:Pi.udpport,username:w.username||Pi.username,password:w.password||Pi.password,forceturn:d!=="proxy4",security:d==="proxy5"}));if(c.useP2P){var T;const w=(T=o.uid)!==null&&T!==void 0?T:g.uid,A="glb:".concat(w.toString()),L=await eI(A),P=f.map(D=>({turnServerURL:D.address,tcpport:d==="proxy3"?void 0:D.tcpport||Pi.tcpport,udpport:d==="proxy4"?void 0:D.udpport||Pi.udpport,username:A,password:L,forceturn:d!=="proxy4",security:d==="proxy5"}));E.push(...P)}return o.turnServer={mode:"manual",servers:E},O.debug("[".concat(o.clientId,"] set proxy server: ").concat(o.proxyServer,", mode: ").concat(d)),_}async function rV(o,n,r,s,c){const d=Y("ACCOUNT_REGISTER").slice(0,Y("AJAX_REQUEST_CONCURRENT"));let h=[];h=n.proxyServer?d.map(g=>"https://".concat(n.proxyServer,"/ap/?url=").concat(g+"/api/v1")):d.map(g=>"https://".concat(g,"/api/v1"));const f=c==null?void 0:c.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:h});try{const g=await async function(_,E,T,w,A){const L=Date.now(),P={sid:T.sid,opid:10,appid:T.appId,string_uid:E};let D=_[0];const G=await Ra(()=>el(D+"".concat(D.indexOf("?")===-1?"?":"&","action=stringuid"),{data:P,cancelToken:w,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),($,X)=>{if($.code===0){if($.uid<=0||$.uid>=Math.pow(2,32))throw O.error("Invalid Uint Uid ".concat(E," => ").concat($.uid),$),Be.reqUserAccount(P.sid,{lts:L,success:!1,serverAddr:D,stringUid:P.string_uid,uid:$.uid,errorCode:B.INVALID_UINT_UID_FROM_STRING_UID,extend:P}),new Z(B.INVALID_UINT_UID_FROM_STRING_UID);return Be.reqUserAccount(P.sid,{lts:L,success:!0,serverAddr:D,stringUid:P.string_uid,uid:$.uid,errorCode:null,extend:P}),!1}const ie=s0($.code);return ie.retry&&(D=_[(X+1)%_.length]),Be.reqUserAccount(P.sid,{lts:L,success:!1,serverAddr:D,stringUid:P.string_uid,uid:$.uid,errorCode:ie.desc,extend:P}),ie.retry},($,X)=>$.code!==B.OPERATION_ABORTED&&(Be.reqUserAccount(P.sid,{lts:L,success:!1,serverAddr:D,stringUid:P.string_uid,uid:null,errorCode:$.code,extend:P}),D=_[(X+1)%_.length],!0),A);if(G.code!==0){const $=s0(G.code);throw new Z(B.UNEXPECTED_RESPONSE,$.desc)}return G}(h,o,n,r,s);return c==null||c.recordJoinChannelService({status:"success",endTs:Date.now()},f),g.uid}catch(g){throw c==null||c.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[g]},f),g}}async function Xie(o,n,r){const s=Y("CDS_AP").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map(g=>o.proxyServer?"https://".concat(o.proxyServer,"/ap/?url=").concat(g+"/api/v1"):"https://".concat(g,"/api/v1?action=config")),c=s.map(g=>function(_,E,T,w){const A=xt(),L={flag:64,cipher_method:0,features:{device:A.name,system:A.os,system_general:navigator.userAgent,vendor:E.appId,version:ms,cname:E.cname,sid:E.sid,session_id:E.sid,detail:"",proxyServer:E.proxyServer}};return Ra(()=>el(_,{data:L,timeout:1e3,cancelToken:T,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,P=>P.code!==B.OPERATION_ABORTED,w)}(g,o,n,r));let d=null,h=null,f={};try{d=await kp(c)}catch(g){if(g.code===B.OPERATION_ABORTED)throw g;h=g}if(c.forEach(g=>g.cancel()),Be.reportApiInvoke(o.sid,{name:tr.REQUEST_CONFIG_DISTRIBUTE,options:{error:h,res:d}}).onSuccess(),d&&d.test_tags)try{f=function(g){if(!g.test_tags)return{};const _=g.test_tags,E=Object.keys(_),T={};return E.forEach(w=>{var A;const L=jI(A=w.slice(4)).call(A),P=JSON.parse(_[w])[1];T[L]=P}),T}(d)}catch{}return f}async function iV(o,n,r,s){const c=Y("PROXY_SERVER_TYPE3"),d=(A,L,P)=>{let D=P||c;return Array.isArray(D)&&(D=L%2==0?c[1]:c[0]),"https://".concat(D,"/ap/?url=").concat(A)};let h=null;const f=[],g=async()=>{const A=Y("WEBCS_DOMAIN").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map((D,G)=>{let $;return $=o.cloudProxyServer==="disabled"&&o.proxyServer?d("".concat(D,"/api/v2/transpond/webrtc?v=2"),G,o.proxyServer):o.cloudProxyServer==="disabled"||o.cloudProxyServer==="fallback"?"https://".concat(D,"/api/v2/transpond/webrtc?v=2"):d("".concat(D,"/api/v2/transpond/webrtc?v=2"),G),{url:$,areaCode:l0(),serviceIds:[kr.CHOOSE_SERVER,o.cloudProxyServer==="proxy5"?kr.CLOUD_PROXY_5:o.cloudProxyServer==="proxy3"||o.cloudProxyServer==="proxy4"?kr.CLOUD_PROXY:kr.CLOUD_PROXY_FALLBACK]}}),L=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:A.map(D=>D.url)}),P=await Pg({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:A,asyncMapHandler:D=>(O.debug("[".concat(o.clientId,"] Connect to choose_server:"),D.url),QF(D,o,n,r)),allFailedhandler:D=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:D},L),D[0]},promisesCollector:f});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},L),P},_=async()=>{if(await Nr(1e3),h!==null)return h;const A=Y("WEBCS_DOMAIN_BACKUP_LIST").map((D,G)=>{let $;return $=o.cloudProxyServer==="disabled"&&o.proxyServer?d("".concat(D,"/api/v2/transpond/webrtc?v=2"),G,o.proxyServer):o.cloudProxyServer==="disabled"||o.cloudProxyServer==="fallback"?"https://".concat(D,"/api/v2/transpond/webrtc?v=2"):d("".concat(D,"/api/v2/transpond/webrtc?v=2"),G),{url:$,areaCode:l0(),serviceIds:[kr.CHOOSE_SERVER,o.cloudProxyServer==="proxy5"?kr.CLOUD_PROXY_5:o.cloudProxyServer==="proxy3"||o.cloudProxyServer==="proxy4"?kr.CLOUD_PROXY:kr.CLOUD_PROXY_FALLBACK]}}),L=s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:A.map(D=>D.url)}),P=await Pg({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:A,asyncMapHandler:D=>(O.debug("[".concat(o.clientId,"] Connect to backup choose_server:"),D.url),QF(D,o,n,r)),allFailedhandler:D=>{throw s.recordJoinChannelService({endTs:Date.now(),status:"error",errors:D},L),D[0]},promisesCollector:f});return s.recordJoinChannelService({endTs:Date.now(),status:"success"},L),P};let E,T,w;try{({gatewayInfo:E,proxyInfo:T,url:w}=await kp([g(),_()]))}catch(A){throw A[0]}if(f.length&&f.forEach(A=>A.cancel&&typeof A.cancel=="function"&&A.cancel()),!E||!T)throw new Z(B.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(o.apUrl=w,o.cloudProxyServer!=="disabled"&&Array.isArray(c)&&w){const A=/^https?:\/\/(.+?)(\/.*)?$/.exec(w)[1];Le(c).call(c,A)&&(o.proxyServer=A,O.setProxyServer(A),Be.setProxyServer(A))}return h={gatewayInfo:E,proxyInfo:await Wie(T,E.uid)},h}async function oV(o,n,r,s){const c=Y("UAP_AP").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map(d=>n.proxyServer?"https://".concat(n.proxyServer,"/ap/?url=").concat(d+"/api/v1?action=uap"):"https://".concat(d,"/api/v1?action=uap"));return await Yie(c,o,n,r,s)}async function Qie(o,n,r){const s=Y("UAP_AP").slice(0,Y("AJAX_REQUEST_CONCURRENT")).map(d=>o.proxyServer?"https://".concat(o.proxyServer,"/ap/?url=").concat(d+"/api/v1?action=uap"):"https://".concat(d,"/api/v1?action=uap")),c=s.map(d=>function(h,f,g,_){const E={command:"convergeAllocateEdge",sid:f.sid,appId:f.appId,token:f.token,ts:Date.now(),version:ms,cname:f.cname,uid:f.uid.toString(),requestId:KI,seq:KI};KI+=1;const T={service_name:"tele_channel",json_body:JSON.stringify(E)};return Ra(async()=>{const w=await el(h,{data:T,cancelToken:g,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(w.code!==0){const L=new Z(B.UNEXPECTED_RESPONSE,"cross channel ap error, code"+w.code,{retry:!0});throw O.error(L.toString()),L}const A=JSON.parse(w.json_body);if(A.code!==200){const L=new Z(B.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(A.code,", reason: ").concat(A.reason));throw O.error(L.toString()),L}if(!A.servers||A.servers.length===0){const L=new Z(B.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw O.error(L.toString()),L}return{vid:A.vid,workerToken:A.workerToken,addressList:(Y("CHANNEL_MEDIA_RELAY_SERVERS")||A.servers).map(L=>"wss://".concat(L.address.replace(/\./g,"-"),".").concat(Y("WORKER_DOMAIN"),":").concat(L.wss))}},void 0,w=>!!(w.code!==B.OPERATION_ABORTED&&w.code!==B.UNEXPECTED_RESPONSE||w.data&&w.data.retry),_)}(d,o,n,r));try{const d=await kp(c);return c.forEach(h=>h.cancel()),d}catch(d){throw d[0]}}async function Zie(o,n,r){let s=null;const c=[],d=async h=>{const f=Y(h?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(g=>o.proxyServer?"https://".concat(o.proxyServer,"/ap/?url=").concat(g+"/api/v2/transpond/webrtc?v=2"):"https://".concat(g,"/api/v2/transpond/webrtc?v=2"));return h&&(await Nr(1e3),s!==null)?s:await Pg({fragementLength:Y("FRAGEMENT_LENGTH"),referenceList:f,asyncMapHandler:g=>(O.debug("[".concat(o.clientId,"] update ticket, Connect to ").concat(h?"backup":""," choose_server:"),g),function(_,E,T,w){const[A]=Jie(E,[kr.CHOOSE_SERVER]);let L=rr.networkState;return Ra(async()=>{L&&rr.networkState===bi.OFFLINE&&rr.onlineWaiter&&await ae.race([rr.onlineWaiter,Nr(w&&w.maxRetryTimeout||ir.maxRetryTimeout)]),L=rr.networkState;const P=await el(_,{data:A,cancelToken:T,headers:{"Content-Type":"multipart/form-data;"}},!0);return qie(P,_)},()=>!1,P=>P.code!==B.OPERATION_ABORTED&&(P.code===B.UPDATE_TICKET_FAILED?P.data.retry:(O.warning("[".concat(E.clientId,"] update ticket network error, retry"),P),!0)),w)}(g,o,n,r)),allFailedhandler:g=>{throw g[0]},promisesCollector:c})};try{return s=await kp([d(!1),d(!0)]),c.length&&c.forEach(h=>h.cancel&&typeof h.cancel=="function"&&h.cancel()),s}catch(h){throw h[0]}}function sV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function aV(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?sV(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):sV(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class eoe extends mn{get isSuccess(){return!!this.configs}constructor(){super(),I(this,"configs",void 0),I(this,"joinInfo",void 0),I(this,"cancelToken",void 0),I(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),I(this,"interval",void 0),I(this,"mutex",new Pr("config-distribute")),I(this,"mutableParamsRead",!1)}startGetConfigDistribute(n,r){this.joinInfo=n,this.cancelToken=r,this.interval&&this.stopGetConfigDistribute(),Y("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},Y("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,Be.reportApiInvoke(null,{options:void 0,name:tr.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:yn.TRACER}).onSuccess(JSON.stringify(td))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void O.debug("[config-distribute] get config distribute interrupted have no joininfo");let n;const r=await this.mutex.lock();try{n=await Xie(this.joinInfo,this.cancelToken,this.retryConfig),O.debug("[config-distribute] get config distribute",JSON.stringify(n)),n.limit_bitrate&&this.handleBitrateLimit(n.limit_bitrate),this.cacheGlobalParameterConfig(n),this.configs=n}catch(s){const c=new Z(B.NETWORK_RESPONSE_ERROR,s);O.warning("[config-distribute] ".concat(c.toString()))}finally{r()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(n){var r;(r=n)&&r.uplink&&r.id&&r.uplink.max_bitrate!==void 0&&r.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==n.id&&this.emit(Ag.UPDATE_BITRATE_LIMIT,n):this.emit(Ag.UPDATE_BITRATE_LIMIT,n))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&aV({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(n){var r;const s=cg(r=Object.keys(n).filter(d=>/^webrtc_ng_global_parameter/.test(d))).call(r);for(let d=0;d<s.length;d++)for(let h=s.length-1;h>d;h--){const f=s[h];if(typeof n[f].__priority=="number"){const g=n[f].__priority,_=s[h-1];if(typeof n[_].__priority=="number"){if(!(g>n[_].__priority))continue;{const E=f;s[h]=s[h-1],s[h-1]=E}}else{const E=f;s[h]=s[h-1],s[h-1]=E}}}const c={};s.forEach(d=>{const h=n[d],f=h.__expires;Object.keys(h).forEach(g=>{g==="__priority"||g==="__expires"||Object.prototype.hasOwnProperty.call(c,g)||(c[g]=aV({value:h[g]},f&&{expires:f}))})});try{(function(f){try{const g=Date.now();Object.keys(f).forEach(_=>{switch(_){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":if(Object.prototype.hasOwnProperty.call(Ci,_)){const{value:E,expires:T}=f[_];if(T&&T<=g)return;td[_]=E,Ci[_]=E,O.debug("Update global parameters from config distribute",_,E)}}})}catch(g){O.error("Error update config immediately: ".concat(f),g.message)}})(c);const d=JSON.stringify(c),h=window.btoa(d);window.localStorage.setItem("websdk_ng_global_parameter",h),O.debug("Caching global parameters ".concat(d))}catch(d){O.error("Error caching global parameters:",d.message)}}}const pi={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1};function Lt(){return pi}var Cr;function Dp(o,n,r){return{sampleRate:o,stereo:n,bitrate:r}}function wt(o,n,r,s,c){return{width:o,height:n,frameRate:r,bitrateMin:s,bitrateMax:c}}function $s(o,n,r,s,c){return{width:{max:o},height:{max:n},frameRate:r,bitrateMin:s,bitrateMax:c}}function qI(o,n){return{numSpatialLayers:o,numTemporalLayers:n}}(function(o){o.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",o.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",o.IOS_INTERRUPTION_START="ios-interruption-start",o.IOS_INTERRUPTION_END="ios-interruption-end",o.STATE_CHANGE="state-change"})(Cr||(Cr={}));const toe={"90p":wt(160,90),"90p_1":wt(160,90),"120p":wt(160,120,15,30,65),"120p_1":wt(160,120,15,30,65),"120p_3":wt(120,120,15,30,50),"120p_4":wt(212,120),"180p":wt(320,180,15,30,140),"180p_1":wt(320,180,15,30,140),"180p_3":wt(180,180,15,30,100),"180p_4":wt(240,180,15,30,120),"240p":wt(320,240,15,40,200),"240p_1":wt(320,240,15,40,200),"240p_3":wt(240,240,15,40,140),"240p_4":wt(424,240,15,40,220),"360p":wt(640,360,15,80,400),"360p_1":wt(640,360,15,80,400),"360p_3":wt(360,360,15,80,260),"360p_4":wt(640,360,30,80,600),"360p_6":wt(360,360,30,80,400),"360p_7":wt(480,360,15,80,320),"360p_8":wt(480,360,30,80,490),"360p_9":wt(640,360,15,80,800),"360p_10":wt(640,360,24,80,800),"360p_11":wt(640,360,24,80,1e3),"480p":wt(640,480,15,100,500),"480p_1":wt(640,480,15,100,500),"480p_2":wt(640,480,30,100,1e3),"480p_3":wt(480,480,15,100,400),"480p_4":wt(640,480,30,100,750),"480p_6":wt(480,480,30,100,600),"480p_8":wt(848,480,15,100,610),"480p_9":wt(848,480,30,100,930),"480p_10":wt(640,480,10,100,400),"720p":wt(1280,720,15,120,1130),"720p_auto":wt(1280,720,30,900,3e3),"720p_1":wt(1280,720,15,120,1130),"720p_2":wt(1280,720,30,120,2e3),"720p_3":wt(1280,720,30,120,1710),"720p_5":wt(960,720,15,120,910),"720p_6":wt(960,720,30,120,1380),"1080p":wt(1920,1080,15,120,2080),"1080p_1":wt(1920,1080,15,120,2080),"1080p_2":wt(1920,1080,30,120,3e3),"1080p_3":wt(1920,1080,30,120,3150),"1080p_5":wt(1920,1080,60,120,4780),"1440p":wt(2560,1440,30,120,4850),"1440p_1":wt(2560,1440,30,120,4850),"1440p_2":wt(2560,1440,60,120,7350),"4k":wt(3840,2160,30,120,8910),"4k_1":wt(3840,2160,30,120,8910),"4k_3":wt(3840,2160,60,120,13500)},h0=[{scaleResolutionDownBy:2,width:1280,height:720,frameRate:30,bitrateMin:300,bitrateMax:900},{scaleResolutionDownBy:1.333333,width:1280,height:720,frameRate:30,bitrateMin:600,bitrateMax:2e3},{scaleResolutionDownBy:1,width:1280,height:720,frameRate:30,bitrateMin:900,bitrateMax:3e3}],noe={"480p":$s(640,480,5),"480p_1":$s(640,480,5),"480p_2":$s(640,480,30),"480p_3":$s(640,480,15),"720p":$s(1280,720,5),"720p_auto":wt(1280,720,30,900,3e3),"720p_1":$s(1280,720,5),"720p_2":$s(1280,720,30),"720p_3":$s(1280,720,15),"1080p":$s(1920,1080,5),"1080p_1":$s(1920,1080,5),"1080p_2":$s(1920,1080,30),"1080p_3":$s(1920,1080,15)},roe={"1SL1TL":qI(1,1),"3SL3TL":qI(3,3),"2SL3TL":qI(2,3)};function ic(o){return o||(o="480p_1"),typeof o=="string"?Object.assign({},toe[o]):o}function JI(o){return typeof o=="string"?Object.assign({},noe[o]):o}function p0(o){return typeof o=="string"?Object.assign({},roe[o]):o}const ioe={speech_low_quality:Dp(16e3,!1),speech_standard:Dp(32e3,!1,18),music_standard:Dp(48e3,!1),standard_stereo:Dp(48e3,!0,56),high_quality:Dp(48e3,!1,128),high_quality_stereo:Dp(48e3,!0,192)};function f0(o){return typeof o=="string"?Object.assign({},ioe[o]):o}const xp=[];function cV(o){return mr(o,"mediaSource",["screen","window","application"]),!0}var ke,tn,dd,XI,QI,ud,hd,pd,eo,lV;(function(o){o.NEED_RENEGOTIATE="@need_renegotiate",o.NEED_REPLACE_TRACK="@need_replace_track",o.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",o.NEED_CLOSE="@need_close",o.NEED_ENABLE_TRACK="@need_enable_track",o.NEED_DISABLE_TRACK="@need_disable_track",o.NEED_SESSION_ID="@need_sid",o.SET_OPTIMIZATION_MODE="@set_optimization_mode",o.GET_STATS="@get_stats",o.GET_RTC_STATS="@get_rtc_stats",o.GET_LOW_VIDEO_TRACK="@get_low_video_track",o.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",o.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",o.NEED_MUTE_TRACK="@need_mute_track",o.NEED_UNMUTE_TRACK="@need_unmute_track"})(ke||(ke={})),function(o){o.SCREEN_TRACK="screen_track",o.CUSTOM_TRACK="custome_track",o.LOW_STREAM="low_stream"}(tn||(tn={})),function(o){o[o.HIGH_STREAM=0]="HIGH_STREAM",o[o.LOW_STREAM=1]="LOW_STREAM"}(dd||(dd={})),function(o){o[o.HIGH_STREAM=0]="HIGH_STREAM",o[o.LOW_STREAM=1]="LOW_STREAM"}(XI||(XI={})),function(o){o[o.DISABLE=0]="DISABLE",o[o.LOW_STREAM=1]="LOW_STREAM",o[o.AUDIO_ONLY=2]="AUDIO_ONLY"}(QI||(QI={})),function(o){o.TRANSCEIVER_UPDATED="transceiver-updated",o.SEI_TO_SEND="sei-to-send",o.SEI_RECEIVED="sei-received"}(ud||(ud={})),function(o){o.SOURCE_STATE_CHANGE="source-state-change",o.TRACK_ENDED="track-ended",o.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",o.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",o.CLOSED="closed"}(hd||(hd={})),function(o){o.FIRST_FRAME_DECODED="first-frame-decoded",o.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",o.VIDEO_STATE_CHANGED="video-state-changed"}(pd||(pd={})),function(o){o.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",o.RECEIVE_TRACK_BUFFER="receive_track_buffer",o.ON_AUDIO_BUFFER="on_audio_buffer",o.UPDATE_SOURCE="update_source"}(eo||(eo={})),function(o){o.UPDATE_TRACK_SOURCE="update-track-source"}(lV||(lV={}));const ZI={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},eA={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},dV={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},ooe={uplinkNetworkQuality:0,downlinkNetworkQuality:0},uV={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};var fi,to,Uu,tl,mi,Ks;(function(o){o.ON_TRACK="on_track",o.ON_NODE="on_node"})(fi||(fi={})),function(o){o.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",o.REQUEST_CONSTRAINTS="request_constraints"}(to||(to={})),function(o){o.IDLE="IDLE",o.INITING="INITING",o.INITEND="INITEND"}(Uu||(Uu={})),function(o){o.STATE_CHANGE="state_change",o.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",o.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",o.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(tl||(tl={})),function(o){o.NONE="none",o.INIT="init",o.CANPLAY="canplay",o.PLAYING="playing",o.PAUSED="paused",o.SUSPEND="suspend",o.STALLED="stalled",o.WAITING="waiting",o.ERROR="error",o.DESTROYED="destroyed",o.ABORT="abort",o.ENDED="ended",o.EMPTIED="emptied",o.LOADEDDATA="loadeddata"}(mi||(mi={})),function(o){o[o.VideoStateStopped=0]="VideoStateStopped",o[o.VideoStateStarting=1]="VideoStateStarting",o[o.VideoStateDecoding=2]="VideoStateDecoding",o[o.VideoStateFrozen=3]="VideoStateFrozen"}(Ks||(Ks={}));const tA={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};var Lp;(function(o){o.OPEN="open",o.MESSAGE="message",o.CLOSE="close",o.CLOSING="closing",o.ERROR="error"})(Lp||(Lp={}));class hV extends mn{constructor(n,r){super(),I(this,"_ID",void 0),I(this,"_rtpTransceiver",void 0),I(this,"_lowRtpTransceiver",void 0),I(this,"_hints",[]),I(this,"_isClosed",!1),I(this,"_originMediaStreamTrack",void 0),I(this,"_mediaStreamTrack",void 0),I(this,"_external",{}),this._ID=r||Qt(8,"track-"),this._originMediaStreamTrack=n,this._mediaStreamTrack=n,function(s){Le(xp).call(xp,s)||xp.push(s)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(n){if(!n){const r=Be.reportApiInvoke(null,{name:tr.GET_MEDIA_STREAM_TRACK,options:[],tag:yn.TRACER});this._mediaStreamTrack&&typeof this._mediaStreamTrack.label=="string"?r.onSuccess(this._mediaStreamTrack.label):r.onSuccess("")}return this._mediaStreamTrack}getRTCRtpTransceiver(n){return n===dd.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(n){const r=xp.indexOf(n);r!==-1&&xp.splice(r,1)}(this),this.emit(hd.CLOSED),this.removeAllListeners(ud.SEI_RECEIVED)}_updateRtpTransceiver(n,r){if(r===dd.LOW_STREAM){if(this._lowRtpTransceiver===n)return;this._lowRtpTransceiver=n}else{if(this._rtpTransceiver===n)return;this._rtpTransceiver=n}this.emit(ud.TRANSCEIVER_UPDATED,n,r)}}class Zr extends hV{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(n,r){super(n,r),I(this,"_enabled",!0),I(this,"_muted",!1),I(this,"_isExternalTrack",!1),I(this,"_isClosed",!1),I(this,"_enabledMutex",void 0),I(this,"processor",void 0),I(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Pr("".concat(this.getTrackId())),n.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var n,r;return(n=(r=this._originMediaStreamTrack)===null||r===void 0?void 0:r.label)!==null&&n!==void 0?n:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,O.debug("[".concat(this.getTrackId(),"] close")),this.emit(ke.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(n,r){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=s,n!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),r&&this._originMediaStreamTrack.stop()),n.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=n,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Xt(this,ke.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){O.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(hd.TRACK_ENDED)}stateCheck(n,r){if(O.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(n,": ").concat(r,"]")),$c(r,n),this._enabled&&this._muted&&n==="enabled"&&r===!1)throw new he(B.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",O);if(!this._enabled&&!this._muted&&n==="muted"&&r===!0)throw new he(B.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",O)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():ae.resolve([])}}function pV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}const fV=window.AudioContext||window.webkitAudioContext;let zo=null;const zt=new class extends mn{constructor(){super(...arguments),I(this,"prevState",void 0),I(this,"curState",void 0),I(this,"currentTime",void 0),I(this,"currentTimeStuckAt",void 0),I(this,"interruptDetectorTrack",void 0),I(this,"onLocalAudioTrackMute",()=>{O.info("ios15-interruption-start"),this.emit(Cr.IOS_15_16_INTERRUPTION_START)}),I(this,"onLocalAudioTrackUnmute",async()=>{O.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?O.info("ios15-interruption-end-canceled"):(zo&&await zo.suspend(),this.emit(Cr.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(o){O.debug("webaudio bindInterruptDetectorTrack ".concat(o.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=o,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(o){O.debug("webaudio unbindInterruptDetectorTrack ".concat(o.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===o&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function soe(){if(!fV)return void O.error("your browser is not support web audio");O.info("create audio context");const o=function(n){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?pV(Object(s),!0).forEach(function(c){I(n,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):pV(Object(s)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(s,c))})}return n}({},Y("WEBAUDIO_INIT_OPTIONS"));O.debug("audio context init option:",JSON.stringify(o)),zo=new fV(o),zt.curState=zo.state,zo.onstatechange=()=>{zt.prevState=zt.curState,zt.curState=zo?zo.state:void 0;const{prevState:n,curState:r}=zt,s=r==="running",c=r==="interrupted",d=n==="running",h=n==="suspended",f=n==="interrupted",g=xt().osVersion;(Ti()||Qa())&&d&&c&&(O.info("ios".concat(g,"-interruption-start")),zt.emit(Cr.IOS_INTERRUPTION_START)),(Ti()||Qa())&&(h||f)&&s&&(O.info("ios".concat(g,"-interruption-end")),zt.emit(Cr.IOS_INTERRUPTION_END)),n!==r&&zt.emit(Cr.STATE_CHANGE,r,n)},setInterval(()=>{var n;const r=(n=zo)===null||n===void 0?void 0:n.currentTime;zt.currentTime!==r?(zt.currentTimeStuckAt&&(O.debug("AudioContext current time resume at ".concat(r)),zt.currentTimeStuckAt=void 0),zt.currentTime=r):(r!==zt.currentTimeStuckAt&&(Be.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:r},tag:yn.TRACER}).onSuccess(),O.warning("AudioContext current time stuck at ".concat(r))),zt.currentTimeStuckAt=r)},5e3),async function(n){const r=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let s,c=!1,d=!1,h=!1;function f(D){n.state==="running"?g(!1):Ti()||Qa()?n.state==="suspended"&&(g(!0),D&&n.resume().then(E,E)):n.state!=="closed"&&(g(!0),D&&n.resume().then(E,E))}function g(D){if(c!==D){c=D;for(let G=0,$=r;G<$.length;G+=1){const X=$[G];D?window.addEventListener(X,T,{capture:!0,passive:!0}):window.removeEventListener(X,T,{capture:!0,passive:!0})}}}function _(){f(!0)}function E(){f(!1)}function T(){f(!0)}function w(D){if(!h)if(s.paused)if(D){let G;A(!1),h=!0;try{G=s.play(),G?G.then(L,L):(s.addEventListener("playing",L),s.addEventListener("abort",L),s.addEventListener("error",L))}catch{L()}}else A(!0);else A(!1)}function A(D){if(d!==D){d=D;for(let G=0,$=r;G<$.length;G++){const X=$[G];D?window.addEventListener(X,P,{capture:!0,passive:!0}):window.removeEventListener(X,P,{capture:!0,passive:!0})}}}function L(){s.removeEventListener("playing",L),s.removeEventListener("abort",L),s.removeEventListener("error",L),h=!1,w(!1)}function P(){w(!0)}if(Ti()){const D=n.createMediaStreamDestination(),G=document.createElement("div");G.innerHTML="<audio x-webkit-airplay='deny'></audio>",s=G.children.item(0),s.controls=!1,s.disableRemotePlayback=!0,s.preload="auto",s.srcObject=D.stream,w(!0)}zt.on(Cr.STATE_CHANGE,_),f(!1)}(zo)}function Mp(){if(!zo){if(soe(),!zo)throw new he(B.NOT_SUPPORTED,"can not create audio context");return zo}return zo}function ju(o){if(function(){if(nA!==null)return nA;const s=Mp(),c=s.createBufferSource(),d=s.createGain(),h=s.createGain();c.connect(d),c.connect(h),c.disconnect(d);let f=!1;try{c.disconnect(d)}catch{f=!0}return c.disconnect(),nA=f,f}())return;const n=o.connect,r=o.disconnect;o.connect=(s,c,d)=>{var h;return o._inputNodes||(o._inputNodes=[]),Le(h=o._inputNodes).call(h,s)||(s instanceof AudioNode?(o._inputNodes.push(s),n.call(o,s,c,d)):n.call(o,s,c)),o},o.disconnect=(s,c,d)=>{r.call(o),s?Fy(o._inputNodes,s):o._inputNodes=[];for(const h of o._inputNodes)n.call(o,h)}}let nA=null;function rA(o,n){let r=!1;const s=1/n;if(Y("DISABLE_WEBAUDIO")){const c=window.setInterval(()=>{r?window.clearInterval(c):o(performance.now()/1e3)},1e3*s)}else{const c=Mp();let d=c.createGain();d.gain.value=0,d.connect(c.destination);const h=()=>{if(r)return void(d=null);const f=c.createOscillator();f.onended=h,f.connect(d),f.start(0),f.stop(c.currentTime+s),o(c.currentTime)};h()}return()=>{r=!0}}class mV{constructor(){I(this,"context",void 0),I(this,"analyserNode",void 0),I(this,"sourceNode",void 0),this.context=Mp(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(n){if(n!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=n,n==null||n.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||Ti()||Qa()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const n=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(n);else{const s=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(s);for(let c=0;c<n.length;++c)n[c]=s[c]/128-1}const r=qc(n).call(n,(s,c)=>s+c*c,0)/n.length;return Math.max(10*Math.log10(r)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var n,r;(n=this.sourceNode)===null||n===void 0||n.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(r=this.sourceNode)===null||r===void 0||r.connect(this.analyserNode)}catch{O.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class gV extends mn{get processSourceNode(){return this.sourceNode}set processedNode(n){var r;if(!this.isDestroyed&&this._processedNode!==n){try{var s;(s=this.sourceNode)===null||s===void 0||s.disconnect(this.outputNode)}catch{}(r=this._processedNode)===null||r===void 0||r.disconnect(),this._processedNode=n,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),I(this,"outputNode",void 0),I(this,"outputTrack",void 0),I(this,"isPlayed",!1),I(this,"context",void 0),I(this,"audioBufferNode",void 0),I(this,"destNode",void 0),I(this,"audioOutputLevel",0),I(this,"volumeLevelAnalyser",void 0),I(this,"_processedNode",void 0),I(this,"playNode",void 0),I(this,"isDestroyed",!1),I(this,"onNoAudioInput",void 0),I(this,"isNoAudioInput",!1),I(this,"_noAudioInputCount",0),this.context=Mp(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),ju(this.outputNode),this.volumeLevelAnalyser=new mV}startGetAudioBuffer(n){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(n),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=r=>{this.emit(eo.ON_AUDIO_BUFFER,function(s){for(let c=0;c<s.outputBuffer.numberOfChannels;c+=1){const d=s.outputBuffer.getChannelData(c);for(let h=0;h<d.length;h+=1)d[h]=0}return s.inputBuffer}(r))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Lt().webAudioMediaStreamDest)throw new he(B.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(n){this.context.state!=="running"&&Vy(()=>{zt.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=n||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(n>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;Ti()||Qa()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const r=this.volumeLevelAnalyser.getAnalyserNode();let s;r.getFloatTimeDomainData?(s=new Float32Array(r.fftSize),r.getFloatTimeDomainData(s)):(s=new Uint8Array(r.fftSize),r.getByteTimeDomainData(s));let c=!1;for(let d=0;d<s.length;d++)s[d]!==0&&(c=!0);return c?(this.isNoAudioInput=!1,!0):(await Nr(200),await this.checkHasAudioInput(n?n+1:1)&&c)}getAudioVolume(){return this.outputNode.gain.value}setVolume(n){this.outputNode.gain.setValueAtTime(n,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var n,r;(n=this.processedNode)===null||n===void 0||n.disconnect(),(r=this.sourceNode)===null||r===void 0||r.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var n;this.processedNode?(n=this.processedNode)===null||n===void 0||n.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class _V extends gV{get isFreeze(){return!1}constructor(n,r,s){var c;if(super(),I(this,"sourceNode",void 0),I(this,"track",void 0),I(this,"clonedTrack",void 0),I(this,"audioElement",void 0),I(this,"isCurrentTrackCloned",!1),I(this,"isRemoteTrack",!1),I(this,"originVolumeLevelAnalyser",void 0),I(this,"rebuildWebAudio",async()=>{if(O.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void O.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>O.info("resume success")),O.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const f=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?f.stop():this.isCurrentTrackCloned=!0;const g=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(g),ju(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const _=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(_,this.context.currentTime),ju(this.outputNode),this.emit(eo.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=g,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),n.kind!=="audio")throw new he(B.UNEXPECTED_ERROR);this.track=n;const d=new MediaStream([this.track]);if(this.isRemoteTrack=!!r,this.sourceNode=this.context.createMediaStreamSource(d),ju(this.sourceNode),s){const f=s.clone();f.enabled=!0,this.clonedTrack=f,O.debug("create an unmuted track ".concat(f.id," from the original track ").concat(s.id," to get the volume"));const g=this.context.createMediaStreamSource(new MediaStream([f]));ju(g),this.originVolumeLevelAnalyser=new mV,this.originVolumeLevelAnalyser.updateSource(g)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=d;const h=xt();r&&h.os===fr.IOS&&Number((c=h.osVersion)===null||c===void 0?void 0:c.split(".")[0])<15&&(zt.on(Cr.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(f=>{f||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(n){this.sourceNode.disconnect(),this.track=n,this.isCurrentTrackCloned=!1;const r=new MediaStream([n]);this.sourceNode=this.context.createMediaStreamSource(r),ju(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(eo.UPDATE_SOURCE),this.audioElement.srcObject=r}destroy(){var n;this.audioElement.srcObject=null,this.audioElement.remove(),zt.off("state-change",this.rebuildWebAudio),(n=this.originVolumeLevelAnalyser)===null||n===void 0||n.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(n){return this.context.createMediaStreamSource(new MediaStream([n]))}updateOriginTrack(n){const r=n.clone();r.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=r),O.debug("create an unmuted track ".concat(r.id," from the original track ").concat(n.id," to get the volume"));const s=this.context.createMediaStreamSource(new MediaStream([r]));ju(s),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(s)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function vV(o,n,r){const s=(d,h)=>d?typeof d!="number"?d.max||d.exact||d.ideal||d.min||h:d:h,c={audio:!!r&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:o,maxHeight:s(n.height,1080),maxWidth:s(n.width,1920)}}};return n.frameRate&&typeof n.frameRate!="number"?(c.video.mandatory.maxFrameRate=n.frameRate.max,c.video.mandatory.minFrameRate=n.frameRate.min):typeof n.frameRate=="number"&&(c.video.mandatory.maxFrameRate=n.frameRate),await navigator.mediaDevices.getUserMedia(c)}async function aoe(o,n){const r=await EV(o.mediaSource),{sourceId:s,audio:c}=await function(d){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new ae((f,g)=>{const _=document.createElement("div");_.innerText="share screen",_.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const E=document.createElement("div");E.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const T=document.createElement("div");T.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",T.setAttribute("style","height: 12%;");const w=document.createElement("div");w.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const A=document.createElement("div");A.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const L=document.createElement("button");L.innerHTML="cancel",L.setAttribute("style","width: 85px;"),L.onclick=()=>{document.body.removeChild(G);const $=new Error("NotAllowedError");$.name="NotAllowedError",g($)};let P=h;const D=document.createElement("div");if(h){const $=document.createElement("input");$.setAttribute("type","checkbox");const X=document.createElement("span");$.setAttribute("style","margin-right: 6px;"),X.innerText="Share audio",$.checked=P,$.onchange=()=>{P=$.checked},D.appendChild($),D.appendChild(X)}A.appendChild(D),A.appendChild(L),E.appendChild(T),E.appendChild(w),E.appendChild(A);const G=document.createElement("div");G.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),G.appendChild(_),G.appendChild(E),document.body.appendChild(G),d.map($=>{if($.id){const X=document.createElement("div");X.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let ie=$.thumbnail;try{const{width:Q}=ie.getSize();Q>1920&&(ie=ie.resize({width:1920}))}catch(Q){throw Q&&Q.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),Q}X.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+ie.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+$.name.replace(/[\u00A0-\u9999<>\&]/g,function(Q){return"&#"+Q.charCodeAt(0)+";"})+"</span>",X.onclick=()=>{document.body.removeChild(G),f({sourceId:$.id,audio:P})},w.appendChild(X)}})})}(r,n);return await vV(s,o,c)}async function EV(o){let n=["window","screen"];o!=="application"&&o!=="window"||(n=["window"]),o==="screen"&&(n=["screen"]);const r=_j();if(!r)throw console.error("failed to fetch electron, please mount it to window"),new he(B.ELECTRON_IS_NULL);let s=null;try{var c;s=((c=r.desktopCapturer)===null||c===void 0?void 0:c.getSources({types:n}))||r.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:n})}catch{s=null}s&&s.then||(s=new ae((d,h)=>{r.desktopCapturer.getSources({types:n},(f,g)=>{f?h(f):d(g)})}));try{return await s}catch(d){throw new he(B.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,d.toString())}}function yV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}const iA=new Pr("safari");let SV=!1,TV=!1;async function Go(o,n){let r=0,s=null;for(;r<2;)try{s=await coe(o,n,r>0);break}catch(c){if(c instanceof he)throw O.error("[".concat(n,"] ").concat(c.toString())),c;const d=m0(c.name||c.code||c,c.message);if(d.code===B.MEDIA_OPTION_INVALID){O.debug("[".concat(n,"] detect media option invalid, retry")),r+=1,await Nr(500);continue}throw O.error("[".concat(n,"] ").concat(d.toString())),d}if(!s)throw new he(B.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return s}async function coe(o,n,r){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new he(B.NOT_SUPPORTED,"can not find getUserMedia");r&&(o.video&&(delete o.video.width,delete o.video.height),o.screen&&(delete o.screen.width,delete o.screen.height));const s=Lt(),c=new MediaStream;if(o.audioSource&&c.addTrack(o.audioSource),o.videoSource&&c.addTrack(o.videoSource),!o.audio&&!o.video&&!o.screen)return O.debug("Using Video Source/ Audio Source"),c;if(o.screen)if(_j())o.screen.sourceId?Up(c,await vV(o.screen.sourceId,o.screen,o.screenAudio)):Up(c,await aoe(o.screen,o.screenAudio));else if(Hc()&&o.screen.extensionId&&o.screen.mandatory){if(!s.getStreamFromExtension)throw new he(B.NOT_SUPPORTED,"This browser does not support screen sharing");O.debug("[".concat(n,'] Screen access on chrome stable, looking for extension"'));const w=await(h=o.screen.extensionId,f=n,new ae((A,L)=>{try{chrome.runtime.sendMessage(h,{getStream:!0},P=>{if(!P||!P.streamId)return O.error("[".concat(f,"] No response from Chrome Plugin. Plugin not installed properly"),P),void L(new he(B.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));A(P.streamId)})}catch(P){O.error("[".concat(f,"] AgoraRTC screensharing plugin is not accessible(").concat(h,")"),P.toString()),L(new he(B.CHROME_PLUGIN_NOT_INSTALL))}}));o.screen.mandatory.chromeMediaSourceId=w,Up(c,await navigator.mediaDevices.getUserMedia({video:{mandatory:o.screen.mandatory}}))}else if(s.getDisplayMedia){var d;o.screen.mediaSource&&cV(o.screen.mediaSource);const w={width:o.screen.width,height:o.screen.height,frameRate:o.screen.frameRate,displaySurface:(d=o.screen.displaySurface)!==null&&d!==void 0?d:o.screen.mediaSource==="screen"?"monitor":o.screen.mediaSource},{selfBrowserSurface:A,surfaceSwitching:L,systemAudio:P}=o.screen,D={selfBrowserSurface:A,surfaceSwitching:L,systemAudio:P};!A&&delete D.selfBrowserSurface,!L&&delete D.surfaceSwitching,!P&&delete D.systemAudio,O.debug("[".concat(n,"] getDisplayMedia:"),JSON.stringify({video:w,audio:!!o.screenAudio,controls:D}));const G=await navigator.mediaDevices.getDisplayMedia(function($){for(var X=1;X<arguments.length;X++){var ie=arguments[X]!=null?arguments[X]:{};X%2?yV(Object(ie),!0).forEach(function(Q){I($,Q,ie[Q])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(ie)):yV(Object(ie)).forEach(function(Q){Object.defineProperty($,Q,Object.getOwnPropertyDescriptor(ie,Q))})}return $}({video:w,audio:!!o.screenAudio},D));Up(c,G)}else{if(!Jt())throw O.error("[".concat(n,"] This browser does not support screenSharing")),new he(B.NOT_SUPPORTED,"This browser does not support screen sharing");{o.screen.mediaSource&&cV(o.screen.mediaSource);const w={video:{mediaSource:o.screen.mediaSource,width:o.screen.width,height:o.screen.height,frameRate:o.screen.frameRate}};O.debug("[".concat(n,"] getUserMedia: ").concat(JSON.stringify(w))),Up(c,await navigator.mediaDevices.getUserMedia(w))}}var h,f;if(!o.video&&!o.audio)return c;let g={video:o.video,audio:o.audio},_=Y("MEDIA_DEVICE_CONSTRAINTS");if(_)try{typeof _=="string"&&(_=JSON.parse(_)),g=iI(g,_)}catch{}O.debug("[".concat(n,"] GetUserMedia"),JSON.stringify(g)),xt();let E,T=null;(Fr()||Ti()||My())&&(T=await iA.lock());try{E=await navigator.mediaDevices.getUserMedia(g)}catch(w){throw T&&T(),w}return g.audio&&(SV=!0),g.video&&(TV=!0),Up(c,E),T&&T(),c}function m0(o,n){switch(o){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new he(B.MEDIA_OPTION_INVALID,"".concat(o,": ").concat(n));case"NotFoundError":case"DevicesNotFoundError":return new he(B.DEVICE_NOT_FOUND,"".concat(o,": ").concat(n));case"NotSupportedError":return new he(B.NOT_SUPPORTED,"".concat(o,": ").concat(n));case"NotReadableError":return new he(B.NOT_READABLE,"".concat(o,": ").concat(n));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new he(B.PERMISSION_DENIED,"".concat(o,": ").concat(n));case"ConstraintNotSatisfiedError":return new he(B.CONSTRAINT_NOT_SATISFIED,"".concat(o,": ").concat(n));default:return O.error("getUserMedia unexpected error",o),new he(B.UNEXPECTED_ERROR,"".concat(o,": ").concat(n))}}function Up(o,n){const r=o.getVideoTracks()[0],s=o.getAudioTracks()[0],c=n.getVideoTracks()[0],d=n.getAudioTracks()[0];d&&(s&&o.removeTrack(s),o.addTrack(d)),c&&(r&&o.removeTrack(r),o.addTrack(c))}const Ho=new class extends mn{get state(){return this._state}set state(o){o!==this._state&&(this.emit(tl.STATE_CHANGE,o),this._state=o)}constructor(){super(),I(this,"_state",Uu.IDLE),I(this,"isAccessMicrophonePermission",!1),I(this,"isAccessCameraPermission",!1),I(this,"lastAccessMicrophonePermission",!1),I(this,"lastAccessCameraPermission",!1),I(this,"checkdeviceMatched",!1),I(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(Y("ENUMERATE_DEVICES_INTERVAL")||(Uy()||Ly()===fr.HARMONY_OS)&&Zl())&&this.updateDevicesInfo()},Y("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(o=>O.error(o.toString()))}async enumerateDevices(o,n){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new he(B.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const s=await navigator.mediaDevices.enumerateDevices(),c=this.checkMediaDeviceInfoIsOk(s);let d=!this.isAccessMicrophonePermission&&o,h=!this.isAccessCameraPermission&&n;c.audio&&(d=!1),c.video&&(h=!1);let f=null,g=null,_=null;if(!r&&(d||h)){if(iA.isLocked&&(O.debug("[device manager] wait GUM lock"),(await iA.lock())(),O.debug("[device manager] GUM unlock")),SV&&(d=!1,this.isAccessMicrophonePermission=!0),TV&&(h=!1,this.isAccessCameraPermission=!0),O.debug("[device manager] check media device permissions",o,n,d,h),d&&h){try{_=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(E){const T=m0(E.name||E.code||E,E.message);if(T.code===B.PERMISSION_DENIED)throw T;O.warning("getUserMedia failed in getDevices",T)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(d){try{f=await navigator.mediaDevices.getUserMedia({audio:o})}catch(E){const T=m0(E.name||E.code||E,E.message);if(T.code===B.PERMISSION_DENIED)throw T;O.warning("getUserMedia failed in getDevices",T)}this.isAccessMicrophonePermission=!0}else if(h){try{g=await navigator.mediaDevices.getUserMedia({video:n})}catch(E){const T=m0(E.name||E.code||E,E.message);if(T.code===B.PERMISSION_DENIED)throw T;O.warning("getUserMedia failed in getDevices",T)}this.isAccessCameraPermission=!0}O.debug("[device manager] mic permission",o,"cam permission",n)}try{const E=await navigator.mediaDevices.enumerateDevices();return f&&f.getTracks().forEach(T=>T.stop()),g&&g.getTracks().forEach(T=>T.stop()),_&&_.getTracks().forEach(T=>T.stop()),f=null,g=null,_=null,E}catch(E){return f&&f.getTracks().forEach(T=>T.stop()),g&&g.getTracks().forEach(T=>T.stop()),_&&_.getTracks().forEach(T=>T.stop()),f=null,g=null,_=null,new he(B.ENUMERATE_DEVICES_FAILED,E.toString()).throw()}}async getRecordingDevices(){let o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,o)).filter(n=>n.kind==="audioinput")}async getCamerasDevices(){let o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,o)).filter(n=>n.kind==="videoinput")}async getSpeakers(){let o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,o)).filter(n=>n.kind==="audiooutput")}searchDeviceIdByName(o){let n=null;return this.deviceInfoMap.forEach(r=>{r.device.label===o&&(n=r.device.deviceId)}),n}async getDeviceById(o){const n=(await this.enumerateDevices(!0,!0,!0)).find(r=>r.deviceId===o);if(!n)throw new he(B.DEVICE_NOT_FOUND,"deviceId: ".concat(o));return n}async init(){this.state=Uu.INITING;try{await this.updateDevicesInfo(),this.state=Uu.INITEND}catch(o){throw O.warning("Device Detection functionality cannot start properly.",o.toString()),this.state=Uu.IDLE,!(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")&&new he(B.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),o}}async updateDevicesInfo(){const o=await this.enumerateDevices(!0,!0,!0),n=Date.now(),r=[];if(o[0]&&o[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const c=o.find(h=>h.kind==="audioinput"&&h.deviceId==="default"),d=o.find(h=>h.kind==="audiooutput"&&h.deviceId==="default");c&&d?d.groupId===c.groupId?O.debug("[device-check] default input ".concat(c.label," and output ").concat(d.label," is the same group")):O.warning("[device-check] default input ".concat(c.label," and output ").concat(d.label," is not the same group")):O.debug("[device-check] default input or output not found")}const s=this.checkMediaDeviceInfoIsOk(o);if(o.forEach(c=>{if(!c.deviceId)return;const d=this.deviceInfoMap.get("".concat(c.kind,"_").concat(c.deviceId));if((d?d.state:"INACTIVE")!=="ACTIVE"){const h={initAt:n,updateAt:n,device:c,state:"ACTIVE"};this.deviceInfoMap.set("".concat(c.kind,"_").concat(c.deviceId),h),r.push(h)}d&&(d.updateAt=n)}),this.deviceInfoMap.forEach((c,d)=>{c.state==="ACTIVE"&&c.updateAt!==n&&(c.state="INACTIVE",r.push(c))}),this.state!==Uu.INITEND)return s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));r.forEach(c=>{switch(c.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(tl.RECORDING_DEVICE_CHANGED,c);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(tl.CAMERA_DEVICE_CHANGED,c);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(tl.PLAYOUT_DEVICE_CHANGED,c)}}),s.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),s.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(o){const n=o.filter(c=>c.kind==="audioinput"),r=o.filter(c=>c.kind==="videoinput"),s={audio:!1,video:!1};for(const c of n)if(c.label&&c.deviceId){s.audio=!0;break}for(const c of r)if(c.label&&c.deviceId){s.video=!0;break}return s}};let oA=!1;const $o=new class extends mn{constructor(){super(...arguments),I(this,"onAutoplayFailed",void 0),I(this,"onAudioAutoplayFailed",void 0)}};function bV(){if(xt(),!oA){const o=n=>{n.preventDefault(),oA=!1,vg()?document.body.removeEventListener("click",o,!0):(document.body.removeEventListener("touchstart",o,!0),document.body.removeEventListener("mousedown",o,!0))};oA=!0,vg()?document.body.addEventListener("click",o,!0):(document.body.addEventListener("touchstart",o,!0),document.body.addEventListener("mousedown",o,!0)),O.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),$o.onAutoplayFailed?$o.onAutoplayFailed():$o.onAudioAutoplayFailed?O.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):O.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),$o.emit("autoplay-failed")}}function CV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function wV(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?CV(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):CV(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}function RV(o,n,r,s){if(!o)return;const c=Be.getBaseInfoBySessionId(o);if(!c)return;const d=c.info,h=Date.now(),f=wV(wV({},d),{},{vid:d.vid===void 0?0:Number(d.vid),lts:h,elapse:h-c.startTime,cbRegistered:$o.onAutoplayFailed||$o.onAudioAutoplayFailed?1:-1,errorMsg:r,mediaType:n,trackId:s,extend:void 0});Be.send({type:dn.AUTOPLAY_FAILED,data:f},!0)}const loe=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],Vi=new class{constructor(){I(this,"onAutoplayFailed",void 0),I(this,"elementMap",new Map),I(this,"elementStateMap",new Map),I(this,"elementsNeedToResume",[]),I(this,"sinkIdMap",new Map),I(this,"autoResumeAfterInterruption",o=>{Array.from(this.elementMap.entries()).forEach(n=>{let[r,s]=n;const c=this.elementStateMap.get(r),d=s.srcObject.getAudioTracks()[0],h=d&&d.readyState;if(O.debug("resume after interrupted, ele: ".concat(c," audio: ").concat(h," ").concat(o)),h==="live"){if(o)return s.pause(),void s.play();if(zt.curState==="running")return Ep()?(s.pause(),void s.play()):void(c&&c==="paused"&&s.play())}})}),I(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(o=>{let[n,r]=o;const s=r.srcObject.getAudioTracks()[0];s&&s.readyState==="live"&&(O.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),r.pause(),r.play())})}),this.autoResumeAudioElement(),zt.on(Cr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),zt.on(Cr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),zt.on(Cr.STATE_CHANGE,()=>{Ti()&&zt.prevState==="suspended"&&zt.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(o,n){const r=this.elementMap.get(o);if(this.sinkIdMap.set(o,n),r)try{await r.setSinkId(n)}catch(s){throw new he(B.PERMISSION_DENIED,"can not set sink id: "+s.toString())}}play(o,n,r,s){if(this.elementMap.has(n))return;const c=document.createElement("audio");c.autoplay=!0,c.srcObject=new MediaStream([o]),this.bindAudioElementEvents(n,c),this.elementMap.set(n,c),this.elementStateMap.set(n,mi.INIT),this.setVolume(n,r);const d=this.sinkIdMap.get(n);if(d)try{c.setSinkId(d).catch(f=>{O.warning("[".concat(n,"] set sink id failed"),f.toString())})}catch(f){O.warning("[".concat(n,"] set sink id failed"),f.toString())}const h=c.play();h&&h.then&&h.catch(f=>{s&&RV(s,"audio",f.message,n),O.warning("audio element play warning",f.toString()),this.elementMap.has(n)&&f.name==="NotAllowedError"&&(O.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(c),Vy(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),bV()}))})}updateTrack(o,n){const r=this.elementMap.get(o);r&&(r.srcObject=new MediaStream([n]))}isPlaying(o){return this.elementMap.has(o)&&this.elementStateMap.get(o)==="playing"}setVolume(o,n){const r=this.elementMap.get(o);r&&(n=Math.max(0,Math.min(100,n)),r.volume=n/100)}stop(o){const n=this.elementMap.get(o);if(this.sinkIdMap.delete(o),!n)return;const r=this.elementsNeedToResume.indexOf(n);this.elementsNeedToResume.splice(r,1),n.srcObject=null,n.remove(),this.elementMap.delete(o),this.elementStateMap.delete(o)}bindAudioElementEvents(o,n){loe.forEach(r=>{n.addEventListener(r,s=>{const c=this.elementStateMap.get(o),d=s.type==="pause"?"paused":s.type;if(O.debug("[".concat(o,"] audio-element-status change ").concat(c," => ").concat(d)),s.type==="error"){const h=n==null?void 0:n.error;h&&O.error("[".concat(o,"] media error, code: ").concat(h.code,", message: ").concat(h.message))}this.elementStateMap.set(o,d)})})}getPlayerState(o){return this.elementStateMap.get(o)||"uninit"}autoResumeAudioElement(){const o=()=>{this.elementsNeedToResume.forEach(n=>{n.play().then(r=>{O.debug("Auto resume audio element success")}).catch(r=>{O.warning("Auto resume audio element failed!",r)})}),this.elementsNeedToResume=[]};new ae(n=>{document.body?n():window.addEventListener("load",()=>n())}).then(()=>{vg()?document.body.addEventListener("click",o,!0):(document.body.addEventListener("touchstart",o,!0),document.body.addEventListener("mousedown",o,!0))})}};function Fn(){return function(o,n,r){const s=r.value;return typeof s=="function"&&(r.value=function(){this._isClosed&&new he(B.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",O);for(var c=arguments.length,d=new Array(c),h=0;h<c;h++)d[h]=arguments[h];const f=s.apply(this,d);return f instanceof ae?new ae((g,_)=>{f.then(g).catch(_)}):f}),r}}function IV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function g0(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?IV(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):IV(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class AV extends mn{constructor(n){super(),I(this,"name","VideoProcessorDestination"),I(this,"ID","0"),I(this,"_source",void 0),I(this,"videoContext",void 0),I(this,"inputTrack",void 0),this.videoContext=n}get kind(){return"video"}get enabled(){return!0}pipe(){throw new he(B.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new he(B.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(n){if(n.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);n.track&&n.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=n.track,this.emit(fi.ON_TRACK,n.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(fi.ON_TRACK,void 0)}}class OV extends mn{set chained(n){this._chained=n}get chained(){return this._chained}constructor(n,r){super(),I(this,"constraintsMap",new Map),I(this,"statsRegistry",[]),I(this,"usageRegistry",[]),I(this,"trackId",void 0),I(this,"direction",void 0),I(this,"_chained",!1),this.trackId=n,this.direction=r}async getConstraints(){return await nr(this,to.REQUEST_CONSTRAINTS)}async requestApplyConstraints(n,r){var s;return O.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),n&&this.constraintsMap.set(r,n),Xt(this,to.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ia(s=this.constraintsMap).call(s)))}async requestRevertConstraints(n){var r;if(this.constraintsMap.has(n))return O.info("processor ".concat(n.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(n),Xt(this,to.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ia(r=this.constraintsMap).call(r)))}registerStats(n,r,s){this.statsRegistry.find(c=>c.processorID===n.ID&&c.processorName===n.name&&c.type===r)||this.statsRegistry.push({processorName:n.name,processorID:n.ID,type:r,cb:s})}unregisterStats(n,r){const s=this.statsRegistry.findIndex(c=>c.processorID===n.ID&&c.processorName===n.name&&c.type===r);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const n=[];for(const{processorID:r,processorName:s,type:c,cb:d}of this.statsRegistry)try{const h=d();n.push({processorID:r,processorName:s,type:c,stats:h})}catch(h){O.error(new he(B.UNEXPECTED_ERROR,h.message))}return n}registerUsage(n,r){this.usageRegistry.find(s=>s.processorID===n.ID&&s.processorName===n.name)||this.usageRegistry.push({processorID:n.ID,processorName:n.name,cb:r})}unregisterUsage(n){const r=this.usageRegistry.findIndex(s=>s.processorID===n.ID&&s.processorName===n.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const n=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let s=r();s instanceof ae&&(s=await s),n.push(g0(g0({},s),{},{direction:this.direction}))}catch(s){O.error("gather extension usage error",s)}return n}getDirection(){return this.direction}}class NV extends mn{constructor(n){super(),I(this,"name","AudioProcessorDestination"),I(this,"ID","0"),I(this,"inputTrack",void 0),I(this,"inputNode",void 0),I(this,"audioProcessorContext",void 0),I(this,"_source",void 0),this.audioProcessorContext=n}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new he(B.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new he(B.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(fi.ON_TRACK,void 0),this.emit(fi.ON_NODE,void 0)}updateInput(n){if(n.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);n.track&&this.inputTrack!==n.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=n.track,this.emit(fi.ON_TRACK,this.inputTrack)),n.node&&this.inputNode!==n.node&&(this.audioProcessorContext.chained=!0,this.inputNode=n.node,this.emit(fi.ON_NODE,this.inputNode))}}class PV extends mn{set chained(n){this._chained=n}get chained(){return this._chained}constructor(n,r,s){super(),I(this,"constraintsMap",new Map),I(this,"statsRegistry",[]),I(this,"audioContext",void 0),I(this,"trackId",void 0),I(this,"direction",void 0),I(this,"usageRegistry",[]),I(this,"_chained",!1),this.audioContext=n,this.trackId=r,this.direction=s}async getConstraints(){return nr(this,to.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(n,r){var s;return O.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),n&&this.constraintsMap.set(r,n),Xt(this,to.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ia(s=this.constraintsMap).call(s)))}async requestRevertConstraints(n){var r;if(this.constraintsMap.has(n))return this.constraintsMap.delete(n),Xt(this,to.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ia(r=this.constraintsMap).call(r)))}registerStats(n,r,s){this.statsRegistry.find(c=>c.processorID===n.ID&&c.processorName===n.name&&c.type===r)||this.statsRegistry.push({processorName:n.name,processorID:n.ID,type:r,cb:s})}unregisterStats(n,r){const s=this.statsRegistry.findIndex(c=>c.processorID===n.ID&&c.processorName===n.name&&c.type===r);s!==-1&&this.statsRegistry.splice(s,1)}gatherStats(){const n=[];for(const{processorID:r,processorName:s,type:c,cb:d}of this.statsRegistry)try{const h=d();n.push({processorID:r,processorName:s,type:c,stats:h})}catch(h){O.error(new he(B.UNEXPECTED_ERROR,h.message))}return n}registerUsage(n,r){this.usageRegistry.find(s=>s.processorID===n.ID&&s.processorName===n.name)||this.usageRegistry.push({processorID:n.ID,processorName:n.name,cb:r})}unregisterUsage(n){const r=this.usageRegistry.findIndex(s=>s.processorID===n.ID&&s.processorName===n.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const n=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let s=r();s instanceof ae&&(s=await s),n.push(g0(g0({},s),{},{direction:this.direction}))}catch(s){O.error("gather extension usage error",s)}return n}getDirection(){return this.direction}}class sA extends mn{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),I(this,"context",void 0),I(this,"processSourceNode",void 0),I(this,"outputTrack",void 0),I(this,"processedNode",void 0),I(this,"clonedTrack",void 0),I(this,"outputNode",void 0),this.outputNode=new doe}setVolume(){}createOutputTrack(){throw new he(B.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class doe{disconnect(){}connect(){}}function kV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function aA(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?kV(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):kV(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class Gt extends Zr{get _source(){return this.initWebAudio()}set _source(n){this._trackSource=n}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?Vi.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(n,r,s,c){super(n,s),I(this,"trackMediaType","audio"),I(this,"_encoderConfig",void 0),I(this,"_trackSource",void 0),I(this,"_enabled",!0),I(this,"_volume",100),I(this,"_useAudioElement",!0),I(this,"_bypassWebAudio",!1),I(this,"processor",void 0),I(this,"_processorContext",void 0),I(this,"_processorDestination",void 0),I(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=r,this._getOriginVolumeLevel=!!c,this._trackSource=new sA,Y("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),Y("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),Fr()&&!zo?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(n){Yt(n,"volume",0,1e3),this._volume=n,this._source.setVolume(n/100),this._useAudioElement&&Vi.setVolume(this.getTrackId(),n);try{if(this._bypassWebAudio)return void O.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const r=this._source.createOutputTrack();this._mediaStreamTrack!==r&&(this._mediaStreamTrack=r,Xt(this,ke.NEED_REPLACE_TRACK,this).then(()=>{O.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(s=>{O.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),s)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(n){if(!this._useAudioElement||!Hc()&&Y("RESTRICTION_SET_PLAYBACK_DEVICE"))throw new he(B.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Vi.setSinkID(this.getTrackId(),n)}async setEnabled(n,r,s){return this._setEnabled(n,r,s)}async _setEnabled(n,r,s){if(!s){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(O.info("[".concat(this.getTrackId(),"] start setEnabled"),n),n){this._originMediaStreamTrack.enabled=!0;try{s||(this._enabled=!0),await Xt(this,ke.NEED_ENABLE_TRACK,this),O.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(n," success"))}catch(c){throw s||(this._enabled=!1),O.error("[".concat(this.getTrackId(),"] setEnabled to true error"),c.toString()),c}}else{this._originMediaStreamTrack.enabled=!1,s||(this._enabled=!1);try{await Xt(this,ke.NEED_DISABLE_TRACK,this)}catch(c){throw s||(this._enabled=!0),O.error("[".concat(this.getTrackId(),"] setEnabled to false error"),c.toString()),c}}}async setMuted(n){n!==this._muted&&(this.stateCheck("muted",n),this._muted=n,this._originMediaStreamTrack.enabled=!n,O.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(n)),n?await Xt(this,ke.NEED_MUTE_TRACK,this):await Xt(this,ke.NEED_UNMUTE_TRACK,this))}getStats(){return bp(()=>{O.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),yo(this,ke.GET_STATS)||aA({},ZI)}setAudioFrameCallback(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!n)return this._source.removeAllListeners(eo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(r),this._source.removeAllListeners(eo.ON_AUDIO_BUFFER),this._source.on(eo.ON_AUDIO_BUFFER,s=>n(s))}play(){O.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(O.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Vi.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){O.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Vi.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let n=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];O.debug("[".concat(this.getTrackId(),"] update player source track")),n&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Vi.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(n,r){this._originMediaStreamTrack!==n&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),r&&this._originMediaStreamTrack.stop()),n.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=n,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:n,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Xt(this,ke.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(n))}renewMediaStreamTrack(n){return ae.resolve(void 0)}pipe(n){if(this._bypassWebAudio)throw new he(B.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===n)return n;if(n._source)throw new he(B.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),n}unpipe(){var n;if(!this.processor)return;const r=this.processor;(n=this._source.processSourceNode)===null||n===void 0||n.disconnect(),this.processor._source=!1,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(n){n.on(fi.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(r),await Xt(this,ke.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Xt(this,ke.NEED_REPLACE_TRACK,this))}),n.on(fi.ON_NODE,r=>{this._source.processedNode=r})}unbindProcessorDestinationEvents(n){n.removeAllListeners(fi.ON_TRACK),n.removeAllListeners(fi.ON_NODE)}bindProcessorContextEvents(n){n.on(to.REQUEST_CONSTRAINTS,async r=>{r(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(n){n.removeAllListeners(to.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof sA&&(this._trackSource=new _V(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const n=new PV(this._source.context,this.getTrackId(),"local"),r=new NV(n);return this._processorContext=n,this._processorDestination=r,this.bindProcessorContextEvents(n),this.bindProcessorDestinationEvents(r),this._source.on(eo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:n})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(Vi.stop(this.getTrackId()),this._source.play()),Xt(this,ke.NEED_REPLACE_MIXING_TRACK,this).then(()=>{O.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(s=>{O.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),s)})),{processorContext:n,processorDestination:r}}}fe([Je({argsMap:(o,n)=>[o.getTrackId(),n],throttleTime:300}),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],Gt.prototype,"setVolume",null),fe([Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],Gt.prototype,"setPlaybackDevice",null),fe([wp("LocalAudioTrack","_enabledMutex"),Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[Boolean,Object,Boolean]),j("design:returntype",ae)],Gt.prototype,"setEnabled",null),fe([wp("LocalAudioTrack","_enabledMutex"),Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[Boolean]),j("design:returntype",ae)],Gt.prototype,"setMuted",null),fe([Fn(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",Object)],Gt.prototype,"getStats",null),fe([Fn(),j("design:type",Function),j("design:paramtypes",[Object,Number]),j("design:returntype",void 0)],Gt.prototype,"setAudioFrameCallback",null),fe([Je({argsMap:o=>[o.getTrackId()]}),Fn(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Gt.prototype,"play",null),fe([Je({argsMap:o=>[o.getTrackId()]}),Fn(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Gt.prototype,"stop",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Gt.prototype,"close",null),fe([Je({argsMap:(o,n)=>[o.getTrackId(),n.name]}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",Object)],Gt.prototype,"pipe",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Gt.prototype,"unpipe",null);class Fu extends Gt{get __className__(){return"MicrophoneAudioTrack"}constructor(n,r,s,c){super(n,r.encoderConfig?f0(r.encoderConfig):{},c,Y("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),I(this,"_config",void 0),I(this,"_deviceName","default"),I(this,"_constraints",void 0),I(this,"_originalConstraints",void 0),I(this,"_enabled",!0),this._config=r,this._constraints=s,this._originalConstraints=s,this._deviceName=n.label,typeof r.bypassWebAudio=="boolean"&&(this._bypassWebAudio=r.bypassWebAudio),(Ep()||XR())&&zt.bindInterruptDetectorTrack(this)}async setDevice(n){if(O.info("[".concat(this.getTrackId(),"] start set device to ").concat(n)),this._enabled)try{const r=await Ho.getDeviceById(n),s={};s.audio=aA({},this._constraints),s.audio.deviceId={exact:n},this._originMediaStreamTrack.stop();let c=null;try{c=await Go(s,this.getTrackId())}catch(d){throw O.error("[".concat(this.getTrackId(),"] setDevice failed"),d.toString()),c=await Go({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!1),d}await this._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!1),this._deviceName=r.label,this._config.microphoneId=n,this._constraints.deviceId={exact:n}}catch(r){throw O.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{const r=await Ho.getDeviceById(n);this._deviceName=r.label,this._config.microphoneId=n,this._constraints.deviceId={exact:n}}catch(r){throw O.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}O.info("[".concat(this.getTrackId(),"] set device to ").concat(n," success"))}async setEnabled(n,r,s){if(r)return O.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(n);if(!s){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(O.info("[".concat(this.getTrackId(),"] start setEnabled"),n),!n){var c;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(c=this._source.clonedTrack)===null||c===void 0||c.stop(),s||(this._enabled=!1);try{await Xt(this,ke.NEED_DISABLE_TRACK,this)}catch(f){throw O.error("[".concat(this.getTrackId(),"] setEnabled false failed"),f.toString()),f}return}const d=aA({},this._constraints),h=Ho.searchDeviceIdByName(this._deviceName);h&&!d.deviceId&&(d.deviceId=h);try{s||(this._enabled=!0);const f=await Go({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(f.getAudioTracks()[0],!1),await Xt(this,ke.NEED_ENABLE_TRACK,this)}catch(f){throw s||(this._enabled=!1),O.error("[".concat(this.getTrackId(),"] setEnabled true failed"),f.toString()),f}O.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(Ep()||XR())&&zt.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((Ti()||Qa())&&this._enabled&&!this._isClosed&&zt.duringInterruption){const n=async()=>{zt.off(Cr.IOS_INTERRUPTION_END,n),this._enabled&&!this._isClosed&&(O.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};zt.on(Cr.IOS_INTERRUPTION_END,n)}else O.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(hd.TRACK_ENDED)}async renewMediaStreamTrack(n){const r=n||this._constraints,s=Ho.searchDeviceIdByName(this._deviceName);if(s&&!r.deviceId&&(r.deviceId=s),this._constraints=r,this._enabled){this._originMediaStreamTrack.stop();const c=await Go({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!0)}}bindProcessorContextEvents(n){super.bindProcessorContextEvents(n),n.on(to.REQUEST_UPDATE_CONSTRAINTS,async(r,s,c)=>{try{const d=Object.assign({},this._originalConstraints,...r);await this.renewMediaStreamTrack(d),s()}catch(d){c(d)}})}unbindProcessorContextEvents(n){super.unbindProcessorContextEvents(n),n.removeAllListeners(to.REQUEST_UPDATE_CONSTRAINTS)}}fe([Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],Fu.prototype,"setDevice",null),fe([wp("MicrophoneAudioTrack","_enabledMutex"),Je({argsMap:(o,n,r)=>[o.getTrackId(),n,r]}),Fn(),j("design:type",Function),j("design:paramtypes",[Boolean,Boolean,Boolean]),j("design:returntype",ae)],Fu.prototype,"setEnabled",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Fu.prototype,"close",null);class fd extends Gt{get __className__(){return"BufferSourceAudioTrack"}constructor(n,r,s,c){super(r.createOutputTrack(),s,c),I(this,"source",void 0),I(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=n,this._bufferSource=r,this._bufferSource.on(eo.AUDIO_SOURCE_STATE_CHANGE,d=>{this.safeEmit(hd.SOURCE_STATE_CHANGE,d)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(n){n&&this._bufferSource.updateOptions(n),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(n){this._bufferSource.seekAudioBuffer(n)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(n){Yt(n,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(n)}}fe([Je({argsMap:(o,n)=>[o.getTrackId(),n,o.duration]}),Fn(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",void 0)],fd.prototype,"startProcessAudioBuffer",null),fe([Je({argsMap:o=>[o.getTrackId()]}),Fn(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],fd.prototype,"pauseProcessAudioBuffer",null),fe([Je({argsMap:o=>[o.getTrackId()]}),Fn(),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],fd.prototype,"seekAudioBuffer",null),fe([Je({argsMap:o=>[o.getTrackId()]}),Fn(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],fd.prototype,"resumeProcessAudioBuffer",null),fe([Je({argsMap:o=>[o.getTrackId()]}),Fn(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],fd.prototype,"stopProcessAudioBuffer",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],fd.prototype,"close",null),fe([Je({argsMap:o=>[o.getTrackId()]}),Fn(),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],fd.prototype,"setAudioBufferPlaybackSpeed",null);class lr extends Gt{get __className__(){return"MixingAudioTrack"}get isActive(){for(const n of this.trackList)if(n._enabled&&!n._isClosed&&!n.muted)return!0;return!1}constructor(){const n=Mp().createMediaStreamDestination();super(n.stream.getAudioTracks()[0],void 0,Qt(8,"track-mix-")),I(this,"trackList",void 0),I(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=n,this.trackList=[]}hasAudioTrack(n){return this.trackList.indexOf(n)!==-1}addAudioTrack(n){this.trackList.indexOf(n)===-1?(O.debug("add ".concat(n.getTrackId()," to mixing track")),n._source.outputNode.connect(this.destNode),this.trackList.push(n),this.updateEncoderConfig()):O.debug("track ".concat(n.getTrackId()," is already added"))}removeAudioTrack(n){if(this.trackList.indexOf(n)!==-1){O.debug("remove ".concat(n.getTrackId()," from mixing track"));try{n._source.outputNode.disconnect(this.destNode)}catch{}Fy(this.trackList,n),this.updateEncoderConfig()}}updateEncoderConfig(){const n={};this.trackList.forEach(r=>{r._encoderConfig&&((r._encoderConfig.bitrate||0)>(n.bitrate||0)&&(n.bitrate=r._encoderConfig.bitrate),(r._encoderConfig.sampleRate||0)>(n.sampleRate||0)&&(n.sampleRate=r._encoderConfig.sampleRate),(r._encoderConfig.sampleSize||0)>(n.sampleSize||0)&&(n.sampleSize=r._encoderConfig.sampleSize),r._encoderConfig.stereo&&(n.stereo=!0))}),this._encoderConfig=n}_updateRtpTransceiver(n){this._rtpTransceiver!==n&&(this._rtpTransceiver=n,this.trackList.forEach(r=>{r instanceof lr?r.emit(ud.TRANSCEIVER_UPDATED,n):r._updateRtpTransceiver(n)}))}}function _0(o){const n={};o.facingMode&&(n.facingMode=o.facingMode),o.cameraId&&(n.deviceId={exact:o.cameraId});const r=ic(o.encoderConfig);return r.width!=null&&(n.width=r.width),r.height!=null&&(n.height=r.height),!uj()&&r.frameRate&&(n.frameRate=r.frameRate),xt().name===Ft.EDGE&&typeof n.frameRate=="object"&&(n.frameRate.max=60),Jt()&&(n.frameRate={ideal:30,max:30}),n}function DV(o){const n={};if(uj()||(o.AGC!==void 0&&(n.autoGainControl=o.AGC),o.AEC!==void 0&&(n.echoCancellation=o.AEC),o.ANS!==void 0&&(n.noiseSuppression=o.ANS,Hc()&&o.ANS&&(n.googHighpassFilter=o.ANS))),o.encoderConfig){const r=f0(o.encoderConfig);n.channelCount=r.stereo?2:1,n.sampleRate=r.sampleRate,n.sampleSize=r.sampleSize}return o.microphoneId&&(n.deviceId={exact:o.microphoneId}),Uy()&&(n.sampleRate=void 0),n}class uoe extends gV{set currentState(n){n!==this._currentState&&(this._currentState=n,this.safeEmit(eo.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),I(this,"audioBuffer",void 0),I(this,"sourceNode",void 0),I(this,"startPlayTime",0),I(this,"startPlayOffset",0),I(this,"pausePlayTime",0),I(this,"options",void 0),I(this,"currentLoopCount",0),I(this,"currentPlaybackSpeed",100),I(this,"_currentState","stopped"),this.audioBuffer=n,this.options=r,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(n){this.currentState==="stopped"?(this.options=n,this.startPlayOffset=this.options.startPlayTime||0):O.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(n){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=n,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=n))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(n){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=n/100),this.currentPlaybackSpeed=n}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const n=this.context.createBufferSource();return n.buffer=this.audioBuffer,n.loop=!!this.options.loop,n.connect(this.outputNode),n.playbackRate.value=this.currentPlaybackSpeed/100,n}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const xV=new Map;async function hoe(o,n){let r=null;if(typeof o=="string"){const c=xV.get(o);if(c)return O.debug("use cached audio resource: ",o),c;try{r=(await Ra(()=>Qi.get(o,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(d){throw new he(B.FETCH_AUDIO_FILE_FAILED,d.toString())}}else r=await new ae((d,h)=>{const f=new FileReader;f.onload=g=>{g.target?d(g.target.result):h(new he(B.READ_LOCAL_AUDIO_FILE_ERROR))},f.onerror=()=>{h(new he(B.READ_LOCAL_AUDIO_FILE_ERROR))},f.readAsArrayBuffer(o)});const s=await function(c){const d=Mp();return new ae((h,f)=>{d.decodeAudioData(c,g=>{h(g)},g=>{f(new he(B.DECODE_AUDIO_FILE_FAILED,g.toString()))})})}(r);return typeof o=="string"&&n&&xV.set(o,s),s}const cA=o=>{const n=document.createElement("canvas");return n.width=2,n.height=2,new ae((r,s)=>{n.toBlob(async c=>{if(n.remove(),c){const d=await LV(c);r({buffer:d,width:n.width,height:n.height})}else s(new he(B.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},o,1)})},LV=async o=>{const n=await o.arrayBuffer();return new Uint8Array(n)};function MV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function UV(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?MV(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):MV(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class lA{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(n){n!==this._videoElementStatus&&(O.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(n)),this._videoElementStatus=n)}get videoState(){return this._videoState}set videoState(n){var r;n!==this._videoState&&(O.debug("[".concat(this.trackId,"] video-status change ").concat(this._videoState," => ").concat(n)),this._videoState=n,(r=this.onVideoStateChanged)===null||r===void 0||r.call(this,this.videoState))}constructor(n){I(this,"trackId",void 0),I(this,"config",void 0),I(this,"onFirstVideoFrameDecoded",void 0),I(this,"onVideoStateChanged",void 0),I(this,"freezeTimeCounterList",[]),I(this,"renderFreezeAccTime",0),I(this,"isKeepLastFrame",!1),I(this,"timeUpdatedCount",0),I(this,"freezeTime",0),I(this,"playbackTime",0),I(this,"lastTimeUpdatedTime",0),I(this,"autoplayFailed",!1),I(this,"videoTrack",void 0),I(this,"videoElement",void 0),I(this,"cacheVideoElement",void 0),I(this,"_videoState",Ks.VideoStateStopped),I(this,"videoElementCheckInterval",void 0),I(this,"videoElementFreezeTimeout",void 0),I(this,"_videoElementStatus",mi.NONE),I(this,"isGettingVideoDimensions",!1),I(this,"startGetVideoDimensions",()=>{const r=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return O.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(r,500)};!this.isGettingVideoDimensions&&r()}),I(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&zt.curState==="running"&&(O.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(ij())),lj()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),I(this,"handleVideoEvents",r=>{switch(r.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=mi.PLAYING;break;case"loadeddata":if(this.videoState=Ks.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=mi.CANPLAY;break;case"stalled":this.videoElementStatus=mi.STALLED;break;case"suspend":this.videoElementStatus=mi.SUSPEND;break;case"pause":this.videoElementStatus=mi.PAUSED,Ti()||Qa()||Fr()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(O.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=mi.WAITING;break;case"abort":this.videoElementStatus=mi.ABORT;break;case"ended":this.videoElementStatus=mi.ENDED;break;case"emptied":this.videoElementStatus=mi.EMPTIED;break;case"error":{this.videoElementStatus=mi.ERROR;const s=this.videoElement.error;s&&O.error("[".concat(this.trackId,"] media error, code: ").concat(s.code,", message: ").concat(s.message));break}case"timeupdate":{const s=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=s);const c=s-this.lastTimeUpdatedTime,d=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=s,nl.lastVisibleTime<nl.lastHiddenTime||d<nl.lastHiddenTime||d<nl.lastVisibleTime)return;for(c>Y("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=c),this.playbackTime+=c;this.playbackTime>=6e3;){this.playbackTime-=6e3;const h=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(h),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),I(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(O.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(ij())),lj()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=n.trackId,this.config=n,n.element instanceof HTMLVideoElement?this.videoElement=n.element:this.videoElement=document.createElement("video"),zt.on(Cr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),zt.on(Cr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var n;return(n=this.videoElement.parentElement)!==null&&n!==void 0?n:void 0}updateConfig(n){this.config=n,this.trackId=n.trackId,n.element!==this.videoElement&&(this.destroy(),this.videoElement=n.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(n){this.videoTrack!==n&&(this.videoTrack=n,this.initVideoElement())}play(n){const r=this.videoElement.play();r&&r.catch&&r.catch(c=>{n&&RV(n,"video",c.message,this.trackId),c.name==="NotAllowedError"?(O.warning("detected video element autoplay failed",c),this.autoplayFailed=!0,this.handleAutoPlayFailed()):O.warning("[".concat(this.trackId,"] play warning: "),c)});const s=xt();if((s.name==="Safari"&&Number(s.version)===15||Ep())&&r&&r.then){const c=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};r.then(c).catch(c)}}getCurrentFrame(){const n=document.createElement("canvas");n.width=this.videoElement.videoWidth,n.height=this.videoElement.videoHeight;const r=n.getContext("2d");if(!r)return O.error("create canvas context failed!"),new ImageData(2,2);r.drawImage(this.videoElement,0,0,n.width,n.height);const s=r.getImageData(0,0,n.width,n.height);return n.remove(),s}async getCurrentFrameToUint8Array(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const s=document.createElement("canvas");s.width=this.videoElement.videoWidth,s.height=this.videoElement.videoHeight;const c=s.getContext("2d");return c?(c.drawImage(this.videoElement,0,0,s.width,s.height),new ae((d,h)=>{s.toBlob(async f=>{if(s.remove(),f){const g=await LV(f);d({buffer:g,width:s.width,height:s.height})}else h(new he(B.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},n,r<0?.1:r>1?1:r)})):await cA(n)}destroy(){zt.off(Cr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),zt.off(Cr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=Ks.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=mi.INIT,!this.videoElementCheckInterval&&(jV.forEach(d=>{this.videoElement.addEventListener(d,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(d){return d!==document.body&&document.body.contains(d)})(this.videoElement)||(this.videoElementStatus=mi.DESTROYED)},1e3),Y("ENABLE_VIDEO_FRAME_CALLBACK"))){var n,r;let d;const h=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",h),this.videoElementFreezeTimeout=window.setTimeout(f,Y("VIDEO_FREEZE_DURATION")))},f=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===Ks.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=Ks.VideoStateFrozen:document.addEventListener("visibilitychange",h))},g=(_,E)=>{if(this.videoElementStatus===mi.PLAYING){if(d){const A=E.presentationTime-d.presentationTime;this.videoState===Ks.VideoStateStarting&&(this.videoState=Ks.VideoStateDecoding),this.videoState===Ks.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(f,Y("VIDEO_FREEZE_DURATION"))),A<Y("VIDEO_FREEZE_DURATION")&&this.videoState===Ks.VideoStateFrozen&&(this.videoState=Ks.VideoStateDecoding),A>Y("VIDEO_FREEZE_DURATION")&&nl.lastVisibleTime>=nl.lastHiddenTime&&d.timestamp>nl.lastVisibleTime&&d.timestamp>nl.lastHiddenTime&&(this.renderFreezeAccTime+=A)}d=UV(UV({},E),{},{timestamp:_})}var T,w;Y("ENABLE_VIDEO_FRAME_CALLBACK")&&((T=(w=this.videoElement).requestVideoFrameCallback)===null||T===void 0||T.call(w,g))};(n=(r=this.videoElement).requestVideoFrameCallback)===null||n===void 0||n.call(r,g)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),Uy()&&(this.videoElement.poster="noposter");const s=xt();s.name==="Safari"&&Number(s.version)===15||Ep()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Jt()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Jt()&&this.videoElement.load());const c=this.videoElement.play();c!==void 0&&c.catch(d=>{O.debug("[".concat(this.trackId,"] playback interrupted"),d.toString())})}resetVideoElement(){jV.forEach(n=>{this.videoElement&&this.videoElement.removeEventListener(n,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=mi.NONE}handleAutoPlayFailed(){const n=r=>{r.preventDefault(),this.videoElement.play().then(()=>{O.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(s=>{O.error(s)}),this.autoplayFailed=!1,vg()?document.body.removeEventListener("click",n,!0):(document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0))};vg()?document.body.addEventListener("click",n,!0):(document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)),bV()}}const jV=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class FV extends lA{constructor(n){super(n),I(this,"container",void 0),I(this,"slot",void 0),this.slot=n.element,this.updateConfig(n)}updateConfig(n){this.config=n,this.trackId=n.trackId;const r=n.element;r!==this.slot&&(this.destroy(),this.slot=r),this.createElements()}updateVideoTrack(n){this.videoTrack!==n&&(this.videoTrack=n,this.createElements())}play(n){var r;(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)&&super.play(n)}getCurrentFrame(){var n;return(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(n){var r;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(n,s):await cA(n)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",Y("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var n;!this.container||(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var n;if((n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var n;(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}function VV(o){return new ae((n,r)=>{let s=!1;const c=document.createElement("video");c.setAttribute("autoplay",""),c.setAttribute("muted",""),c.muted=!0,c.autoplay=!0,c.setAttribute("playsinline",""),c.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(c);const d=Ti()?"canplay":"playing";c.addEventListener(d,()=>{const h=c.videoWidth,f=c.videoHeight;!h&&Jt()||(s=!0,c.srcObject=null,c.remove(),n([h,f]))}),c.srcObject=new MediaStream([o]),c.play().catch(By),setTimeout(()=>{s||(c.srcObject=null,c.remove(),n([c.videoWidth,c.videoHeight]))},4e3)})}const poe=async(o,n,r)=>{const s=function(h){const f=[];for(let g=0;g<h.length;g+=2)f.push(parseInt(h.slice(g,g+2),16));return Uint8Array.from(f)}(function(h){const f="0123456789abcdef";function g(Se){let Ae,st="";for(Ae=0;Ae<=3;Ae++)st+=f.charAt(Se>>8*Ae+4&15)+f.charAt(Se>>8*Ae&15);return st}function _(Se,Ae){const st=(65535&Se)+(65535&Ae);return(Se>>16)+(Ae>>16)+(st>>16)<<16|65535&st}function E(Se,Ae,st,gt,nn,dr){return _(function(un,Ro){return un<<Ro|un>>>32-Ro}(_(_(Ae,Se),_(gt,dr)),nn),st)}function T(Se,Ae,st,gt,nn,dr,un){return E(Ae&st|~Ae&gt,Se,Ae,nn,dr,un)}function w(Se,Ae,st,gt,nn,dr,un){return E(Ae&gt|st&~gt,Se,Ae,nn,dr,un)}function A(Se,Ae,st,gt,nn,dr,un){return E(Ae^st^gt,Se,Ae,nn,dr,un)}function L(Se,Ae,st,gt,nn,dr,un){return E(st^(Ae|~gt),Se,Ae,nn,dr,un)}const P=function(Se){let Ae;const st=1+(Se.length+8>>6),gt=new Array(16*st);for(Ae=0;Ae<16*st;Ae++)gt[Ae]=0;for(Ae=0;Ae<Se.length;Ae++)gt[Ae>>2]|=Se.charCodeAt(Ae)<<Ae%4*8;return gt[Ae>>2]|=128<<Ae%4*8,gt[16*st-2]=8*Se.length,gt}(h);let D,G,$,X,ie,Q=1732584193,te=-271733879,ce=-1732584194,le=271733878;for(D=0;D<P.length;D+=16)G=Q,$=te,X=ce,ie=le,Q=T(Q,te,ce,le,P[D+0],7,-680876936),le=T(le,Q,te,ce,P[D+1],12,-389564586),ce=T(ce,le,Q,te,P[D+2],17,606105819),te=T(te,ce,le,Q,P[D+3],22,-1044525330),Q=T(Q,te,ce,le,P[D+4],7,-176418897),le=T(le,Q,te,ce,P[D+5],12,1200080426),ce=T(ce,le,Q,te,P[D+6],17,-1473231341),te=T(te,ce,le,Q,P[D+7],22,-45705983),Q=T(Q,te,ce,le,P[D+8],7,1770035416),le=T(le,Q,te,ce,P[D+9],12,-1958414417),ce=T(ce,le,Q,te,P[D+10],17,-42063),te=T(te,ce,le,Q,P[D+11],22,-1990404162),Q=T(Q,te,ce,le,P[D+12],7,1804603682),le=T(le,Q,te,ce,P[D+13],12,-40341101),ce=T(ce,le,Q,te,P[D+14],17,-1502002290),te=T(te,ce,le,Q,P[D+15],22,1236535329),Q=w(Q,te,ce,le,P[D+1],5,-165796510),le=w(le,Q,te,ce,P[D+6],9,-1069501632),ce=w(ce,le,Q,te,P[D+11],14,643717713),te=w(te,ce,le,Q,P[D+0],20,-373897302),Q=w(Q,te,ce,le,P[D+5],5,-701558691),le=w(le,Q,te,ce,P[D+10],9,38016083),ce=w(ce,le,Q,te,P[D+15],14,-660478335),te=w(te,ce,le,Q,P[D+4],20,-405537848),Q=w(Q,te,ce,le,P[D+9],5,568446438),le=w(le,Q,te,ce,P[D+14],9,-1019803690),ce=w(ce,le,Q,te,P[D+3],14,-187363961),te=w(te,ce,le,Q,P[D+8],20,1163531501),Q=w(Q,te,ce,le,P[D+13],5,-1444681467),le=w(le,Q,te,ce,P[D+2],9,-51403784),ce=w(ce,le,Q,te,P[D+7],14,1735328473),te=w(te,ce,le,Q,P[D+12],20,-1926607734),Q=A(Q,te,ce,le,P[D+5],4,-378558),le=A(le,Q,te,ce,P[D+8],11,-2022574463),ce=A(ce,le,Q,te,P[D+11],16,1839030562),te=A(te,ce,le,Q,P[D+14],23,-35309556),Q=A(Q,te,ce,le,P[D+1],4,-1530992060),le=A(le,Q,te,ce,P[D+4],11,1272893353),ce=A(ce,le,Q,te,P[D+7],16,-155497632),te=A(te,ce,le,Q,P[D+10],23,-1094730640),Q=A(Q,te,ce,le,P[D+13],4,681279174),le=A(le,Q,te,ce,P[D+0],11,-358537222),ce=A(ce,le,Q,te,P[D+3],16,-722521979),te=A(te,ce,le,Q,P[D+6],23,76029189),Q=A(Q,te,ce,le,P[D+9],4,-640364487),le=A(le,Q,te,ce,P[D+12],11,-421815835),ce=A(ce,le,Q,te,P[D+15],16,530742520),te=A(te,ce,le,Q,P[D+2],23,-995338651),Q=L(Q,te,ce,le,P[D+0],6,-198630844),le=L(le,Q,te,ce,P[D+7],10,1126891415),ce=L(ce,le,Q,te,P[D+14],15,-1416354905),te=L(te,ce,le,Q,P[D+5],21,-57434055),Q=L(Q,te,ce,le,P[D+12],6,1700485571),le=L(le,Q,te,ce,P[D+3],10,-1894986606),ce=L(ce,le,Q,te,P[D+10],15,-1051523),te=L(te,ce,le,Q,P[D+1],21,-2054922799),Q=L(Q,te,ce,le,P[D+8],6,1873313359),le=L(le,Q,te,ce,P[D+15],10,-30611744),ce=L(ce,le,Q,te,P[D+6],15,-1560198380),te=L(te,ce,le,Q,P[D+13],21,1309151649),Q=L(Q,te,ce,le,P[D+4],6,-145523070),le=L(le,Q,te,ce,P[D+11],10,-1120210379),ce=L(ce,le,Q,te,P[D+2],15,718787259),te=L(te,ce,le,Q,P[D+9],21,-343485551),Q=_(Q,G),te=_(te,$),ce=_(ce,X),le=_(le,ie);return g(Q)+g(te)+g(ce)+g(le)}(""+n+r)).slice(0,16),c=s.slice(0,12),d=await window.crypto.subtle.importKey("raw",s,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:c},d,o))},BV=async(o,n,r)=>await poe(o.buffer,n,r);function WV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function Ko(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?WV(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):WV(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class ht extends Zr{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==mi.PLAYING)}get processorContext(){return this._processorContext}set processorContext(n){this._processorContext=n}get __className__(){return"LocalVideoTrack"}constructor(n,r,s,c,d,h){if(super(n,d),I(this,"trackMediaType","video"),I(this,"_player",void 0),I(this,"isUseScaleResolutionDownBy",!1),I(this,"_videoVisibleTimer",null),I(this,"_statsTimer",null),I(this,"_previousVideoVisibleStatus",void 0),I(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),I(this,"_encoderConfig",void 0),I(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),I(this,"_optimizationMode",void 0),I(this,"_videoHeight",void 0),I(this,"_videoWidth",void 0),I(this,"_forceBitrateLimit",void 0),I(this,"_enabled",!0),I(this,"processorDestination",void 0),I(this,"_processorContext",void 0),Fr()){const{width:f,height:g}=n.getSettings();this._videoWidth=f,this._videoHeight=g}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=r,this._scalabilityMode=s,this._optimizationMode=c,this._hints=h||[],this._hints.indexOf(tn.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(function(f,g,_){const E=xt();return!(E.name!==f||!E.osVersion)&&Number(E.version)===g}(Ft.CHROME,115)&&Ly().indexOf("Windows")!==-1){const f=function(g,_){if("VideoFrame"in window&&"TransformStream"in window&&Lt().supportWebRTCInsertableStream){const E=new MediaStreamTrackProcessor(g),T=new MediaStreamTrackGenerator({kind:"video"});let w,A,L=Date.now();const P=()=>{D&&(clearInterval(D),D=void 0),w&&(w.close(),w=void 0),g.stop(),A=void 0,T.removeEventListener("ended",P)};let D=window.setInterval(()=>{if(A&&w&&Date.now()-L>1e3)try{T.readyState==="live"?A.enqueue(w.clone()):P()}catch{P()}},1e3);const G=new TransformStream({transform:($,X)=>{T.readyState==="live"?(A=X,L=Date.now(),w===void 0?(w=$,X.enqueue($.clone())):(X.enqueue(w),w=$)):$.close()}});return T.addEventListener("ended",P),E.readable.pipeThrough(G).pipeTo(T.writable),T}}(n);f&&(O.info("local screen video track begin to inject frame"),this._mediaStreamTrack=f)}r&&this._hints.indexOf(tn.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(r),this._processorContext=new OV(this.getTrackId(),"local"),this.processorDestination=new AV(this.processorContext),this.bindProcessorDestinationEvents()}play(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="string"){const c=document.getElementById(n);c?n=c:(O.warning("[".concat(this.getTrackId(),'] can not find "#').concat(n,'" element, use document.body')),n=document.body)}O.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(n instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));const s=Ko(Ko(Ko({},this._getDefaultPlayerConfig()),r),{},{trackId:this.getTrackId(),element:n});this._player?this._player.updateConfig(s):(n instanceof HTMLVideoElement?this._player=new lA(s):this._player=new FV(s),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const c=this.getVideoElementVisibleStatus();this.safeEmit(hd.VIDEO_ELEMENT_VISIBLE_STATUS,c)}catch{}},Y("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._statsTimer&&(this.isUseScaleResolutionDownBy=!1,window.clearInterval(this._statsTimer),this._statsTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,O.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(n,r){if(!r){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(O.info("[".concat(this.getTrackId(),"] start setEnabled"),n),!n){this._originMediaStreamTrack.enabled=!1;try{await Xt(this,ke.NEED_DISABLE_TRACK,this)}catch(s){throw O.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}return r||(this._enabled=!1),void O.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await Xt(this,ke.NEED_ENABLE_TRACK,this)}catch(s){throw O.error("[".concat(this.getTrackId(),"] setEnabled to true error"),s.toString()),s}O.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}async setMuted(n){n!==this._muted&&(this.stateCheck("muted",n),this._muted=n,this._originMediaStreamTrack.enabled=!n,O.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(n)),n?await Xt(this,ke.NEED_MUTE_TRACK,this):await Xt(this,ke.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(n,r){if(!this._enabled)throw new he(B.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(n==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),n=ic(n),this._forceBitrateLimit&&(n.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:n.bitrateMax,n.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:n.bitrateMin),n.width||n.height||n.frameRate){const s=_0({encoderConfig:n});(Fr()||Ti()||Qa())&&(s.deviceId=void 0),O.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(n),JSON.stringify(s));try{await this._originMediaStreamTrack.applyConstraints(s),this.updateMediaStreamTrackResolution()}catch(c){const d=new he(B.UNEXPECTED_ERROR,c.toString());throw O.error("[".concat(this.getTrackId(),"] applyConstraints error"),d.toString()),d}}this._encoderConfig=n,this._hints.indexOf(tn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Xt(this,ke.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(O)}}getStats(){return bp(()=>{O.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),yo(this,ke.GET_STATS)||Ko({},eA)}async setBeautyEffect(n){O.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(n,r):await cA(n)}async setBitrateLimit(n){if(O.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(n))),n){this._forceBitrateLimit=n,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<n.max_bitrate?this._encoderConfig.bitrateMax:n.max_bitrate:this._encoderConfig.bitrateMax=n.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=n.min_bitrate);try{await Xt(this,ke.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(O)}}}async setOptimizationMode(n){if(n!=="motion"&&n!=="detail"&&n!=="balanced")return void O.error(B.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const r=this._optimizationMode;try{this._optimizationMode=n,await Xt(this,ke.SET_OPTIMIZATION_MODE,this)}catch(s){throw this._optimizationMode=r,O.error("[".concat(this.getTrackId(),"] set optimization mode failed"),s.toString()),s}O.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(n,")"))}setScalabiltyMode(n){if(n.numSpatialLayers===1&&n.numTemporalLayers!==1)return O.error(B.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=n,O.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(n,")"))}updateMediaStreamTrackResolution(){VV(this._originMediaStreamTrack).then(n=>{let[r,s]=n;this._videoHeight=s,this._videoWidth=r}).catch(By)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(n){if(!this._enabled)throw new he(B.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");O.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(n)),n=ic(n),this._forceBitrateLimit&&(n.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:n.bitrateMax,n.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:n.bitrateMin),this._encoderConfig=n,this._hints.indexOf(tn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Xt(this,ke.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(O)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:n,height:r,frameRate:s}=this.getMediaStreamTrackSettings();if(!n||!r||!s)return;const{bitrateMax:c,bitrateMin:d}=this._encoderConfig;if(d==null||c==null){const{max:h,min:f}=function(g,_,E,T,w){const A=Y("BITRATE_ADAPTER_TYPE");if(A==="DEFAULT_BITRATE")return{min:T,max:w};if(w===void 0){var L;const D=Math.floor(200*Math.pow(E/15,.6)*Math.pow(g*_/640/360,.75));w=A==="STANDARD_BITRATE"?4*D:2*D,T=(L=T)!==null&&L!==void 0?L:D}else{var P;T=(P=T)!==null&&P!==void 0?P:Math.floor(w/10)}return{min:T,max:w}}(n,r,s,d,c);this._encoderConfig.bitrateMin=f,this._encoderConfig.bitrateMax=h,O.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(n,", h: ").concat(r,", fps: ").concat(s,"] => [brMax: ").concat(h,", brMin: ").concat(f,"]"))}}getVideoElementVisibleStatus(){try{var n,r;const s=this==null||(n=this._player)===null||n===void 0?void 0:n.getContainerElement(),c={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:d,slot:h}=c;if(this.isPlaying&&d instanceof HTMLVideoElement&&h instanceof HTMLElement){const f=mj.checkOneElementVisible(d),g=Object.assign({},f);if(g.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=g.visible;const _=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});g.visible?_.onSuccess("Video is visible"):_.onSuccess("Invisible because of ".concat(g.reason))}return g}return}catch(s){throw new he(B.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}async renewMediaStreamTrack(n){}pipe(n){if(this.processor===n)return n;if(n._source)throw new he(B.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),n}unpipe(){if(!this.processor)return;const n=this.processor;this.processor._source=void 0,this.processor=void 0,n.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(n){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;n&&(s=Ko(Ko({},s),ic(n))),s=ku(s);const c=Qt(8,"track-video-cloned-"),d=new ht(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,s,ku(this._scalabilityMode),this._optimizationMode,c,ku(this._hints));return n&&s&&d.setEncoderConfiguration(s),O.debug("clone video track from ".concat(this.getTrackId()," to ").concat(c,", clone ").concat(r)),d}async replaceTrack(n,r){if(!(n instanceof MediaStreamTrack))throw new he(B.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(n.kind!=="video")throw new he(B.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(n,r,!0),this.updateMediaStreamTrackResolution()}startMonitorStats(){if(!Fr()&&!Ti())return;this._statsTimer&&window.clearInterval(this._statsTimer);let n=2,r=h0[n],s=-1,c=Date.now();const d=h=>{h>2||h<0||(c=Date.now(),r=h0[h],this.setSenderConfiguration(r))};this.isUseScaleResolutionDownBy=!0,this._statsTimer=window.setInterval(()=>{const h=this.getStats(),f=yo(this,ke.GET_RTC_STATS);if(h.sendPackets>0&&f){s===-1&&(s=Date.now());const g=Date.now();if(g-s<1e3||g-c<Y("PROFILE_SWITCH_INTERVAL"))return;const _=h.sendFrameRate,E=.6*r.frameRate,T=.9*r.frameRate;typeof _=="number"&&_>0&&_<E?n>0&&(n--,d(n),O.debug("[".concat(this.getTrackId(),"] step down for fps ").concat(_,", switchProfile to ").concat(n))):f.OutgoingAvailableBandwidth<r.bitrateMin?n>0&&(n--,d(n),O.debug("[".concat(this.getTrackId(),"] step down for OutgoingAvailableBandwidth ").concat(f.OutgoingAvailableBandwidth,", bitrateMin ").concat(r.bitrateMin,", switchProfile to ").concat(n))):typeof _=="number"&&_>T&&n<h0.length-1&&f.OutgoingAvailableBandwidth>1.2*h0[n+1].bitrateMin&&(n++,d(n),O.debug("[".concat(this.getTrackId(),"] step up for fps ").concat(_,", OutgoingAvailableBandwidth ").concat(f.OutgoingAvailableBandwidth,", switchProfile to ").concat(n)))}},Y("CHECK_LOCAL_STATS_INTERVAL"))}sendSeiData(n){if(bp(()=>{Be.reportApiInvoke(null,{name:tr.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:yn.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!Y("ENABLE_VIDEO_SEI")||!Y("ENABLE_ENCODED_TRANSFORM"))return void O.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(!(n instanceof Uint8Array))return new he(B.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const r=this.getRTCRtpTransceiver();if(!r)return void O.warning("Video track is not published, SEI can not be send");const s=r.sender.getParameters();if(s.codecs.length===0)return;const c=s.codecs[0].mimeType.toLocaleLowerCase();c==="video/h264"?this.safeEmit("sei-to-send",n):O.warning("SEI is not supported by ".concat(c))}bindProcessorDestinationEvents(){this.processorDestination.on(fi.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource(),await Xt(this,ke.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Xt(this,ke.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(fi.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(to.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(to.REQUEST_CONSTRAINTS)}}fe([Je({argsMap:(o,n,r)=>[o.getTrackId(),typeof n=="string"?n:n instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),Fn(),j("design:type",Function),j("design:paramtypes",[Object,Object]),j("design:returntype",void 0)],ht.prototype,"play",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ht.prototype,"stop",null),fe([wp("LocalVideoTrack","_enabledMutex"),Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[Boolean,Boolean]),j("design:returntype",ae)],ht.prototype,"setEnabled",null),fe([wp("LocalVideoTrack","_enabledMutex"),Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[Boolean]),j("design:returntype",ae)],ht.prototype,"setMuted",null),fe([Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",ae)],ht.prototype,"setEncoderConfiguration",null),fe([Fn(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",Object)],ht.prototype,"getStats",null),fe([Je({argsMap:(o,n,r)=>[o.getTrackId(),n,r]}),Fn(),j("design:type",Function),j("design:paramtypes",[Boolean,Object]),j("design:returntype",ae)],ht.prototype,"setBeautyEffect",null),fe([Fn(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ImageData)],ht.prototype,"getCurrentFrameData",null),fe([Fn(),j("design:type",Function),j("design:paramtypes",[String,Number]),j("design:returntype",ae)],ht.prototype,"getCurrentFrameImage",null),fe([Fn(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],ht.prototype,"setBitrateLimit",null),fe([Fn(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],ht.prototype,"setOptimizationMode",null),fe([Fn(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",void 0)],ht.prototype,"setScalabiltyMode",null),fe([Fn(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ht.prototype,"updateMediaStreamTrackResolution",null),fe([Je({argsMap:(o,n)=>[o.getTrackId(),n.name]}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",Object)],ht.prototype,"pipe",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ht.prototype,"unpipe",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ht.prototype,"close",null),fe([Je({argsMap:(o,n,r)=>[o.getTrackId(),n.label,r]}),j("design:type",Function),j("design:paramtypes",[MediaStreamTrack,Boolean]),j("design:returntype",ae)],ht.prototype,"replaceTrack",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ht.prototype,"startMonitorStats",null);class md extends ht{get __className__(){return"CameraVideoTrack"}constructor(n,r,s,c,d,h){super(n,ic(r.encoderConfig),c,d,h),I(this,"_config",void 0),I(this,"_originalConstraints",void 0),I(this,"_constraints",void 0),I(this,"_enabled",!0),I(this,"_deviceName","default"),I(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(Ep()||XR())&&!function(){const f=xt();if(f.os!==fr.IOS||!f.osVersion)return!1;const g=f.osVersion.split(".");return Number(g[0])===15&&Number(g[1])>=2}()&&dj()&&this._enabled&&!this._isClosed&&(O.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=r,this._originalConstraints=s,this._constraints=s,this._deviceName=n.label,this._encoderConfig=ic(this._config.encoderConfig),zt.on(Cr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),zt.on(Cr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(n){return typeof n=="string"?this._setDeviceById(n):n.deviceId?this._setDeviceById(n.deviceId):n.facingMode?this._setDeviceByFacingModel(n.facingMode):void 0}async _setDeviceById(n){if(O.info("[".concat(this.getTrackId(),"] set device to ").concat(n)),this._enabled)try{const r=await Ho.getDeviceById(n),s={};s.video=Ko({},this._constraints),s.video.deviceId={exact:n},s.video.facingMode=void 0,this._originMediaStreamTrack.stop();let c=null;try{c=await Go(s,this.getTrackId())}catch(d){throw O.error("[".concat(this.getTrackId(),"] setDevice failed"),d.toString()),c=await Go({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),d}await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=r.label,this._config.cameraId=n,this._constraints.deviceId={exact:n}}catch(r){throw O.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{const r=await Ho.getDeviceById(n);this._deviceName=r.label,this._config.cameraId=n,this._constraints.deviceId={exact:n}}catch(r){throw O.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}O.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(n){O.info("[".concat(this.getTrackId(),"] set facingMode ").concat(n));const r={video:Ko(Ko({},this._constraints),{},{deviceId:void 0,facingMode:{exact:n}})};if(this._enabled){this._originMediaStreamTrack.stop();let s=null;try{s=await Go(r,this.getTrackId())}catch(c){throw O.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),c.toString()),s=await Go({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),c}await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=n,this._config.cameraId=void 0,this._constraints=Ko({},r.video),O.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(n,r){if(!r){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(O.info("[".concat(this.getTrackId(),"] start setEnabled"),n),n){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const s=await Go({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(s.getVideoTracks()[0],!1)}await Xt(this,ke.NEED_ENABLE_TRACK,this)}catch(s){throw O.error("[".concat(this.getTrackId(),"] setEnabled true error"),s.toString()),s}this.updateMediaStreamTrackResolution(),O.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),r||(this._enabled=!1);try{await Xt(this,ke.NEED_DISABLE_TRACK,this)}catch(s){throw O.error("[".concat(this.getTrackId(),"] setEnabled to false error"),s.toString()),s}O.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(n,r){if(!this._enabled)throw new he(B.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");n==="720p_auto"?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),n=ic(n),this._forceBitrateLimit&&(n.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:n.bitrateMax,n.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:n.bitrateMin);const s=en(this._config);s.encoderConfig=n;const c=_0(s);(Fr()||Ti()||Qa())&&(c.deviceId=void 0),O.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(n),JSON.stringify(c));try{await this._originMediaStreamTrack.applyConstraints(c),this.updateMediaStreamTrackResolution()}catch(d){const h=new he(B.UNEXPECTED_ERROR,d.toString());throw O.error("[".concat(this.getTrackId(),"] applyConstraints error"),h.toString()),h}this._config=s,this._constraints=c,this._originalConstraints=c,this._encoderConfig=n,this._hints.indexOf(tn.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await Xt(this,ke.NEED_UPDATE_VIDEO_ENCODER,this)}catch(d){return d.throw(O)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((Ti()||Qa())&&this._enabled&&!this._isClosed&&zt.duringInterruption){const n=async()=>{zt.off(Cr.IOS_INTERRUPTION_END,n),this._enabled&&!this._isClosed&&(O.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};zt.on(Cr.IOS_INTERRUPTION_END,n)}else O.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(hd.TRACK_ENDED)}async renewMediaStreamTrack(n){const r=n||this._constraints,s=Ho.searchDeviceIdByName(this._deviceName);if(s&&!r.deviceId&&(r.deviceId={exact:s}),this._enabled){const c=await Go({video:r},this.getTrackId());this._constraints=r,await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),zt.off(Cr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),zt.off(Cr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(n){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],s=this._encoderConfig;n&&(s=Ko(Ko({},s),ic(n))),s=ku(s);const c=Qt(8,"track-cam-cloned-"),d=new md(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,ku(Ko(Ko({},this._config),{},{encoderConfig:s})),ku(this._constraints),ku(this._scalabilityMode),this._optimizationMode,c);return n&&s&&d.setEncoderConfiguration(s),O.debug("clone track from ".concat(this.getTrackId()," to ").concat(c,", clone ").concat(r)),d}bindProcessorContextEvents(){this.processorContext.on(to.REQUEST_UPDATE_CONSTRAINTS,async(n,r,s)=>{try{const c=Object.assign({},this._originalConstraints,...n);await this.renewMediaStreamTrack(c),r()}catch(c){s(c)}}),this.processorContext.on(to.REQUEST_CONSTRAINTS,async n=>{n(this._originMediaStreamTrack.getSettings())})}}function zV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function v0(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?zV(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):zV(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}function dA(o,n,r,s){r.optimizationMode&&(s&&s.width&&s.height?(r.encoderConfig=v0(v0({},s),{},{bitrateMin:s.bitrateMin,bitrateMax:s.bitrateMax}),r.optimizationMode!=="motion"&&r.optimizationMode!=="detail"||(n.contentHint=r.optimizationMode,n.contentHint===r.optimizationMode?O.debug("[".concat(o,"] set content hint to"),r.optimizationMode):O.debug("[".concat(o,"] set content hint failed")))):O.warning("[".concat(o,"] can not apply optimization mode bitrate config, no encoderConfig")))}function GV(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function E0(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?GV(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):GV(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}fe([Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],md.prototype,"setDevice",null),fe([wp("CameraVideoTrack","_enabledMutex"),Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[Boolean,Boolean]),j("design:returntype",ae)],md.prototype,"setEnabled",null),fe([Je({argsMap:(o,n)=>[o.getTrackId(),n]}),Fn(),j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",ae)],md.prototype,"setEncoderConfiguration",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],md.prototype,"close",null);class HV extends hV{getUserId(){return this._userId}constructor(n,r,s,c){super(n,"track-".concat(n.kind,"-").concat(r,"-").concat(c.clientId,"_").concat(Qt(5,""))),I(this,"_userId",void 0),I(this,"_uintId",void 0),I(this,"_isDestroyed",!1),I(this,"store",void 0),I(this,"processor",void 0),this._userId=r,this._uintId=s,this.store=c}_updateOriginMediaStreamTrack(n){this._originMediaStreamTrack=n,this._mediaStreamTrack=n,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,O.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}class oc extends HV{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==mi.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(n,r,s,c){super(n,r,s,c),I(this,"_videoVisibleTimer",null),I(this,"_previousVideoVisibleStatus",void 0),I(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),I(this,"trackMediaType","video"),I(this,"_videoWidth",void 0),I(this,"_videoHeight",void 0),I(this,"_player",void 0),I(this,"processorDestination",void 0),I(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new OV(this.getTrackId(),"remote"),this.processorDestination=new AV(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return bp(()=>{O.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),yo(this,ke.GET_STATS)||E0({},uV)}play(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="string"){const c=document.getElementById(n);c?n=c:(O.warning("[".concat(this.getTrackId(),'] can not find "#').concat(n,'" element, use document.body')),n=document.body)}O.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(n instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));const s=E0(E0({fit:"cover"},r),{},{trackId:this.getTrackId(),element:n});this._player?this._player.updateConfig(s):(n instanceof HTMLVideoElement?this._player=new lA(s):this._player=new FV(s),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(pd.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=c=>{this.safeEmit(pd.VIDEO_STATE_CHANGED,c)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const c=this.getVideoElementVisibleStatus();this.safeEmit(pd.VIDEO_ELEMENT_VISIBLE_STATUS,c)}catch{}},Y("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,O.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){VV(this._originMediaStreamTrack).then(n=>{let[r,s]=n;this._videoHeight=s,this._videoWidth=r}).catch(By)}_updatePlayerSource(){O.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var n,r;const s=this==null||(n=this._player)===null||n===void 0?void 0:n.getContainerElement(),c={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:d,slot:h}=c;if(this.isPlaying&&d instanceof HTMLVideoElement&&h instanceof HTMLElement){const f=mj.checkOneElementVisible(d),g=Object.assign({},f);if(g.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=g.visible;const _=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});g.visible?_.onSuccess("Video is visible"):_.onSuccess("Invisible because of ".concat(g.reason))}return g}return}catch(s){throw new he(B.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}pipe(n){if(this.processor===n)return n;if(n._source)throw new he(B.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),n}unpipe(){if(!this.processor)return;const n=this.processor;this.processor._source=void 0,this.processor=void 0,n.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(fi.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(fi.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(n){this.emit(ud.SEI_RECEIVED,n)}}fe([Je({argsMap:(o,n,r)=>[o.getTrackId(),typeof n=="string"?n:n instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),j("design:type",Function),j("design:paramtypes",[Object,Object]),j("design:returntype",void 0)],oc.prototype,"play",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],oc.prototype,"stop",null),fe([Je({argsMap:(o,n)=>[o.getTrackId(),n.name]}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",Object)],oc.prototype,"pipe",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],oc.prototype,"unpipe",null);class Ys extends HV{get isPlaying(){return this._useAudioElement?Vi.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(n,r,s,c){super(n,r,s,c),I(this,"trackMediaType","audio"),I(this,"_source",void 0),I(this,"_useAudioElement",!0),I(this,"_volume",100),I(this,"processorContext",void 0),I(this,"processorDestination",void 0),I(this,"_played",!1),I(this,"_bypassWebAudio",!1),Y("DISABLE_WEBAUDIO")?(this._source=new sA,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new _V(n,!0),Y("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(eo.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(pd.FIRST_FRAME_DECODED)}),this.processorContext=new PV(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new NV(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(eo.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!n)return this._source.removeAllListeners(eo.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(r),this._source.removeAllListeners(eo.ON_AUDIO_BUFFER),this._source.on(eo.ON_AUDIO_BUFFER,s=>n(s))}setVolume(n){this._volume=n,this._useAudioElement?Vi.setVolume(this.getTrackId(),n):this._source.setVolume(n/100)}async setPlaybackDevice(n){if(!this._useAudioElement||!Hc()&&Y("RESTRICTION_SET_PLAYBACK_DEVICE"))throw new he(B.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Vi.setSinkID(this.getTrackId(),n)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return bp(()=>{O.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),yo(this,ke.GET_STATS)||E0({},dV)}play(){O.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(O.debug("[".concat(this.getTrackId(),"] use audio element to play")),Vi.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){O.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?Vi.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let n=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];O.debug("[".concat(this.getTrackId(),"] update player source track")),n&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Vi.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(n){if(this._bypassWebAudio)throw new he(B.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===n)return n;if(n._source)throw new he(B.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),n}unpipe(){var n;if(this._bypassWebAudio)throw new he(B.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const r=this.processor;(n=this._source.processSourceNode)===null||n===void 0||n.disconnect(),this.processor._source=!1,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(fi.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(n)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(fi.ON_NODE,n=>{this._source.processedNode=n;const r=!n;this._useAudioElement!==r&&(this._played?(this.stop(),this._useAudioElement=r,this.play()):this._useAudioElement=r)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(fi.ON_TRACK),this.processorDestination.removeAllListeners(fi.ON_NODE)}}fe([Je({argsMap:(o,n)=>[o.getTrackId(),n],throttleTime:300}),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],Ys.prototype,"setVolume",null),fe([Je({argsMap:(o,n)=>[o.getTrackId(),n]}),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],Ys.prototype,"setPlaybackDevice",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ys.prototype,"play",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ys.prototype,"stop",null),fe([Je({argsMap:(o,n)=>[o.getTrackId(),n.name]}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",Object)],Ys.prototype,"pipe",null),fe([Je({argsMap:o=>[o.getTrackId()]}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ys.prototype,"unpipe",null);const nl=new class extends mn{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),I(this,"_lastHiddenTime",0),I(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),O.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function jp(o){let n=o.length;for(;--n>=0;)o[n]=0}const uA=256,$V=286,kg=30,Dg=15,hA=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),y0=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),foe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),KV=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rl=new Array(576);jp(rl);const xg=new Array(60);jp(xg);const Lg=new Array(512);jp(Lg);const Mg=new Array(256);jp(Mg);const pA=new Array(29);jp(pA);const S0=new Array(kg);function fA(o,n,r,s,c){this.static_tree=o,this.extra_bits=n,this.extra_base=r,this.elems=s,this.max_length=c,this.has_stree=o&&o.length}let YV,qV,JV;function mA(o,n){this.dyn_tree=o,this.max_code=0,this.stat_desc=n}jp(S0);const XV=o=>o<256?Lg[o]:Lg[256+(o>>>7)],Ug=(o,n)=>{o.pending_buf[o.pending++]=255&n,o.pending_buf[o.pending++]=n>>>8&255},Yo=(o,n,r)=>{o.bi_valid>16-r?(o.bi_buf|=n<<o.bi_valid&65535,Ug(o,o.bi_buf),o.bi_buf=n>>16-o.bi_valid,o.bi_valid+=r-16):(o.bi_buf|=n<<o.bi_valid&65535,o.bi_valid+=r)},sc=(o,n,r)=>{Yo(o,r[2*n],r[2*n+1])},QV=(o,n)=>{let r=0;do r|=1&o,o>>>=1,r<<=1;while(--n>0);return r>>>1},ZV=(o,n,r)=>{const s=new Array(16);let c,d,h=0;for(c=1;c<=Dg;c++)h=h+r[c-1]<<1,s[c]=h;for(d=0;d<=n;d++){let f=o[2*d+1];f!==0&&(o[2*d]=QV(s[f]++,f))}},eB=o=>{let n;for(n=0;n<$V;n++)o.dyn_ltree[2*n]=0;for(n=0;n<kg;n++)o.dyn_dtree[2*n]=0;for(n=0;n<19;n++)o.bl_tree[2*n]=0;o.dyn_ltree[512]=1,o.opt_len=o.static_len=0,o.sym_next=o.matches=0},tB=o=>{o.bi_valid>8?Ug(o,o.bi_buf):o.bi_valid>0&&(o.pending_buf[o.pending++]=o.bi_buf),o.bi_buf=0,o.bi_valid=0},nB=(o,n,r,s)=>{const c=2*n,d=2*r;return o[c]<o[d]||o[c]===o[d]&&s[n]<=s[r]},gA=(o,n,r)=>{const s=o.heap[r];let c=r<<1;for(;c<=o.heap_len&&(c<o.heap_len&&nB(n,o.heap[c+1],o.heap[c],o.depth)&&c++,!nB(n,s,o.heap[c],o.depth));)o.heap[r]=o.heap[c],r=c,c<<=1;o.heap[r]=s},rB=(o,n,r)=>{let s,c,d,h,f=0;if(o.sym_next!==0)do s=255&o.pending_buf[o.sym_buf+f++],s+=(255&o.pending_buf[o.sym_buf+f++])<<8,c=o.pending_buf[o.sym_buf+f++],s===0?sc(o,c,n):(d=Mg[c],sc(o,d+uA+1,n),h=hA[d],h!==0&&(c-=pA[d],Yo(o,c,h)),s--,d=XV(s),sc(o,d,r),h=y0[d],h!==0&&(s-=S0[d],Yo(o,s,h)));while(f<o.sym_next);sc(o,256,n)},_A=(o,n)=>{const r=n.dyn_tree,s=n.stat_desc.static_tree,c=n.stat_desc.has_stree,d=n.stat_desc.elems;let h,f,g,_=-1;for(o.heap_len=0,o.heap_max=573,h=0;h<d;h++)r[2*h]!==0?(o.heap[++o.heap_len]=_=h,o.depth[h]=0):r[2*h+1]=0;for(;o.heap_len<2;)g=o.heap[++o.heap_len]=_<2?++_:0,r[2*g]=1,o.depth[g]=0,o.opt_len--,c&&(o.static_len-=s[2*g+1]);for(n.max_code=_,h=o.heap_len>>1;h>=1;h--)gA(o,r,h);g=d;do h=o.heap[1],o.heap[1]=o.heap[o.heap_len--],gA(o,r,1),f=o.heap[1],o.heap[--o.heap_max]=h,o.heap[--o.heap_max]=f,r[2*g]=r[2*h]+r[2*f],o.depth[g]=(o.depth[h]>=o.depth[f]?o.depth[h]:o.depth[f])+1,r[2*h+1]=r[2*f+1]=g,o.heap[1]=g++,gA(o,r,1);while(o.heap_len>=2);o.heap[--o.heap_max]=o.heap[1],((E,T)=>{const w=T.dyn_tree,A=T.max_code,L=T.stat_desc.static_tree,P=T.stat_desc.has_stree,D=T.stat_desc.extra_bits,G=T.stat_desc.extra_base,$=T.stat_desc.max_length;let X,ie,Q,te,ce,le,Se=0;for(te=0;te<=Dg;te++)E.bl_count[te]=0;for(w[2*E.heap[E.heap_max]+1]=0,X=E.heap_max+1;X<573;X++)ie=E.heap[X],te=w[2*w[2*ie+1]+1]+1,te>$&&(te=$,Se++),w[2*ie+1]=te,ie>A||(E.bl_count[te]++,ce=0,ie>=G&&(ce=D[ie-G]),le=w[2*ie],E.opt_len+=le*(te+ce),P&&(E.static_len+=le*(L[2*ie+1]+ce)));if(Se!==0){do{for(te=$-1;E.bl_count[te]===0;)te--;E.bl_count[te]--,E.bl_count[te+1]+=2,E.bl_count[$]--,Se-=2}while(Se>0);for(te=$;te!==0;te--)for(ie=E.bl_count[te];ie!==0;)Q=E.heap[--X],Q>A||(w[2*Q+1]!==te&&(E.opt_len+=(te-w[2*Q+1])*w[2*Q],w[2*Q+1]=te),ie--)}})(o,n),ZV(r,_,o.bl_count)},iB=(o,n,r)=>{let s,c,d=-1,h=n[1],f=0,g=7,_=4;for(h===0&&(g=138,_=3),n[2*(r+1)+1]=65535,s=0;s<=r;s++)c=h,h=n[2*(s+1)+1],++f<g&&c===h||(f<_?o.bl_tree[2*c]+=f:c!==0?(c!==d&&o.bl_tree[2*c]++,o.bl_tree[32]++):f<=10?o.bl_tree[34]++:o.bl_tree[36]++,f=0,d=c,h===0?(g=138,_=3):c===h?(g=6,_=3):(g=7,_=4))},oB=(o,n,r)=>{let s,c,d=-1,h=n[1],f=0,g=7,_=4;for(h===0&&(g=138,_=3),s=0;s<=r;s++)if(c=h,h=n[2*(s+1)+1],!(++f<g&&c===h)){if(f<_)do sc(o,c,o.bl_tree);while(--f!=0);else c!==0?(c!==d&&(sc(o,c,o.bl_tree),f--),sc(o,16,o.bl_tree),Yo(o,f-3,2)):f<=10?(sc(o,17,o.bl_tree),Yo(o,f-3,3)):(sc(o,18,o.bl_tree),Yo(o,f-11,7));f=0,d=c,h===0?(g=138,_=3):c===h?(g=6,_=3):(g=7,_=4)}};let sB=!1;const aB=(o,n,r,s)=>{Yo(o,0+(s?1:0),3),tB(o),Ug(o,r),Ug(o,~r),r&&o.pending_buf.set(o.window.subarray(n,n+r),o.pending),o.pending+=r};var moe=o=>{sB||((()=>{let n,r,s,c,d;const h=new Array(16);for(s=0,c=0;c<28;c++)for(pA[c]=s,n=0;n<1<<hA[c];n++)Mg[s++]=c;for(Mg[s-1]=c,d=0,c=0;c<16;c++)for(S0[c]=d,n=0;n<1<<y0[c];n++)Lg[d++]=c;for(d>>=7;c<kg;c++)for(S0[c]=d<<7,n=0;n<1<<y0[c]-7;n++)Lg[256+d++]=c;for(r=0;r<=Dg;r++)h[r]=0;for(n=0;n<=143;)rl[2*n+1]=8,n++,h[8]++;for(;n<=255;)rl[2*n+1]=9,n++,h[9]++;for(;n<=279;)rl[2*n+1]=7,n++,h[7]++;for(;n<=287;)rl[2*n+1]=8,n++,h[8]++;for(ZV(rl,287,h),n=0;n<kg;n++)xg[2*n+1]=5,xg[2*n]=QV(n,5);YV=new fA(rl,hA,257,$V,Dg),qV=new fA(xg,y0,0,kg,Dg),JV=new fA(new Array(0),foe,0,19,7)})(),sB=!0),o.l_desc=new mA(o.dyn_ltree,YV),o.d_desc=new mA(o.dyn_dtree,qV),o.bl_desc=new mA(o.bl_tree,JV),o.bi_buf=0,o.bi_valid=0,eB(o)},goe=(o,n,r,s)=>{let c,d,h=0;o.level>0?(o.strm.data_type===2&&(o.strm.data_type=(f=>{let g,_=4093624447;for(g=0;g<=31;g++,_>>>=1)if(1&_&&f.dyn_ltree[2*g]!==0)return 0;if(f.dyn_ltree[18]!==0||f.dyn_ltree[20]!==0||f.dyn_ltree[26]!==0)return 1;for(g=32;g<uA;g++)if(f.dyn_ltree[2*g]!==0)return 1;return 0})(o)),_A(o,o.l_desc),_A(o,o.d_desc),h=(f=>{let g;for(iB(f,f.dyn_ltree,f.l_desc.max_code),iB(f,f.dyn_dtree,f.d_desc.max_code),_A(f,f.bl_desc),g=18;g>=3&&f.bl_tree[2*KV[g]+1]===0;g--);return f.opt_len+=3*(g+1)+5+5+4,g})(o),c=o.opt_len+3+7>>>3,d=o.static_len+3+7>>>3,d<=c&&(c=d)):c=d=r+5,r+4<=c&&n!==-1?aB(o,n,r,s):o.strategy===4||d===c?(Yo(o,2+(s?1:0),3),rB(o,rl,xg)):(Yo(o,4+(s?1:0),3),((f,g,_,E)=>{let T;for(Yo(f,g-257,5),Yo(f,_-1,5),Yo(f,E-4,4),T=0;T<E;T++)Yo(f,f.bl_tree[2*KV[T]+1],3);oB(f,f.dyn_ltree,g-1),oB(f,f.dyn_dtree,_-1)})(o,o.l_desc.max_code+1,o.d_desc.max_code+1,h+1),rB(o,o.dyn_ltree,o.dyn_dtree)),eB(o),s&&tB(o)},_oe=(o,n,r)=>(o.pending_buf[o.sym_buf+o.sym_next++]=n,o.pending_buf[o.sym_buf+o.sym_next++]=n>>8,o.pending_buf[o.sym_buf+o.sym_next++]=r,n===0?o.dyn_ltree[2*r]++:(o.matches++,n--,o.dyn_ltree[2*(Mg[r]+uA+1)]++,o.dyn_dtree[2*XV(n)]++),o.sym_next===o.sym_end),voe={_tr_init:moe,_tr_stored_block:aB,_tr_flush_block:goe,_tr_tally:_oe,_tr_align:o=>{Yo(o,2,3),sc(o,256,rl),(n=>{n.bi_valid===16?(Ug(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=255&n.bi_buf,n.bi_buf>>=8,n.bi_valid-=8)})(o)}},jg=(o,n,r,s)=>{let c=65535&o|0,d=o>>>16&65535|0,h=0;for(;r!==0;){h=r>2e3?2e3:r,r-=h;do c=c+n[s++]|0,d=d+c|0;while(--h);c%=65521,d%=65521}return c|d<<16|0};const Eoe=new Uint32Array((()=>{let o,n=[];for(var r=0;r<256;r++){o=r;for(var s=0;s<8;s++)o=1&o?3988292384^o>>>1:o>>>1;n[r]=o}return n})());var Di=(o,n,r,s)=>{const c=Eoe,d=s+r;o^=-1;for(let h=s;h<d;h++)o=o>>>8^c[255&(o^n[h])];return-1^o},Vu={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Fp={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:yoe,_tr_stored_block:vA,_tr_flush_block:Soe,_tr_tally:gd,_tr_align:Toe}=voe,{Z_NO_FLUSH:_d,Z_PARTIAL_FLUSH:boe,Z_FULL_FLUSH:Coe,Z_FINISH:qs,Z_BLOCK:cB,Z_OK:Bi,Z_STREAM_END:lB,Z_STREAM_ERROR:ac,Z_DATA_ERROR:woe,Z_BUF_ERROR:EA,Z_DEFAULT_COMPRESSION:Roe,Z_FILTERED:Ioe,Z_HUFFMAN_ONLY:T0,Z_RLE:Aoe,Z_FIXED:Ooe,Z_DEFAULT_STRATEGY:Noe,Z_UNKNOWN:Poe,Z_DEFLATED:b0}=Fp,yA=286,koe=30,Doe=19,xoe=2*yA+1,Loe=15,Bu=258,cc=262,Vp=42,Wu=113,Fg=666,zu=(o,n)=>(o.msg=Vu[n],n),dB=o=>2*o-(o>4?9:0),vd=o=>{let n=o.length;for(;--n>=0;)o[n]=0},Moe=o=>{let n,r,s,c=o.w_size;n=o.hash_size,s=n;do r=o.head[--s],o.head[s]=r>=c?r-c:0;while(--n);n=c,s=n;do r=o.prev[--s],o.prev[s]=r>=c?r-c:0;while(--n)};let Ed=(o,n,r)=>(n<<o.hash_shift^r)&o.hash_mask;const Es=o=>{const n=o.state;let r=n.pending;r>o.avail_out&&(r=o.avail_out),r!==0&&(o.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+r),o.next_out),o.next_out+=r,n.pending_out+=r,o.total_out+=r,o.avail_out-=r,n.pending-=r,n.pending===0&&(n.pending_out=0))},ys=(o,n)=>{Soe(o,o.block_start>=0?o.block_start:-1,o.strstart-o.block_start,n),o.block_start=o.strstart,Es(o.strm)},Pn=(o,n)=>{o.pending_buf[o.pending++]=n},Vg=(o,n)=>{o.pending_buf[o.pending++]=n>>>8&255,o.pending_buf[o.pending++]=255&n},SA=(o,n,r,s)=>{let c=o.avail_in;return c>s&&(c=s),c===0?0:(o.avail_in-=c,n.set(o.input.subarray(o.next_in,o.next_in+c),r),o.state.wrap===1?o.adler=jg(o.adler,n,c,r):o.state.wrap===2&&(o.adler=Di(o.adler,n,c,r)),o.next_in+=c,o.total_in+=c,c)},uB=(o,n)=>{let r,s,c=o.max_chain_length,d=o.strstart,h=o.prev_length,f=o.nice_match;const g=o.strstart>o.w_size-cc?o.strstart-(o.w_size-cc):0,_=o.window,E=o.w_mask,T=o.prev,w=o.strstart+Bu;let A=_[d+h-1],L=_[d+h];o.prev_length>=o.good_match&&(c>>=2),f>o.lookahead&&(f=o.lookahead);do if(r=n,_[r+h]===L&&_[r+h-1]===A&&_[r]===_[d]&&_[++r]===_[d+1]){d+=2,r++;do;while(_[++d]===_[++r]&&_[++d]===_[++r]&&_[++d]===_[++r]&&_[++d]===_[++r]&&_[++d]===_[++r]&&_[++d]===_[++r]&&_[++d]===_[++r]&&_[++d]===_[++r]&&d<w);if(s=Bu-(w-d),d=w-Bu,s>h){if(o.match_start=n,h=s,s>=f)break;A=_[d+h-1],L=_[d+h]}}while((n=T[n&E])>g&&--c!=0);return h<=o.lookahead?h:o.lookahead},Bp=o=>{const n=o.w_size;let r,s,c;do{if(s=o.window_size-o.lookahead-o.strstart,o.strstart>=n+(n-cc)&&(o.window.set(o.window.subarray(n,n+n-s),0),o.match_start-=n,o.strstart-=n,o.block_start-=n,o.insert>o.strstart&&(o.insert=o.strstart),Moe(o),s+=n),o.strm.avail_in===0)break;if(r=SA(o.strm,o.window,o.strstart+o.lookahead,s),o.lookahead+=r,o.lookahead+o.insert>=3)for(c=o.strstart-o.insert,o.ins_h=o.window[c],o.ins_h=Ed(o,o.ins_h,o.window[c+1]);o.insert&&(o.ins_h=Ed(o,o.ins_h,o.window[c+3-1]),o.prev[c&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=c,c++,o.insert--,!(o.lookahead+o.insert<3)););}while(o.lookahead<cc&&o.strm.avail_in!==0)},hB=(o,n)=>{let r,s,c,d=o.pending_buf_size-5>o.w_size?o.w_size:o.pending_buf_size-5,h=0,f=o.strm.avail_in;do{if(r=65535,c=o.bi_valid+42>>3,o.strm.avail_out<c||(c=o.strm.avail_out-c,s=o.strstart-o.block_start,r>s+o.strm.avail_in&&(r=s+o.strm.avail_in),r>c&&(r=c),r<d&&(r===0&&n!==qs||n===_d||r!==s+o.strm.avail_in)))break;h=n===qs&&r===s+o.strm.avail_in?1:0,vA(o,0,0,h),o.pending_buf[o.pending-4]=r,o.pending_buf[o.pending-3]=r>>8,o.pending_buf[o.pending-2]=~r,o.pending_buf[o.pending-1]=~r>>8,Es(o.strm),s&&(s>r&&(s=r),o.strm.output.set(o.window.subarray(o.block_start,o.block_start+s),o.strm.next_out),o.strm.next_out+=s,o.strm.avail_out-=s,o.strm.total_out+=s,o.block_start+=s,r-=s),r&&(SA(o.strm,o.strm.output,o.strm.next_out,r),o.strm.next_out+=r,o.strm.avail_out-=r,o.strm.total_out+=r)}while(h===0);return f-=o.strm.avail_in,f&&(f>=o.w_size?(o.matches=2,o.window.set(o.strm.input.subarray(o.strm.next_in-o.w_size,o.strm.next_in),0),o.strstart=o.w_size,o.insert=o.strstart):(o.window_size-o.strstart<=f&&(o.strstart-=o.w_size,o.window.set(o.window.subarray(o.w_size,o.w_size+o.strstart),0),o.matches<2&&o.matches++,o.insert>o.strstart&&(o.insert=o.strstart)),o.window.set(o.strm.input.subarray(o.strm.next_in-f,o.strm.next_in),o.strstart),o.strstart+=f,o.insert+=f>o.w_size-o.insert?o.w_size-o.insert:f),o.block_start=o.strstart),o.high_water<o.strstart&&(o.high_water=o.strstart),h?4:n!==_d&&n!==qs&&o.strm.avail_in===0&&o.strstart===o.block_start?2:(c=o.window_size-o.strstart,o.strm.avail_in>c&&o.block_start>=o.w_size&&(o.block_start-=o.w_size,o.strstart-=o.w_size,o.window.set(o.window.subarray(o.w_size,o.w_size+o.strstart),0),o.matches<2&&o.matches++,c+=o.w_size,o.insert>o.strstart&&(o.insert=o.strstart)),c>o.strm.avail_in&&(c=o.strm.avail_in),c&&(SA(o.strm,o.window,o.strstart,c),o.strstart+=c,o.insert+=c>o.w_size-o.insert?o.w_size-o.insert:c),o.high_water<o.strstart&&(o.high_water=o.strstart),c=o.bi_valid+42>>3,c=o.pending_buf_size-c>65535?65535:o.pending_buf_size-c,d=c>o.w_size?o.w_size:c,s=o.strstart-o.block_start,(s>=d||(s||n===qs)&&n!==_d&&o.strm.avail_in===0&&s<=c)&&(r=s>c?c:s,h=n===qs&&o.strm.avail_in===0&&r===s?1:0,vA(o,o.block_start,r,h),o.block_start+=r,Es(o.strm)),h?3:1)},TA=(o,n)=>{let r,s;for(;;){if(o.lookahead<cc){if(Bp(o),o.lookahead<cc&&n===_d)return 1;if(o.lookahead===0)break}if(r=0,o.lookahead>=3&&(o.ins_h=Ed(o,o.ins_h,o.window[o.strstart+3-1]),r=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),r!==0&&o.strstart-r<=o.w_size-cc&&(o.match_length=uB(o,r)),o.match_length>=3)if(s=gd(o,o.strstart-o.match_start,o.match_length-3),o.lookahead-=o.match_length,o.match_length<=o.max_lazy_match&&o.lookahead>=3){o.match_length--;do o.strstart++,o.ins_h=Ed(o,o.ins_h,o.window[o.strstart+3-1]),r=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart;while(--o.match_length!=0);o.strstart++}else o.strstart+=o.match_length,o.match_length=0,o.ins_h=o.window[o.strstart],o.ins_h=Ed(o,o.ins_h,o.window[o.strstart+1]);else s=gd(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++;if(s&&(ys(o,!1),o.strm.avail_out===0))return 1}return o.insert=o.strstart<2?o.strstart:2,n===qs?(ys(o,!0),o.strm.avail_out===0?3:4):o.sym_next&&(ys(o,!1),o.strm.avail_out===0)?1:2},Wp=(o,n)=>{let r,s,c;for(;;){if(o.lookahead<cc){if(Bp(o),o.lookahead<cc&&n===_d)return 1;if(o.lookahead===0)break}if(r=0,o.lookahead>=3&&(o.ins_h=Ed(o,o.ins_h,o.window[o.strstart+3-1]),r=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart),o.prev_length=o.match_length,o.prev_match=o.match_start,o.match_length=2,r!==0&&o.prev_length<o.max_lazy_match&&o.strstart-r<=o.w_size-cc&&(o.match_length=uB(o,r),o.match_length<=5&&(o.strategy===Ioe||o.match_length===3&&o.strstart-o.match_start>4096)&&(o.match_length=2)),o.prev_length>=3&&o.match_length<=o.prev_length){c=o.strstart+o.lookahead-3,s=gd(o,o.strstart-1-o.prev_match,o.prev_length-3),o.lookahead-=o.prev_length-1,o.prev_length-=2;do++o.strstart<=c&&(o.ins_h=Ed(o,o.ins_h,o.window[o.strstart+3-1]),r=o.prev[o.strstart&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=o.strstart);while(--o.prev_length!=0);if(o.match_available=0,o.match_length=2,o.strstart++,s&&(ys(o,!1),o.strm.avail_out===0))return 1}else if(o.match_available){if(s=gd(o,0,o.window[o.strstart-1]),s&&ys(o,!1),o.strstart++,o.lookahead--,o.strm.avail_out===0)return 1}else o.match_available=1,o.strstart++,o.lookahead--}return o.match_available&&(s=gd(o,0,o.window[o.strstart-1]),o.match_available=0),o.insert=o.strstart<2?o.strstart:2,n===qs?(ys(o,!0),o.strm.avail_out===0?3:4):o.sym_next&&(ys(o,!1),o.strm.avail_out===0)?1:2};function lc(o,n,r,s,c){this.good_length=o,this.max_lazy=n,this.nice_length=r,this.max_chain=s,this.func=c}const Bg=[new lc(0,0,0,0,hB),new lc(4,4,8,4,TA),new lc(4,5,16,8,TA),new lc(4,6,32,32,TA),new lc(4,4,16,16,Wp),new lc(8,16,32,32,Wp),new lc(8,16,128,128,Wp),new lc(8,32,128,256,Wp),new lc(32,128,258,1024,Wp),new lc(32,258,258,4096,Wp)];function Uoe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=b0,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*xoe),this.dyn_dtree=new Uint16Array(2*(2*koe+1)),this.bl_tree=new Uint16Array(2*(2*Doe+1)),vd(this.dyn_ltree),vd(this.dyn_dtree),vd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Loe+1),this.heap=new Uint16Array(2*yA+1),vd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*yA+1),vd(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Wg=o=>{if(!o)return 1;const n=o.state;return!n||n.strm!==o||n.status!==Vp&&n.status!==57&&n.status!==69&&n.status!==73&&n.status!==91&&n.status!==103&&n.status!==Wu&&n.status!==Fg?1:0},pB=o=>{if(Wg(o))return zu(o,ac);o.total_in=o.total_out=0,o.data_type=Poe;const n=o.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?57:n.wrap?Vp:Wu,o.adler=n.wrap===2?0:1,n.last_flush=-2,yoe(n),Bi},fB=o=>{const n=pB(o);var r;return n===Bi&&((r=o.state).window_size=2*r.w_size,vd(r.head),r.max_lazy_match=Bg[r.level].max_lazy,r.good_match=Bg[r.level].good_length,r.nice_match=Bg[r.level].nice_length,r.max_chain_length=Bg[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),n},mB=(o,n,r,s,c,d)=>{if(!o)return ac;let h=1;if(n===Roe&&(n=6),s<0?(h=0,s=-s):s>15&&(h=2,s-=16),c<1||c>9||r!==b0||s<8||s>15||n<0||n>9||d<0||d>Ooe||s===8&&h!==1)return zu(o,ac);s===8&&(s=9);const f=new Uoe;return o.state=f,f.strm=o,f.status=Vp,f.wrap=h,f.gzhead=null,f.w_bits=s,f.w_size=1<<f.w_bits,f.w_mask=f.w_size-1,f.hash_bits=c+7,f.hash_size=1<<f.hash_bits,f.hash_mask=f.hash_size-1,f.hash_shift=~~((f.hash_bits+3-1)/3),f.window=new Uint8Array(2*f.w_size),f.head=new Uint16Array(f.hash_size),f.prev=new Uint16Array(f.w_size),f.lit_bufsize=1<<c+6,f.pending_buf_size=4*f.lit_bufsize,f.pending_buf=new Uint8Array(f.pending_buf_size),f.sym_buf=f.lit_bufsize,f.sym_end=3*(f.lit_bufsize-1),f.level=n,f.strategy=d,f.method=r,fB(o)};var joe=(o,n)=>{if(Wg(o)||n>cB||n<0)return o?zu(o,ac):ac;const r=o.state;if(!o.output||o.avail_in!==0&&!o.input||r.status===Fg&&n!==qs)return zu(o,o.avail_out===0?EA:ac);const s=r.last_flush;if(r.last_flush=n,r.pending!==0){if(Es(o),o.avail_out===0)return r.last_flush=-1,Bi}else if(o.avail_in===0&&dB(n)<=dB(s)&&n!==qs)return zu(o,EA);if(r.status===Fg&&o.avail_in!==0)return zu(o,EA);if(r.status===Vp&&r.wrap===0&&(r.status=Wu),r.status===Vp){let c=b0+(r.w_bits-8<<4)<<8,d=-1;if(d=r.strategy>=T0||r.level<2?0:r.level<6?1:r.level===6?2:3,c|=d<<6,r.strstart!==0&&(c|=32),c+=31-c%31,Vg(r,c),r.strstart!==0&&(Vg(r,o.adler>>>16),Vg(r,65535&o.adler)),o.adler=1,r.status=Wu,Es(o),r.pending!==0)return r.last_flush=-1,Bi}if(r.status===57){if(o.adler=0,Pn(r,31),Pn(r,139),Pn(r,8),r.gzhead)Pn(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Pn(r,255&r.gzhead.time),Pn(r,r.gzhead.time>>8&255),Pn(r,r.gzhead.time>>16&255),Pn(r,r.gzhead.time>>24&255),Pn(r,r.level===9?2:r.strategy>=T0||r.level<2?4:0),Pn(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Pn(r,255&r.gzhead.extra.length),Pn(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(o.adler=Di(o.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(Pn(r,0),Pn(r,0),Pn(r,0),Pn(r,0),Pn(r,0),Pn(r,r.level===9?2:r.strategy>=T0||r.level<2?4:0),Pn(r,3),r.status=Wu,Es(o),r.pending!==0)return r.last_flush=-1,Bi}if(r.status===69){if(r.gzhead.extra){let c=r.pending,d=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+d>r.pending_buf_size;){let f=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+f),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>c&&(o.adler=Di(o.adler,r.pending_buf,r.pending-c,c)),r.gzindex+=f,Es(o),r.pending!==0)return r.last_flush=-1,Bi;c=0,d-=f}let h=new Uint8Array(r.gzhead.extra);r.pending_buf.set(h.subarray(r.gzindex,r.gzindex+d),r.pending),r.pending+=d,r.gzhead.hcrc&&r.pending>c&&(o.adler=Di(o.adler,r.pending_buf,r.pending-c,c)),r.gzindex=0}r.status=73}if(r.status===73){if(r.gzhead.name){let c,d=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>d&&(o.adler=Di(o.adler,r.pending_buf,r.pending-d,d)),Es(o),r.pending!==0)return r.last_flush=-1,Bi;d=0}c=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Pn(r,c)}while(c!==0);r.gzhead.hcrc&&r.pending>d&&(o.adler=Di(o.adler,r.pending_buf,r.pending-d,d)),r.gzindex=0}r.status=91}if(r.status===91){if(r.gzhead.comment){let c,d=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>d&&(o.adler=Di(o.adler,r.pending_buf,r.pending-d,d)),Es(o),r.pending!==0)return r.last_flush=-1,Bi;d=0}c=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Pn(r,c)}while(c!==0);r.gzhead.hcrc&&r.pending>d&&(o.adler=Di(o.adler,r.pending_buf,r.pending-d,d))}r.status=103}if(r.status===103){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Es(o),r.pending!==0))return r.last_flush=-1,Bi;Pn(r,255&o.adler),Pn(r,o.adler>>8&255),o.adler=0}if(r.status=Wu,Es(o),r.pending!==0)return r.last_flush=-1,Bi}if(o.avail_in!==0||r.lookahead!==0||n!==_d&&r.status!==Fg){let c=r.level===0?hB(r,n):r.strategy===T0?((d,h)=>{let f;for(;;){if(d.lookahead===0&&(Bp(d),d.lookahead===0)){if(h===_d)return 1;break}if(d.match_length=0,f=gd(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++,f&&(ys(d,!1),d.strm.avail_out===0))return 1}return d.insert=0,h===qs?(ys(d,!0),d.strm.avail_out===0?3:4):d.sym_next&&(ys(d,!1),d.strm.avail_out===0)?1:2})(r,n):r.strategy===Aoe?((d,h)=>{let f,g,_,E;const T=d.window;for(;;){if(d.lookahead<=Bu){if(Bp(d),d.lookahead<=Bu&&h===_d)return 1;if(d.lookahead===0)break}if(d.match_length=0,d.lookahead>=3&&d.strstart>0&&(_=d.strstart-1,g=T[_],g===T[++_]&&g===T[++_]&&g===T[++_])){E=d.strstart+Bu;do;while(g===T[++_]&&g===T[++_]&&g===T[++_]&&g===T[++_]&&g===T[++_]&&g===T[++_]&&g===T[++_]&&g===T[++_]&&_<E);d.match_length=Bu-(E-_),d.match_length>d.lookahead&&(d.match_length=d.lookahead)}if(d.match_length>=3?(f=gd(d,1,d.match_length-3),d.lookahead-=d.match_length,d.strstart+=d.match_length,d.match_length=0):(f=gd(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++),f&&(ys(d,!1),d.strm.avail_out===0))return 1}return d.insert=0,h===qs?(ys(d,!0),d.strm.avail_out===0?3:4):d.sym_next&&(ys(d,!1),d.strm.avail_out===0)?1:2})(r,n):Bg[r.level].func(r,n);if(c!==3&&c!==4||(r.status=Fg),c===1||c===3)return o.avail_out===0&&(r.last_flush=-1),Bi;if(c===2&&(n===boe?Toe(r):n!==cB&&(vA(r,0,0,!1),n===Coe&&(vd(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Es(o),o.avail_out===0))return r.last_flush=-1,Bi}return n!==qs?Bi:r.wrap<=0?lB:(r.wrap===2?(Pn(r,255&o.adler),Pn(r,o.adler>>8&255),Pn(r,o.adler>>16&255),Pn(r,o.adler>>24&255),Pn(r,255&o.total_in),Pn(r,o.total_in>>8&255),Pn(r,o.total_in>>16&255),Pn(r,o.total_in>>24&255)):(Vg(r,o.adler>>>16),Vg(r,65535&o.adler)),Es(o),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Bi:lB)},Foe=(o,n)=>{let r=n.length;if(Wg(o))return ac;const s=o.state,c=s.wrap;if(c===2||c===1&&s.status!==Vp||s.lookahead)return ac;if(c===1&&(o.adler=jg(o.adler,n,r,0)),s.wrap=0,r>=s.w_size){c===0&&(vd(s.head),s.strstart=0,s.block_start=0,s.insert=0);let g=new Uint8Array(s.w_size);g.set(n.subarray(r-s.w_size,r),0),n=g,r=s.w_size}const d=o.avail_in,h=o.next_in,f=o.input;for(o.avail_in=r,o.next_in=0,o.input=n,Bp(s);s.lookahead>=3;){let g=s.strstart,_=s.lookahead-2;do s.ins_h=Ed(s,s.ins_h,s.window[g+3-1]),s.prev[g&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=g,g++;while(--_);s.strstart=g,s.lookahead=2,Bp(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,o.next_in=h,o.input=f,o.avail_in=d,s.wrap=c,Bi},zg={deflateInit:(o,n)=>mB(o,n,b0,15,8,Noe),deflateInit2:mB,deflateReset:fB,deflateResetKeep:pB,deflateSetHeader:(o,n)=>Wg(o)||o.state.wrap!==2?ac:(o.state.gzhead=n,Bi),deflate:joe,deflateEnd:o=>{if(Wg(o))return ac;const n=o.state.status;return o.state=null,n===Wu?zu(o,woe):Bi},deflateSetDictionary:Foe,deflateInfo:"pako deflate (from Nodeca project)"};const Voe=(o,n)=>Object.prototype.hasOwnProperty.call(o,n);var C0={assign:function(o){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const r=n.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const s in r)Voe(r,s)&&(o[s]=r[s])}}return o},flattenChunks:o=>{let n=0;for(let s=0,c=o.length;s<c;s++)n+=o[s].length;const r=new Uint8Array(n);for(let s=0,c=0,d=o.length;s<d;s++){let h=o[s];r.set(h,c),c+=h.length}return r}};let gB=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{gB=!1}const Gg=new Uint8Array(256);for(let o=0;o<256;o++)Gg[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;Gg[254]=Gg[254]=1;var Hg={string2buf:o=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(o);let n,r,s,c,d,h=o.length,f=0;for(c=0;c<h;c++)r=o.charCodeAt(c),(64512&r)==55296&&c+1<h&&(s=o.charCodeAt(c+1),(64512&s)==56320&&(r=65536+(r-55296<<10)+(s-56320),c++)),f+=r<128?1:r<2048?2:r<65536?3:4;for(n=new Uint8Array(f),d=0,c=0;d<f;c++)r=o.charCodeAt(c),(64512&r)==55296&&c+1<h&&(s=o.charCodeAt(c+1),(64512&s)==56320&&(r=65536+(r-55296<<10)+(s-56320),c++)),r<128?n[d++]=r:r<2048?(n[d++]=192|r>>>6,n[d++]=128|63&r):r<65536?(n[d++]=224|r>>>12,n[d++]=128|r>>>6&63,n[d++]=128|63&r):(n[d++]=240|r>>>18,n[d++]=128|r>>>12&63,n[d++]=128|r>>>6&63,n[d++]=128|63&r);return n},buf2string:(o,n)=>{const r=n||o.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(o.subarray(0,n));let s,c;const d=new Array(2*r);for(c=0,s=0;s<r;){let h=o[s++];if(h<128){d[c++]=h;continue}let f=Gg[h];if(f>4)d[c++]=65533,s+=f-1;else{for(h&=f===2?31:f===3?15:7;f>1&&s<r;)h=h<<6|63&o[s++],f--;f>1?d[c++]=65533:h<65536?d[c++]=h:(h-=65536,d[c++]=55296|h>>10&1023,d[c++]=56320|1023&h)}}return((h,f)=>{if(f<65534&&h.subarray&&gB)return String.fromCharCode.apply(null,h.length===f?h:h.subarray(0,f));let g="";for(let _=0;_<f;_++)g+=String.fromCharCode(h[_]);return g})(d,c)},utf8border:(o,n)=>{(n=n||o.length)>o.length&&(n=o.length);let r=n-1;for(;r>=0&&(192&o[r])==128;)r--;return r<0||r===0?n:r+Gg[o[r]]>n?r:n}},_B=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const vB=Object.prototype.toString,{Z_NO_FLUSH:Boe,Z_SYNC_FLUSH:Woe,Z_FULL_FLUSH:zoe,Z_FINISH:Goe,Z_OK:w0,Z_STREAM_END:Hoe,Z_DEFAULT_COMPRESSION:$oe,Z_DEFAULT_STRATEGY:Koe,Z_DEFLATED:Yoe}=Fp;function $g(o){this.options=C0.assign({level:$oe,method:Yoe,chunkSize:16384,windowBits:15,memLevel:8,strategy:Koe},o||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _B,this.strm.avail_out=0;let r=zg.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(r!==w0)throw new Error(Vu[r]);if(n.header&&zg.deflateSetHeader(this.strm,n.header),n.dictionary){let s;if(s=typeof n.dictionary=="string"?Hg.string2buf(n.dictionary):vB.call(n.dictionary)==="[object ArrayBuffer]"?new Uint8Array(n.dictionary):n.dictionary,r=zg.deflateSetDictionary(this.strm,s),r!==w0)throw new Error(Vu[r]);this._dict_set=!0}}function bA(o,n){const r=new $g(n);if(r.push(o,!0),r.err)throw r.msg||Vu[r.err];return r.result}$g.prototype.push=function(o,n){const r=this.strm,s=this.options.chunkSize;let c,d;if(this.ended)return!1;for(d=n===~~n?n:n===!0?Goe:Boe,typeof o=="string"?r.input=Hg.string2buf(o):vB.call(o)==="[object ArrayBuffer]"?r.input=new Uint8Array(o):r.input=o,r.next_in=0,r.avail_in=r.input.length;;)if(r.avail_out===0&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),(d===Woe||d===zoe)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(c=zg.deflate(r,d),c===Hoe)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),c=zg.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===w0;if(r.avail_out!==0){if(d>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(r.avail_in===0)break}else this.onData(r.output)}return!0},$g.prototype.onData=function(o){this.chunks.push(o)},$g.prototype.onEnd=function(o){o===w0&&(this.result=C0.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg};var qoe={Deflate:$g,deflate:bA,deflateRaw:function(o,n){return(n=n||{}).raw=!0,bA(o,n)},gzip:function(o,n){return(n=n||{}).gzip=!0,bA(o,n)},constants:Fp};const R0=16209;var Joe=function(o,n){let r,s,c,d,h,f,g,_,E,T,w,A,L,P,D,G,$,X,ie,Q,te,ce,le,Se;const Ae=o.state;r=o.next_in,le=o.input,s=r+(o.avail_in-5),c=o.next_out,Se=o.output,d=c-(n-o.avail_out),h=c+(o.avail_out-257),f=Ae.dmax,g=Ae.wsize,_=Ae.whave,E=Ae.wnext,T=Ae.window,w=Ae.hold,A=Ae.bits,L=Ae.lencode,P=Ae.distcode,D=(1<<Ae.lenbits)-1,G=(1<<Ae.distbits)-1;e:do{A<15&&(w+=le[r++]<<A,A+=8,w+=le[r++]<<A,A+=8),$=L[w&D];t:for(;;){if(X=$>>>24,w>>>=X,A-=X,X=$>>>16&255,X===0)Se[c++]=65535&$;else{if(!(16&X)){if(!(64&X)){$=L[(65535&$)+(w&(1<<X)-1)];continue t}if(32&X){Ae.mode=16191;break e}o.msg="invalid literal/length code",Ae.mode=R0;break e}ie=65535&$,X&=15,X&&(A<X&&(w+=le[r++]<<A,A+=8),ie+=w&(1<<X)-1,w>>>=X,A-=X),A<15&&(w+=le[r++]<<A,A+=8,w+=le[r++]<<A,A+=8),$=P[w&G];n:for(;;){if(X=$>>>24,w>>>=X,A-=X,X=$>>>16&255,!(16&X)){if(!(64&X)){$=P[(65535&$)+(w&(1<<X)-1)];continue n}o.msg="invalid distance code",Ae.mode=R0;break e}if(Q=65535&$,X&=15,A<X&&(w+=le[r++]<<A,A+=8,A<X&&(w+=le[r++]<<A,A+=8)),Q+=w&(1<<X)-1,Q>f){o.msg="invalid distance too far back",Ae.mode=R0;break e}if(w>>>=X,A-=X,X=c-d,Q>X){if(X=Q-X,X>_&&Ae.sane){o.msg="invalid distance too far back",Ae.mode=R0;break e}if(te=0,ce=T,E===0){if(te+=g-X,X<ie){ie-=X;do Se[c++]=T[te++];while(--X);te=c-Q,ce=Se}}else if(E<X){if(te+=g+E-X,X-=E,X<ie){ie-=X;do Se[c++]=T[te++];while(--X);if(te=0,E<ie){X=E,ie-=X;do Se[c++]=T[te++];while(--X);te=c-Q,ce=Se}}}else if(te+=E-X,X<ie){ie-=X;do Se[c++]=T[te++];while(--X);te=c-Q,ce=Se}for(;ie>2;)Se[c++]=ce[te++],Se[c++]=ce[te++],Se[c++]=ce[te++],ie-=3;ie&&(Se[c++]=ce[te++],ie>1&&(Se[c++]=ce[te++]))}else{te=c-Q;do Se[c++]=Se[te++],Se[c++]=Se[te++],Se[c++]=Se[te++],ie-=3;while(ie>2);ie&&(Se[c++]=Se[te++],ie>1&&(Se[c++]=Se[te++]))}break}}break}}while(r<s&&c<h);ie=A>>3,r-=ie,A-=ie<<3,w&=(1<<A)-1,o.next_in=r,o.next_out=c,o.avail_in=r<s?s-r+5:5-(r-s),o.avail_out=c<h?h-c+257:257-(c-h),Ae.hold=w,Ae.bits=A};const I0=15,Xoe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Qoe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Zoe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ese=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Kg=(o,n,r,s,c,d,h,f)=>{const g=f.bits;let _,E,T,w,A,L,P=0,D=0,G=0,$=0,X=0,ie=0,Q=0,te=0,ce=0,le=0,Se=null;const Ae=new Uint16Array(16),st=new Uint16Array(16);let gt,nn,dr,un=null;for(P=0;P<=I0;P++)Ae[P]=0;for(D=0;D<s;D++)Ae[n[r+D]]++;for(X=g,$=I0;$>=1&&Ae[$]===0;$--);if(X>$&&(X=$),$===0)return c[d++]=20971520,c[d++]=20971520,f.bits=1,0;for(G=1;G<$&&Ae[G]===0;G++);for(X<G&&(X=G),te=1,P=1;P<=I0;P++)if(te<<=1,te-=Ae[P],te<0)return-1;if(te>0&&(o===0||$!==1))return-1;for(st[1]=0,P=1;P<I0;P++)st[P+1]=st[P]+Ae[P];for(D=0;D<s;D++)n[r+D]!==0&&(h[st[n[r+D]]++]=D);if(o===0?(Se=un=h,L=20):o===1?(Se=Xoe,un=Qoe,L=257):(Se=Zoe,un=ese,L=0),le=0,D=0,P=G,A=d,ie=X,Q=0,T=-1,ce=1<<X,w=ce-1,o===1&&ce>852||o===2&&ce>592)return 1;for(;;){gt=P-Q,h[D]+1<L?(nn=0,dr=h[D]):h[D]>=L?(nn=un[h[D]-L],dr=Se[h[D]-L]):(nn=96,dr=0),_=1<<P-Q,E=1<<ie,G=E;do E-=_,c[A+(le>>Q)+E]=gt<<24|nn<<16|dr|0;while(E!==0);for(_=1<<P-1;le&_;)_>>=1;if(_!==0?(le&=_-1,le+=_):le=0,D++,--Ae[P]==0){if(P===$)break;P=n[r+h[D]]}if(P>X&&(le&w)!==T){for(Q===0&&(Q=X),A+=G,ie=P-Q,te=1<<ie;ie+Q<$&&(te-=Ae[ie+Q],!(te<=0));)ie++,te<<=1;if(ce+=1<<ie,o===1&&ce>852||o===2&&ce>592)return 1;T=le&w,c[T]=X<<24|ie<<16|A-d|0}}return le!==0&&(c[A+le]=P-Q<<24|64<<16|0),f.bits=X,0};const{Z_FINISH:EB,Z_BLOCK:tse,Z_TREES:A0,Z_OK:Gu,Z_STREAM_END:nse,Z_NEED_DICT:rse,Z_STREAM_ERROR:Js,Z_DATA_ERROR:yB,Z_MEM_ERROR:SB,Z_BUF_ERROR:ise,Z_DEFLATED:TB}=Fp,O0=16180,N0=16190,il=16191,CA=16192,wA=16194,P0=16199,k0=16200,RA=16206,Dr=16209,bB=o=>(o>>>24&255)+(o>>>8&65280)+((65280&o)<<8)+((255&o)<<24);function ose(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Hu=o=>{if(!o)return 1;const n=o.state;return!n||n.strm!==o||n.mode<O0||n.mode>16211?1:0},CB=o=>{if(Hu(o))return Js;const n=o.state;return o.total_in=o.total_out=n.total=0,o.msg="",n.wrap&&(o.adler=1&n.wrap),n.mode=O0,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,Gu},wB=o=>{if(Hu(o))return Js;const n=o.state;return n.wsize=0,n.whave=0,n.wnext=0,CB(o)},RB=(o,n)=>{let r;if(Hu(o))return Js;const s=o.state;return n<0?(r=0,n=-n):(r=5+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?Js:(s.window!==null&&s.wbits!==n&&(s.window=null),s.wrap=r,s.wbits=n,wB(o))},IB=(o,n)=>{if(!o)return Js;const r=new ose;o.state=r,r.strm=o,r.window=null,r.mode=O0;const s=RB(o,n);return s!==Gu&&(o.state=null),s};let IA,AA,AB=!0;const sse=o=>{if(AB){IA=new Int32Array(512),AA=new Int32Array(32);let n=0;for(;n<144;)o.lens[n++]=8;for(;n<256;)o.lens[n++]=9;for(;n<280;)o.lens[n++]=7;for(;n<288;)o.lens[n++]=8;for(Kg(1,o.lens,0,288,IA,0,o.work,{bits:9}),n=0;n<32;)o.lens[n++]=5;Kg(2,o.lens,0,32,AA,0,o.work,{bits:5}),AB=!1}o.lencode=IA,o.lenbits=9,o.distcode=AA,o.distbits=5},OB=(o,n,r,s)=>{let c;const d=o.state;return d.window===null&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new Uint8Array(d.wsize)),s>=d.wsize?(d.window.set(n.subarray(r-d.wsize,r),0),d.wnext=0,d.whave=d.wsize):(c=d.wsize-d.wnext,c>s&&(c=s),d.window.set(n.subarray(r-s,r-s+c),d.wnext),(s-=c)?(d.window.set(n.subarray(r-s,r),0),d.wnext=s,d.whave=d.wsize):(d.wnext+=c,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=c))),0};var ase=(o,n)=>{let r,s,c,d,h,f,g,_,E,T,w,A,L,P,D,G,$,X,ie,Q,te,ce,le=0;const Se=new Uint8Array(4);let Ae,st;const gt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Hu(o)||!o.output||!o.input&&o.avail_in!==0)return Js;r=o.state,r.mode===il&&(r.mode=CA),h=o.next_out,c=o.output,g=o.avail_out,d=o.next_in,s=o.input,f=o.avail_in,_=r.hold,E=r.bits,T=f,w=g,ce=Gu;e:for(;;)switch(r.mode){case O0:if(r.wrap===0){r.mode=CA;break}for(;E<16;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if(2&r.wrap&&_===35615){r.wbits===0&&(r.wbits=15),r.check=0,Se[0]=255&_,Se[1]=_>>>8&255,r.check=Di(r.check,Se,2,0),_=0,E=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&_)<<8)+(_>>8))%31){o.msg="incorrect header check",r.mode=Dr;break}if((15&_)!==TB){o.msg="unknown compression method",r.mode=Dr;break}if(_>>>=4,E-=4,te=8+(15&_),r.wbits===0&&(r.wbits=te),te>15||te>r.wbits){o.msg="invalid window size",r.mode=Dr;break}r.dmax=1<<r.wbits,r.flags=0,o.adler=r.check=1,r.mode=512&_?16189:il,_=0,E=0;break;case 16181:for(;E<16;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if(r.flags=_,(255&r.flags)!==TB){o.msg="unknown compression method",r.mode=Dr;break}if(57344&r.flags){o.msg="unknown header flags set",r.mode=Dr;break}r.head&&(r.head.text=_>>8&1),512&r.flags&&4&r.wrap&&(Se[0]=255&_,Se[1]=_>>>8&255,r.check=Di(r.check,Se,2,0)),_=0,E=0,r.mode=16182;case 16182:for(;E<32;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}r.head&&(r.head.time=_),512&r.flags&&4&r.wrap&&(Se[0]=255&_,Se[1]=_>>>8&255,Se[2]=_>>>16&255,Se[3]=_>>>24&255,r.check=Di(r.check,Se,4,0)),_=0,E=0,r.mode=16183;case 16183:for(;E<16;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}r.head&&(r.head.xflags=255&_,r.head.os=_>>8),512&r.flags&&4&r.wrap&&(Se[0]=255&_,Se[1]=_>>>8&255,r.check=Di(r.check,Se,2,0)),_=0,E=0,r.mode=16184;case 16184:if(1024&r.flags){for(;E<16;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}r.length=_,r.head&&(r.head.extra_len=_),512&r.flags&&4&r.wrap&&(Se[0]=255&_,Se[1]=_>>>8&255,r.check=Di(r.check,Se,2,0)),_=0,E=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(A=r.length,A>f&&(A=f),A&&(r.head&&(te=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(s.subarray(d,d+A),te)),512&r.flags&&4&r.wrap&&(r.check=Di(r.check,s,A,d)),f-=A,d+=A,r.length-=A),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(f===0)break e;A=0;do te=s[d+A++],r.head&&te&&r.length<65536&&(r.head.name+=String.fromCharCode(te));while(te&&A<f);if(512&r.flags&&4&r.wrap&&(r.check=Di(r.check,s,A,d)),f-=A,d+=A,te)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(f===0)break e;A=0;do te=s[d+A++],r.head&&te&&r.length<65536&&(r.head.comment+=String.fromCharCode(te));while(te&&A<f);if(512&r.flags&&4&r.wrap&&(r.check=Di(r.check,s,A,d)),f-=A,d+=A,te)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;E<16;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if(4&r.wrap&&_!==(65535&r.check)){o.msg="header crc mismatch",r.mode=Dr;break}_=0,E=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),o.adler=r.check=0,r.mode=il;break;case 16189:for(;E<32;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}o.adler=r.check=bB(_),_=0,E=0,r.mode=N0;case N0:if(r.havedict===0)return o.next_out=h,o.avail_out=g,o.next_in=d,o.avail_in=f,r.hold=_,r.bits=E,rse;o.adler=r.check=1,r.mode=il;case il:if(n===tse||n===A0)break e;case CA:if(r.last){_>>>=7&E,E-=7&E,r.mode=RA;break}for(;E<3;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}switch(r.last=1&_,_>>>=1,E-=1,3&_){case 0:r.mode=16193;break;case 1:if(sse(r),r.mode=P0,n===A0){_>>>=2,E-=2;break e}break;case 2:r.mode=16196;break;case 3:o.msg="invalid block type",r.mode=Dr}_>>>=2,E-=2;break;case 16193:for(_>>>=7&E,E-=7&E;E<32;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if((65535&_)!=(_>>>16^65535)){o.msg="invalid stored block lengths",r.mode=Dr;break}if(r.length=65535&_,_=0,E=0,r.mode=wA,n===A0)break e;case wA:r.mode=16195;case 16195:if(A=r.length,A){if(A>f&&(A=f),A>g&&(A=g),A===0)break e;c.set(s.subarray(d,d+A),h),f-=A,d+=A,g-=A,h+=A,r.length-=A;break}r.mode=il;break;case 16196:for(;E<14;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if(r.nlen=257+(31&_),_>>>=5,E-=5,r.ndist=1+(31&_),_>>>=5,E-=5,r.ncode=4+(15&_),_>>>=4,E-=4,r.nlen>286||r.ndist>30){o.msg="too many length or distance symbols",r.mode=Dr;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;E<3;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}r.lens[gt[r.have++]]=7&_,_>>>=3,E-=3}for(;r.have<19;)r.lens[gt[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Ae={bits:r.lenbits},ce=Kg(0,r.lens,0,19,r.lencode,0,r.work,Ae),r.lenbits=Ae.bits,ce){o.msg="invalid code lengths set",r.mode=Dr;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;le=r.lencode[_&(1<<r.lenbits)-1],D=le>>>24,G=le>>>16&255,$=65535&le,!(D<=E);){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if($<16)_>>>=D,E-=D,r.lens[r.have++]=$;else{if($===16){for(st=D+2;E<st;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if(_>>>=D,E-=D,r.have===0){o.msg="invalid bit length repeat",r.mode=Dr;break}te=r.lens[r.have-1],A=3+(3&_),_>>>=2,E-=2}else if($===17){for(st=D+3;E<st;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}_>>>=D,E-=D,te=0,A=3+(7&_),_>>>=3,E-=3}else{for(st=D+7;E<st;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}_>>>=D,E-=D,te=0,A=11+(127&_),_>>>=7,E-=7}if(r.have+A>r.nlen+r.ndist){o.msg="invalid bit length repeat",r.mode=Dr;break}for(;A--;)r.lens[r.have++]=te}}if(r.mode===Dr)break;if(r.lens[256]===0){o.msg="invalid code -- missing end-of-block",r.mode=Dr;break}if(r.lenbits=9,Ae={bits:r.lenbits},ce=Kg(1,r.lens,0,r.nlen,r.lencode,0,r.work,Ae),r.lenbits=Ae.bits,ce){o.msg="invalid literal/lengths set",r.mode=Dr;break}if(r.distbits=6,r.distcode=r.distdyn,Ae={bits:r.distbits},ce=Kg(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Ae),r.distbits=Ae.bits,ce){o.msg="invalid distances set",r.mode=Dr;break}if(r.mode=P0,n===A0)break e;case P0:r.mode=k0;case k0:if(f>=6&&g>=258){o.next_out=h,o.avail_out=g,o.next_in=d,o.avail_in=f,r.hold=_,r.bits=E,Joe(o,w),h=o.next_out,c=o.output,g=o.avail_out,d=o.next_in,s=o.input,f=o.avail_in,_=r.hold,E=r.bits,r.mode===il&&(r.back=-1);break}for(r.back=0;le=r.lencode[_&(1<<r.lenbits)-1],D=le>>>24,G=le>>>16&255,$=65535&le,!(D<=E);){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if(G&&!(240&G)){for(X=D,ie=G,Q=$;le=r.lencode[Q+((_&(1<<X+ie)-1)>>X)],D=le>>>24,G=le>>>16&255,$=65535&le,!(X+D<=E);){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}_>>>=X,E-=X,r.back+=X}if(_>>>=D,E-=D,r.back+=D,r.length=$,G===0){r.mode=16205;break}if(32&G){r.back=-1,r.mode=il;break}if(64&G){o.msg="invalid literal/length code",r.mode=Dr;break}r.extra=15&G,r.mode=16201;case 16201:if(r.extra){for(st=r.extra;E<st;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}r.length+=_&(1<<r.extra)-1,_>>>=r.extra,E-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;le=r.distcode[_&(1<<r.distbits)-1],D=le>>>24,G=le>>>16&255,$=65535&le,!(D<=E);){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if(!(240&G)){for(X=D,ie=G,Q=$;le=r.distcode[Q+((_&(1<<X+ie)-1)>>X)],D=le>>>24,G=le>>>16&255,$=65535&le,!(X+D<=E);){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}_>>>=X,E-=X,r.back+=X}if(_>>>=D,E-=D,r.back+=D,64&G){o.msg="invalid distance code",r.mode=Dr;break}r.offset=$,r.extra=15&G,r.mode=16203;case 16203:if(r.extra){for(st=r.extra;E<st;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}r.offset+=_&(1<<r.extra)-1,_>>>=r.extra,E-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){o.msg="invalid distance too far back",r.mode=Dr;break}r.mode=16204;case 16204:if(g===0)break e;if(A=w-g,r.offset>A){if(A=r.offset-A,A>r.whave&&r.sane){o.msg="invalid distance too far back",r.mode=Dr;break}A>r.wnext?(A-=r.wnext,L=r.wsize-A):L=r.wnext-A,A>r.length&&(A=r.length),P=r.window}else P=c,L=h-r.offset,A=r.length;A>g&&(A=g),g-=A,r.length-=A;do c[h++]=P[L++];while(--A);r.length===0&&(r.mode=k0);break;case 16205:if(g===0)break e;c[h++]=r.length,g--,r.mode=k0;break;case RA:if(r.wrap){for(;E<32;){if(f===0)break e;f--,_|=s[d++]<<E,E+=8}if(w-=g,o.total_out+=w,r.total+=w,4&r.wrap&&w&&(o.adler=r.check=r.flags?Di(r.check,c,w,h-w):jg(r.check,c,w,h-w)),w=g,4&r.wrap&&(r.flags?_:bB(_))!==r.check){o.msg="incorrect data check",r.mode=Dr;break}_=0,E=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;E<32;){if(f===0)break e;f--,_+=s[d++]<<E,E+=8}if(4&r.wrap&&_!==(4294967295&r.total)){o.msg="incorrect length check",r.mode=Dr;break}_=0,E=0}r.mode=16208;case 16208:ce=nse;break e;case Dr:ce=yB;break e;case 16210:return SB;default:return Js}return o.next_out=h,o.avail_out=g,o.next_in=d,o.avail_in=f,r.hold=_,r.bits=E,(r.wsize||w!==o.avail_out&&r.mode<Dr&&(r.mode<RA||n!==EB))&&OB(o,o.output,o.next_out,w-o.avail_out),T-=o.avail_in,w-=o.avail_out,o.total_in+=T,o.total_out+=w,r.total+=w,4&r.wrap&&w&&(o.adler=r.check=r.flags?Di(r.check,c,w,o.next_out-w):jg(r.check,c,w,o.next_out-w)),o.data_type=r.bits+(r.last?64:0)+(r.mode===il?128:0)+(r.mode===P0||r.mode===wA?256:0),(T===0&&w===0||n===EB)&&ce===Gu&&(ce=ise),ce},ol={inflateReset:wB,inflateReset2:RB,inflateResetKeep:CB,inflateInit:o=>IB(o,15),inflateInit2:IB,inflate:ase,inflateEnd:o=>{if(Hu(o))return Js;let n=o.state;return n.window&&(n.window=null),o.state=null,Gu},inflateGetHeader:(o,n)=>{if(Hu(o))return Js;const r=o.state;return 2&r.wrap?(r.head=n,n.done=!1,Gu):Js},inflateSetDictionary:(o,n)=>{const r=n.length;let s,c,d;return Hu(o)?Js:(s=o.state,s.wrap!==0&&s.mode!==N0?Js:s.mode===N0&&(c=1,c=jg(c,n,r,0),c!==s.check)?yB:(d=OB(o,n,r,r),d?(s.mode=16210,SB):(s.havedict=1,Gu)))},inflateInfo:"pako inflate (from Nodeca project)"},cse=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const NB=Object.prototype.toString,{Z_NO_FLUSH:lse,Z_FINISH:dse,Z_OK:Yg,Z_STREAM_END:OA,Z_NEED_DICT:NA,Z_STREAM_ERROR:use,Z_DATA_ERROR:PB,Z_MEM_ERROR:hse}=Fp;function qg(o){this.options=C0.assign({chunkSize:65536,windowBits:15,to:""},o||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),!(n.windowBits>=0&&n.windowBits<16)||o&&o.windowBits||(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&!(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _B,this.strm.avail_out=0;let r=ol.inflateInit2(this.strm,n.windowBits);if(r!==Yg)throw new Error(Vu[r]);if(this.header=new cse,ol.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=Hg.string2buf(n.dictionary):NB.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(r=ol.inflateSetDictionary(this.strm,n.dictionary),r!==Yg)))throw new Error(Vu[r])}function PA(o,n){const r=new qg(n);if(r.push(o),r.err)throw r.msg||Vu[r.err];return r.result}qg.prototype.push=function(o,n){const r=this.strm,s=this.options.chunkSize,c=this.options.dictionary;let d,h,f;if(this.ended)return!1;for(h=n===~~n?n:n===!0?dse:lse,NB.call(o)==="[object ArrayBuffer]"?r.input=new Uint8Array(o):r.input=o,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(s),r.next_out=0,r.avail_out=s),d=ol.inflate(r,h),d===NA&&c&&(d=ol.inflateSetDictionary(r,c),d===Yg?d=ol.inflate(r,h):d===PB&&(d=NA));r.avail_in>0&&d===OA&&r.state.wrap>0&&o[r.next_in]!==0;)ol.inflateReset(r),d=ol.inflate(r,h);switch(d){case use:case PB:case NA:case hse:return this.onEnd(d),this.ended=!0,!1}if(f=r.avail_out,r.next_out&&(r.avail_out===0||d===OA))if(this.options.to==="string"){let g=Hg.utf8border(r.output,r.next_out),_=r.next_out-g,E=Hg.buf2string(r.output,g);r.next_out=_,r.avail_out=s-_,_&&r.output.set(r.output.subarray(g,g+_),0),this.onData(E)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(d!==Yg||f!==0){if(d===OA)return d=ol.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},qg.prototype.onData=function(o){this.chunks.push(o)},qg.prototype.onEnd=function(o){o===Yg&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=C0.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg};var pse={Inflate:qg,inflate:PA,inflateRaw:function(o,n){return(n=n||{}).raw=!0,PA(o,n)},ungzip:PA,constants:Fp};const{Deflate:PLe,deflate:fse,deflateRaw:kLe,gzip:DLe}=qoe,{Inflate:xLe,inflate:mse,inflateRaw:LLe,ungzip:MLe}=pse;var kA,gse=fse,_se=mse;(function(o){o[o.ONE_BYTE=0]="ONE_BYTE",o[o.TWO_BYTE=1]="TWO_BYTE"})(kA||(kA={}));class vse{constructor(){I(this,"_sequence",0),I(this,"_startTime",Date.now()),I(this,"isUseOneByte",!0)}get startTime(){const n=Date.now()-this._startTime;return n<Math.pow(2,16)?n:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(n){const r={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:n};if(n.byteLength>128){const f=new Uint8Array(4);f.set([1,0,0,0]);const g={id:0,length:4,data:f.buffer},_={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[g]};r.commonPacketHeader.extension=1,r.extension=_,r.payload=this.compress(n),r.commonPacketHeader.length=8+(r.extension.length+2)+r.payload.byteLength}else r.commonPacketHeader.length=8+r.payload.byteLength;Y("SHOW_DATASTREAM2_LOG")&&O.debug("send data header: ".concat(JSON.stringify(r.commonPacketHeader)));const s=new ArrayBuffer(r.commonPacketHeader.length),c=new Uint8Array(s),d=new DataView(s);let h=0;if(d.setUint16(h,r.commonPacketHeader.extension<<15|r.commonPacketHeader.reserved<<14|r.commonPacketHeader.length,!0),h+=2,d.setUint32(h,r.commonPacketHeader.sequence,!0),h+=4,d.setUint16(h,r.commonStreamHeader,!0),h+=2,r.extension){const f=this.serializeExtension(r.extension);c.set(new Uint8Array(f),h),h+=f.byteLength}if(c.set(new Uint8Array(r.payload),h),h+=r.payload.byteLength,h!==r.commonPacketHeader.length)throw Error("serialize error!");return s}deserialize(n){if(n.byteLength<4)return new ArrayBuffer(0);const r=new DataView(n);let s=0;const c=r.getUint16(s,!0);s+=2;const d={length:16383&c,reserved:(16384&c)>>14,extension:(32768&c)>>15,sequence:r.getUint16(s+2,!0)<<16|r.getUint16(s,!0)};let h,f;if(s+=4,Y("SHOW_DATASTREAM2_LOG")&&O.debug("receive data header: ".concat(JSON.stringify(d))),r.getUint16(s,!0),s+=2,d.extension){f=this.deserializeExtension(n.slice(s)),s+=2+f.length,h=n.slice(s);let g=!1;if(f.datas.length>0){const _=f.datas.find(E=>E.id===0);_&&(g=(1&new DataView(_.data).getUint32(0,!0))==1)}h=g?this.decompress(h):h}else h=n.slice(8);return h}serializeExtension(n){const{profile:r,length:s,datas:c}=n,d=new ArrayBuffer(s+2),h=new Uint8Array(d),f=new DataView(d);let g=0;if(f.setUint8(g++,r),f.setUint8(g++,s),c.forEach(_=>{r?(f.setUint8(g++,_.id),f.setUint8(g++,_.length),h.set(new Uint8Array(_.data),g),g+=_.data.byteLength):(f.setUint8(g++,_.id|_.length<<4),h.set(new Uint8Array(_.data),g),g+=_.data.byteLength)}),g!==s+2)throw Error("serialize extension error, is ".concat(g,"!==").concat(s+2));return d}deserializeExtension(n){const r=new DataView(n);let s=0;const c=r.getUint8(s);s++;const d=r.getUint8(s);s++;const h=c===kA.TWO_BYTE,f=[],g=new DataView(n,2);let _=0;for(;_<d;){let E=0,T=0,w=new ArrayBuffer(0);h?(E=g.getUint8(_),_++,T=g.getUint8(_),_++):(E=15&g.getUint8(_),T=g.getUint8(_)>>4,_++),T>0&&(w=g.buffer.slice(_+2,_+2+T),_+=w.byteLength),f.push({id:E,length:T,data:w})}if(_!==d)throw Error("parse error");return{profile:c,length:d,datas:f}}decompress(n){return _se(new Uint8Array(n))}compress(n){return gse(new Uint8Array(n))}}class kB extends mn{constructor(n,r){super(),I(this,"_version",1),I(this,"_type",3),I(this,"_config",void 0),I(this,"_originDataChannel",void 0),I(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),I(this,"_dataStreamPacketHandler",void 0),I(this,"_datachannelEventMap",new Map),this._config=n,r&&(this._originDataChannel=r,this._bandDataChannelEvents(r)),this._initPacketHeader(),this._dataStreamPacketHandler=new vse}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return Y("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var n,r;return(n=(r=this._originDataChannel)===null||r===void 0?void 0:r.readyState)!==null&&n!==void 0?n:"connecting"}get _originDataChannelId(){var n,r;return(n=(r=this._originDataChannel)===null||r===void 0?void 0:r.id)!==null&&n!==void 0?n:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new ae((n,r)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&n();const s=setTimeout(()=>{var c;r(new he(B.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((c=this._originDataChannel)===null||c===void 0?void 0:c.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(s),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),n()},this._originDataChannel.onerror=()=>{throw clearTimeout(s),new he(B.DATACHANNEL_CONNECTION_TIMEOUT)}}else r(new he(B.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(n){this._originDataChannel=n,this._bandDataChannelEvents(n)}_initPacketHeader(){const n=new DataView(this._dataStreamPacketHeader);n.setUint16(0,this._version),n.setUint8(2,this._type),n.setUint8(3,this._config.id)}_bandDataChannelEvents(n){this._unbindDataChannelEvents(n),[Lp.OPEN,Lp.CLOSE,Lp.ERROR].forEach(r=>{const s=()=>{this.emit(r)};this._datachannelEventMap.set(r,s),n.addEventListener(r,s)})}_unbindDataChannelEvents(n){Array.from(this._datachannelEventMap.entries()).forEach(r=>{let[s,c]=r;n.removeEventListener(s,c)}),this._datachannelEventMap.clear()}}class Ese extends kB{constructor(n){super(n),I(this,"_messageListener",void 0),this._messageListener=r=>{if(r.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const s=r.data.slice(0,this._dataStreamPacketHeader.byteLength),c=new DataView(s).getUint8(3);if(c!==this.id)return void(Y("SHOW_DATASTREAM2_LOG")&&O.debug("invalid datachannel id: ".concat(c," !== ").concat(this.id)));let d=r.data.slice(this._dataStreamPacketHeader.byteLength);d=this._dataStreamPacketHandler.deserialize(d),this.emit(Lp.MESSAGE,d)}}_updateOriginDataChannel(n){super._updateOriginDataChannel(n),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class DB extends kB{send(n){if(this._originDataChannel){let r=n;r=this._dataStreamPacketHandler.serialize(n);const s=new Uint8Array(this._dataStreamPacketHeader.byteLength+r.byteLength);s.set(new Uint8Array(this._dataStreamPacketHeader),0),s.set(new Uint8Array(r),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(s.buffer)}}}var yse=p,Sse=er("iterator"),DA=!yse(function(){var o=new URL("b?a=1&b=2&c=3","http://a"),n=o.searchParams,r=new URLSearchParams("a=1&a=2"),s="";return o.pathname="c%20d",n.forEach(function(c,d){n.delete("b"),s+=d+c}),r.delete("a",2),!o.toJSON||!r.has("a",1)||r.has("a",2)||!n.size&&!0||!n.sort||o.href!=="http://a/c%20d?a=1&c=3"||n.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!n[Sse]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||s!=="a1c3"||new URL("http://x",void 0).host!=="x"}),Tse=Kl,xA=En,zp=U,D0=be,dc=R,Gp=Te,xB=DA,LB=Kl,bse=ly,Cse=function(o,n,r){for(var s in n)r&&r.unsafe&&o[s]?o[s]=n[s]:Tse(o,s,n[s],r);return o},wse=Yl,Rse=cM,LA=cp,MB=bR,MA=Oe,Ise=ci,Ase=ge,Ose=$l,Nse=Bt,UB=br,To=Bs,Pse=eg,jB=kt,UA=vR,kse=Ty,Hp=Ry,Dse=BM,xse=er("iterator"),Jg="URLSearchParams",FB=Jg+"Iterator",VB=LA.set,Xs=LA.getterFor(Jg),Lse=LA.getterFor(FB),Mse=Object.getOwnPropertyDescriptor,jA=function(o){if(!Gp)return zp[o];var n=Mse(zp,o);return n&&n.value},BB=jA("fetch"),x0=jA("Request"),Xg=jA("Headers"),FA=x0&&x0.prototype,WB=Xg&&Xg.prototype,Use=zp.RegExp,jse=zp.TypeError,zB=zp.decodeURIComponent,Fse=zp.encodeURIComponent,Vse=dc("".charAt),GB=dc([].join),$u=dc([].push),VA=dc("".replace),Bse=dc([].shift),HB=dc([].splice),$B=dc("".split),Wse=dc("".slice),zse=/\+/g,KB=Array(4),Gse=function(o){return KB[o-1]||(KB[o-1]=Use("((?:%[\\da-f]{2}){"+o+"})","gi"))},Hse=function(o){try{return zB(o)}catch{return o}},YB=function(o){var n=VA(o,zse," "),r=4;try{return zB(n)}catch{for(;r;)n=VA(n,Gse(r--),Hse);return n}},$se=/[!'()~]|%20/g,Kse={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Yse=function(o){return Kse[o]},qB=function(o){return VA(Fse(o),$se,Yse)},BA=Rse(function(o,n){VB(this,{type:FB,iterator:UA(Xs(o).entries),kind:n})},"Iterator",function(){var o=Lse(this),n=o.kind,r=o.iterator.next(),s=r.value;return r.done||(r.value=n==="keys"?s.key:n==="values"?s.value:[s.key,s.value]),r},!0),JB=function(o){this.entries=[],this.url=null,o!==void 0&&(UB(o)?this.parseObject(o):this.parseQuery(typeof o=="string"?Vse(o,0)==="?"?Wse(o,1):o:To(o)))};JB.prototype={type:Jg,bindURL:function(o){this.url=o,this.update()},parseObject:function(o){var n,r,s,c,d,h,f,g=kse(o);if(g)for(r=(n=UA(o,g)).next;!(s=D0(r,n)).done;){if(d=(c=UA(Nse(s.value))).next,(h=D0(d,c)).done||(f=D0(d,c)).done||!D0(d,c).done)throw jse("Expected sequence with length 2");$u(this.entries,{key:To(h.value),value:To(f.value)})}else for(var _ in o)Ise(o,_)&&$u(this.entries,{key:_,value:To(o[_])})},parseQuery:function(o){if(o)for(var n,r,s=$B(o,"&"),c=0;c<s.length;)(n=s[c++]).length&&(r=$B(n,"="),$u(this.entries,{key:YB(Bse(r)),value:YB(GB(r,"="))}))},serialize:function(){for(var o,n=this.entries,r=[],s=0;s<n.length;)o=n[s++],$u(r,qB(o.key)+"="+qB(o.value));return GB(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var L0=function(){MB(this,$p);var o=VB(this,new JB(arguments.length>0?arguments[0]:void 0));Gp||(this.size=o.entries.length)},$p=L0.prototype;if(Cse($p,{append:function(o,n){var r=Xs(this);Hp(arguments.length,2),$u(r.entries,{key:To(o),value:To(n)}),Gp||this.length++,r.updateURL()},delete:function(o){for(var n=Xs(this),r=Hp(arguments.length,1),s=n.entries,c=To(o),d=r<2?void 0:arguments[1],h=d===void 0?d:To(d),f=0;f<s.length;){var g=s[f];if(g.key!==c||h!==void 0&&g.value!==h)f++;else if(HB(s,f,1),h!==void 0)break}Gp||(this.size=s.length),n.updateURL()},get:function(o){var n=Xs(this).entries;Hp(arguments.length,1);for(var r=To(o),s=0;s<n.length;s++)if(n[s].key===r)return n[s].value;return null},getAll:function(o){var n=Xs(this).entries;Hp(arguments.length,1);for(var r=To(o),s=[],c=0;c<n.length;c++)n[c].key===r&&$u(s,n[c].value);return s},has:function(o){for(var n=Xs(this).entries,r=Hp(arguments.length,1),s=To(o),c=r<2?void 0:arguments[1],d=c===void 0?c:To(c),h=0;h<n.length;){var f=n[h++];if(f.key===s&&(d===void 0||f.value===d))return!0}return!1},set:function(o,n){var r=Xs(this);Hp(arguments.length,1);for(var s,c=r.entries,d=!1,h=To(o),f=To(n),g=0;g<c.length;g++)(s=c[g]).key===h&&(d?HB(c,g--,1):(d=!0,s.value=f));d||$u(c,{key:h,value:f}),Gp||(this.size=c.length),r.updateURL()},sort:function(){var o=Xs(this);Dse(o.entries,function(n,r){return n.key>r.key?1:-1}),o.updateURL()},forEach:function(o){for(var n,r=Xs(this).entries,s=Ase(o,arguments.length>1?arguments[1]:void 0),c=0;c<r.length;)s((n=r[c++]).value,n.key,this)},keys:function(){return new BA(this,"keys")},values:function(){return new BA(this,"values")},entries:function(){return new BA(this,"entries")}},{enumerable:!0}),LB($p,xse,$p.entries,{name:"entries"}),LB($p,"toString",function(){return Xs(this).serialize()},{enumerable:!0}),Gp&&bse($p,"size",{get:function(){return Xs(this).entries.length},configurable:!0,enumerable:!0}),wse(L0,Jg),xA({global:!0,constructor:!0,forced:!xB},{URLSearchParams:L0}),!xB&&MA(Xg)){var qse=dc(WB.has),Jse=dc(WB.set),XB=function(o){if(UB(o)){var n,r=o.body;if(Ose(r)===Jg)return n=o.headers?new Xg(o.headers):new Xg,qse(n,"content-type")||Jse(n,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Pse(o,{body:jB(0,To(r)),headers:jB(0,n)})}return o};if(MA(BB)&&xA({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(o){return BB(o,arguments.length>1?XB(arguments[1]):{})}}),MA(x0)){var WA=function(o){return MB(this,FA),new x0(o,arguments.length>1?XB(arguments[1]):{})};FA.constructor=WA,WA.prototype=FA,xA({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:WA})}}var Qs,Xse={URLSearchParams:L0,getState:Xs},QB=Te,Qse=R,Zse=be,eae=p,zA=iy,tae=tg,nae=xe,rae=Vs,iae=St,Kp=Object.assign,ZB=Object.defineProperty,oae=Qse([].concat),sae=!Kp||eae(function(){if(QB&&Kp({b:1},Kp(ZB({},"a",{enumerable:!0,get:function(){ZB(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var o={},n={},r=Symbol(),s="abcdefghijklmnopqrst";return o[r]=7,s.split("").forEach(function(c){n[c]=c}),Kp({},o)[r]!=7||zA(Kp({},n)).join("")!=s})?function(o,n){for(var r=rae(o),s=arguments.length,c=1,d=tae.f,h=nae.f;s>c;)for(var f,g=iae(arguments[c++]),_=d?oae(zA(g),d(g)):zA(g),E=_.length,T=0;E>T;)f=_[T++],QB&&!Zse(h,g,f)||(r[f]=g[f]);return r}:Kp,aae=Bt,cae=oU,lae=ge,dae=be,uae=Vs,hae=function(o,n,r,s){try{return s?n(aae(r)[0],r[1]):n(r)}catch(c){cae(o,"throw",c)}},pae=nU,fae=Dw,mae=Gl,e3=Nw,gae=vR,_ae=Ty,t3=Array,Ku=R,GA=2147483647,vae=/[^\0-\u007E]/,n3=/[.\u3002\uFF0E\uFF61]/g,r3="Overflow: input needs wider integers to process",i3=RangeError,Eae=Ku(n3.exec),Yp=Math.floor,HA=String.fromCharCode,o3=Ku("".charCodeAt),s3=Ku([].join),yd=Ku([].push),yae=Ku("".replace),Sae=Ku("".split),Tae=Ku("".toLowerCase),a3=function(o){return o+22+75*(o<26)},bae=function(o,n,r){var s=0;for(o=r?Yp(o/700):o>>1,o+=Yp(o/n);o>455;)o=Yp(o/35),s+=36;return Yp(s+36*o/(o+38))},Cae=function(o){var n=[];o=function(G){for(var $=[],X=0,ie=G.length;X<ie;){var Q=o3(G,X++);if(Q>=55296&&Q<=56319&&X<ie){var te=o3(G,X++);(64512&te)==56320?yd($,((1023&Q)<<10)+(1023&te)+65536):(yd($,Q),X--)}else yd($,Q)}return $}(o);var r,s,c=o.length,d=128,h=0,f=72;for(r=0;r<o.length;r++)(s=o[r])<128&&yd(n,HA(s));var g=n.length,_=g;for(g&&yd(n,"-");_<c;){var E=GA;for(r=0;r<o.length;r++)(s=o[r])>=d&&s<E&&(E=s);var T=_+1;if(E-d>Yp((GA-h)/T))throw i3(r3);for(h+=(E-d)*T,d=E,r=0;r<o.length;r++){if((s=o[r])<d&&++h>GA)throw i3(r3);if(s==d){for(var w=h,A=36;;){var L=A<=f?1:A>=f+26?26:A-f;if(w<L)break;var P=w-L,D=36-L;yd(n,HA(a3(L+P%D))),w=Yp(P/D),A+=36}yd(n,HA(a3(w))),f=bae(h,T,_==g),h=0,_++}}h++,d++}return s3(n,"")},wae=En,$A=Te,Rae=DA,KA=U,l3=ge,Zs=R,M0=Kl,ea=ly,Iae=bR,YA=ci,qA=sae,qp=function(o){var n=uae(o),r=fae(this),s=arguments.length,c=s>1?arguments[1]:void 0,d=c!==void 0;d&&(c=lae(c,s>2?arguments[2]:void 0));var h,f,g,_,E,T,w=_ae(n),A=0;if(!w||this===t3&&pae(w))for(h=mae(n),f=r?new this(h):t3(h);h>A;A++)T=d?c(n[A],A):n[A],e3(f,A,T);else for(E=(_=gae(n,w)).next,f=r?new this:[];!(g=dae(E,_)).done;A++)T=d?hae(_,c,[g.value,A],!0):g.value,e3(f,A,T);return f.length=A,f},Na=Vw,Aae=xM.codeAt,Oae=function(o){var n,r,s=[],c=Sae(yae(Tae(o),n3,"."),".");for(n=0;n<c.length;n++)r=c[n],yd(s,Eae(vae,r)?"xn--"+Cae(r):r);return s3(s,".")},sl=Bs,Nae=Yl,Pae=Ry,d3=Xse,u3=cp,kae=u3.set,U0=u3.getterFor("URL"),Dae=d3.URLSearchParams,xae=d3.getState,Qg=KA.URL,JA=KA.TypeError,j0=KA.parseInt,Lae=Math.floor,h3=Math.pow,ta=Zs("".charAt),Pa=Zs(/./.exec),Zg=Zs([].join),Mae=Zs(1 .toString),Uae=Zs([].pop),Jp=Zs([].push),XA=Zs("".replace),jae=Zs([].shift),Fae=Zs("".split),e_=Zs("".slice),F0=Zs("".toLowerCase),Vae=Zs([].unshift),QA="Invalid scheme",Yu="Invalid host",p3="Invalid port",f3=/[a-z]/i,Bae=/[\d+-.a-z]/i,ZA=/\d/,Wae=/^0x/i,zae=/^[0-7]+$/,Gae=/^\d+$/,m3=/^[\da-f]+$/i,Hae=/[\0\t\n\r #%/:<>?@[\\\]^|]/,$ae=/[\0\t\n\r #/:<>?@[\\\]^|]/,Kae=/^[\u0000-\u0020]+/,Yae=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,qae=/[\t\n\r]/g,t_=function(o){var n,r,s,c;if(typeof o=="number"){for(n=[],r=0;r<4;r++)Vae(n,o%256),o=Lae(o/256);return Zg(n,".")}if(typeof o=="object"){for(n="",s=function(d){for(var h=null,f=1,g=null,_=0,E=0;E<8;E++)d[E]!==0?(_>f&&(h=g,f=_),g=null,_=0):(g===null&&(g=E),++_);return _>f&&(h=g,f=_),h}(o),r=0;r<8;r++)c&&o[r]===0||(c&&(c=!1),s===r?(n+=r?":":"::",c=!0):(n+=Mae(o[r],16),r<7&&(n+=":")));return"["+n+"]"}return o},V0={},g3=qA({},V0,{" ":1,'"':1,"<":1,">":1,"`":1}),_3=qA({},g3,{"#":1,"?":1,"{":1,"}":1}),e1=qA({},_3,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Sd=function(o,n){var r=Aae(o,0);return r>32&&r<127&&!YA(n,o)?o:encodeURIComponent(o)},B0={ftp:21,file:null,http:80,https:443,ws:80,wss:443},n_=function(o,n){var r;return o.length==2&&Pa(f3,ta(o,0))&&((r=ta(o,1))==":"||!n&&r=="|")},v3=function(o){var n;return o.length>1&&n_(e_(o,0,2))&&(o.length==2||(n=ta(o,2))==="/"||n==="\\"||n==="?"||n==="#")},Jae=function(o){return o==="."||F0(o)==="%2e"},t1={},E3={},n1={},y3={},S3={},r1={},T3={},b3={},W0={},z0={},i1={},o1={},s1={},a1={},C3={},c1={},Xp={},uc={},w3={},qu={},al={},l1=function(o,n,r){var s,c,d,h=sl(o);if(n){if(c=this.parse(h))throw JA(c);this.searchParams=null}else{if(r!==void 0&&(s=new l1(r,!0)),c=this.parse(h,null,s))throw JA(c);(d=xae(new Dae)).bindURL(this),this.searchParams=d}};l1.prototype={type:"URL",parse:function(o,n,r){var s,c,d,h,f,g=this,_=n||t1,E=0,T="",w=!1,A=!1,L=!1;for(o=sl(o),n||(g.scheme="",g.username="",g.password="",g.host=null,g.port=null,g.path=[],g.query=null,g.fragment=null,g.cannotBeABaseURL=!1,o=XA(o,Kae,""),o=XA(o,Yae,"$1")),o=XA(o,qae,""),s=qp(o);E<=s.length;){switch(c=s[E],_){case t1:if(!c||!Pa(f3,c)){if(n)return QA;_=n1;continue}T+=F0(c),_=E3;break;case E3:if(c&&(Pa(Bae,c)||c=="+"||c=="-"||c=="."))T+=F0(c);else{if(c!=":"){if(n)return QA;T="",_=n1,E=0;continue}if(n&&(g.isSpecial()!=YA(B0,T)||T=="file"&&(g.includesCredentials()||g.port!==null)||g.scheme=="file"&&!g.host))return;if(g.scheme=T,n)return void(g.isSpecial()&&B0[g.scheme]==g.port&&(g.port=null));T="",g.scheme=="file"?_=a1:g.isSpecial()&&r&&r.scheme==g.scheme?_=y3:g.isSpecial()?_=b3:s[E+1]=="/"?(_=S3,E++):(g.cannotBeABaseURL=!0,Jp(g.path,""),_=w3)}break;case n1:if(!r||r.cannotBeABaseURL&&c!="#")return QA;if(r.cannotBeABaseURL&&c=="#"){g.scheme=r.scheme,g.path=Na(r.path),g.query=r.query,g.fragment="",g.cannotBeABaseURL=!0,_=al;break}_=r.scheme=="file"?a1:r1;continue;case y3:if(c!="/"||s[E+1]!="/"){_=r1;continue}_=W0,E++;break;case S3:if(c=="/"){_=z0;break}_=uc;continue;case r1:if(g.scheme=r.scheme,c==Qs)g.username=r.username,g.password=r.password,g.host=r.host,g.port=r.port,g.path=Na(r.path),g.query=r.query;else if(c=="/"||c=="\\"&&g.isSpecial())_=T3;else if(c=="?")g.username=r.username,g.password=r.password,g.host=r.host,g.port=r.port,g.path=Na(r.path),g.query="",_=qu;else{if(c!="#"){g.username=r.username,g.password=r.password,g.host=r.host,g.port=r.port,g.path=Na(r.path),g.path.length--,_=uc;continue}g.username=r.username,g.password=r.password,g.host=r.host,g.port=r.port,g.path=Na(r.path),g.query=r.query,g.fragment="",_=al}break;case T3:if(!g.isSpecial()||c!="/"&&c!="\\"){if(c!="/"){g.username=r.username,g.password=r.password,g.host=r.host,g.port=r.port,_=uc;continue}_=z0}else _=W0;break;case b3:if(_=W0,c!="/"||ta(T,E+1)!="/")continue;E++;break;case W0:if(c!="/"&&c!="\\"){_=z0;continue}break;case z0:if(c=="@"){w&&(T="%40"+T),w=!0,d=qp(T);for(var P=0;P<d.length;P++){var D=d[P];if(D!=":"||L){var G=Sd(D,e1);L?g.password+=G:g.username+=G}else L=!0}T=""}else if(c==Qs||c=="/"||c=="?"||c=="#"||c=="\\"&&g.isSpecial()){if(w&&T=="")return"Invalid authority";E-=qp(T).length+1,T="",_=i1}else T+=c;break;case i1:case o1:if(n&&g.scheme=="file"){_=c1;continue}if(c!=":"||A){if(c==Qs||c=="/"||c=="?"||c=="#"||c=="\\"&&g.isSpecial()){if(g.isSpecial()&&T=="")return Yu;if(n&&T==""&&(g.includesCredentials()||g.port!==null))return;if(h=g.parseHost(T))return h;if(T="",_=Xp,n)return;continue}c=="["?A=!0:c=="]"&&(A=!1),T+=c}else{if(T=="")return Yu;if(h=g.parseHost(T))return h;if(T="",_=s1,n==o1)return}break;case s1:if(!Pa(ZA,c)){if(c==Qs||c=="/"||c=="?"||c=="#"||c=="\\"&&g.isSpecial()||n){if(T!=""){var $=j0(T,10);if($>65535)return p3;g.port=g.isSpecial()&&$===B0[g.scheme]?null:$,T=""}if(n)return;_=Xp;continue}return p3}T+=c;break;case a1:if(g.scheme="file",c=="/"||c=="\\")_=C3;else{if(!r||r.scheme!="file"){_=uc;continue}if(c==Qs)g.host=r.host,g.path=Na(r.path),g.query=r.query;else if(c=="?")g.host=r.host,g.path=Na(r.path),g.query="",_=qu;else{if(c!="#"){v3(Zg(Na(s,E),""))||(g.host=r.host,g.path=Na(r.path),g.shortenPath()),_=uc;continue}g.host=r.host,g.path=Na(r.path),g.query=r.query,g.fragment="",_=al}}break;case C3:if(c=="/"||c=="\\"){_=c1;break}r&&r.scheme=="file"&&!v3(Zg(Na(s,E),""))&&(n_(r.path[0],!0)?Jp(g.path,r.path[0]):g.host=r.host),_=uc;continue;case c1:if(c==Qs||c=="/"||c=="\\"||c=="?"||c=="#"){if(!n&&n_(T))_=uc;else if(T==""){if(g.host="",n)return;_=Xp}else{if(h=g.parseHost(T))return h;if(g.host=="localhost"&&(g.host=""),n)return;T="",_=Xp}continue}T+=c;break;case Xp:if(g.isSpecial()){if(_=uc,c!="/"&&c!="\\")continue}else if(n||c!="?")if(n||c!="#"){if(c!=Qs&&(_=uc,c!="/"))continue}else g.fragment="",_=al;else g.query="",_=qu;break;case uc:if(c==Qs||c=="/"||c=="\\"&&g.isSpecial()||!n&&(c=="?"||c=="#")){if((f=F0(f=T))===".."||f==="%2e."||f===".%2e"||f==="%2e%2e"?(g.shortenPath(),c=="/"||c=="\\"&&g.isSpecial()||Jp(g.path,"")):Jae(T)?c=="/"||c=="\\"&&g.isSpecial()||Jp(g.path,""):(g.scheme=="file"&&!g.path.length&&n_(T)&&(g.host&&(g.host=""),T=ta(T,0)+":"),Jp(g.path,T)),T="",g.scheme=="file"&&(c==Qs||c=="?"||c=="#"))for(;g.path.length>1&&g.path[0]==="";)jae(g.path);c=="?"?(g.query="",_=qu):c=="#"&&(g.fragment="",_=al)}else T+=Sd(c,_3);break;case w3:c=="?"?(g.query="",_=qu):c=="#"?(g.fragment="",_=al):c!=Qs&&(g.path[0]+=Sd(c,V0));break;case qu:n||c!="#"?c!=Qs&&(c=="'"&&g.isSpecial()?g.query+="%27":g.query+=c=="#"?"%23":Sd(c,V0)):(g.fragment="",_=al);break;case al:c!=Qs&&(g.fragment+=Sd(c,g3))}E++}},parseHost:function(o){var n,r,s;if(ta(o,0)=="["){if(ta(o,o.length-1)!="]"||(n=function(c){var d,h,f,g,_,E,T,w=[0,0,0,0,0,0,0,0],A=0,L=null,P=0,D=function(){return ta(c,P)};if(D()==":"){if(ta(c,1)!=":")return;P+=2,L=++A}for(;D();){if(A==8)return;if(D()!=":"){for(d=h=0;h<4&&Pa(m3,D());)d=16*d+j0(D(),16),P++,h++;if(D()=="."){if(h==0||(P-=h,A>6))return;for(f=0;D();){if(g=null,f>0){if(!(D()=="."&&f<4))return;P++}if(!Pa(ZA,D()))return;for(;Pa(ZA,D());){if(_=j0(D(),10),g===null)g=_;else{if(g==0)return;g=10*g+_}if(g>255)return;P++}w[A]=256*w[A]+g,++f!=2&&f!=4||A++}if(f!=4)return;break}if(D()==":"){if(P++,!D())return}else if(D())return;w[A++]=d}else{if(L!==null)return;P++,L=++A}}if(L!==null)for(E=A-L,A=7;A!=0&&E>0;)T=w[A],w[A--]=w[L+E-1],w[L+--E]=T;else if(A!=8)return;return w}(e_(o,1,-1)),!n))return Yu;this.host=n}else if(this.isSpecial()){if(o=Oae(o),Pa(Hae,o)||(n=function(c){var d,h,f,g,_,E,T,w=Fae(c,".");if(w.length&&w[w.length-1]==""&&w.length--,(d=w.length)>4)return c;for(h=[],f=0;f<d;f++){if((g=w[f])=="")return c;if(_=10,g.length>1&&ta(g,0)=="0"&&(_=Pa(Wae,g)?16:8,g=e_(g,_==8?1:2)),g==="")E=0;else{if(!Pa(_==10?Gae:_==8?zae:m3,g))return c;E=j0(g,_)}Jp(h,E)}for(f=0;f<d;f++)if(E=h[f],f==d-1){if(E>=h3(256,5-d))return null}else if(E>255)return null;for(T=Uae(h),f=0;f<h.length;f++)T+=h[f]*h3(256,3-f);return T}(o),n===null))return Yu;this.host=n}else{if(Pa($ae,o))return Yu;for(n="",r=qp(o),s=0;s<r.length;s++)n+=Sd(r[s],V0);this.host=n}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return YA(B0,this.scheme)},shortenPath:function(){var o=this.path,n=o.length;!n||this.scheme=="file"&&n==1&&n_(o[0],!0)||o.length--},serialize:function(){var o=this,n=o.scheme,r=o.username,s=o.password,c=o.host,d=o.port,h=o.path,f=o.query,g=o.fragment,_=n+":";return c!==null?(_+="//",o.includesCredentials()&&(_+=r+(s?":"+s:"")+"@"),_+=t_(c),d!==null&&(_+=":"+d)):n=="file"&&(_+="//"),_+=o.cannotBeABaseURL?h[0]:h.length?"/"+Zg(h,"/"):"",f!==null&&(_+="?"+f),g!==null&&(_+="#"+g),_},setHref:function(o){var n=this.parse(o);if(n)throw JA(n);this.searchParams.update()},getOrigin:function(){var o=this.scheme,n=this.port;if(o=="blob")try{return new Qp(o.path[0]).origin}catch{return"null"}return o!="file"&&this.isSpecial()?o+"://"+t_(this.host)+(n!==null?":"+n:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(o){this.parse(sl(o)+":",t1)},getUsername:function(){return this.username},setUsername:function(o){var n=qp(sl(o));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<n.length;r++)this.username+=Sd(n[r],e1)}},getPassword:function(){return this.password},setPassword:function(o){var n=qp(sl(o));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<n.length;r++)this.password+=Sd(n[r],e1)}},getHost:function(){var o=this.host,n=this.port;return o===null?"":n===null?t_(o):t_(o)+":"+n},setHost:function(o){this.cannotBeABaseURL||this.parse(o,i1)},getHostname:function(){var o=this.host;return o===null?"":t_(o)},setHostname:function(o){this.cannotBeABaseURL||this.parse(o,o1)},getPort:function(){var o=this.port;return o===null?"":sl(o)},setPort:function(o){this.cannotHaveUsernamePasswordPort()||((o=sl(o))==""?this.port=null:this.parse(o,s1))},getPathname:function(){var o=this.path;return this.cannotBeABaseURL?o[0]:o.length?"/"+Zg(o,"/"):""},setPathname:function(o){this.cannotBeABaseURL||(this.path=[],this.parse(o,Xp))},getSearch:function(){var o=this.query;return o?"?"+o:""},setSearch:function(o){(o=sl(o))==""?this.query=null:(ta(o,0)=="?"&&(o=e_(o,1)),this.query="",this.parse(o,qu)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var o=this.fragment;return o?"#"+o:""},setHash:function(o){(o=sl(o))!=""?(ta(o,0)=="#"&&(o=e_(o,1)),this.fragment="",this.parse(o,al)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Qp=function(o){var n=Iae(this,bo),r=Pae(arguments.length,1)>1?arguments[1]:void 0,s=kae(n,new l1(o,!1,r));$A||(n.href=s.serialize(),n.origin=s.getOrigin(),n.protocol=s.getProtocol(),n.username=s.getUsername(),n.password=s.getPassword(),n.host=s.getHost(),n.hostname=s.getHostname(),n.port=s.getPort(),n.pathname=s.getPathname(),n.search=s.getSearch(),n.searchParams=s.getSearchParams(),n.hash=s.getHash())},bo=Qp.prototype,na=function(o,n){return{get:function(){return U0(this)[o]()},set:n&&function(r){return U0(this)[n](r)},configurable:!0,enumerable:!0}};if($A&&(ea(bo,"href",na("serialize","setHref")),ea(bo,"origin",na("getOrigin")),ea(bo,"protocol",na("getProtocol","setProtocol")),ea(bo,"username",na("getUsername","setUsername")),ea(bo,"password",na("getPassword","setPassword")),ea(bo,"host",na("getHost","setHost")),ea(bo,"hostname",na("getHostname","setHostname")),ea(bo,"port",na("getPort","setPort")),ea(bo,"pathname",na("getPathname","setPathname")),ea(bo,"search",na("getSearch","setSearch")),ea(bo,"searchParams",na("getSearchParams")),ea(bo,"hash",na("getHash","setHash"))),M0(bo,"toJSON",function(){return U0(this).serialize()},{enumerable:!0}),M0(bo,"toString",function(){return U0(this).serialize()},{enumerable:!0}),Qg){var R3=Qg.createObjectURL,I3=Qg.revokeObjectURL;R3&&M0(Qp,"createObjectURL",l3(R3,Qg)),I3&&M0(Qp,"revokeObjectURL",l3(I3,Qg))}Nae(Qp,"URL"),wae({global:!0,constructor:!0,forced:!Rae,sham:!$A},{URL:Qp});var Xae=En,Qae=p,Zae=Ry,A3=Bs,ece=DA,O3=$r("URL");Xae({target:"URL",stat:!0,forced:!(ece&&Qae(function(){O3.canParse()}))},{canParse:function(o){var n=Zae(arguments.length,1),r=A3(o),s=n<2||arguments[1]===void 0?void 0:A3(arguments[1]);try{return!!new O3(r,s)}catch{return!1}}});var N3=u(Jr.URL);function G0(){const o=new Blob([atob("ZnVuY3Rpb24gZShlKXtjb25zdCB0PW5ldyBEYXRhVmlldyhlLmRhdGEpO2lmKDA9PT10LmdldFVpbnQ4KDApJiYwPT09dC5nZXRVaW50OCgxKSYmMD09PXQuZ2V0VWludDgoMikmJjE9PT10LmdldFVpbnQ4KDMpJiY2PT09dC5nZXRVaW50OCg0KSl7bGV0IG49NixyPTAsbz0wO2Zvcig7MjU1PT09KG89dC5nZXRVaW50OChuKyspKTspcis9MjU1O3IrPW87Y29uc3QgYT1mdW5jdGlvbihlLHQsbil7bGV0IHI9bmV3IFVpbnQ4QXJyYXkoZSx0LG4pLG89W10sYT0wO2Zvcig7YTxuOylhKzM8biYmMD09PXJbYV0mJjA9PT1yW2ErMV0mJjM9PT1yW2ErMl0mJigwPT09clthKzNdfHwxPT09clthKzNdfHwyPT09clthKzNdfHwzPT09clthKzNdKT8oby5wdXNoKHJbYV0sclthKzFdLHJbYSszXSksYSs9NCk6KG8ucHVzaChyW2FdKSxhKyspO3JldHVybiBuZXcgVWludDhBcnJheShvKX0oZS5kYXRhLG4scik7cmV0dXJuIG5ldyBVaW50OEFycmF5KGEpfXJldHVybiBudWxsfWZ1bmN0aW9uIHQoZSx0KXtjb25zdCBuPWZ1bmN0aW9uKGUpe2NvbnN0IHQ9ZS5sZW5ndGg7bGV0IG49W10scj0wO2Zvcig7cjx0OylyKzI8dCYmMD09PWVbcl0mJjA9PT1lW3IrMV0mJigwPT09ZVtyKzJdfHwxPT09ZVtyKzJdfHwyPT09ZVtyKzJdfHwzPT09ZVtyKzJdKT8obi5wdXNoKGVbcl0sZVtyKzFdLDMsZVtyKzJdKSxyKz0zKToobi5wdXNoKGVbcl0pLHIrKyk7cmV0dXJuIG5ldyBVaW50OEFycmF5KG4pfSh0KSxyPW4ubGVuZ3RoLG89TWF0aC5mbG9vcihyLzI1NSksYT1yJTI1NSxzPW5ldyBVaW50OEFycmF5KDYrbysxK3IrZS5ieXRlTGVuZ3RoKTtzWzBdPTAsc1sxXT0wLHNbMl09MCxzWzNdPTEsc1s0XT02LHNbNV09MTAxO2xldCBpPTA7Zm9yKDtpPG87KXNbNitpXT0yNTUsaSsrO3JldHVybiBzWzYraV09YSxpKysscy5zZXQobiw2K2kpLHMuc2V0KG5ldyBVaW50OEFycmF5KGUpLDYraStyKSxzLmJ1ZmZlcn1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIlNhZmFyaSIpPi0xJiYtMT09PW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiQ2hyb21lIikmJihzZWxmLm9ucnRjdHJhbnNmb3JtPW49Pntjb25zdCByPW4udHJhbnNmb3JtZXI7bGV0IG89W107ci5vcHRpb25zLnBvcnQub25tZXNzYWdlPWU9PntlLmRhdGEuc2VpJiZvLnB1c2goZS5kYXRhLnNlaSl9LHNlbGYucG9zdE1lc3NhZ2UoInN0YXJ0ZWQiKTtjb25zdCBhPXIucmVhZGFibGUuZ2V0UmVhZGVyKCkscz1yLndyaXRhYmxlLmdldFdyaXRlcigpOyJyeCI9PT1yLm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KG4pe2EucmVhZCgpLnRoZW4oKHI9PntpZighci5kb25lKXtpZihyLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9ZShyLnZhbHVlKTt0JiZuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7c2VpOnR9KX1zLndyaXRlKHIudmFsdWUpLG4ub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQobil9fSkpfShyKToidHgiPT09ci5vcHRpb25zLm5hbWUmJmZ1bmN0aW9uIGUobil7YS5yZWFkKCkudGhlbigocj0+e2lmKCFyLmRvbmUpe2lmKHIudmFsdWUgaW5zdGFuY2VvZiBSVENFbmNvZGVkVmlkZW9GcmFtZSl7Y29uc3QgZT1vLnNoaWZ0KCk7ZSYmKHIudmFsdWUuZGF0YT10KHIudmFsdWUuZGF0YSxlKSl9cy53cml0ZShyLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0ocil9LHNlbGYucG9zdE1lc3NhZ2UoInJlZ2lzdGVyZWQiKSk7Cg==")],{type:"text/javascript"});return setTimeout(()=>N3.revokeObjectURL(o),0),new Worker(N3.createObjectURL(o))}const H0=new Map,$0=new Map;async function tce(o){if(!Lt().supportWebRTCEncodedTransform)return void O.warning("browser not support audio encoded transform");if($0.has(o))return;const n={track:o.track};if(Hc()){if(!o.createEncodedStreams)return void O.warning("browser not support createEncodedStreams() API");let s=null;try{s=o.createEncodedStreams()}catch(d){return void O.error("create audio-encoded-streams error",d&&d.message)}const c=new TransformStream({transform(d,h){n.controller||(n.controller=h),o.track&&o.track.id!==n.track.id&&(O.debug("audio track changed: ".concat(n.track.id," => ").concat(o.track.id)),n.track.removeEventListener("ended",r),n.track=o.track,n.track.addEventListener("ended",r)),h.enqueue(d)}});s.readable.pipeThrough(c).pipeTo(s.writable)}else if(Fr()){if(typeof RTCRtpScriptTransform>"u")return void O.warning("browser not support RTCRtpScriptTransform");const s=G0(),c=new MessageChannel;await new ae(h=>s.onmessage=f=>{f.data==="registered"&&h(void 0)});const d=new RTCRtpScriptTransform(s,{name:"rx",port:c.port2},[c.port2]);o.transform=d,await new ae(h=>s.onmessage=f=>{f.data==="started"&&h(void 0)}),c.port1.onmessage=h=>{var f;h.data.transformed&&o.track&&((f=o.track)===null||f===void 0?void 0:f.id)!==n.track.id&&(O.debug("audio track changed: ".concat(n.track.id," => ").concat(o.track.id)),n.track.removeEventListener("ended",r),n.track=o.track,n.track.addEventListener("ended",r))},n.worker=s}function r(){o.track.removeEventListener("ended",r),function(s){const c=$0.get(s);if(c){$0.delete(s);try{var d,h;(d=c.controller)===null||d===void 0||d.terminate(),(h=c.worker)===null||h===void 0||h.terminate()}catch(f){O.warning(f&&f.message)}}}(o)}$0.set(o,n),o.track.addEventListener("ended",r)}function nce(o){const n=new DataView(o.data);if(n.getUint8(0)===0&&n.getUint8(1)===0&&n.getUint8(2)===0&&n.getUint8(3)===1&&n.getUint8(4)===6){let r=6,s=0,c=0;for(;(c=n.getUint8(r++))===255;)s+=255;s+=c;const d=function(h,f,g){let _=new Uint8Array(h,f,g),E=[],T=0;for(;T<g;)T+3<g&&_[T]===0&&_[T+1]===0&&_[T+2]===3&&(_[T+3]===0||_[T+3]===1||_[T+3]===2||_[T+3]===3)?(E.push(_[T],_[T+1],_[T+3]),T+=4):(E.push(_[T]),T++);return new Uint8Array(E)}(o.data,r,s);return new Uint8Array(d)}return null}function rce(o,n){const r=function(g){const _=g.length;let E=[],T=0;for(;T<_;)T+2<_&&g[T]===0&&g[T+1]===0&&(g[T+2]===0||g[T+2]===1||g[T+2]===2||g[T+2]===3)?(E.push(g[T],g[T+1],3,g[T+2]),T+=3):(E.push(g[T]),T++);return new Uint8Array(E)}(n),s=r.length,c=Math.floor(s/255),d=s%255,h=new Uint8Array(6+c+1+s+o.byteLength);h[0]=0,h[1]=0,h[2]=0,h[3]=1,h[4]=6,h[5]=101;let f=0;for(;f<c;)h[6+f]=255,f++;return h[6+f]=d,f++,h.set(r,6+f),h.set(new Uint8Array(o),6+f+s),h.buffer}const K0=new Map,r_=new Map;async function ice(o){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Lt().supportWebRTCEncodedTransform)return void O.warning("browser not support video encoded transform");if(!o.track)return;if(r_.has(o)){const c=r_.get(o);return void(c&&(c.onSei=n.onSei))}const r={track:o.track,onSei:n.onSei};if(Hc()){if(!o.createEncodedStreams)return void O.warning("browser not support createEncodedStreams() API");let c=null;try{c=o.createEncodedStreams()}catch(h){return void O.error("create video-encoded-streams error",h&&h.message)}const d=new TransformStream({transform(h,f){r.controller||(r.controller=f),o.track&&o.track.id!==r.track.id&&(O.debug("video track changed: ".concat(r.track.id," => ").concat(o.track.id)),r.track.removeEventListener("ended",s),r.track=o.track,r.track.addEventListener("ended",s));const g=nce(h);g&&r.onSei&&r.onSei(g),f.enqueue(h)}});c.readable.pipeThrough(d).pipeTo(c.writable)}else if(Fr()){if(typeof RTCRtpScriptTransform>"u")return void O.warning("browser not support RTCRtpScriptTransform");const c=G0(),d=new MessageChannel;await new ae(f=>c.onmessage=g=>{g.data==="registered"&&f(void 0)});const h=new RTCRtpScriptTransform(c,{name:"rx",port:d.port2},[d.port2]);o.transform=h,await new ae(f=>c.onmessage=g=>{g.data==="started"&&f(void 0)}),d.port1.onmessage=f=>{var g;f.data.transformed&&o.track&&((g=o.track)===null||g===void 0?void 0:g.id)!==r.track.id?(O.debug("video track changed: ".concat(r.track.id," => ").concat(o.track.id)),r.track.removeEventListener("ended",s),r.track=o.track,r.track.addEventListener("ended",s)):f.data.sei&&r.onSei&&r.onSei(f.data.sei)},r.worker=c}function s(){if(o.track){if(this.id!==o.track.id)return;o.track.removeEventListener("ended",s)}(function(c){const d=r_.get(c);if(d){r_.delete(c);try{var h,f;(h=d.controller)===null||h===void 0||h.terminate(),(f=d.worker)===null||f===void 0||f.terminate()}catch(g){O.warning(g&&g.message)}}})(o)}r_.set(o,r),o.track.addEventListener("ended",s)}(function(){const o=xt();pi.getDisplayMedia=function(n){return!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)}(),pi.getStreamFromExtension=o.name===Ft.CHROME&&Number(o.version)>34,pi.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const n=new RTCPeerConnection;let r=!1;try{n.addTransceiver("audio"),r=!0}catch{}return n.close(),r}(),pi.supportMinBitrate=o.name===Ft.CHROME||o.name===Ft.EDGE,pi.supportSetRtpSenderParameters=function(){const n=xt();return!window.RTCRtpSender||!window.RTCRtpSender.prototype.setParameters||!window.RTCRtpSender.prototype.getParameters?!1:!!Zl()||!(!Fr()&&!My())||n.name===Ft.FIREFOX&&Number(n.version)>=64}(),o.name===Ft.SAFARI&&(Number(o.version)>=14?pi.supportDualStream=!0:pi.supportDualStream=!1),pi.webAudioMediaStreamDest=function(){const n=xt();return!(n.name===Ft.SAFARI&&Number(n.version)<12)}(),pi.supportReplaceTrack=function(){return window.RTCRtpSender?typeof RTCRtpSender.prototype.replaceTrack=="function":!1}(),pi.supportWebGL=typeof WebGLRenderingContext<"u",pi.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Zl()||(pi.webAudioWithAEC=!0),pi.supportShareAudio=function(){const n=xt();return(n.os===fr.WIN_10||n.os===fr.WIN_81||n.os===fr.WIN_7||n.os===fr.LINUX||n.os===fr.MAC_OS||n.os===fr.CHROMIUM_OS)&&n.name===Ft.CHROME&&Number(n.version)>=74}(),pi.supportDataChannel=function(){return!!(JR(76)||function(n){const r=xt();return!(r.name!==Ft.FIREFOX||!r.osVersion)&&Number(r.version)>=n}(68)||function(n){const r=xt();return!(r.name!==Ft.SAFARI||!r.osVersion)&&Number(r.version)>=n}(14))}(),pi.supportPCSetConfiguration=function(){const n=window.RTCPeerConnection;return!Jt()&&!!n&&n.prototype.setConfiguration instanceof Function}(),pi.supportWebRTCEncodedTransform=function(){const n=xt();return n.name==="Chrome"&&Number(n.version)>=86||n.name==="Safari"&&Number(n.version)>=15}(),pi.supportWebRTCInsertableStream=function(){const n=xt();return(n.name===Ft.CHROME||n.name===Ft.EDGE)&&Number(n.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),Vy(()=>{pi.supportDualStreamEncoding=function(){const n=xt();return Y("DISABLE_WEBAUDIO")?!0:n.name==="Safari"&&Number(n.version)>=14||!!(n.name==="Chrome"&&/Windows/i.test(n.os||"")&&Number(n.version)>=100&&Y("CHROME_DUAL_STREAM_USE_ENCODING"))}(),O.info("browser compatibility",JSON.stringify(pi),JSON.stringify(o))})})();class oce extends mn{constructor(){super(...arguments),I(this,"resultStorage",new Map)}setLocalAudioStats(n,r,s){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",n,this.checkAudioInputLevel(s,r)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",n,this.checkSendAudioBitrate(s,r))}setLocalVideoStats(n,r,s){this.record("SEND_VIDEO_BITRATE_TOO_LOW",n,this.checkSendVideoBitrate(s,r)),this.record("FRAMERATE_INPUT_TOO_LOW",n,this.checkFramerateInput(s,r)),this.record("FRAMERATE_SENT_TOO_LOW",n,this.checkFramerateSent(s))}setRemoteAudioStats(n,r){const s=n.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",s,this.checkAudioOutputLevel(r))}setRemoteVideoStats(n,r){const s=n.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",s,this.checkVideoDecode(r))}record(n,r,s){if(Y("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(n)||this.resultStorage.set(n,{result:[],isPrevNormal:!0});const c=this.resultStorage.get(n);if(c&&(c.result.push(s),c.result.length>=5)){var d;const h=Le(d=c.result).call(d,!0);c.isPrevNormal&&!h&&this.emit("exception",P3[n],n,r),!c.isPrevNormal&&h&&this.emit("exception",P3[n]+2e3,n+"_RECOVER",r),c.isPrevNormal=h,c.result=[]}}checkAudioOutputLevel(n){return!(n.receiveBitrate>0&&n.receiveLevel===0)}checkAudioInputLevel(n,r){return r instanceof lr&&!r.isActive||!!r.muted||n.sendVolumeLevel!==0}checkFramerateInput(n,r){let s=null;r._encoderConfig&&r._encoderConfig.frameRate&&(s=Wo(r._encoderConfig.frameRate));const c=n.captureFrameRate;return!s||!c||!(s>10&&c<5||s<10&&s>=5&&c<=1)}checkFramerateSent(n){return!(n.captureFrameRate&&n.sendFrameRate&&n.captureFrameRate>5&&n.sendFrameRate<=1)}checkSendVideoBitrate(n,r){return!!r.muted||n.sendBitrate!==0}checkSendAudioBitrate(n,r){return r instanceof lr&&!r.isActive||!!r.muted||n.sendBitrate!==0}checkVideoDecode(n){return n.receiveBitrate===0||n.decodeFrameRate!==0}}const P3={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},ei=new class{markSubscribeStart(o,n){performance.mark("agora-web-sdk/".concat(o,"/subscribe-").concat(n))}markPublishStart(o,n){performance.mark("agora-web-sdk/".concat(o,"/publish-").concat(n))}measureFromSubscribeStart(o,n){const r=performance.getEntriesByName("agora-web-sdk/".concat(o,"/subscribe-").concat(n));if(r.length>0){const s=r[r.length-1];return Math.round(performance.now()-s.startTime)}return 0}measureFromPublishStart(o,n){const r=performance.getEntriesByName("agora-web-sdk/".concat(o,"/publish-").concat(n));if(r.length>0){const s=r[r.length-1];return Math.round(performance.now()-s.startTime)}return 0}};function d1(o,n){this.v=o,this.k=n}function ut(o){return new d1(o,0)}var sce=nj,ace=Ja;En({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var o=ace.f(this);return{promise:o.promise,resolve:o.resolve,reject:o.reject}}});var cce=Ja,lce=gp;En({target:"Promise",stat:!0,forced:!0},{try:function(o){var n=cce.f(this),r=lce(o);return(r.error?n.reject:n.resolve)(r.value),n.promise}});var u1=u(sce),k3=sp.f("asyncIterator"),dce=u(k3);function i_(o){var n,r;function s(d,h){try{var f=o[d](h),g=f.value,_=g instanceof d1;u1.resolve(_?g.v:g).then(function(E){if(_){var T=d==="return"?"return":"next";if(!g.k||E.done)return s(T,E);E=o[T](E).value}c(f.done?"return":"normal",E)},function(E){s("throw",E)})}catch(E){c("throw",E)}}function c(d,h){switch(d){case"return":n.resolve({value:h,done:!0});break;case"throw":n.reject(h);break;default:n.resolve({value:h,done:!1})}(n=n.next)?s(n.key,n.arg):r=null}this._invoke=function(d,h){return new u1(function(f,g){var _={key:d,arg:h,resolve:f,reject:g,next:null};r?r=r.next=_:(n=r=_,s(d,h))})},typeof o.return!="function"&&(this.return=void 0)}function Co(o){return function(){return new i_(o.apply(this,arguments))}}i_.prototype[typeof hp=="function"&&dce||"@@asyncIterator"]=function(){return this},i_.prototype.next=function(o){return this._invoke("next",o)},i_.prototype.throw=function(o){return this._invoke("throw",o)},i_.prototype.return=function(o){return this._invoke("return",o)};var D3=u(Jr.Object.getOwnPropertySymbols),uce=En,hce=vw.indexOf,pce=mR,h1=pe([].indexOf),x3=!!h1&&1/h1([1],1,-0)<0;uce({target:"Array",proto:!0,forced:x3||!pce("indexOf")},{indexOf:function(o){var n=arguments.length>1?arguments[1]:void 0;return x3?h1(this,o,n)||0:hce(this,o,n)}});var fce=Hl("Array").indexOf,mce=N,gce=fce,p1=Array.prototype,L3=u(function(o){var n=o.indexOf;return o===p1||mce(p1,o)&&n===p1.indexOf?gce:n}),_ce=Vs,M3=iy;En({target:"Object",stat:!0,forced:p(function(){M3(1)})},{keys:function(o){return M3(_ce(o))}});var vce=u(Jr.Object.keys);function Ece(o,n){if(o==null)return{};var r,s,c=function(h,f){if(h==null)return{};var g,_,E={},T=vce(h);for(_=0;_<T.length;_++)g=T[_],L3(f).call(f,g)>=0||(E[g]=h[g]);return E}(o,n);if(D3){var d=D3(o);for(s=0;s<d.length;s++)r=d[s],L3(n).call(n,r)>=0||Object.prototype.propertyIsEnumerable.call(o,r)&&(c[r]=o[r])}return c}var U3={exports:{}};(function(o,n){o.exports=(()=>{var r={8:(d,h,f)=>{f.r(h),f.d(h,{Parser:()=>st,Printer:()=>Ro,parse:()=>it,print:()=>Mt});const g=`
`,_="".concat("\r").concat(g),E=" ";let T;function w(Ne){return Ne>="0"&&Ne<="9"}function A(Ne){return Ne>="!"&&Ne<="~"}function L(Ne){return A(Ne)||Ne>=""&&Ne<="ÿ"}function P(Ne){return Ne==="!"||Ne>="#"&&Ne<="'"||Ne>="*"&&Ne<="+"||Ne>="-"&&Ne<="."||Ne>="0"&&Ne<="9"||Ne>="A"&&Ne<="Z"||Ne>="^"&&Ne<="~"}function D(Ne){return Ne>="1"&&Ne<="9"}function G(Ne){return Ne>="A"&&Ne<="Z"||Ne>="a"&&Ne<="z"}function $(Ne){return Ne==="d"||Ne==="h"||Ne==="m"||Ne==="s"}function X(Ne){return Ne>""&&Ne<"	"||Ne>"\v"&&Ne<"\f"||Ne>""&&Ne<"ÿ"}function ie(Ne){return G(Ne)||w(Ne)||Ne==="+"||Ne==="/"}function Q(Ne){return w(Ne)||G(Ne)||Ne==="+"||Ne==="/"||Ne==="-"||Ne==="_"}function te(Ne){return G(Ne)||w(Ne)||Ne==="+"||Ne==="/"}function ce(Ne,k){var K=Object.keys(Ne);if(Object.getOwnPropertySymbols){var J=Object.getOwnPropertySymbols(Ne);k&&(J=J.filter(function(ye){return Object.getOwnPropertyDescriptor(Ne,ye).enumerable})),K.push.apply(K,J)}return K}function le(Ne){for(var k=1;k<arguments.length;k++){var K=arguments[k]!=null?arguments[k]:{};k%2?ce(Object(K),!0).forEach(function(J){Se(Ne,J,K[J])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ne,Object.getOwnPropertyDescriptors(K)):ce(Object(K)).forEach(function(J){Object.defineProperty(Ne,J,Object.getOwnPropertyDescriptor(K,J))})}return Ne}function Se(Ne,k,K){return k in Ne?Object.defineProperty(Ne,k,{value:K,enumerable:!0,configurable:!0,writable:!0}):Ne[k]=K,Ne}(function(Ne){Ne.VERSION="v",Ne.ORIGIN="o",Ne.SESSION_NAME="s",Ne.INFORMATION="i",Ne.URI="u",Ne.EMAIL="e",Ne.PHONE="p",Ne.CONNECTION="c",Ne.BANDWIDTH="b",Ne.TIME="t",Ne.REPEAT="r",Ne.ZONE_ADJUSTMENTS="z",Ne.KEY="k",Ne.ATTRIBUTE="a",Ne.MEDIA="m"})(T||(T={}));class Ae{consumeText(k,K){let J=K;for(;J<k.length;){const ye=k[J];if(ye==="\0"||ye==="\r"||ye===g)break;J+=1}if(J-K==0)throw new Error("Invalid text, at ".concat(k));return J}consumeUnicastAddress(k,K,J){return this.consumeTill(k,K,E)}consumeOneOrMore(k,K,J){let ye=K;for(;J(k[ye]);)ye++;if(ye-K==0)throw new Error("Invalid rule at ".concat(K,"."));return ye}consumeSpace(k,K){if(k[K]===E)return K+1;throw new Error("Invalid space at ".concat(K,"."))}consumeIP4Address(k,K){let J=K;for(let ye=0;ye<4;ye++)if(J=this.consumeDecimalUChar(k,J),ye!==3){if(k[J]!==".")throw new Error("Invalid IP4 address.");J++}return J}consumeDecimalUChar(k,K){let J=K;for(let at=0;at<3&&w(k[J]);at++,J++);if(J-K==0)throw new Error("Invalid decimal uchar.");const ye=parseInt(k.slice(K,J));if(ye>=0&&ye<=255)return J;throw new Error("Invalid decimal uchar")}consumeIP6Address(k,K){let J=this.consumeHexpart(k,K);return k[J]===":"&&(J+=1,J=this.consumeIP4Address(k,J)),J}consumeHexpart(k,K){let J=K;if(k[J]===":"&&k[J+1]===":"){J+=2;try{J=this.consumeHexseq(k,J)}catch{}return J}if(J=this.consumeHexseq(k,J),k[J]===":"&&k[J+1]===":"){J+=2;try{J=this.consumeHexseq(k,J)}catch{}return J}return J}consumeHexseq(k,K){let J=K;for(;J=this.consumeHex4(k,J),k[J]===":"&&k[J+1]!==":";)J+=1;return J}consumeHex4(k,K){let J=0;for(;J<4;J++)if(!((ye=k[K+J])>="0"&&ye<="9"||ye>="a"&&ye<="f"||ye>="A"&&ye<="F")){if(J===0)throw new Error("Invalid hex 4");break}var ye;return K+J}consumeFQDN(k,K){let J=K;for(;w(k[J])||G(k[J])||k[J]==="-"||k[J]===".";)J+=1;if(J-K<4)throw new Error("Invalid FQDN");return J}consumeExtnAddr(k,K){return this.consumeOneOrMore(k,K,L)}consumeMulticastAddress(k,K,J){switch(J){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(k,K);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(k,K);default:try{return this.consumeFQDN(k,K)}catch{return this.consumeExtnAddr(k,K)}}}consumeIP6MulticastAddress(k,K){const J=this.consumeHexpart(k,K);return k[J]==="/"?this.consumeInteger(k,J+1):J}consumeIP4MulticastAddress(k,K){let J=K+3;const ye=k.slice(K,J),at=parseInt(ye);if(at<224||at>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let an=0;an<3;an++){if(k[J]!==".")throw new Error("Invalid IP4 multicast address.");J+=1,J=this.consumeDecimalUChar(k,J)}return k[J]==="/"&&(J+=1),J=this.consumeTTL(k,J),k[J]==="/"&&(J=this.consumeInteger(k,J)),J}consumeInteger(k,K){if(!D(k[K]))throw new Error("Invalid integer.");for(K+=1;w(k[K]);)K+=1;return K}consumeTTL(k,K){if(k[K]==="0")return K+1;if(!D(k[K]))throw new Error("Invalid TTL.");K+=1;for(let J=0;J<2&&w(k[K]);J++)K+=1;return K}consumeToken(k,K){return this.consumeOneOrMore(k,K,P)}consumeTime(k,K){let J=K;if(k[J]==="0")return J+1;for(D(k[J])&&(J+=1);w(k[J]);)J++;if(J-K<10)throw new Error("Invalid time");return J}consumeAddress(k,K){return this.consumeTill(k,K,E)}consumeTypedTime(k,K){let J=K;return J=this.consumeOneOrMore(k,J,w),$(k[J])?J+1:J}consumeRepeatInterval(k,K){if(!D(k[K]))throw new Error("Invalid repeat interval");for(K+=1;w(k[K]);)K+=1;return $(k[K])&&(K+=1),K}consumePort(k,K){return this.consumeOneOrMore(k,K,w)}consume(k,K,J){for(let ye=0;ye<J.length;ye++){if(K+ye>=k.length)throw new Error("consume exceeding value length");if(k[K+ye]!==J[ye])throw new Error("consume ".concat(J," failed at ").concat(ye))}return K+J.length}consumeTill(k,K,J){let ye=K;for(;ye<k.length&&(typeof J!="string"||k[ye]!==J)&&(typeof J!="function"||!J(k[ye]));)ye++;return ye}}class st extends Ae{constructor(){super(),Se(this,"records",[]),Se(this,"currentLine",0)}parse(k){const K=this.probeEOL(k);this.records=k.split(K).filter(ur=>!!ur.trim()).map(this.parseLine),this.currentLine=0;const J=this.parseVersion(),ye=this.parseOrigin(),at=this.parseSessionName(),an=this.parseInformation(),ri=this.parseUri(),Io=this.parseEmail(),dl=this.parsePhone(),cS=this.parseConnection(),lS=this.parseBandWidth(),Cs=this.parseTimeFields(),Nd=this.parseKey(),af=this.parseSessionAttribute(),Vn=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:J,origin:ye,sessionName:at,information:an,uri:ri,emails:Io,phones:dl,connection:cS,bandwidths:lS,timeFields:Cs,key:Nd,attributes:af,mediaDescriptions:Vn}}getCurrentRecord(){const k=this.records[this.currentLine];if(!k)throw new Error("Record doesn't exit.");return k}probeEOL(k){for(let K=0;K<k.length;K++)if(k[K]===g)return k[K-1]==="\r"?_:g;throw new Error("Invalid newline character.")}parseLine(k,K){if(k.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const J=k[0];if(k[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:J,value:k.slice(2),line:K,cur:0}}parseSessionAttribute(){const k=new nn;for(;this.currentLine<this.records.length;){const K=this.getCurrentRecord();if(K.type!==T.ATTRIBUTE)break;const J={attField:this.extractOneOrMore(K,ye=>P(ye)&&ye!==":"),_cur:0};K.value[K.cur]===":"&&(K.cur+=1,J.attValue=this.extractOneOrMore(K,X)),k.parse(J),this.currentLine++}return k.digest()}parseMediaAttributes(k){const K=new dr(k);for(;this.currentLine<this.records.length;){const J=this.getCurrentRecord();if(J.type!==T.ATTRIBUTE)break;const ye={attField:this.extractOneOrMore(J,at=>P(at)&&at!==":"),_cur:0};J.value[J.cur]===":"&&(J.cur+=1,ye.attValue=this.extractOneOrMore(J,X)),K.parse(ye),this.currentLine++}return K.digest()}parseKey(){const k=this.getCurrentRecord();if(k.type===T.KEY){if(k.value==="prompt"||k.value==="clear:"||k.value==="base64:"||k.value==="uri:")return k.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const k=this.getCurrentRecord();if(k.type===T.ZONE_ADJUSTMENTS){const K=[];for(;;)try{const J=this.extract(k,this.consumeTime);this.consumeSpaceForRecord(k);let ye=!1;k.value[k.cur]==="-"&&(ye=!0,k.cur+=1);const at=this.extract(k,this.consumeTypedTime);K.push({time:J,typedTime:at,back:ye})}catch{break}if(K.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,K}return[]}parseRepeat(){const k=[];for(;;){const K=this.getCurrentRecord();if(K.type!==T.REPEAT)break;{const J=this.extract(K,this.consumeRepeatInterval),ye=this.parseTypedTime(K);k.push({repeatInterval:J,typedTimes:ye}),this.currentLine++}}return k}parseTypedTime(k){const K=[];for(;;)try{this.consumeSpaceForRecord(k),K.push(this.extract(k,this.consumeTypedTime))}catch{break}if(K.length===0)throw new Error("Invalid typed time.");return K}parseTime(){const k=this.getCurrentRecord(),K=this.extract(k,this.consumeTime);this.consumeSpaceForRecord(k);const J=this.extract(k,this.consumeTime);return this.currentLine++,{startTime:K,stopTime:J}}parseBandWidth(){const k=[];for(;this.currentLine<this.records.length;){const K=this.getCurrentRecord();if(K.type!==T.BANDWIDTH)break;{const J=this.extractOneOrMore(K,P);if(K.value[K.cur]!==":")throw new Error("Invalid bandwidth field.");K.cur++;const ye=this.extractOneOrMore(K,w);k.push({bwtype:J,bandwidth:ye}),this.currentLine++}}return k}parseVersion(){const k=this.getCurrentRecord();if(k.type!==T.VERSION)throw new Error("first sdp record must be version");const K=k.value.slice(0,this.consumeOneOrMore(k.value,0,w));if(K.length!==k.value.length)throw new Error('invalid proto version, "v='.concat(k.value,'"'));return this.currentLine++,K}parseOrigin(){const k=this.getCurrentRecord();if(k.type!==T.ORIGIN)throw new Error("second line of sdp must be origin");const K=this.extractOneOrMore(k,L);this.consumeSpaceForRecord(k);const J=this.extractOneOrMore(k,w);this.consumeSpaceForRecord(k);const ye=this.extractOneOrMore(k,w);this.consumeSpaceForRecord(k);const at=this.extractOneOrMore(k,P);this.consumeSpaceForRecord(k);const an=this.extractOneOrMore(k,P);this.consumeSpaceForRecord(k);const ri=this.extract(k,this.consumeUnicastAddress);return this.currentLine++,{username:K,sessId:J,sessVersion:ye,nettype:at,addrtype:an,unicastAddress:ri}}parseSessionName(){const k=this.getCurrentRecord();if(k.type===T.SESSION_NAME){const K=this.extract(k,this.consumeText);return this.currentLine++,K}}parseInformation(){const k=this.getCurrentRecord();if(k.type!==T.INFORMATION)return;const K=this.extract(k,this.consumeText);return this.currentLine++,K}parseUri(){const k=this.getCurrentRecord();if(k.type===T.URI)return this.currentLine++,k.value}parseEmail(){const k=[];for(;;){const K=this.getCurrentRecord();if(K.type!==T.EMAIL)break;k.push(K.value),this.currentLine++}return k}parsePhone(){const k=[];for(;;){const K=this.getCurrentRecord();if(K.type!==T.PHONE)break;k.push(K.value),this.currentLine++}return k}parseConnection(){const k=this.getCurrentRecord();if(k.type===T.CONNECTION){const K=this.extractOneOrMore(k,P);this.consumeSpaceForRecord(k);const J=this.extractOneOrMore(k,P);this.consumeSpaceForRecord(k);const ye=this.extract(k,this.consumeAddress);return this.currentLine++,{nettype:K,addrtype:J,address:ye}}}parseMedia(){const k=this.getCurrentRecord(),K=this.extract(k,this.consumeToken);this.consumeSpaceForRecord(k);let J=this.extract(k,this.consumePort);k.value[k.cur]==="/"&&(k.cur+=1,J+=this.extract(k,this.consumeInteger)),this.consumeSpaceForRecord(k);const ye=[];for(ye.push(this.extract(k,this.consumeToken));k.value[k.cur]==="/";)k.cur+=1,ye.push(this.extract(k,this.consumeToken));if(ye.length===0)throw new Error("Invalid proto");const at=this.parseFmt(k);return this.currentLine++,{mediaType:K,port:J,protos:ye,fmts:at}}parseTimeFields(){const k=[];for(;this.getCurrentRecord().type===T.TIME;){const K=this.parseTime(),J=this.parseRepeat(),ye=this.parseZone();k.push({time:K,repeats:J,zones:ye})}return k}parseMediaDescription(){const k=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===T.MEDIA;){const K=this.parseMedia(),J=this.parseInformation(),ye=this.parseConnections(),at=this.parseBandWidth(),an=this.parseKey(),ri=this.parseMediaAttributes(K);k.push({media:K,information:J,connections:ye,bandwidths:at,key:an,attributes:ri})}return k}parseConnections(){const k=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===T.CONNECTION;)k.push(this.parseConnection());return k}parseFmt(k){const K=[];for(;;)try{this.consumeSpaceForRecord(k),K.push(this.extract(k,this.consumeToken))}catch{break}if(K.length===0)throw new Error("Invalid fmts");return K}extract(k,K,...J){const ye=K.call(this,k.value,k.cur,...J),at=k.value.slice(k.cur,ye);return k.cur=ye,at}extractOneOrMore(k,K){const J=this.consumeOneOrMore(k.value,k.cur,K),ye=k.value.slice(k.cur,J);return k.cur=J,ye}consumeSpaceForRecord(k){if(k.value[k.cur]!==E)throw new Error("Invalid space at ".concat(k.cur,"."));k.cur+=1}}class gt extends Ae{constructor(...k){super(...k),Se(this,"attributes",void 0),Se(this,"digested",!1)}extractOneOrMore(k,K,J){const ye=this.consumeOneOrMore(k.attValue,k._cur,K),at=k.attValue.slice(k._cur,ye),[an,ri]=J||[];if(typeof an=="number"&&at.length<an)throw new Error("error in length, should be more or equal than ".concat(an," characters."));if(typeof ri=="number"&&at.length>ri)throw new Error("error in length, should be less or equal than ".concat(ri," characters."));return k._cur=ye,at}consumeAttributeSpace(k){if(k.attValue[k._cur]!==E)throw new Error("Invalid space at ".concat(k._cur,"."));k._cur+=1}extract(k,K,...J){if(!k.attValue)throw new Error("Nothing to extract from attValue.");const ye=K.call(this,k.attValue,k._cur,...J),at=k.attValue.slice(k._cur,ye);return k._cur=ye,at}atEnd(k){if(!k.attValue)throw new Error;return k._cur>=k.attValue.length}peekChar(k){if(!k.attValue)throw new Error;return k.attValue[k._cur]}peek(k,K){if(!k.attValue)throw new Error;for(let J=0;J<K.length;J++)if(K[J]!==k.attValue[k._cur+J])return!1;return!0}parseIceUfrag(k){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(k,ie,[4,256])}parseIcePwd(k){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(k,ie,[22,256])}parseIceOptions(k){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const K=[];for(;!this.atEnd(k);){K.push(this.extractOneOrMore(k,ie));try{this.consumeAttributeSpace(k)}catch(J){if(this.atEnd(k))break;throw J}}this.attributes.iceOptions=K}parseFingerprint(k){const K=this.extract(k,this.consumeToken);this.consumeAttributeSpace(k);const J=this.extract(k,this.consumeTill);this.attributes.fingerprints.push({hashFunction:K,fingerprint:J})}parseExtmap(k){const K=this.extractOneOrMore(k,w);let J;this.peekChar(k)==="/"&&(this.extract(k,this.consume,"/"),J=this.extract(k,this.consumeToken)),this.consumeAttributeSpace(k);const ye=this.extract(k,this.consumeTill,E),at=le(le({entry:parseInt(K,10)},J&&{direction:J}),{},{extensionName:ye});this.peekChar(k)===E&&(this.consumeAttributeSpace(k),at.extensionAttributes=this.extract(k,this.consumeTill)),this.attributes.extmaps.push(at)}parseSetup(k){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const K=this.extract(k,this.consumeTill);if(K!=="active"&&K!=="passive"&&K!=="actpass"&&K!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=K}}class nn extends gt{constructor(...k){super(...k),Se(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(k){if(this.digested)throw new Error("already digested");try{switch(k.attField){case"group":this.parseGroup(k);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(k);break;case"ice-pwd":this.parseIcePwd(k);break;case"ice-options":this.parseIceOptions(k);break;case"fingerprint":this.parseFingerprint(k);break;case"setup":this.parseSetup(k);break;case"tls-id":this.parseTlsId(k);break;case"identity":this.parseIdentity(k);break;case"extmap":this.parseExtmap(k);break;case"msid-semantic":this.parseMsidSemantic(k);break;default:k.ignored=!0,this.attributes.unrecognized.push(k)}}catch(K){throw console.error("parsing session attribute ".concat(k.attField,' error, "a=').concat(k.attField,":").concat(k.attValue,'"')),K}if(!k.ignored&&k.attValue&&!this.atEnd(k))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(k){const K=this.extract(k,this.consumeToken),J=[];for(;!this.atEnd(k)&&this.peekChar(k)===E;)this.consumeAttributeSpace(k),J.push(this.extract(k,this.consumeToken));this.attributes.groups.push({semantic:K,identificationTag:J})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(k){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(k,Q)}parseIdentity(k){const K=this.extractOneOrMore(k,te),J=[];for(;!this.atEnd(k)&&this.peekChar(k)===E;){this.consumeAttributeSpace(k);const ye=this.extract(k,this.consumeToken);this.extract(k,this.consume,"=");const at=this.extractOneOrMore(k,an=>an!==E&&X(an));J.push({name:ye,value:at})}this.attributes.identities.push({assertionValue:K,extensions:J})}parseMsidSemantic(k){this.peekChar(k)===E&&this.consumeAttributeSpace(k);const K={semantic:this.extract(k,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(k)}catch{break}if(this.peekChar(k)==="*"){this.extract(k,this.consume,"*"),K.applyForAll=!0;break}{const J=this.extract(k,this.consumeTill,E);K.identifierList.push(J)}}this.attributes.msidSemantic=K}}class dr extends gt{constructor(k){super(),Se(this,"attributes",void 0),k.protos.indexOf("RTP")!==-1||k.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(k){if(this.digested)throw new Error("already digested");try{switch(k.attField){case"extmap":this.parseExtmap(k);break;case"setup":this.parseSetup(k);break;case"ice-ufrag":this.parseIceUfrag(k);break;case"ice-pwd":this.parseIcePwd(k);break;case"ice-options":this.parseIceOptions(k);break;case"candidate":this.parseCandidate(k);break;case"remote-candidate":this.parseRemoteCandidate(k);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(k);break;case"rtpmap":this.parseRtpmap(k);break;case"ptime":this.parsePtime(k);break;case"maxptime":this.parseMaxPtime(k);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(k);break;case"ssrc":this.parseSSRC(k);break;case"fmtp":this.parseFmtp(k);break;case"rtcp-fb":this.parseRtcpFb(k);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(k);break;case"mid":this.parseMid(k);break;case"msid":this.parseMsid(k);break;case"imageattr":this.parseImageAttr(k);break;case"rid":this.parseRid(k);break;case"simulcast":this.parseSimulcast(k);break;case"sctp-port":this.parseSctpPort(k);break;case"max-message-size":this.parseMaxMessageSize(k);break;case"ssrc-group":this.parseSSRCGroup(k);break;default:k.ignored=!0,this.attributes.unrecognized.push(k)}}catch(K){throw console.error("parsing media attribute ".concat(k.attField,' error, "a=').concat(k.attField,":").concat(k.attValue,'"')),K}if(!k.ignored&&k.attValue&&!this.atEnd(k))throw new Error("attribute parsing error")}parseCandidate(k){const K=this.extractOneOrMore(k,ie,[1,32]);this.consumeAttributeSpace(k);const J=this.extractOneOrMore(k,w,[1,5]);this.consumeAttributeSpace(k);const ye=this.extract(k,this.consumeToken);this.consumeAttributeSpace(k);const at=this.extractOneOrMore(k,w,[1,10]);this.consumeAttributeSpace(k);const an=this.extract(k,this.consumeAddress);this.consumeAttributeSpace(k);const ri=this.extract(k,this.consumePort);this.consumeAttributeSpace(k),this.extract(k,this.consume,"typ"),this.consumeAttributeSpace(k);const Io={foundation:K,componentId:J,transport:ye,priority:at,connectionAddress:an,port:ri,type:this.extract(k,this.consumeToken),extension:{}};for(this.peek(k," raddr")&&(this.extract(k,this.consume," raddr"),this.consumeAttributeSpace(k),Io.relAddr=this.extract(k,this.consumeAddress)),this.peek(k," rport")&&(this.extract(k,this.consume," rport"),this.consumeAttributeSpace(k),Io.relPort=this.extract(k,this.consumePort));this.peekChar(k)===E;){this.consumeAttributeSpace(k);const dl=this.extract(k,this.consumeToken);this.consumeAttributeSpace(k),Io.extension[dl]=this.extractOneOrMore(k,A)}this.attributes.candidates.push(Io)}parseRemoteCandidate(k){const K=[];for(;;){const J=this.extractOneOrMore(k,w,[1,5]);this.consumeAttributeSpace(k);const ye=this.extract(k,this.consumeAddress);this.consumeAttributeSpace(k);const at=this.extract(k,this.consumePort);K.push({componentId:J,connectionAddress:ye,port:at});try{this.consumeAttributeSpace(k)}catch{break}}this.attributes.remoteCandidatesList.push(K)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(k){const K=this.extract(k,this.consumeToken);this.consumeAttributeSpace(k);const J=this.extract(k,this.consumeTill,"/");this.extract(k,this.consume,"/");const ye={encodingName:J,clockRate:this.extractOneOrMore(k,w)};this.atEnd(k)||this.peekChar(k)!=="/"||(this.extract(k,this.consume,"/"),ye.encodingParameters=parseInt(this.extract(k,this.consumeTill),10));const at=this.attributes.payloads.find(an=>an.payloadType===parseInt(K,10));at?at.rtpMap=ye:this.attributes.payloads.push({payloadType:parseInt(K,10),rtpMap:ye,rtcpFeedbacks:[]})}parsePtime(k){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(k,this.consumeTill)}parseMaxPtime(k){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(k,this.consumeTill)}parseDirection(k){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=k.attField}parseSSRC(k){const K=this.extractOneOrMore(k,w);this.consumeAttributeSpace(k);const J=this.extract(k,this.consumeTill,":");let ye;this.peekChar(k)===":"&&(this.extract(k,this.consume,":"),ye=this.extract(k,this.consumeTill));const at=this.attributes.ssrcs.find(an=>an.ssrcId===parseInt(K,10));at?at.attributes[J]=ye:this.attributes.ssrcs.push({ssrcId:parseInt(K,10),attributes:{[J]:ye}})}parseFmtp(k){const K=this.extract(k,this.consumeTill,E);this.consumeAttributeSpace(k);const J=this.extract(k,this.consumeTill),ye={};J.split(";").forEach(an=>{let[ri,Io]=an.split("=");ri=ri.trim();const dl=typeof Io=="string"?Io.trim():null;typeof ri=="string"&&ri.length>0&&(ye[ri]=dl)});const at=this.attributes.payloads.find(an=>an.payloadType===parseInt(K,10));at?at.fmtp={parameters:ye}:this.attributes.payloads.push({payloadType:parseInt(K,10),rtcpFeedbacks:[],fmtp:{parameters:ye}})}parseFmtParameters(k){const K={},J=this.extract(k,this.consumeTill,"=");k._cur++;const ye=this.extract(k,this.consumeTill,";");for(K[J]=ye;k.attValue[k._cur]===";";){const at=this.extract(k,this.consumeTill,"=");k._cur++;const an=this.extract(k,this.consumeTill,";");K[at]=an}return K}parseRtcpFb(k){let K="";K=this.peekChar(k)==="*"?this.extract(k,this.consume,"*"):this.extract(k,this.consumeTill,E),this.consumeAttributeSpace(k);const J=this.extract(k,this.consumeTill,E);let ye;if(J==="trr-int")ye={type:J,interval:this.extract(k,this.consumeTill)};else{const at={type:J};this.peekChar(k)===E&&(this.consumeAttributeSpace(k),at.parameter=this.extract(k,this.consumeToken),this.peekChar(k)===E&&(at.additional=this.extract(k,this.consumeTill))),ye=at}if(K==="*")this.attributes.rtcpFeedbackWildcards.push(ye);else{const at=this.attributes.payloads.find(an=>an.payloadType===parseInt(K,10));at?at.rtcpFeedbacks.push(ye):this.attributes.payloads.push({payloadType:parseInt(K,10),rtcpFeedbacks:[ye]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(k){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const K={port:this.extract(k,this.consumePort)};this.peekChar(k)===E&&(this.consumeAttributeSpace(k),K.netType=this.extractOneOrMore(k,P),this.consumeAttributeSpace(k),K.addressType=this.extractOneOrMore(k,P),this.consumeAttributeSpace(k),K.address=this.extract(k,this.consumeAddress)),this.attributes.rtcp=K}parseMsid(k){const K={id:this.extractOneOrMore(k,P,[1,64])};this.peekChar(k)===E&&(this.consumeAttributeSpace(k),K.appdata=this.extractOneOrMore(k,P,[1,64])),this.attributes.msids.push(K)}parseImageAttr(k){this.attributes.imageattr.push(k.attValue)}parseRid(k){const K=this.extractOneOrMore(k,ye=>G(ye)||w(ye)||ye==="_"||ye==="-");this.consumeAttributeSpace(k);const J={id:K,direction:this.extract(k,this.consumeToken),params:[]};if(this.peekChar(k)===E){if(this.consumeAttributeSpace(k),this.peek(k,"pt=")){this.extract(k,this.consume,"pt=");const ye=[];for(;;){const at=this.extract(k,this.consumeToken);ye.push(at);try{this.extract(k,this.consume,",")}catch{break}}J.payloads=ye,this.peekChar(k)===E&&this.extract(k,this.consume,E)}for(;;){const ye=this.extract(k,this.consumeToken);switch(ye){case"depend":{const at={type:ye,rids:this.extract(k,this.consume,"=").split(",")};J.params.push(at);break}default:{const at={type:ye};this.peekChar(k)==="="&&(this.extract(k,this.consume,"="),at.val=this.extract(k,this.consumeTill,";")),J.params.push(at)}}try{this.extract(k,this.consume,";")}catch{break}}}this.attributes.rids.push(J)}parseSimulcast(k){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=k.attValue,this.extract(k,this.consumeTill)}parseSctpPort(k){this.attributes.sctpPort=this.extractOneOrMore(k,w,[1,5])}parseMaxMessageSize(k){this.attributes.maxMessageSize=this.extractOneOrMore(k,w,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(k){this.attributes.mid=this.extract(k,this.consumeToken)}parseSSRCGroup(k){const K=this.extract(k,this.consumeToken),J=[];for(;;)try{this.consumeAttributeSpace(k);const ye=this.extract(k,this.consumeInteger);J.push(parseInt(ye,10))}catch{break}this.attributes.ssrcGroups.push({semantic:K,ssrcIds:J})}}function un(Ne,k,K){return k in Ne?Object.defineProperty(Ne,k,{value:K,enumerable:!0,configurable:!0,writable:!0}):Ne[k]=K,Ne}class Ro{constructor(){un(this,"eol",_)}print(k,K){let J="";return K&&(this.eol=K),J+=this.printVersion(k.version),J+=this.printOrigin(k.origin),J+=this.printSessionName(k.sessionName),J+=this.printInformation(k.information),J+=this.printUri(k.uri),J+=this.printEmail(k.emails),J+=this.printPhone(k.phones),J+=this.printConnection(k.connection),J+=this.printBandwidth(k.bandwidths),J+=this.printTimeFields(k.timeFields),J+=this.printKey(k.key),J+=this.printSessionAttributes(k.attributes),J+=this.printMediaDescription(k.mediaDescriptions),J}printVersion(k){return"v=".concat(k).concat(this.eol)}printOrigin(k){return"o=".concat(k.username," ").concat(k.sessId," ").concat(k.sessVersion," ").concat(k.nettype," ").concat(k.addrtype," ").concat(k.unicastAddress).concat(this.eol)}printSessionName(k){return k?"s=".concat(k).concat(this.eol):""}printInformation(k){return k?"i=".concat(k).concat(this.eol):""}printUri(k){return k?"u=".concat(k).concat(this.eol):""}printEmail(k){let K="";for(const J of k)K+="e=".concat(J).concat(this.eol);return K}printPhone(k){let K="";for(const J of k)K+="e=".concat(J).concat(this.eol);return K}printConnection(k){return k?"c=".concat(k.nettype," ").concat(k.addrtype," ").concat(k.address).concat(this.eol):""}printBandwidth(k){let K="";for(const J of k)K+="b=".concat(J.bwtype,":").concat(J.bandwidth).concat(this.eol);return K}printTimeFields(k){let K="";for(const J of k){K+="t=".concat(J.time.startTime," ").concat(J.time.startTime).concat(this.eol);for(const ye of J.repeats)K+="r=".concat(ye.repeatInterval," ").concat(ye.typedTimes.join(" ")).concat(this.eol);J.zoneAdjustments&&(K+="z=",K+="z=".concat(J.zoneAdjustments.map(ye=>"".concat(ye.time," ").concat(ye.back?"-":""," ").concat(ye.typedTime)).join(" ")).concat(this.eol),K+=this.eol)}return K}printKey(k){return k?"k=".concat(k).concat(this.eol):""}printAttributes(k){let K="";for(const J of k)K+="a=".concat(J.attField).concat(J.attValue?":".concat(J.attValue):"").concat(this.eol);return K}printMediaDescription(k){let K="";for(const J of k)K+=this.printMedia(J.media),K+=this.printInformation(J.information),K+=this.printConnections(J.connections),K+=this.printBandwidth(J.bandwidths),K+=this.printKey(J.key),K+=this.printMediaAttributes(J);return K}printConnections(k){let K="";for(const J of k)K+=this.printConnection(J);return K}printMedia(k){return"m=".concat(k.mediaType," ").concat(k.port," ").concat(k.protos.join("/")," ").concat(k.fmts.join(" ")).concat(this.eol)}printSessionAttributes(k){return new we(this.eol).print(k)}printMediaAttributes(k){return new Ve(this.eol).print(k)}}class ve{constructor(k){un(this,"eol",void 0),this.eol=k}printIceUfrag(k){return k===void 0?"":"a=ice-ufrag:".concat(k).concat(this.eol)}printIcePwd(k){return k===void 0?"":"a=ice-pwd:".concat(k).concat(this.eol)}printIceOptions(k){return k===void 0?"":"a=ice-options:".concat(k.join(E)).concat(this.eol)}printFingerprints(k){return k.length>0?k.map(K=>"a=fingerprint:".concat(K.hashFunction).concat(E).concat(K.fingerprint)).join(this.eol)+this.eol:""}printExtmap(k){return k.map(K=>"a=extmap:".concat(K.entry).concat(K.direction?"/".concat(K.direction):"").concat(E).concat(K.extensionName).concat(K.extensionAttributes?"".concat(E).concat(K.extensionAttributes):"").concat(this.eol)).join("")}printSetup(k){return k===void 0?"":"a=setup:".concat(k).concat(this.eol)}printUnrecognized(k){return k.map(K=>"a=".concat(K.attField).concat(K.attValue?":".concat(K.attValue):"").concat(this.eol)).join("")}}class we extends ve{print(k){let K="";return K+=this.printGroups(k.groups),K+=this.printMsidSemantic(k.msidSemantic),K+=this.printIceLite(k.iceLite),K+=this.printIceUfrag(k.iceUfrag),K+=this.printIcePwd(k.icePwd),K+=this.printIceOptions(k.iceOptions),K+=this.printFingerprints(k.fingerprints),K+=this.printSetup(k.setup),K+=this.printTlsId(k.tlsId),K+=this.printIdentity(k.identities),K+=this.printExtmap(k.extmaps),K+=this.printUnrecognized(k.unrecognized),K}printGroups(k){let K="";return k.length>0&&(K+=k.map(J=>"a=group:".concat(J.semantic).concat(J.identificationTag.map(ye=>"".concat(E).concat(ye)).join("")).concat(this.eol)).join("")),K}printIceLite(k){return k===void 0?"":"a=ice-lite"+this.eol}printTlsId(k){return k?"a=tls-id:".concat(k).concat(this.eol):""}printIdentity(k){return k.length===0?"":k.map(K=>"a=identity:".concat(K.assertionValue).concat(K.extensions.map(J=>"".concat(E).concat(J.name).concat(J.value?"=".concat(J.value):"")))).join(this.eol)+this.eol}printMsidSemantic(k){if(!k)return"";let K="a=msid-semantic:".concat(k.semantic);return k.applyForAll?K+="".concat(E,"*"):k.identifierList.length>0&&(K+=k.identifierList.map(J=>"".concat(E).concat(J))),K+this.eol}}class Ve extends ve{print(k){const K=k.attributes;let J="";return J+=this.printRTCP(K.rtcp),J+=this.printIceUfrag(K.iceUfrag),J+=this.printIcePwd(K.icePwd),J+=this.printIceOptions(K.iceOptions),J+=this.printCandidates(K.candidates),J+=this.printRemoteCandidatesList(K.remoteCandidatesList),J+=this.printEndOfCandidates(K.endOfCandidates),J+=this.printFingerprints(K.fingerprints),J+=this.printSetup(K.setup),J+=this.printMid(K.mid),J+=this.printExtmap(K.extmaps),J+=this.printRTPRelated(K),J+=this.printPtime(K.ptime),J+=this.printMaxPtime(K.maxPtime),J+=this.printDirection(K.direction),J+=this.printSSRCGroups(K.ssrcGroups),J+=this.printSSRC(K.ssrcs),J+=this.printRTCPMux(K.rtcpMux),J+=this.printRTCPMuxOnly(K.rtcpMuxOnly),J+=this.printRTCPRsize(K.rtcpRsize),J+=this.printMSId(K.msids),J+=this.printImageattr(K.imageattr),J+=this.printRid(K.rids),J+=this.printSimulcast(K.simulcast),J+=this.printSCTPPort(K.sctpPort),J+=this.printMaxMessageSize(K.maxMessageSize),J+=this.printUnrecognized(K.unrecognized),J}printCandidates(k){return k.map(K=>"a=candidate:".concat(K.foundation).concat(E).concat(K.componentId).concat(E).concat(K.transport).concat(E).concat(K.priority).concat(E).concat(K.connectionAddress).concat(E).concat(K.port).concat(E,"typ").concat(E).concat(K.type).concat(K.relAddr?"".concat(E,"raddr").concat(E).concat(K.relAddr):"").concat(K.relPort?"".concat(E,"rport").concat(E).concat(K.relPort):"").concat(Object.keys(K.extension).map(J=>"".concat(E).concat(J).concat(E).concat(K.extension[J])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(k){return k.map(K=>"a=remote-candidates:".concat(K.join(E)).concat(this.eol)).join("")}printEndOfCandidates(k){return k===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(k){if(!k.payloads)return"";const K=k.payloads;let J="";J+=k.rtcpFeedbackWildcards.map(ye=>this.printRTCPFeedback("*",ye)).join("");for(const ye of K)J+=this.printRtpMap(ye.payloadType,ye.rtpMap),J+=this.printFmtp(ye.payloadType,ye.fmtp),J+=ye.rtcpFeedbacks.map(at=>this.printRTCPFeedback(ye.payloadType,at)).join("");return J}printFmtp(k,K){if(!K)return"";const J=Object.keys(K.parameters);return J.length===1&&K.parameters[J[0]]===null?"a=fmtp:".concat(k).concat(E).concat(J[0]).concat(this.eol):"a=fmtp:".concat(k).concat(E).concat(Object.keys(K.parameters).map(ye=>"".concat(ye,"=").concat(K.parameters[ye])).join(";")).concat(this.eol)}printRtpMap(k,K){return K?"a=rtpmap:".concat(k).concat(E).concat(K.encodingName,"/").concat(K.clockRate).concat(K.encodingParameters?"/".concat(K.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(k,K){let J="a=rtcp-fb:".concat(k).concat(E),ye=K;return ye.type==="trr-int"?J+="ttr-int".concat(E).concat(ye.interval):(J+="".concat(ye.type),ye.parameter&&(J+="".concat(E).concat(ye.parameter),ye.additional&&(J+="".concat(E).concat(ye.additional)))),J+this.eol}printPtime(k){return k===void 0?"":"a=ptime:".concat(k).concat(this.eol)}printMaxPtime(k){return k===void 0?"":"a=maxptime:".concat(k).concat(this.eol)}printDirection(k){return k===void 0?"":"a=".concat(k).concat(this.eol)}printSSRC(k){return k.map(K=>Object.keys(K.attributes).map(J=>"a=ssrc:".concat(K.ssrcId.toString(10)).concat(E).concat(J).concat(K.attributes[J]?":".concat(K.attributes[J]):"").concat(this.eol)).join("")).join("")}printRTCPMux(k){return k===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(k){return k===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(k){return k===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(k){if(k===void 0)return"";let K="a=rtcp:".concat(k.port);return k.netType&&(K+="".concat(E).concat(k.netType)),k.addressType&&(K+="".concat(E).concat(k.addressType)),k.address&&(K+="".concat(E).concat(k.address)),K+this.eol}printMSId(k){return k.map(K=>"a=msid:".concat(K.id).concat(K.appdata?"".concat(E).concat(K.appdata):"").concat(this.eol)).join("")}printImageattr(k){return k.map(K=>"a=imageattr:".concat(K).concat(this.eol)).join("")}printRid(k){return k.map(K=>{let J="a=rid:".concat(K.id).concat(E).concat(K.direction);return K.payloads&&(J+="".concat(E,"pt=").concat(K.payloads.join(","))),K.params.length>0&&(J+="".concat(E).concat(K.params.map(ye=>ye.type==="depend"?"depend=".concat(ye.rids.join(",")):"".concat(ye.type,"=").concat(ye.val)).join(";"))),J+this.eol}).join("")}printSimulcast(k){return k===void 0?"":"a=simulcast:".concat(k).concat(this.eol)}printSCTPPort(k){return k===void 0?"":"a=sctp-port:".concat(k).concat(this.eol)}printMaxMessageSize(k){return k===void 0?"":"a=max-message-size:".concat(k).concat(this.eol)}printMid(k){return k===void 0?"":"a=mid:".concat(k).concat(this.eol)}printSSRCGroups(k){return k.map(K=>"a=ssrc-group:".concat(K.semantic).concat(K.ssrcIds.map(J=>"".concat(E).concat(J.toString(10))).join("")).concat(this.eol)).join("")}}function it(Ne){return new st().parse(Ne)}function Mt(Ne,k){return new Ro().print(Ne,k)}}},s={};function c(d){if(s[d])return s[d].exports;var h=s[d]={exports:{}};return r[d](h,h.exports,c),h.exports}return c.d=(d,h)=>{for(var f in h)c.o(h,f)&&!c.o(d,f)&&Object.defineProperty(d,f,{enumerable:!0,get:h[f]})},c.o=(d,h)=>Object.prototype.hasOwnProperty.call(d,h),c.r=d=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(d,"__esModule",{value:!0})},c(8)})()})(U3);var gn=U3.exports;function ra(o){if(Array.isArray(o))return o.map(r=>r);if(!j3(o))return o;const n={};for(const r in o){const s=o[r];j3(s)||Array.isArray(s)?n[r]=ra(s):n[r]=s}return n}function j3(o){return!(typeof o!="object"||Array.isArray(o)||!o)}class f1{constructor(n){I(this,"input",[]),I(this,"size",void 0),this.size=n}add(n){this.input.push(n),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const hc={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},o_={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:hc,remoteCandidate:hc}},F3={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},V3={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},B3={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},W3={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function z3(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function G3(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?z3(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):z3(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class m1{constructor(n,r){I(this,"onFirstVideoReceived",void 0),I(this,"onFirstVideoDecoded",void 0),I(this,"onFirstAudioReceived",void 0),I(this,"onFirstVideoDecodedTimeout",void 0),I(this,"onFirstAudioDecoded",void 0),I(this,"onSelectedLocalCandidateChanged",void 0),I(this,"onSelectedRemoteCandidateChanged",void 0),I(this,"videoIsReady",!1),I(this,"videoIsReady2",{}),I(this,"pc",void 0),I(this,"options",void 0),I(this,"intervalTimer",void 0),I(this,"stats",ra(o_)),I(this,"isFirstVideoReceived",{}),I(this,"isFirstVideoDecoded",{}),I(this,"isFirstAudioReceived",{}),I(this,"isFirstAudioDecoded",{}),I(this,"isFirstVideoDecodedTimeout",{}),I(this,"lossRateWindowStats",[]),this.pc=n,this.options=r,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new ae(n=>{n({local:G3({},hc),remote:G3({},hc)})})}setVideoIsReady(n){this.videoIsReady=n}setVideoIsReady2(n,r){this.videoIsReady2[n]=r}getVideoIsReady(n){return this.videoIsReady2[n]||!1}setIsFirstAudioDecoded(n){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(n){this.lossRateWindowStats.push(n),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const r=this.lossRateWindowStats.length,s=["videoSend","audioSend","videoRecv","audioRecv"];let c=0,d=0,h=0,f=0;for(const g of s)n[g].forEach((_,E)=>{if(!this.lossRateWindowStats[r-1][g][E]||!this.lossRateWindowStats[0][g][E])return;const T=this.lossRateWindowStats[r-1][g][E].packets-this.lossRateWindowStats[0][g][E].packets,w=this.lossRateWindowStats[r-1][g][E].packetsLost-this.lossRateWindowStats[0][g][E].packetsLost;g==="videoSend"||g==="audioSend"?(c+=T,h+=w):(d+=T,f+=w),Number.isNaN(T)||Number.isNaN(T)?_.packetLostRate=0:_.packetLostRate=T<=0||w<=0?0:w/(T+w)});n.sendPacketLossRate=c<=0||h<=0?0:h/(c+h),n.recvPacketLossRate=d<=0||f<=0?0:f/(d+f)}}function H3(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function yce(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?H3(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):H3(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class Sce extends m1{constructor(){super(...arguments),I(this,"_stats",o_),I(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const n=await this._getStats(),r=this.statsResponsesToObjects(n);this._stats=ra(o_);const s=r.filter(d=>d.type==="ssrc");this.processSSRCStats(s);const c=r.find(d=>d.type==="VideoBwe");c&&this.processBandwidthStats(c),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(n){this._stats.bitrate={actualEncoded:Number(n.googActualEncBitrate),targetEncoded:Number(n.googTargetEncBitrate),retransmit:Number(n.googRetransmitBitrate),transmit:Number(n.googTransmitBitrate)},this._stats.sendBandwidth=Number(n.googAvailableSendBandwidth)}processSSRCStats(n){n.forEach(r=>{var s;const c=Le(s=r.id).call(s,"send");switch("".concat(r.mediaType,"_").concat(c?"send":"recv")){case"video_send":{const d=ra(V3);d.codec=r.googCodecName,d.adaptionChangeReason="none",r.googCpuLimitedResolution&&(d.adaptionChangeReason="cpu"),r.googBandwidthLimitedResolution&&(d.adaptionChangeReason="bandwidth"),d.avgEncodeMs=Number(r.googAvgEncodeMs),d.inputFrame={width:Number(r.googFrameWidthInput)||Number(r.googFrameWidthSent),height:Number(r.googFrameHeightInput)||Number(r.googFrameHeightSent),frameRate:Number(r.googFrameRateInput)},d.sentFrame={width:Number(r.googFrameWidthSent),height:Number(r.googFrameHeightSent),frameRate:Number(r.googFrameRateInput)},d.firsCount=Number(r.googFirReceived),d.nacksCount=Number(r.googNacksReceived),d.plisCount=Number(r.googPlisReceived),d.frameCount=Number(r.framesEncoded),d.bytes=Number(r.bytesSent),d.packets=Number(r.packetsSent),d.packetsLost=Number(r.packetsLost),d.ssrc=Number(r.ssrc),d.rttMs=Number(r.googRtt||0),this._stats.videoSend.push(d),this._stats.rtt=d.rttMs;break}case"video_recv":{const d=ra(F3),h=this.lastDecodeVideoReceiverStats.get(Number(r.ssrc));if(d.codec=r.googCodecName,d.targetDelayMs=Number(r.googTargetDelayMs),d.renderDelayMs=Number(r.googRenderDelayMs),d.currentDelayMs=Number(r.googCurrentDelayMs),d.minPlayoutDelayMs=Number(r.googMinPlayoutDelayMs),d.decodeMs=Number(r.googDecodeMs),d.maxDecodeMs=Number(r.googMaxDecodeMs),d.receivedFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateReceived)},d.decodedFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateDecoded)},d.decodeFrameRate=Number(r.googFrameRateDecoded),d.outputFrame={width:Number(r.googFrameWidthReceived),height:Number(r.googFrameHeightReceived),frameRate:Number(r.googFrameRateOutput)},d.jitterBufferMs=Number(r.googJitterBufferMs),d.firsCount=Number(r.googFirsSent),d.nacksCount=Number(r.googNacksSent),d.plisCount=Number(r.googPlisSent),d.framesDecodeCount=Number(r.framesDecoded),d.bytes=Number(r.bytesReceived),d.packets=Number(r.packetsReceived),d.packetsLost=Number(r.packetsLost),d.ssrc=Number(r.ssrc),d.packets>0&&!this.isFirstVideoReceived[d.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(d.ssrc),this.isFirstVideoReceived[d.ssrc]=!0),d.framesDecodeCount>0&&!this.isFirstVideoDecoded[d.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(d.ssrc,d.decodedFrame.width,d.decodedFrame.height),this.isFirstVideoDecoded[d.ssrc]=!0),h){const f=h.stats,g=Date.now()-h.lts;d.framesDecodeFreezeTime=f.framesDecodeFreezeTime,d.framesDecodeInterval=f.framesDecodeInterval,d.framesDecodeCount>f.framesDecodeCount&&this.isFirstVideoDecoded[d.ssrc]?(h.lts=Date.now(),d.framesDecodeInterval=g,d.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(r.ssrc,10))?d.framesDecodeFreezeTime+=d.framesDecodeInterval:this.setVideoIsReady2(parseInt(r.ssrc,10),!0))):d.framesDecodeCount<h.stats.framesDecodeCount&&(d.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(d.ssrc,{stats:yce({},d),lts:Date.now()}),this._stats.videoRecv.push(d);break}case"audio_recv":{const d=ra(W3);d.codec=r.googCodecName,d.outputLevel=Math.abs(Number(r.audioOutputLevel))/32767,d.decodingCNG=Number(r.googDecodingCNG),d.decodingCTN=Number(r.googDecodingCTN),d.decodingCTSG=Number(r.googDecodingCTSG),d.decodingNormal=Number(r.googDecodingNormal),d.decodingPLC=Number(r.googDecodingPLC),d.decodingPLCCNG=Number(r.googDecodingPLCCNG),d.expandRate=Number(r.googExpandRate),d.accelerateRate=Number(r.googAccelerateRate),d.preemptiveExpandRate=Number(r.googPreemptiveExpandRate),d.secondaryDecodedRate=Number(r.googSecondaryDecodedRate),d.speechExpandRate=Number(r.googSpeechExpandRate),d.preferredJitterBufferMs=Number(r.googPreferredJitterBufferMs),d.jitterBufferMs=Number(r.googJitterBufferMs),d.jitterMs=Number(r.googJitterReceived),d.bytes=Number(r.bytesReceived),d.packets=Number(r.packetsReceived),d.packetsLost=Number(r.packetsLost),d.ssrc=Number(r.ssrc),d.receivedFrames=Number(r.googDecodingCTN)||Number(r.packetsReceived),d.droppedFrames=Number(r.googDecodingPLC)+Number(r.googDecodingPLCCNG)||Number(r.packetsLost),d.receivedFrames>0&&!this.isFirstAudioReceived[d.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(d.ssrc),this.isFirstAudioReceived[d.ssrc]=!0),d.decodingNormal>0&&!this.isFirstAudioDecoded[d.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(d.ssrc),this.isFirstAudioDecoded[d.ssrc]=!0),this._stats.audioRecv.push(d);break}case"audio_send":{const d=ra(B3);d.codec=r.googCodecName,d.inputLevel=Math.abs(Number(r.audioInputLevel))/32767,d.aecReturnLoss=Number(r.googEchoCancellationReturnLoss||0),d.aecReturnLossEnhancement=Number(r.googEchoCancellationReturnLossEnhancement||0),d.residualEchoLikelihood=Number(r.googResidualEchoLikelihood||0),d.residualEchoLikelihoodRecentMax=Number(r.googResidualEchoLikelihoodRecentMax||0),d.bytes=Number(r.bytesSent),d.packets=Number(r.packetsSent),d.packetsLost=Number(r.packetsLost),d.ssrc=Number(r.ssrc),d.rttMs=Number(r.googRtt||0),this._stats.rtt=d.rttMs,this._stats.audioSend.push(d);break}}})}_getStats(){return new ae((n,r)=>{this.pc.getStats(n,r)})}statsResponsesToObjects(n){const r=[];return n.result().forEach(s=>{const c={id:s.id,timestamp:s.timestamp.valueOf().toString(),type:s.type};s.names().forEach(d=>{c[d]=s.stat(d)}),r.push(c)}),r}}function $3(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function Ju(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?$3(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):$3(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class K3 extends m1{constructor(){super(...arguments),I(this,"_stats",o_),I(this,"report",void 0),I(this,"lastDecodeVideoReceiverStats",new Map),I(this,"lastVideoFramesRecv",new Map),I(this,"lastVideoFramesSent",new Map),I(this,"lastVideoFramesDecode",new Map),I(this,"lastVideoJBDelay",new Map),I(this,"lastAudioJBDelay",new Map),I(this,"mediaBytesSent",new Map),I(this,"mediaBytesRetransmit",new Map),I(this,"mediaBytesTargetEncode",new Map),I(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=ra(o_),this.report.forEach(n=>{switch(n.type){case Zi.OUTBOUND:case Zi.INBOUND:{const r=n.mediaType||n.kind,s=!r&&"frameWidth"in n,c=!r&&!("frameWidth"in n);n.type===Zi.OUTBOUND?r==="audio"||c?this.processAudioOutboundStats(n):(r==="video"||s)&&this.processVideoOutboundStats(n):n.type===Zi.INBOUND&&(r==="audio"||c?this.processAudioInboundStats(n):(r==="video"||s)&&this.processVideoInboundStats(n));break}case Zi.TRANSPORT:{const r=this.report.get(n.selectedCandidatePairId);r&&this.processCandidatePairStats(r);break}case Zi.CANDIDATE_PAIR:n.selected&&this.processCandidatePairStats(n)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const n=await this.pc.getStats(),r={local:Ju({},hc),remote:Ju({},hc)};return n.forEach(s=>{let c;if(s.type===Zi.TRANSPORT&&(c=n.get(s.selectedCandidatePairId)),s.type===Zi.CANDIDATE_PAIR&&s.selected&&(c=s),c){const d=(h,f)=>{h.type=f.type,h.id=f.id,f.address&&(h.address=f.address),f.candidateType&&(h.candidateType=f.candidateType),f.port&&(h.port=f.port),f.priority&&(h.priority=f.priority),f.protocol&&(h.protocol=f.protocol),f.relayProtocol&&(h.relayProtocol=f.relayProtocol)};if(c.localCandidateId){const h=n.get(c.localCandidateId);h&&d(r.local,h)}if(c.remoteCandidateId){const h=n.get(c.remoteCandidateId);h&&d(r.remote,h)}}}),r}processCandidatePairStats(n){if(this._stats.sendBandwidth=n.availableOutgoingBitrate||0,n.currentRoundTripTime&&(this._stats.rtt=1e3*n.currentRoundTripTime),this._stats.videoSend.forEach(r=>{n.currentRoundTripTime&&(r.rttMs=1e3*n.currentRoundTripTime)}),this._stats.audioSend.forEach(r=>{n.currentRoundTripTime&&(r.rttMs=1e3*n.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=n.id,n.localCandidateId){const r=this.report.get(n.localCandidateId);r&&this.processCandidateStats(r)}if(n.remoteCandidateId){const r=this.report.get(n.remoteCandidateId);r&&this.processCandidateStats(r)}}processCandidateStats(n){let r;n.type===Zi.LOCAL_CANDIDATE&&(r=this._stats.selectedCandidatePair.localCandidate),n.type===Zi.REMOTE_CANDIDATE&&(r=this._stats.selectedCandidatePair.remoteCandidate),r&&(r.type=n.type,r.id=n.id,n.address&&(r.address=n.address),n.candidateType&&(r.candidateType=n.candidateType),n.port&&(r.port=n.port),n.priority&&(r.priority=n.priority),n.protocol&&(r.protocol=n.protocol),n.relayProtocol&&(r.relayProtocol=n.relayProtocol),n.type===Zi.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==r.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Ju({},r),Ju({},this.stats.selectedCandidatePair.localCandidate)),n.type===Zi.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==r.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Ju({},r),Ju({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(n){let r=this._stats.audioRecv.find(s=>s.ssrc===n.ssrc);r||(r=ra(W3),this._stats.audioRecv.push(r)),r.ssrc=n.ssrc,r.packets=n.packetsReceived,r.packetsLost=n.packetsLost,r.bytes=n.bytesReceived,r.jitterMs=1e3*n.jitter,this.processAudioTrackReceiverStats(n,n.trackId,r),n.codecId&&(r.codec=this.getCodecFromCodecStats(n.codecId)),r.receivedFrames||(r.receivedFrames=n.packetsReceived),r.droppedFrames||(r.droppedFrames=n.packetsLost),r.receivedFrames>0&&!this.isFirstAudioReceived[r.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(r.ssrc),this.isFirstAudioReceived[r.ssrc]=!0),r.outputLevel&&r.outputLevel>0&&!this.isFirstAudioDecoded[r.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(r.ssrc),this.isFirstAudioDecoded[r.ssrc]=!0),typeof n.concealedSamples=="number"&&(r.concealedSamples=n.concealedSamples)}processVideoInboundStats(n){let r=this._stats.videoRecv.find(h=>h.ssrc===n.ssrc);r||(r=ra(F3),this._stats.videoRecv.push(r)),r.ssrc=n.ssrc,r.packets=n.packetsReceived,r.packetsLost=n.packetsLost,r.bytes=n.bytesReceived,r.firsCount=n.firCount,r.nacksCount=n.nackCount,r.plisCount=n.pliCount,r.framesDecodeCount=n.framesDecoded,r.totalInterFrameDelay=n.totalInterFrameDelay,r.totalSquaredInterFrameDelay=n.totalSquaredInterFrameDelay;const s=this.lastDecodeVideoReceiverStats.get(r.ssrc),c=this.lastVideoFramesDecode.get(r.ssrc),d=Date.now();if(r.framesDecodeCount>0&&!this.isFirstVideoDecoded[r.ssrc]){const h=r.decodedFrame?r.decodedFrame.width:0,f=r.decodedFrame?r.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(r.ssrc,h,f),this.isFirstVideoDecoded[r.ssrc]=!0}if(s){const h=s.stats,f=d-s.lts;r.framesDecodeFreezeTime=h.framesDecodeFreezeTime,r.framesDecodeInterval=h.framesDecodeInterval,!this.isFirstVideoDecoded[r.ssrc]&&f>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[r.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(r.ssrc),this.isFirstVideoDecodedTimeout[r.ssrc]=!0),r.framesDecodeCount>h.framesDecodeCount&&this.isFirstVideoDecoded[r.ssrc]?(s.lts=Date.now(),r.framesDecodeInterval=f,r.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(n.ssrc))?r.framesDecodeFreezeTime+=r.framesDecodeInterval:this.setVideoIsReady2(parseInt(n.ssrc,10),!0))):r.framesDecodeCount<h.framesDecodeCount&&(r.framesDecodeInterval=0),n.framesDecoded&&n.qpSum&&(s.stats.framesDecodeCount>n.framesDecoded?r.qpSumPerFrame=n.qpSum/n.framesDecoded:r.qpSumPerFrame=(n.qpSum-s.qpSum)/(n.framesDecoded-s.stats.framesDecodeCount))}c&&d-c.lts>=800?(r.decodeFrameRate=Math.round((r.framesDecodeCount-c.count)/((d-c.lts)/1e3)),this.lastVideoFramesDecode.set(r.ssrc,{count:r.framesDecodeCount,lts:d,rate:r.decodeFrameRate})):c?r.decodeFrameRate=c.rate:this.lastVideoFramesDecode.set(r.ssrc,{count:r.framesDecodeCount,lts:d,rate:0}),n.totalDecodeTime&&(r.decodeMs=1e3*n.totalDecodeTime),this.processVideoTrackReceiverStats(n,n.trackId,r),n.codecId&&(r.codec=this.getCodecFromCodecStats(n.codecId)),n.framerateMean&&(r.framesRateFirefox=n.framerateMean),r.packets>0&&!this.isFirstVideoReceived[r.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(r.ssrc),this.isFirstVideoReceived[r.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(r.ssrc,{stats:Ju({},r),lts:s?s.lts:Date.now(),qpSum:n.qpSum})}processVideoOutboundStats(n){let r=this._stats.videoSend.find(c=>c.ssrc===n.ssrc);r||(r=ra(V3),this._stats.videoSend.push(r));const s=this.mediaBytesSent.get(n.ssrc);if(s)s.add(n.bytesSent);else{const c=new f1(10);c.add(n.bytesSent),this.mediaBytesSent.set(n.ssrc,c)}if(n.retransmittedBytesSent!==void 0){const c=this.mediaBytesRetransmit.get(n.ssrc);if(c)c.add(n.retransmittedBytesSent);else{const d=new f1(10);d.add(n.retransmittedBytesSent),this.mediaBytesRetransmit.set(n.ssrc,d)}}if(n.totalEncodedBytesTarget){const c=this.mediaBytesTargetEncode.get(n.ssrc);if(c)c.add(n.totalEncodedBytesTarget);else{const d=new f1(10);d.add(n.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(n.ssrc,d)}}if(r.ssrc=n.ssrc,r.bytes=n.bytesSent,r.packets=n.packetsSent,r.firsCount=n.firCount,r.nacksCount=n.nackCount,r.plisCount=n.pliCount,r.frameCount=n.framesEncoded,r.adaptionChangeReason=n.qualityLimitationReason,r.scalabilityMode=n.scalabilityMode,n.totalEncodeTime&&n.framesEncoded){const c=this.lastEncoderMs.get(n.ssrc);if(!c||c.lastFrameCount>n.framesEncoded)r.avgEncodeMs=1e3*n.totalEncodeTime/n.framesEncoded;else{const d=n.framesEncoded-c.lastFrameCount,h=n.totalEncodeTime-c.lastEncoderTime;r.avgEncodeMs=1e3*h/d}}if(n.framesEncoded&&n.qpSum){const c=this.lastEncoderMs.get(n.ssrc);!c||c.lastFrameCount>n.framesEncoded?r.qpSumPerFrame=n.qpSum/n.framesEncoded:r.qpSumPerFrame=(n.qpSum-c.lastQpSum)/(n.framesEncoded-c.lastFrameCount)}if(this.lastEncoderMs.set(n.ssrc,{lastFrameCount:n.framesEncoded,lastEncoderTime:n.totalEncodeTime,lastQpSum:n.qpSum,lts:Date.now()}),n.codecId&&(r.codec=this.getCodecFromCodecStats(n.codecId)),n.mediaSourceId&&this.processVideoMediaSource(n.mediaSourceId,r),this.processVideoTrackSenderStats(n,n.trackId,r),n.remoteId)this.processRemoteInboundStats(n.remoteId,r);else{const c=this.findRemoteStatsId(n.ssrc,Zi.REMOTE_INBOUND);c&&this.processRemoteInboundStats(c,r)}}processAudioOutboundStats(n){let r=this._stats.audioSend.find(s=>s.ssrc===n.ssrc);if(r||(r=ra(B3),this._stats.audioSend.push(r)),r.ssrc=n.ssrc,r.packets=n.packetsSent,r.bytes=n.bytesSent,n.mediaSourceId&&this.processAudioMediaSource(n.mediaSourceId,r),n.codecId&&(r.codec=this.getCodecFromCodecStats(n.codecId)),this.processAudioTrackSenderStats(n,n.trackId,r),n.remoteId)this.processRemoteInboundStats(n.remoteId,r);else{const s=this.findRemoteStatsId(n.ssrc,Zi.REMOTE_INBOUND);s&&this.processRemoteInboundStats(s,r)}}findRemoteStatsId(n,r){var s;const c=Array.from(Ia(s=this.report).call(s)).find(d=>d.type===r&&d.ssrc===n);return c?c.id:null}processVideoMediaSource(n,r){const s=this.report.get(n);s&&s.width&&s.height&&s.framesPerSecond&&(r.inputFrame={width:s.width,height:s.height,frameRate:s.framesPerSecond})}processAudioMediaSource(n,r){const s=this.report.get(n);s&&(r.inputLevel=s.audioLevel)}processVideoTrackSenderStats(n,r,s){var c,d,h,f;const g=r?this.report.get(r):void 0,_=(c=g==null?void 0:g.framesSent)!==null&&c!==void 0?c:n.framesSent;if(typeof _!="number")return;let E=(d=g==null?void 0:g.frameWidth)!==null&&d!==void 0?d:n.frameWidth,T=(h=g==null?void 0:g.frameHeight)!==null&&h!==void 0?h:n.frameHeight,w=(f=g==null?void 0:g.framesPerSecond)!==null&&f!==void 0?f:n.framesPerSecond;if(typeof E=="number"&&typeof T=="number"||(E=0,T=0),w==null){const A=Date.now(),L=this.lastVideoFramesSent.get(s.ssrc);L&&A-L.lts>=800?(w=Math.round((_-L.count)/((A-L.lts)/1e3)),this.lastVideoFramesSent.set(s.ssrc,{count:_,lts:A,rate:w})):L?w=L.rate:this.lastVideoFramesSent.set(s.ssrc,{count:_,lts:A,rate:0})}s.sentFrame={width:E,height:T,frameRate:Math.max(0,w)}}processVideoTrackReceiverStats(n,r,s){var c,d,h,f,g;const _=r?this.report.get(r):void 0,E=(c=_==null?void 0:_.framesReceived)!==null&&c!==void 0?c:n.framesReceived,T=(d=_==null?void 0:_.frameWidth)!==null&&d!==void 0?d:n.frameWidth,w=(h=_==null?void 0:_.frameHeight)!==null&&h!==void 0?h:n.frameHeight,A=(f=_==null?void 0:_.jitterBufferDelay)!==null&&f!==void 0?f:n.jitterBufferDelay,L=(g=_==null?void 0:_.jitterBufferEmittedCount)!==null&&g!==void 0?g:n.jitterBufferEmittedCount;if(typeof E=="number"){const P=this.lastVideoFramesRecv.get(s.ssrc),D=Date.now();s.framesReceivedCount=E;let G=0;P&&D-P.lts>=800?(G=Math.round((E-P.count)/((D-P.lts)/1e3)),this.lastVideoFramesRecv.set(s.ssrc,{count:E,lts:D,rate:G})):P?G=P.rate:this.lastVideoFramesRecv.set(s.ssrc,{count:E,lts:D,rate:0}),s.receivedFrame={width:T||0,height:w||0,frameRate:G||0},s.decodedFrame={width:T||0,height:w||0,frameRate:s.decodeFrameRate||0},s.outputFrame={width:T||0,height:w||0,frameRate:s.decodeFrameRate||0}}if(A&&L){const P=this.lastVideoJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let D=P.jitterBufferMs;const G=L-P.jitterBufferEmittedCount;G>0&&(D=1e3*(A-P.jitterBufferDelay)/G),s.jitterBufferMs=D,s.currentDelayMs=Math.round(D),this.lastVideoJBDelay.set(s.ssrc,{jitterBufferDelay:A,jitterBufferEmittedCount:L,jitterBufferMs:s.currentDelayMs})}}processAudioTrackSenderStats(n,r,s){var c,d,h,f;const g=r?this.report.get(r):void 0,_=(c=(d=g==null?void 0:g.echoReturnLoss)!==null&&d!==void 0?d:n.echoReturnLoss)!==null&&c!==void 0?c:0,E=(h=(f=g==null?void 0:g.echoReturnLossEnhancement)!==null&&f!==void 0?f:n.echoReturnLossEnhancement)!==null&&h!==void 0?h:0;s.aecReturnLoss=_,s.aecReturnLossEnhancement=E}processAudioTrackReceiverStats(n,r,s){var c,d,h,f,g,_,E;const T=r?this.report.get(r):void 0,w=(c=T==null?void 0:T.removedSamplesForAcceleration)!==null&&c!==void 0?c:n.removedSamplesForAcceleration,A=(d=T==null?void 0:T.totalSamplesReceived)!==null&&d!==void 0?d:n.totalSamplesReceived,L=(h=T==null?void 0:T.jitterBufferDelay)!==null&&h!==void 0?h:n.jitterBufferDelay,P=(f=T==null?void 0:T.jitterBufferEmittedCount)!==null&&f!==void 0?f:n.jitterBufferEmittedCount,D=(g=T==null?void 0:T.audioLevel)!==null&&g!==void 0?g:n==null?void 0:n.audioLevel,G=(_=T==null?void 0:T.totalSamplesDuration)!==null&&_!==void 0?_:n==null?void 0:n.totalSamplesDuration,$=(E=T==null?void 0:T.concealedSamples)!==null&&E!==void 0?E:n.concealedSamples;if(w&&A&&(s.accelerateRate=w/A),L&&P){const ie=this.lastAudioJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let Q=ie.jitterBufferMs;const te=P-ie.jitterBufferEmittedCount;te>0&&(Q=1e3*(L-ie.jitterBufferDelay)/te),s.jitterBufferMs=Math.round(Q),this.lastAudioJBDelay.set(s.ssrc,{jitterBufferDelay:L,jitterBufferEmittedCount:P,jitterBufferMs:s.jitterBufferMs})}s.outputLevel=D;let X=1920;G&&A&&(X=A/G/50,s.receivedFrames=Math.round(A/X)),$&&(s.droppedFrames=Math.round($/X))}processRemoteInboundStats(n,r){const s=this.report.get(n);s&&(r.packetsLost=s.packetsLost,s.roundTripTime&&(r.rttMs=1e3*s.roundTripTime),s.jitter&&(r.jitterMs=1e3*s.jitter),s.timestamp&&(r.timestamp=s.timestamp))}getCodecFromCodecStats(n){const r=this.report.get(n);if(!r)return"";const s=r.mimeType.match(/\/(.*)$/);return s&&s[1]?s[1]:""}updateSendBitrate(){let n=0,r=null,s=null;this.mediaBytesSent.forEach(d=>{n+=d.diffMean()}),this.mediaBytesRetransmit.forEach(d=>{r=r===null?d.diffMean():r+d.diffMean()}),this.mediaBytesTargetEncode.forEach(d=>{s=s===null?d.diffMean():s+d.diffMean()});const c=r!==null?n-r:n;this._stats.bitrate={actualEncoded:8*c/(this.options.updateInterval/1e3),transmit:8*n/(this.options.updateInterval/1e3)},r!==null&&(this._stats.bitrate.retransmit=8*r/(this.options.updateInterval/1e3)),s!==null&&(this._stats.bitrate.targetEncoded=8*s/(this.options.updateInterval/1e3))}}class Tce extends m1{updateStats(){return ae.resolve()}}function Y0(o){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const d=function(){const h=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return h&&h[0]?Number(h[0].split("/")[1]):null}();return d?d<76?new Sce(o,{updateInterval:n,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:c}):new K3(o,{updateInterval:n,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:c}):function(h){return!!window.RTCStatsReport&&h.getStats()instanceof ae}(o)?new K3(o,{updateInterval:n,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:c}):new Tce(o,{updateInterval:n,lossRateInterval:r,freezeRateLimit:s,firstVideoDecodedTimeout:c})}function Y3(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function q3(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Y3(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):Y3(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}function s_(o){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;const{filterRTX:c,filterVideoFec:d,filterAudioFec:h,filterAudioCodec:f,filterVideoCodec:g}=n,{useXR:_}=r;let E=[],T=[],w=[],A=[],L=!1,P=!1;if(gn.parse(o).mediaDescriptions.forEach(G=>{s&&s!==G.attributes.direction||(G.media.mediaType!=="video"||L||(T=G.attributes.payloads,A=G.attributes.extmaps,L=!0),G.media.mediaType!=="audio"||P||(E=G.attributes.payloads,w=G.attributes.extmaps,P=!0))}),!A||T.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!w||E.length===0)throw new Error("Cannot get audio capabilities from SDP.");T.forEach(G=>{var $;($=G.rtpMap)!==null&&$!==void 0&&$.clockRate&&(G.rtpMap.clockRate=parseInt(G.rtpMap.clockRate)),_&&G.rtcpFeedbacks.push({type:"rrtr"})}),E.forEach(G=>{var $;($=G.rtpMap)!==null&&$!==void 0&&$.clockRate&&(G.rtpMap.clockRate=parseInt(G.rtpMap.clockRate)),_&&G.rtcpFeedbacks.push({type:"rrtr"})}),c&&(E=E.filter(G=>{var $;return(($=G.rtpMap)===null||$===void 0?void 0:$.encodingName.toLowerCase())!=="rtx"}),T=T.filter(G=>{var $;return(($=G.rtpMap)===null||$===void 0?void 0:$.encodingName.toLowerCase())!=="rtx"})),d&&(T=T.filter(G=>{var $;return!/(red)|(ulpfec)|(flexfec)/i.test((($=G.rtpMap)===null||$===void 0?void 0:$.encodingName)||"")})),h&&(E=E.filter(G=>{var $;return!/(red)|(ulpfec)|(flexfec)/i.test((($=G.rtpMap)===null||$===void 0?void 0:$.encodingName)||"")})),f&&(f==null?void 0:f.length)>0&&(E=E.filter(G=>{var $;return Le(f).call(f,(($=G.rtpMap)===null||$===void 0?void 0:$.encodingName.toLowerCase())||"")})),g&&(g==null?void 0:g.length)>0&&(T=T.filter(G=>{var $;return Le(g).call(g,(($=G.rtpMap)===null||$===void 0?void 0:$.encodingName.toLowerCase())||"")}));const D=Y("UNSUPPORTED_VIDEO_CODEC");return D&&D.length>0&&(T=T.filter(G=>!(G.rtpMap&&Le(D).call(D,G.rtpMap.encodingName.toLowerCase())))),{audioCodecs:E,videoCodecs:T,audioExtensions:w,videoExtensions:A}}function ka(o){const n=gn.parse(o);let r,s;for(const c of n.mediaDescriptions){if(!r){const d=c.attributes.iceUfrag,h=c.attributes.icePwd;if(!d||!h)throw new Error("Cannot get iceUfrag or icePwd from SDP.");r={iceUfrag:d,icePwd:h}}if(!s){const d=c.attributes.fingerprints;d.length>0&&(s={fingerprints:d})}}if(!s&&n.attributes.fingerprints.length>0&&(s={fingerprints:n.attributes.fingerprints}),!s||!r)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:r,dtlsParameters:s}}function g1(o,n){const r=[],s=o.attributes.ssrcGroups.filter(h=>h.semantic==="FID"),c=o.attributes.ssrcGroups.find(h=>h.semantic==="SIM"),d=o.attributes.ssrcs;if(c)c.ssrcIds.forEach(h=>{var f;const g=(f=s.find(_=>_.ssrcIds[0]===h))===null||f===void 0?void 0:f.ssrcIds[1];r.push({ssrcId:h,rtx:n?g:void 0})});else if(s.length>0){const h=s[0].ssrcIds[0],f=s[0].ssrcIds[1];r.push({ssrcId:h,rtx:n?f:void 0})}else{if(d.length===0)throw new Error("No ssrcs found on local media description.");r.push({ssrcId:d[0].ssrcId})}return r}function J3(o,n){const{cname:r}=o;let s;n&&n.ip&&typeof n.port=="number"?(s=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:n.ip,port:n.port.toString(),type:"host",extension:{}}],O.debug("Using remote candidate from AP ".concat(n.ip,":").concat(n.port)),n.ip6&&(s.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:n.ip6,port:n.port.toString(),type:"host",extension:{}}),O.debug("Using IPV6 remote candidate from AP ".concat(n.ip6,":").concat(n.port)))):s=o.iceParameters.candidates.map(f=>({foundation:f.foundation,componentId:"1",transport:f.protocol,priority:f.priority.toString(),connectionAddress:f.ip,port:f.port.toString(),type:f.type,extension:{}}));const c={fingerprints:o.dtlsParameters.fingerprints.map(f=>({hashFunction:f.algorithm,fingerprint:f.fingerprint}))},d={iceUfrag:o.iceParameters.iceUfrag,icePwd:o.iceParameters.icePwd};let h;switch(o.dtlsParameters.role){case"server":h="passive";break;case"client":h="active";break;case"auto":h="actpass"}return{dtlsParameters:c,iceParameters:d,candidates:s,rtpCapabilities:ef(o.rtpCapabilities),setup:h,cname:r}}function no(o,n,r){const s=[],c=[];return o.forEach(d=>{let{ssrcId:h,rtx:f}=d;const g=Qt(8,"track-"),_={ssrcId:h,attributes:q3({label:g,mslabel:r=r||Qt(10,""),msid:"".concat(r," ").concat(g)},n&&{cname:n})};if(s.push(_),f!==void 0){const E={ssrcId:f,attributes:q3({label:g,mslabel:r,msid:"".concat(r," ").concat(g)},n&&{cname:n})};s.push(E),c.push({semantic:"FID",ssrcIds:[h,f]})}}),o.length>1&&c.push({semantic:"SIM",ssrcIds:o.map(d=>{let{ssrcId:h}=d;return h})}),{ssrcs:s,ssrcGroups:c}}function Td(o,n){n instanceof Gt&&o.attributes.payloads.forEach(r=>{var s;const c=(s=r.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase();if(!c||["opus","pcmu","pcma","g722"].indexOf(c)===-1)return;r.fmtp||(r.fmtp={parameters:{}}),r.fmtp.parameters.minptime="10",r.fmtp.parameters.useinbandfec="1";const d=n._encoderConfig;d&&c!=="pcmu"&&c!=="pcma"&&c!=="g722"&&(d.bitrate&&!Jt()&&(r.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*d.bitrate))),d.sampleRate&&(r.fmtp.parameters.maxplaybackrate="".concat(d.sampleRate),r.fmtp.parameters["sprop-maxcapturerate"]="".concat(d.sampleRate)),d.stereo&&(r.fmtp.parameters.stereo="1",r.fmtp.parameters["sprop-stereo"]="1"))})}function q0(o){const n=o.attributes.unrecognized.findIndex(r=>r.attField==="x-google-flag"&&r.attValue==="conference");n!==-1&&o.attributes.unrecognized.splice(n,1)}function J0(o,n){var r;if(!(n instanceof ht&&n._encoderConfig&&n._hints.indexOf(tn.SCREEN_TRACK)===-1))return;const s=n._encoderConfig;Lt().supportMinBitrate&&s.bitrateMin&&o.attributes.payloads.forEach(c=>{var d,h;Le(d=["h264","h265","vp8","vp9","av1"]).call(d,((h=c.rtpMap)===null||h===void 0?void 0:h.encodingName.toLowerCase())||"")&&(c.fmtp||(c.fmtp={parameters:{}}),c.fmtp.parameters["x-google-min-bitrate"]="".concat(s.bitrateMin))}),Lt().supportMinBitrate&&!Le(r=n._hints).call(r,tn.LOW_STREAM)&&s.bitrateMax&&o.attributes.payloads.forEach(c=>{var d,h;Le(d=["h264","h265","vp8","vp9","av1"]).call(d,((h=c.rtpMap)===null||h===void 0?void 0:h.encodingName.toLowerCase())||"")&&(c.fmtp||(c.fmtp={parameters:{}}),c.fmtp.parameters["x-google-start-bitrate"]="".concat(Y("X_GOOGLE_START_BITRATE")||Math.floor(s.bitrateMax)))})}function _1(o){if(o.media.mediaType!=="video")return;const n=xt();if(n.name!==Ft.SAFARI&&n.os!==fr.IOS)return;const r=o.attributes.extmaps.findIndex(s=>/video-orientation/g.test(s.extensionName));r!==-1&&o.attributes.extmaps.splice(r,1)}function Zp(o,n,r){if(!n)return;let s,c;if(o.media.mediaType==="video"?(s=r.videoExtensions,c=r.videoCodecs):(s=r.audioExtensions,c=r.audioCodecs),n.twcc===!0){const d=s.find(h=>h.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");d&&(o.attributes.extmaps.find(f=>f.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||o.attributes.extmaps.push({entry:d.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(f,g){return g.filter(_=>!!f.find(E=>E.payloadType===_.payloadType&&!!E.rtcpFeedbacks.find(T=>T.type==="transport-cc")))}(c,o.attributes.payloads).forEach(f=>{f.rtcpFeedbacks.find(g=>g.type==="transport-cc")||f.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(n.twcc===!1){const d=o.attributes.extmaps.findIndex(h=>h.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");d!==-1&&o.attributes.extmaps.splice(d,1),o.attributes.payloads.forEach(h=>{const f=h.rtcpFeedbacks.findIndex(g=>g.type==="transport-cc");f!==-1&&h.rtcpFeedbacks.splice(f,1)})}if(n.remb===!0){const d=s.find(h=>h.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");d&&(o.attributes.extmaps.find(f=>f.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||o.attributes.extmaps.push({entry:d.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(f,g){return g.filter(_=>!!f.find(E=>E.payloadType===_.payloadType&&!!E.rtcpFeedbacks.find(T=>T.type==="goog-remb")))}(c,o.attributes.payloads).forEach(f=>{f.rtcpFeedbacks.find(g=>g.type==="goog-remb")||f.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(n.remb===!1){const d=o.attributes.extmaps.findIndex(h=>h.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");d!==-1&&o.attributes.extmaps.splice(d,1),o.attributes.payloads.forEach(h=>{const f=h.rtcpFeedbacks.findIndex(g=>g.type==="goog-remb");f!==-1&&h.rtcpFeedbacks.splice(f,1)})}}function v1(o,n,r){if(Jt()||o.media.mediaType!=="video"||!(n instanceof ht)||r!=="vp9"&&r!=="vp8"||r==="vp8"&&!Y("SIMULCAST")||n._scalabilityMode===void 0||n._scalabilityMode.numSpatialLayers<=1)return;const s=r==="vp8"?2:n._scalabilityMode.numSpatialLayers,c=o.attributes.ssrcs[0],d=o.attributes.ssrcGroups.find(f=>f.semantic==="FID"&&f.ssrcIds[0]===c.ssrcId),h={semantic:"SIM",ssrcIds:[c.ssrcId]};for(let f=1;f<s;f++)o.attributes.ssrcs.push({ssrcId:c.ssrcId+f,attributes:en(c.attributes)}),h.ssrcIds.push(c.ssrcId+f),d&&(o.attributes.ssrcs.push({ssrcId:d.ssrcIds[1]+f,attributes:en(c.attributes)}),o.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[c.ssrcId+f,d.ssrcIds[1]+f]}));o.attributes.ssrcGroups.unshift(h)}async function E1(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new RTCPeerConnection;r.addTransceiver("video",{direction:"sendonly"}),r.addTransceiver("audio",{direction:"sendonly"}),r.addTransceiver("video",{direction:"recvonly"}),r.addTransceiver("audio",{direction:"recvonly"});const s=(await r.createOffer()).sdp,{send:c,recv:d,sendrecv:h}=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2?arguments[2]:void 0;const E=s_(_,f,g,"sendonly"),T=s_(_,f,g,"recvonly"),w={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},A={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},L={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ia(E,T,"videoExtensions",w,A,L),ia(E,T,"videoCodecs",w,A,L),ia(E,T,"audioExtensions",w,A,L),ia(E,T,"audioCodecs",w,A,L),Y("RAISE_H264_BASELINE_PRIORITY")){const P=L.videoCodecs.findIndex(D=>{var G,$;return((G=D.rtpMap)===null||G===void 0?void 0:G.encodingName.toLocaleLowerCase())==="h264"&&(($=D.fmtp)===null||$===void 0?void 0:$.parameters["profile-level-id"])==="42001f"});if(P!==-1){const D=L.videoCodecs.findIndex(G=>{var $;return(($=G.rtpMap)===null||$===void 0?void 0:$.encodingName.toLocaleLowerCase())==="h264"});if(D<P){O.debug("raising H264 baseline profile priority");const G=L.videoCodecs[P];L.videoCodecs.splice(P,1),L.videoCodecs.splice(D,0,G)}D!==-1&&(A.videoCodecs=A.videoCodecs.filter(G=>{var $,X;return!((($=G.rtpMap)===null||$===void 0?void 0:$.encodingName.toLocaleLowerCase())==="h264"&&((X=G.fmtp)===null||X===void 0?void 0:X.parameters["profile-level-id"])!=="42001f")})),D!==-1&&Y("FILTER_SEND_H264_BASELINE")&&(w.videoCodecs=w.videoCodecs.filter(G=>{var $,X;return!((($=G.rtpMap)===null||$===void 0?void 0:$.encodingName.toLocaleLowerCase())==="h264"&&((X=G.fmtp)===null||X===void 0?void 0:X.parameters["profile-level-id"])!=="42001f")}))}}return{send:w,recv:A,sendrecv:L}}(o,n,s);try{r.close()}catch{}return{send:c,recv:d,sendrecv:h}}function X3(){const o={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},n=s_(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ia(o,n,"videoExtensions",r,s,c),ia(o,n,"videoCodecs",r,s,c),ia(o,n,"audioExtensions",r,s,c),ia(o,n,"audioCodecs",r,s,c),Y("RAISE_H264_BASELINE_PRIORITY")){const d=c.videoCodecs.findIndex(h=>h.rtpMap&&h.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&h.fmtp&&h.fmtp.parameters["profile-level-id"]==="42001f");if(d!==-1){const h=c.videoCodecs.findIndex(f=>f.rtpMap&&f.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(h<d){O.debug("raising H264 baseline profile priority");const f=c.videoCodecs[d];c.videoCodecs.splice(d,1),c.videoCodecs.splice(h,0,f)}h!==-1&&(s.videoCodecs=s.videoCodecs.filter(f=>!(f.rtpMap&&f.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&f.fmtp&&f.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:r,recv:s,sendrecv:c}}function ia(o,n,r,s,c,d){if(r==="videoExtensions"||r==="audioExtensions"){const h=[];return o[r].forEach(f=>{n[r].some((g,_)=>{if(f.entry===g.entry&&f.extensionName===g.extensionName)return h.push(_),!0})?d[r].push(f):s[r].push(f)}),void n[r].forEach((f,g)=>{h.indexOf(g)===-1&&c[r].push(f)})}if(r==="videoCodecs"||r==="audioCodecs"){const h=[];return o[r].forEach(f=>{n[r].some((g,_)=>{if(f.payloadType===g.payloadType&&JSON.stringify(f)===JSON.stringify(g))return h.push(_),!0})?d[r].push(f):s[r].push(f)}),void n[r].forEach((f,g)=>{h.indexOf(g)===-1&&c[r].push(f)})}}function ef(o){const{send:n,recv:r,sendrecv:s}=o;if(!s){if(!n||!r)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:n,recv:r}}let c,d;return n?(c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},c.audioCodecs=[...n.audioCodecs,...s.audioCodecs],c.videoCodecs=[...n.videoCodecs,...s.videoCodecs],c.audioExtensions=[...n.audioExtensions,...s.audioExtensions],c.videoExtensions=[...n.videoExtensions,...s.videoExtensions]):c=s,r?(d={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},d.audioCodecs=[...r.audioCodecs,...s.audioCodecs],d.videoCodecs=[...r.videoCodecs,...s.videoCodecs],d.audioExtensions=[...r.audioExtensions,...s.audioExtensions],d.videoExtensions=[...r.videoExtensions,...s.videoExtensions]):d=s,{send:c,recv:d}}function Da(o){o.media.mediaType==="audio"&&o.attributes.payloads.filter(n=>{var r;return((r=n.rtpMap)===null||r===void 0?void 0:r.encodingName.toLowerCase())==="opus"}).forEach(n=>{n.fmtp||(n.fmtp={parameters:{}}),n.fmtp.parameters.stereo="1",n.fmtp.parameters["sprop-stereo"]="1"})}function a_(o){o.mediaDescriptions.forEach(n=>{n.media.mediaType!=="video"&&n.media.mediaType!=="audio"||n.attributes.payloads.forEach(r=>{r.rtcpFeedbacks.findIndex(s=>s.type==="rrtr")===-1&&r.rtcpFeedbacks.push({type:"rrtr"})})})}function Xu(o,n,r,s){let c=[];if(o===Fe.VIDEO){if(Y("H264_PROFILE_LEVEL_ID")&&s==="h264"&&(c=n.videoCodecs.filter(d=>{var h;return Le(h=d.rtpMap&&d.rtpMap.encodingName.toLowerCase()||"").call(h,s)&&d&&d.fmtp&&d.fmtp.parameters["profile-level-id"]===Y("H264_PROFILE_LEVEL_ID")})),!Array.isArray(c)||c.length===0){let d=[];const h=[],f=[];r.videoCodecs.forEach(g=>{var _,E,T;Le(_=g.rtpMap&&g.rtpMap.encodingName.toLowerCase()||"").call(_,s)&&d.push(g),Le(E=g.rtpMap&&g.rtpMap.encodingName.toLowerCase()||"").call(E,"vp8")&&h.push(g),Le(T=g.rtpMap&&g.rtpMap.encodingName.toLowerCase()||"").call(T,"h264")&&f.push(g)}),d.length===0&&(h.length!==0?(d=h,O.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: vp8"))):f.length!==0&&(d=f,O.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: h264")))),d.length!==0&&(c=n.videoCodecs.filter(g=>d.some(_=>_.payloadType===g.payloadType)))}if(Y("USE_PUB_RTX")){const d=c.map(f=>f.payloadType.toString()),h=n.videoCodecs.filter(f=>f.rtpMap&&f.rtpMap.encodingName==="rtx"&&Le(d).call(d,f.fmtp&&f.fmtp.parameters.apt||""));c=[...c,...h]}c.length===0&&(O.warning("codec ".concat(s," not included in rtpCapabilities, fallback to default payloads: ").concat(n.videoCodecs[0].rtpMap&&n.videoCodecs[0].rtpMap.encodingName)),c=n.videoCodecs)}else c=n.audioCodecs.filter(d=>{var h;return Le(h=d.rtpMap&&d.rtpMap.encodingName.toLowerCase()||"").call(h,s)}),c.length===0&&(O.warning("codec ".concat(s," not included in rtpCapabilities, fallback to opus")),c=n.audioCodecs.filter(d=>{var h;return Le(h=d.rtpMap&&d.rtpMap.encodingName.toLowerCase()||"").call(h,"opus")}));return c}let Q3=class{get localCapabilities(){return en(this._localCapabilities)}get rtpCapabilities(){return en(this._rtpCapabilities)}get candidates(){return en(this._candidates)}get iceParameters(){return en(this._iceParameters)}get dtlsParameters(){return en(this._dtlsParameters)}constructor(o){I(this,"sessionDesc",void 0),I(this,"_localCapabilities",void 0),I(this,"_rtpCapabilities",void 0),I(this,"_candidates",void 0),I(this,"_iceParameters",void 0),I(this,"_dtlsParameters",void 0),I(this,"setup",void 0),I(this,"currentMidIndex",void 0),I(this,"cname","o/i14u9pJrxRKAsu"),I(this,"firefoxSsrcMidMap",new Map),o=en(o);const{remoteIceParameters:n,remoteDtlsParameters:r,candidates:s,remoteRTPCapabilities:c,localCapabilities:d,direction:h,setup:f,videoCodec:g,audioCodec:_}=o;let E;this.setup=f,E=h===ui.RECEIVE_ONLY?gn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):gn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=c,this._candidates=s,this._iceParameters=n,this._dtlsParameters=r,this._localCapabilities=d;const T=h===ui.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,w=h===ui.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,A=h===ui.RECEIVE_ONLY?c.send.videoCodecs:Xu(Fe.VIDEO,T,w,g),L=h===ui.RECEIVE_ONLY?c.send.audioCodecs:Xu(Fe.AUDIO,T,w,_);for(const P of E.mediaDescriptions){if(P.attributes.iceUfrag=n.iceUfrag,P.attributes.icePwd=n.icePwd,P.attributes.fingerprints=r.fingerprints,P.attributes.candidates=s,P.attributes.setup=this.setup,P.media.mediaType==="application"&&(P.attributes.sctpPort="5000"),P.media.mediaType==="video"&&(P.media.fmts=A.map(D=>D.payloadType.toString(10)),P.attributes.payloads=A,P.attributes.extmaps=T.videoExtensions,Y("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:D,ssrcGroups:G}=no([{ssrcId:4e4,rtx:Y("USE_SUB_RTX")?40001:void 0}],this.cname);P.attributes.ssrcs=D,P.attributes.ssrcGroups=G}if(P.media.mediaType==="audio"&&(P.media.fmts=L.map(D=>D.payloadType.toString(10)),P.attributes.payloads=L,P.attributes.extmaps=T.audioExtensions,Da(P),Y("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:D,ssrcGroups:G}=no([{ssrcId:2e4}],this.cname);P.attributes.ssrcs=D,P.attributes.ssrcGroups=G}}this.sessionDesc=E,this.currentMidIndex=E.mediaDescriptions.length-1}toString(){return gn.print(this.sessionDesc)}hasMid(o){return Array.isArray(o)?o.every(n=>this.hasMid(n)):this.sessionDesc.mediaDescriptions.some(n=>n.attributes.mid===o)}send(o,n,r,s,c){r=r.replace(/ /g,"-");const{ssrcs:d,ssrcGroups:h}=no(n,this.cname,Y("SYNC_GROUP")?r:void 0),f=this.findPreloadMediaDesc(d);if(f){if(Jt()&&this.firefoxSsrcMidMap.set(d[0].ssrcId,f.attributes.mid),c&&(c.twcc||c.remb)){const g=this.sessionDesc.mediaDescriptions.indexOf(f);return this.sessionDesc.mediaDescriptions[g]=this.mungSendMediaDesc(f,c),{mid:f.attributes.mid,needExchangeSDP:!0}}return{mid:f.attributes.mid,needExchangeSDP:!1}}{const g=this.findAvailableMediaIndex(o,d,s);let _;return g===-1?(_=this.createOrRecycleSendMedia(o,d,h,"sendonly",s,c),this.updateBundleMids()):(_=en(this.sessionDesc.mediaDescriptions[g]),_.attributes.direction="sendonly",_.attributes.ssrcs=d,_.attributes.ssrcGroups=h,this.sessionDesc.mediaDescriptions[g]=this.mungSendMediaDesc(_,c)),Jt()&&this.firefoxSsrcMidMap.set(d[0].ssrcId,_.attributes.mid),{needExchangeSDP:!0,mid:_.attributes.mid}}}stopSending(o){const n=this.sessionDesc.mediaDescriptions.filter(r=>r.attributes.mid&&o.indexOf(r.attributes.mid)!==-1);if(n.length!==o.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");n.forEach(r=>{r.attributes.ssrcs=[]}),this.updateBundleMids()}receive(o,n,r){const s=[];return o.forEach(c=>{const d=c._mediaStreamTrack.kind,h=this.findAvailableRecvMediaIndex(d);let f,g=!1;h===-1?(g=!0,f=this.createOrRecycleRecvMedia(c,[],"recvonly",n,r),this.updateBundleMids()):(f=en(this.sessionDesc.mediaDescriptions[h]),f.attributes.direction="recvonly"),s.push({mid:f.attributes.mid,needCreateTransceiver:g})}),s}stopReceiving(o){const n=this.sessionDesc.mediaDescriptions.filter(r=>o.indexOf(r.attributes.mid)!==-1);if(n.length!==o.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");n.forEach(r=>{r.media.port="0",r.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(o){const{foundation:n,protocol:r,address:s,port:c,type:d,relatedAddress:h,relatedPort:f,priority:g}=new RTCIceCandidate(o),_={foundation:n??"",componentId:"1",transport:r??"",priority:g?g+"":"",connectionAddress:s??"",port:c?c+"":"",type:d?d+"":"",relAddr:h??"",relPort:f?f+"":"",extension:{}};this.candidates.some(E=>E.priority===_.priority&&E.connectionAddress===_.connectionAddress&&E.port===_.port)||(this._candidates.push(_),this.sessionDesc.mediaDescriptions.forEach(E=>{E.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(o,n,r,s,c){const d=o._mediaStreamTrack.kind,h=this.rtpCapabilities.recv,f=Xu(d,h,this.localCapabilities.send,d===Fe.AUDIO?c:s),g=d===Fe.VIDEO?h.videoExtensions:h.audioExtensions,_="".concat(++this.currentMidIndex);let E={media:{mediaType:d,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:f.map(w=>w.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:g,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:f,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_)}};E=this.mungRecvMediaDsec(E,o);const T=this.findFirstClosedMedia(d);if(T){const w=this.sessionDesc.mediaDescriptions.indexOf(T);this.sessionDesc.mediaDescriptions[w]=E}else this.sessionDesc.mediaDescriptions.push(E);return E}muteRemote(o){const n=this.sessionDesc.mediaDescriptions.filter(r=>Le(o).call(o,r.attributes.mid||""));if(n.length!==o.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(r=>{r.attributes.direction="inactive"})}unmuteRemote(o){const n=this.sessionDesc.mediaDescriptions.filter(r=>Le(o).call(o,r.attributes.mid||""));if(n.length!==o.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(r=>{r.attributes.direction="recvonly"})}findAvailableMediaIndex(o,n,r){return this.sessionDesc.mediaDescriptions.findIndex(s=>{const c=s.media.mediaType===o&&s.media.port!=="0"&&(s.attributes.direction==="sendonly"||s.attributes.direction==="sendrecv")&&s.attributes.ssrcs.length===0;if(Jt()){if(c){const d=this.firefoxSsrcMidMap.get(n[0].ssrcId);return!(d||s.attributes.mid!=="0"&&s.attributes.mid!=="1")||!(!d||d!==s.attributes.mid)}return!1}return c&&s.attributes.mid===r})}findAvailableRecvMediaIndex(o){return this.sessionDesc.mediaDescriptions.findIndex(n=>{const r=n.media.mediaType===o&&n.media.port!=="0"&&(n.attributes.direction==="recvonly"||n.attributes.direction==="sendrecv");return n.attributes.mid!=="0"&&n.attributes.mid!=="1"&&r})}predictReceivingMids(o){const n=[];for(let r=0;r<o;r++)n.push((this.currentMidIndex+r+1).toString(10));return n}restartICE(o){o=en(o),this._iceParameters=o,this.sessionDesc.mediaDescriptions.forEach(n=>{n.attributes.iceUfrag=o.iceUfrag,n.attributes.icePwd=o.icePwd})}createOrRecycleSendMedia(o,n,r,s,c,d){const h=this.rtpCapabilities.send,f=o===Fe.VIDEO?h.videoCodecs:h.audioCodecs,g=o===Fe.VIDEO?h.videoExtensions:h.audioExtensions;Jt()&&(c="".concat(++this.currentMidIndex));let _={media:{mediaType:o,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:f.map(T=>T.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:g,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:r,rtcpFeedbackWildcards:[],payloads:f,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:c}};_=this.mungSendMediaDesc(_,d);const E=this.findFirstClosedMedia(o);if(E){const T=this.sessionDesc.mediaDescriptions.indexOf(E);this.sessionDesc.mediaDescriptions[T]=_}else this.sessionDesc.mediaDescriptions.push(_);return _}mungRecvMediaDsec(o,n,r){const s=en(o);return q0(s),Td(s,n),J0(s,n),_1(s),Zp(s,r,this.localCapabilities.send),s}mungSendMediaDesc(o,n){const r=en(o);return Zp(r,n,this.localCapabilities.recv),Da(r),r}updateRecvMedia(o,n){const r=this.sessionDesc.mediaDescriptions.findIndex(s=>s.attributes.mid===o);if(r!==-1){const s=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],n);this.sessionDesc.mediaDescriptions[r]=s}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(o=>o.media.port!=="0").map(o=>o.attributes.mid)}findPreloadMediaDesc(o){return this.sessionDesc.mediaDescriptions.find(n=>{var r;return((r=n.attributes)===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId)===o[0].ssrcId})}findFirstClosedMedia(o){return this.sessionDesc.mediaDescriptions.find(n=>Jt()?n.media.port==="0"&&n.media.mediaType===o:n.media.port==="0")}};const bce=["sdp"];function Z3(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function bd(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Z3(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):Z3(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}let qo=class vf extends NF{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var n,r;return(n=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&n!==void 0?n:null}get localCodecs(){return[]}set isInRestartIce(n){this._isInRestartIce=n}get isInRestartIce(){return this._isInRestartIce}constructor(n,r,s){super(n,r),I(this,"direction",void 0),I(this,"name",void 0),I(this,"store",void 0),I(this,"spec",void 0),I(this,"peerConnection",void 0),I(this,"initialOffer",void 0),I(this,"transport",void 0),I(this,"statsFilter",void 0),I(this,"localCandidateCount",0),I(this,"allCandidatesReceived",!1),I(this,"localCandidateAddress",null),I(this,"useXR",Y("USE_XR")),I(this,"filter",{filterRTX:!Y("USE_PUB_RTX")&&!Y("USE_SUB_RTX"),filterVideoFec:Y("FILTER_VIDEO_FEC"),filterAudioFec:Y("FILTER_AUDIO_FEC")}),I(this,"extension",{useXR:this.useXR}),I(this,"_isInRestartIce",!1),I(this,"mutex",new Pr("P2PConnection-mutex")),I(this,"onLocalCandidate",void 0),I(this,"remoteSDP",void 0),I(this,"pendingCandidates",[]),I(this,"localCapabilities",void 0),I(this,"isReady",!1),I(this,"restartCnt",0),I(this,"curTurnServerIndex",0),this.store=r,this.spec=n,this.peerConnection=new RTCPeerConnection(vf.resolvePCConfiguration(n,r.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=s??ui.SEND_ONLY,this.name=this.direction===ui.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=Y0(this.peerConnection,Y("STATS_UPDATE_INTERVAL"),void 0,Jt()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(n){try{const r=await E1(this.filter,this.extension);if(this.localCapabilities=ef(r),n){const{sdp:s}=n,c=Ece(n,bce),d=function(){const E={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},T=s_(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),w={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},A={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},L={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(ia(T,E,"videoExtensions",w,A,L),ia(T,E,"videoCodecs",w,A,L),ia(T,E,"audioExtensions",w,A,L),ia(T,E,"audioCodecs",w,A,L),Y("RAISE_H264_BASELINE_PRIORITY")){const P=L.videoCodecs.findIndex(D=>D.rtpMap&&D.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&D.fmtp&&D.fmtp.parameters["profile-level-id"]==="42001f");if(P!==-1){const D=L.videoCodecs.findIndex(G=>G.rtpMap&&G.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(D<P){O.debug("raising H264 baseline profile priority");const G=L.videoCodecs[P];L.videoCodecs.splice(P,1),L.videoCodecs.splice(D,0,G)}D!==-1&&Y("FILTER_SEND_H264_BASELINE")&&(w.videoCodecs=w.videoCodecs.filter(G=>!(G.rtpMap&&G.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&G.fmtp&&G.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:w,recv:A,sendrecv:L}}(this.filter,this.extension,s);this.remoteSDP=new Q3({remoteIceParameters:c.iceParameters,remoteDtlsParameters:c.dtlsParameters,candidates:[],remoteRTPCapabilities:d,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const h=await this.peerConnection.createAnswer();if(!h.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const f=ka(h.sdp);await this.peerConnection.setLocalDescription(h);const g=await X3(this.filter,this.extension,h.sdp);this.localCapabilities=ef(g);const _=this.peerConnection.getTransceivers()[0];return _!=null&&_.receiver&&_.receiver.transport&&this.tryBindTransportEvents(_.receiver.transport),bd(bd({},f),{},{sdp:h.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const s=await this.peerConnection.createOffer();if(!s.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const c=ka(s.sdp);return this.initialOffer=s,bd(bd({},c),{},{sdp:s.sdp})}}catch(r){throw new he(B.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async connect(n){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:r,iceParameters:s,dtlsParameters:c}=n,d=await X3(this.filter,this.extension,r);this.remoteSDP=new Q3({remoteIceParameters:s,remoteDtlsParameters:c,candidates:[],remoteRTPCapabilities:d,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const h=this.peerConnection.getTransceivers()[0];h!=null&&h.sender&&h.sender.transport&&this.tryBindTransportEvents(h.sender.transport)}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async addRemoteCandidate(n){try{n&&this.pendingCandidates.push(n),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(r=>{this.peerConnection.addIceCandidate(r)}),this.pendingCandidates=[])}catch(r){throw new he(B.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(r.toString()))}}send(n,r,s){var c=this;return Co(function*(){const d=yield ut(c.mutex.lock("From P2PConnection.send"));try{if(!c.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const h=[],f=c.remoteSDP.receive(n,r,s);n.forEach((D,G)=>{if(f[G].needCreateTransceiver){const $=c.peerConnection.addTransceiver(D._mediaStreamTrack,{direction:"sendonly"});h.push($),D._updateRtpTransceiver($)}else{const $=c.peerConnection.getTransceivers().find(X=>X.mid===f[G].mid);if(!$)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(f[G].mid));h.push($),D._updateRtpTransceiver($)}}),Jt()&&Y("SIMULCAST")===!0&&(yield ut(c.applySimulcastForFirefox(h,n)));const g=f.map(D=>D.mid),_=yield ut(c.peerConnection.createOffer()),E=c.mungSendOfferSDP(_.sdp,n,g),T=gn.parse(E),w=g.map(D=>{const G=T.mediaDescriptions.find($=>$.attributes.mid===D);if(!G)throw new Error("Cannot extract ssrc from mediaDescription.");return g1(G,Y("USE_PUB_RTX"))}),A=h.map((D,G)=>{const $=g[G];return{localSSRC:w[G],id:$}});yield ut(c.peerConnection.setLocalDescription({type:"offer",sdp:E}));try{yield A}catch(D){const G=c.remoteSDP.toString();throw yield ut(c.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield ut(c.peerConnection.setRemoteDescription({type:"answer",sdp:G})),yield ut(c.stopSending(g,!0)),D}yield ut(c.applySimulcastEncodings(h,n)),yield ut(c.applySendEncodings(h,n));const L=c.remoteSDP.toString(),P=c.logSDPExchange(E,"offer","local","send");return P==null||P(L),yield ut(c.setRemoteDescription({type:"answer",sdp:L})),h.map((D,G)=>{const $=g[G];return{localSSRC:w[G],id:$}})}catch(h){throw h instanceof he?h:new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(h.toString()))}finally{d()}})()}async stopSending(n,r){const s=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const c=this.peerConnection.getTransceivers().filter(g=>n.indexOf(g.mid)!==-1);if(c.length!==n.length)throw new Error("Transceivers' length (".concat(c.length,") doesn't match mids' length (").concat(n.length,") when trying to call P2PConnection.stopSending."));c.map(g=>{var _;g.direction="inactive",(_=g.stop)===null||_===void 0||_.call(g)});const d=await this.peerConnection.createOffer(),h=this.logSDPExchange(d.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(d),this.remoteSDP.stopReceiving(n);const f=this.remoteSDP.toString();h==null||h(f),await this.setRemoteDescription({type:"answer",sdp:f})}catch(c){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(c.toString()))}finally{s&&s()}}async receive(n,r,s,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(n," before remoteSDP created."));const{mid:d,needExchangeSDP:h}=this.remoteSDP.send(n,r,s,c);if(h){const g=this.remoteSDP.toString(),_=this.logSDPExchange(g,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:g});const E=await this.peerConnection.createAnswer(),T=this.mungReceiveAnswerSDP(E.sdp,d,n);_==null||_(T||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:T}),O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," by exchanging SDP."))}else O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," no need to exchange SDP."));const f=this.peerConnection.getTransceivers().find(g=>g.mid===d);if(!f||f.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,mid:f.mid,transceiver:f}}catch(d){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(d.toString()))}}async mockReceive(n,r,s,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(n," before remoteSDP created."));const{mid:d,needExchangeSDP:h}=this.remoteSDP.send(n,r,s,c);if(h){const f=this.remoteSDP.toString(),g=this.logSDPExchange(f,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:f});const _=await this.peerConnection.createAnswer(),E=this.mungReceiveAnswerSDP(_.sdp,d,n);g==null||g(E||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:E}),O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," by exchanging SDP."))}else O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," no need to exchange SDP."))}catch(d){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(d.toString()))}}async stopReceiving(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(n);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async restartICE(n){try{if(this.store.p2pTransport===Xc.Auto&&(this.store.p2pTransport=Xc.SdRtn,Lt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(vf.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,Lt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(vf.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!n){this.restartCnt++,this.isReady=!1;const r=await this.peerConnection.createOffer({iceRestart:!0});if(!r.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:s}=ka(r.sdp);return this.store.descriptionStart(),this.direction===ui.SEND_ONLY&&await this.peerConnection.setLocalDescription(r),s}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(n),this.store.descriptionStart(),this.direction===ui.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const r=await this.peerConnection.createAnswer();if(!r.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:s}=ka(r.sdp);return await this.peerConnection.setLocalDescription(r),s}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}close(){var n;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(n){return this.statsFilter.getVideoIsReady(n)}async updateEncoderConfig(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(s.sdp,[r],[n]);this.remoteSDP.updateRecvMedia(n,r);const d=this.remoteSDP.toString(),h=this.logSDPExchange(c,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),h==null||h(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(s){throw new he(B.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(n,r){const s=this.peerConnection.getTransceivers().filter(c=>c.mid===n);s.length===1&&(this.isVP8Simulcast(r)?Jt()||await this.applySimulcastEncodings(s,[r]):await this.applySendEncodings(s,[r]))}setStatsRemoteVideoIsReady(n,r){this.statsFilter.setVideoIsReady2(n,r)}async replaceTrack(n,r){const s=this.peerConnection.getTransceivers().find(c=>c.mid===r);s&&await s.sender.replaceTrack(n._mediaStreamTrack)}async getSelectedCandidatePair(){const n=this.peerConnection.getReceivers();if(n.length>0&&n[0].transport&&n[0].transport.iceTransport&&n[0].transport.iceTransport.getSelectedCandidatePair&&n[0].transport.iceTransport.getSelectedCandidatePair()){const r=n[0].transport.iceTransport,{local:s,remote:c}=r.getSelectedCandidatePair();return{local:bd(bd({},hc),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:bd(bd({},hc),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var n,r;Le(n=["connected","completed"]).call(n,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var n;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=n=>{if(n.candidate){var r;n.candidate.candidate&&(this.localCandidateAddress=n.candidate.address,(r=this.onLocalCandidate)===null||r===void 0||r.call(this,n.candidate.toJSON())),this.localCandidateCount+=1}else this.allCandidatesReceived=!0,O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(n,r){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const c={iceServers:[]};var d;return n.iceServers?c.iceServers=n.iceServers:n.turnServer&&n.turnServer.mode!=="off"&&(Sp(n.turnServer.servers)?c.iceServers=n.turnServer.servers:(c.iceServers&&c.iceServers.push(...vf.turnServerConfigToIceServers(n.turnServer.servers,r,s)),Y("USE_TURN_SERVER_OF_GATEWAY")&&c.iceServers&&n.turnServer.serversFromGateway&&c.iceServers.push(...vf.turnServerConfigToIceServers(n.turnServer.serversFromGateway,r,s)),Le(d=[Xc.Relay,Xc.SdRtn]).call(d,r)&&(c.iceTransportPolicy="relay"),Y("FORCE_TURN_TCP")?c.iceTransportPolicy="relay":n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).forEach(h=>{h.forceturn&&(c.iceTransportPolicy="relay")}))),Y("ENABLE_ENCODED_TRANSFORM")&&Lt().supportWebRTCEncodedTransform&&(c.encodedInsertableStreams=!0),O.debug("P2PConnection p2pTransport is ".concat(r)),c}static turnServerConfigToIceServers(n,r){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const c=[],d=n.filter(f=>f.tcpport);O.debug("P2PConnection turnServers is ".concat(d,", current index is ").concat(s));const h=d.length>s?d[s]:d[0];switch(r){case Xc.SdRtn:const f=n.filter(_=>{var E;return Le(E=_.username).call(E,"glb:")&&_.turnServerURL==_.turnServerURL}),g=f.length>s?f[s]:f[0];g&&(c.push({username:g.username,credential:g.password,credentialType:"password",urls:"turn:".concat(cd(g.turnServerURL),":").concat(g.tcpport,"?transport=udp")}),c.push({username:g.username,credential:g.password,credentialType:"password",urls:"turns:".concat(cd(g.turnServerURL),":").concat(g.tcpport,"?transport=tcp")}));break;case Xc.Relay:h&&(c.push({username:h.username,credential:h.password,credentialType:"password",urls:"turn:".concat(h.turnServerURL,":").concat(h.tcpport,"?transport=udp")}),c.push({username:h.username,credential:h.password,credentialType:"password",urls:"turns:".concat(cd(h.turnServerURL),":").concat(h.tcpport,"?transport=tcp")}));break;default:h&&(c.push({username:h.username,credential:h.password,credentialType:"password",urls:"turn:".concat(h.turnServerURL,":").concat(h.tcpport,"?transport=udp")}),c.push({username:h.username,credential:h.password,credentialType:"password",urls:"turns:".concat(cd(h.turnServerURL),":").concat(h.tcpport,"?transport=tcp")}),c.push({username:h.username,credential:h.password,credentialType:"password",urls:"stun:".concat(h.turnServerURL,":").concat(h.tcpport)}))}return c}tryBindTransportEvents(n){if(n){this.transport=n,n.onstatechange=()=>{var s;n!=null&&n.state&&((s=this.onDTLSTransportStateChange)===null||s===void 0||s.call(this,n.state))},n.onerror=s=>{var c;(c=this.onDTLSTransportError)===null||c===void 0||c.call(this,"error"in s?s.error:s)};const r=n.iceTransport;r&&(r.onstatechange=()=>{const s=n==null?void 0:n.iceTransport.state;var c;s&&((c=this.onICETransportStateChange)===null||c===void 0||c.call(this,s))},r.getSelectedCandidatePair&&(r.onselectedcandidatepairchange=()=>{if(r.getSelectedCandidatePair()){const{local:s,remote:c}=r.getSelectedCandidatePair();O.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:s.type,protocol:s.protocol}),", remote ").concat(JSON.stringify({candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(n,r){var s;if(r||(r=this.peerConnection.getSenders().find(E=>E.track===n._mediaStreamTrack)),!r)return O.warn("[".concat(n.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(n))return O.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Lt().supportSetRtpSenderParameters)return O.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const c={},d={};switch(n._optimizationMode){case"motion":c.degradationPreference="maintain-framerate";break;case"detail":c.degradationPreference="maintain-resolution";break;default:c.degradationPreference="balanced"}if(n._encoderConfig){var h;const{bitrateMax:E,frameRate:T,scaleResolutionDownBy:w}=n._encoderConfig;E&&(d.maxBitrate=1e3*E),Le(h=n._hints).call(h,tn.LOW_STREAM)&&(T&&(d.maxFramerate=Wo(T)),w&&w>=1&&(d.scaleResolutionDownBy=w))}if(Y("DSCP_TYPE")&&Zl()){var f;const E=Y("DSCP_TYPE");Le(f=["very-low","low","medium","high"]).call(f,E)&&(d.networkPriority=E)}const g=r.getParameters(),_=(s=g.encodings)===null||s===void 0?void 0:s[0];Jt()&&!_&&(c.encodings=[d]),_&&Object.assign(_,d),Object.assign(g,c),O.debug("[".concat(n.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(g.encodings))),await r.setParameters(g)}async applySendEncodings(n,r){try{if(!Lt().supportSetRtpSenderParameters||n.length!==r.length)return;for(let s=0;s<n.length;s++){const c=n[s],d=r[s];d instanceof ht&&!this.isVP8Simulcast(d)&&await this.updateRtpSenderEncodings(d,c.sender)}}catch{O.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(n,r,s){const c=gn.parse(n);return r.forEach((d,h)=>{const f=s[h],g=c.mediaDescriptions.find(_=>_.attributes.mid===f);g&&(Td(g,d),v1(g,d,this.store.codec))}),gn.print(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=n=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoReceived=n=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstAudioDecoded=n=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoDecoded=(n,r,s)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,n,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(n,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,n,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(n,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,n,r)},this.statsFilter.onFirstVideoDecodedTimeout=n=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,n)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(n,r){if(n.length===r.length)for(let g=0;g<n.length;g++){var s,c,d,h,f;const _=n[g],E=r[g];if(E instanceof ht&&!Le(s=E._hints).call(s,tn.LOW_STREAM)&&(c=E._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((d=E._encoderConfig)===null||d===void 0?void 0:d.bitrateMax)>200&&(h=E._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((f=E._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1&&this.store.codec==="vp8"){const T={},w={high:1e3*(E._encoderConfig.bitrateMax-50),medium:5e4};T.encodings=[{rid:"m",active:!0,maxBitrate:w.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:w.high}];const A=_.sender.getParameters();await _.sender.setParameters(Object.assign(A,T))}}}async applySimulcastEncodings(n,r){if(!Jt()&&n.length===r.length)for(let s=0;s<n.length;s++){const c=r[s];if(c instanceof ht&&this.isVP8Simulcast(c)){const d=n[s],h={},f={high:1e3*(c._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:f.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:f.medium,scaleResolutionDownBy:4}];const g=d.sender.getParameters();await d.sender.setParameters(Object.assign(g,h))}}}isVP8Simulcast(n){var r,s,c,d,h;return!!(n instanceof ht&&Y("SIMULCAST")&&this.store.codec==="vp8"&&!Le(r=n._hints).call(r,tn.LOW_STREAM)&&(s=n._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((c=n._encoderConfig)===null||c===void 0?void 0:c.bitrateMax)>200&&(d=n._scalabilityMode)!==null&&d!==void 0&&d.numSpatialLayers&&((h=n._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(n,r,s,c){if(Y("SDP_LOGGING"))return O.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(r," SDP during P2PConnection.").concat(c,`
`),n),r==="offer"?d=>{this.logSDPExchange(d,"answer",s==="local"?"remote":"local",c)}:void 0}async muteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&n.indexOf(h.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(h=>{h.direction="inactive"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(n);const d=this.remoteSDP.toString();c==null||c(d),await this.setRemoteDescription({type:"answer",sdp:d})}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&n.indexOf(h.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async h=>{h.direction="sendonly"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(n);const d=this.remoteSDP.toString();c==null||c(d),await this.setRemoteDescription({type:"answer",sdp:d})}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}async getRemoteSSRC(n,r){var s,c;if(r=(s=r)!==null&&s!==void 0?s:(c=this.currentRemoteDescription)===null||c===void 0?void 0:c.sdp){var d;const h=(d=gn.parse(r).mediaDescriptions.find(f=>f.attributes.mid===n))===null||d===void 0?void 0:d.attributes.ssrcs;return h==null?void 0:h[0].ssrcId}}async setRemoteDescription(n){var r;await this.peerConnection.setRemoteDescription(n),Le(r=["connected","completed"]).call(r,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(n,r,s){const c=gn.parse(n),d=c.mediaDescriptions.find(h=>h.attributes.mid===r);return d&&(s===Fe.AUDIO&&d.media.mediaType==="audio"&&Da(d),this.useXR&&a_(c)),gn.print(c)}};function oa(o,n,r){const s=o[n];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,d=await c.lock("From P2PConnection.".concat(n));try{for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return await s.apply(this,f)}finally{d()}},r}function y1(o,n){let r=document.createElement("video"),s=document.createElement("canvas");r.setAttribute("style","display:none"),s.setAttribute("style","display:none"),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("autoplay",""),r.autoplay=!0,r.setAttribute("playsinline",""),s.width=Wo(n.width),s.height=Wo(n.height);const c=Wo(n.framerate||15);document.body.append(r),document.body.append(s);let d=o._mediaStreamTrack;r.srcObject=new MediaStream([d]),r.play();const h=s.getContext("2d");if(!h)throw new Z(B.UNEXPECTED_ERROR,"can not get canvas context");const f=Lt(),g=s.captureStream(f.supportRequestFrame?0:c).getVideoTracks()[0];g.canvas||(g.canvas=s),s.startCapture=()=>{if(!r)return s.stopCapture&&s.stopCapture();if(r.paused&&r.play(),r.videoHeight>2&&r.videoWidth>2){const E=r.videoWidth,T=r.videoHeight/E,w=s.width*T;Math.abs(w-s.height)>=2&&(O.debug("adjust low stream resolution","".concat(s.width,"x").concat(s.height," -> ").concat(s.width,"x").concat(w)),s.height=w)}h.drawImage(r,0,0,s.width,s.height),g.requestFrame&&g.requestFrame(),d!==o._mediaStreamTrack&&(d=o._mediaStreamTrack,r.srcObject=new MediaStream([d]))},s.stopCapture=rA(()=>s.startCapture&&s.startCapture(),c);const _=g.stop;return g.stop=()=>{_.call(g),r&&(r.remove(),r.srcObject=null,r=null),s&&(s.width=0,s.remove(),s.stopCapture&&s.stopCapture(),s.startCapture=void 0,s.stopCapture=void 0,s=null),O.debug("clean low stream renderer")},g}var c_,e4,wr,Cd,ti,tf,S1,cl,Ss,T1,Jo;fe([oa,j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],qo.prototype,"establish",null),fe([oa,j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],qo.prototype,"connect",null),fe([oa,j("design:type",Function),j("design:paramtypes",[String,Array,String,String]),j("design:returntype",ae)],qo.prototype,"receive",null),fe([oa,j("design:type",Function),j("design:paramtypes",[String,Array,String,String]),j("design:returntype",ae)],qo.prototype,"mockReceive",null),fe([oa,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],qo.prototype,"stopReceiving",null),fe([oa,j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],qo.prototype,"restartICE",null),fe([oa,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],qo.prototype,"close",null),fe([oa,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],qo.prototype,"updateEncoderConfig",null),fe([oa,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],qo.prototype,"updateSendParameters",null),fe([oa,j("design:type",Function),j("design:paramtypes",[Zr,String]),j("design:returntype",ae)],qo.prototype,"replaceTrack",null),fe([oa,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],qo.prototype,"muteLocal",null),fe([oa,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],qo.prototype,"unmuteLocal",null),function(o){o[o.HEIGHT=2033]="HEIGHT",o[o.FRAME_RATE=2034]="FRAME_RATE",o[o.WIDTH=2035]="WIDTH"}(c_||(c_={})),function(o){o[o.HEIGHT=2072]="HEIGHT",o[o.FRAME_RATE=2074]="FRAME_RATE",o[o.WIDTH=2076]="WIDTH"}(e4||(e4={})),function(o){o[o.FRAME_RATE=2002]="FRAME_RATE",o[o.WIDTH=2003]="WIDTH",o[o.HEIGHT=2004]="HEIGHT",o[o.PACKAGE_LOST=2005]="PACKAGE_LOST",o[o.AVG_ENCODE=2007]="AVG_ENCODE",o[o.NACKS=2009]="NACKS",o[o.PLIS=2010]="PLIS",o[o.FIRS=2011]="FIRS",o[o.BITRATE=2012]="BITRATE",o[o.PACKAGE_RATE=2031]="PACKAGE_RATE",o[o.ADAPTATION=2032]="ADAPTATION",o[o.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",o[o.BANDWIDTH=2061]="BANDWIDTH",o[o.RETRANSMIT=2062]="RETRANSMIT",o[o.TARGET_ENCODED=2064]="TARGET_ENCODED",o[o.TRANSMIT=2066]="TRANSMIT",o[o.FREEZE=2082]="FREEZE",o[o.DISABLED=2095]="DISABLED",o[o.PLAYER_STATUS=2128]="PLAYER_STATUS",o[o.QP_SUM=2143]="QP_SUM"}(wr||(wr={})),function(o){o[o.BITRATE=2069]="BITRATE",o[o.PACKAGE_LOST=2070]="PACKAGE_LOST",o[o.PACKAGE_RATE=2071]="PACKAGE_RATE",o[o.HEIGHT=2073]="HEIGHT",o[o.FRAME_RATE=2075]="FRAME_RATE",o[o.WIDTH=2077]="WIDTH"}(Cd||(Cd={})),function(o){o[o.JITTER=-1]="JITTER",o[o.PACKAGE_LOST=2014]="PACKAGE_LOST",o[o.WIDTH=2018]="WIDTH",o[o.HEIGHT=2019]="HEIGHT",o[o.FRAME_RATE=2020]="FRAME_RATE",o[o.JITTER_BUFFER=2023]="JITTER_BUFFER",o[o.CURRENT_DELAY=2024]="CURRENT_DELAY",o[o.NACKS=2026]="NACKS",o[o.PLIS=2027]="PLIS",o[o.FIRS=2028]="FIRS",o[o.BITRATE=2029]="BITRATE",o[o.PACKAGE_RATE=2078]="PACKAGE_RATE",o[o.FREEZE=2084]="FREEZE",o[o.DISABLED=2101]="DISABLED",o[o.PLAYER_STATUS=2129]="PLAYER_STATUS",o[o.QP_SUM=2144]="QP_SUM",o[o.I_FRAME_DELAY=2149]="I_FRAME_DELAY"}(ti||(ti={})),function(o){o[o.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",o[o.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",o[o.FREEZE_TIME=2109]="FREEZE_TIME",o[o.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER"}(tf||(tf={})),function(o){o[o.PCM_LEVEL=2104]="PCM_LEVEL"}(S1||(S1={})),function(o){o[o.PACKAGE_LOST=-1]="PACKAGE_LOST",o[o.LEVEL=2038]="LEVEL",o[o.BITRATE=2039]="BITRATE",o[o.PACKAGE_RATE=2040]="PACKAGE_RATE",o[o.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",o[o.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",o[o.FREEZE=2081]="FREEZE",o[o.DISABLED=2096]="DISABLED"}(cl||(cl={})),function(o){o[o.BITRATE=2044]="BITRATE",o[o.PACKAGE_LOST=2045]="PACKAGE_LOST",o[o.PACKAGE_RATE=2046]="PACKAGE_RATE",o[o.CURRENT_DELAY=2047]="CURRENT_DELAY",o[o.JITTER_BUFFER=2054]="JITTER_BUFFER",o[o.JITTER=2055]="JITTER",o[o.FREEZE=2083]="FREEZE",o[o.DISABLED=2102]="DISABLED",o[o.PCM_LEVEL=2105]="PCM_LEVEL",o[o.PLAYER_STATUS=2130]="PLAYER_STATUS",o[o.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES"}(Ss||(Ss={})),function(o){o[o.FREEZE_TIME=-1]="FREEZE_TIME",o[o.LEVEL=2043]="LEVEL"}(T1||(T1={})),function(o){o[o.RTT=2006]="RTT",o[o.CONN_TYPE=801]="CONN_TYPE"}(Jo||(Jo={}));const ll=1e3,Qu=3;function mt(o,n,r){r!=null&&Number.isFinite(r)&&(o[n]=Math.round(Math.max(0,r)))}function t4(o){const n={[Jo.CONN_TYPE]:0,[Jo.RTT]:o.rtt};switch(o.selectedCandidatePair.localCandidate.candidateType){case"relay":{const r=o.selectedCandidatePair.localCandidate.relayProtocol;r==="udp"&&(n[Jo.CONN_TYPE]=1),r==="tcp"&&(n[Jo.CONN_TYPE]=3),r==="tls"&&(n[Jo.CONN_TYPE]=4);break}case"srflx":n[Jo.CONN_TYPE]=2}return n}class n4 extends mn{constructor(n){super(),I(this,"store",void 0),I(this,"uploadWRTCStatsTimer",void 0),I(this,"uploadOutboundDenoiserStatsTimer",void 0),I(this,"uploadExtStatsTimer",void 0),I(this,"uploadExtUsageStatsTimer",void 0),I(this,"uploadInboundExtStatsTimer",void 0),I(this,"requestStats",void 0),I(this,"requestTransportStats",void 0),I(this,"requestLocalMedia",void 0),I(this,"requestRemoteMedia",void 0),I(this,"requestAllTracks",void 0),I(this,"requestVideoIsReady",void 0),I(this,"requestUploadStats",void 0),I(this,"requestUpload",void 0),I(this,"uploadOutboundStarted",!1),I(this,"uploadInboundStarted",!1),I(this,"uploadTransportStarted",!1),I(this,"uploadExtensionUsageStarted",!1),I(this,"lastRecvStats",void 0),I(this,"lastSendStats",void 0),I(this,"lastFullRecvStats",void 0),I(this,"lastFullSendStats",void 0),I(this,"needUploadRenderFreezeTime",!0),this.store=n}uploadWRTCStats(n){if(!this.requestStats||!this.requestUploadStats)return;let r,s;if(this.uploadTransportStarted&&(r=this.requestStats(),this.store.useP2P&&(s=this.requestStats(!0))),!r&&this.uploadOutboundStarted&&(r=this.requestStats()),!s&&this.uploadInboundStarted&&(s=this.requestStats(!0)),r||s){const c={};if(this.uploadTransportStarted&&r){const d=this.getTransportStats(r,s,n);d&&(c.misc=[d])}if(this.uploadOutboundStarted&&r){const d=this.getOutboundStats(r,n?this.lastSendStats:this.lastFullSendStats,n);d&&(c.outbound=[d])}if(this.uploadInboundStarted&&s){const d=this.getInboundStats(s,n?this.lastRecvStats:this.lastFullRecvStats,n);d&&(c.inbound=d)}this.requestUploadStats(c)}this.lastRecvStats=s,this.lastSendStats=r,n||(this.lastFullRecvStats=s,this.lastFullSendStats=r)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;let n=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted)return this.stopUploadWRTCStats();this.uploadWRTCStats(n!==Qu),++n===Qu+1&&(n=1)},ll)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(n,r,s){if(!this.requestStats)return;if(s)return n.rtt==null?void 0:{addition:{[Jo.RTT]:n.rtt,[Jo.CONN_TYPE]:void 0}};const c=t4(n);if(this.store.useP2P){if(r){const d=t4(r);c[Jo.CONN_TYPE]+=d[Jo.CONN_TYPE]<<3}c[Jo.CONN_TYPE]+=110}else c[Jo.CONN_TYPE]+=100;return{addition:c}}getOutboundStats(n,r,s){if(!this.requestUploadStats||!this.requestLocalMedia)return;const c=this.requestLocalMedia();if(!c||c.length===0)return;let d,h,f;return c.forEach(g=>{let[_,{track:E,ssrcs:T}]=g;switch(_){case Ee.LocalVideoLowTrack:case Ee.LocalVideoTrack:if(_===Ee.LocalVideoTrack){const w=function(P,D,G,$,X){const ie=D.videoSend.find(Se=>Se.ssrc===P);if(!ie)return;const Q={},{sentFrame:te,inputFrame:ce}=ie;if(ce&&te){const Se=ce.frameRate,Ae=te.frameRate;Q[wr.FREEZE]=function(st,gt){let nn=!0;return nn=!(st<=5)&&(st<=10?gt<3:st<=20?gt<4:gt<5),nn}(Se,Ae)?1:0}if(mt(Q,wr.QP_SUM,ie.qpSumPerFrame),X)return Q;switch(te&&(mt(Q,wr.HEIGHT,te.height),mt(Q,wr.WIDTH,te.width),mt(Q,wr.FRAME_RATE,te.frameRate)),Q[wr.DISABLED]=$._originMediaStreamTrack&&!$._originMediaStreamTrack.enabled||$._mediaStreamTrack&&!$._mediaStreamTrack.enabled?1:0,ie.adaptionChangeReason){case"none":Q[wr.ADAPTATION]=0;break;case"cpu":Q[wr.ADAPTATION]=1;break;case"bandwidth":Q[wr.ADAPTATION]=2;break;case"other":Q[wr.ADAPTATION]=3}Q[wr.PLAYER_STATUS]=tA[$._player?$._player.videoElementStatus:"uninit"],mt(Q,wr.NACKS,ie.nacksCount),mt(Q,wr.PLIS,ie.plisCount),mt(Q,wr.FIRS,ie.firsCount),mt(Q,wr.AVG_ENCODE,ie.avgEncodeMs);const le=G&&G.videoSend.find(Se=>Se.ssrc===P);if(le){let Se=X?ll:ll*Qu;le.timestamp&&ie.timestamp&&(Se=ie.timestamp-le.timestamp),le.packets!=null&&ie.packets!=null&&mt(Q,wr.PACKAGE_RATE,1e3*(ie.packets-le.packets)/Se),ie.packetsLost!=null&&le.packetsLost!=null&&mt(Q,wr.PACKAGE_LOST,ie.packetsLost-le.packetsLost),le.bytes!=null&&ie.bytes!=null&&mt(Q,wr.BITRATE,8*(ie.bytes-le.bytes)/Se)}return Q}(T[0].ssrcId,n,r,E,s),A=s?null:function(P,D,G){const $=D.videoSend.find(le=>le.ssrc===P);if(!$)return null;const X={},ie=$.inputFrame,Q=ie&&ie.height||G&&G._videoHeight||0,te=ie&&ie.width||G&&G._videoWidth||0,ce=ie&&ie.frameRate||0;return mt(X,c_.HEIGHT,Q),mt(X,c_.WIDTH,te),mt(X,c_.FRAME_RATE,ce),X}(T[0].ssrcId,n,E),L=s?null:function(P){const D={};return mt(D,wr.RETRANSMIT,P.bitrate.retransmit),mt(D,wr.TARGET_ENCODED,P.bitrate.targetEncoded),mt(D,wr.ACTUAL_ENCODED,P.bitrate.actualEncoded),mt(D,wr.TRANSMIT,P.bitrate.transmit),mt(D,wr.BANDWIDTH,P.sendBandwidth),D}(n);h=Object.assign({},w,A,L)}else f=s?void 0:function(w,A,L){const P=A.videoSend.find($=>$.ssrc===w);if(!P)return;const D={},G=P.sentFrame;if(G&&(mt(D,Cd.HEIGHT,G.height),mt(D,Cd.WIDTH,G.width),mt(D,Cd.FRAME_RATE,G.frameRate)),L){const $=L.videoSend.find(X=>X.ssrc===w);if($){let X=ll*Qu;$.timestamp&&P.timestamp&&(X=P.timestamp-$.timestamp),$.packets!=null&&P.packets!=null&&mt(D,Cd.PACKAGE_RATE,1e3*(P.packets-$.packets)/X),P.packetsLost!=null&&$.packetsLost!=null&&mt(D,Cd.PACKAGE_LOST,P.packetsLost-$.packetsLost),$.bytes!=null&&P.bytes!=null&&mt(D,Cd.BITRATE,8*(P.bytes-$.bytes)/X)}}return D}(T[0].ssrcId,n,r);break;case Ee.LocalAudioTrack:d=s?void 0:function(w,A,L,P){const D=A.audioSend.find(Q=>Q.ssrc===w);if(!D)return;const G={};G[cl.DISABLED]=P._originMediaStreamTrack&&!P._originMediaStreamTrack.enabled||P._mediaStreamTrack&&!P._mediaStreamTrack.enabled?1:0;const $=P._source.getAccurateVolumeLevel(),X=D.inputLevel;mt(G,cl.LEVEL,100*(X??$)),mt(G,S1.PCM_LEVEL,100*$),mt(G,cl.AEC_RETURN_LOSS,D.aecReturnLoss),mt(G,cl.AEC_RETURN_LOSS_ENH,D.aecReturnLossEnhancement),G[cl.FREEZE]=0;const ie=L&&L.audioSend.find(Q=>Q.ssrc===w);if(ie){let Q=ll*Qu;ie.timestamp&&D.timestamp&&(Q=D.timestamp-ie.timestamp),ie.bytes!=null&&D.bytes!=null&&mt(G,cl.BITRATE,8*(D.bytes-ie.bytes)/Q),ie.packets!=null&&D.packets!=null&&mt(G,cl.PACKAGE_RATE,1e3*(D.packets-ie.packets)/Q)}return G}(T[0].ssrcId,n,r,E)}}),{high:h,low:f,audio:d}}getInboundStats(n,r,s){if(!this.requestRemoteMedia)return;const c=this.requestRemoteMedia()||[],d=[];return c.forEach(h=>{let[f,g]=h;const _={peer:f.uid};if(g.has(Fe.VIDEO)&&f.videoTrack){const E=f._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(f._videoSSRC)||!1,T=f.videoTrack?function(w,A,L,P,D,G,$){const X=A.videoRecv.find(Se=>Se.ssrc===w);if(!X)return;const ie={},{receivedFrame:Q,outputFrame:te,decodeFrameRate:ce}=X,le=L&&L.videoRecv.find(Se=>Se.ssrc===w);if(ie[ti.FREEZE]=D&&l_.isRemoteVideoFreeze(P,X,le)?1:0,mt(ie,tf.FRAME_RATE_DECODE,ce),mt(ie,ti.QP_SUM,X.qpSumPerFrame),X.framesRateFirefox&&mt(ie,ti.FRAME_RATE,X.framesRateFirefox),Q&&mt(ie,ti.FRAME_RATE,Q.frameRate),le){const Se=A.timestamp-L.timestamp||($?ll:Qu*ll);X.packetsLost!=null&&le.packetsLost!=null&&mt(ie,ti.PACKAGE_LOST,X.packetsLost-le.packetsLost),le.bytes!=null&&X.bytes!=null&&mt(ie,ti.BITRATE,8*(X.bytes-le.bytes)/Se),le.packets!=null&&X.packets!=null&&mt(ie,ti.PACKAGE_RATE,1e3*(X.packets-le.packets)/Se)}if($)return ie;if(Q?(mt(ie,ti.HEIGHT,Q.height),mt(ie,ti.WIDTH,Q.width)):P&&(mt(ie,ti.HEIGHT,P._videoHeight||0),mt(ie,ti.WIDTH,P._videoWidth||0)),te&&mt(ie,tf.FRAME_RATE_RENDER,te.frameRate),mt(ie,ti.JITTER_BUFFER,X.jitterBufferMs),mt(ie,ti.CURRENT_DELAY,X.currentDelayMs),mt(ie,ti.FIRS,X.firsCount),mt(ie,ti.NACKS,X.nacksCount),mt(ie,ti.PLIS,X.plisCount),P){ie[ti.DISABLED]=P._originMediaStreamTrack.enabled&&P._mediaStreamTrack.enabled?0:1;const Se=P._player;if(Se){const{freezeTimeCounterList:Ae,renderFreezeAccTime:st}=Se;if(Ae&&Ae.length>0&&mt(ie,tf.FREEZE_TIME,Ae.splice(0,1)[0]),G&&nl.visibility==="visible"){const gt=Math.min(6e3,st);Se.renderFreezeAccTime=Math.max(0,st-gt),mt(ie,tf.FREEZE_TIME_RENDER,gt)}}}if(ie[ti.PLAYER_STATUS]=tA[P._player?P._player.videoElementStatus:"uninit"],le&&X.totalInterFrameDelay!==void 0&&X.totalSquaredInterFrameDelay!==void 0&&le.totalInterFrameDelay!==void 0&&le.totalSquaredInterFrameDelay!==void 0){const Se=X.totalInterFrameDelay-le.totalInterFrameDelay,Ae=X.totalSquaredInterFrameDelay-le.totalSquaredInterFrameDelay,st=X.framesDecodeCount-le.framesDecodeCount,gt=Se/st*1e3,nn=Math.round(1e3*Math.sqrt((Ae-Math.pow(Se,2)/st)/st));!isNaN(nn)&&gt+nn>Math.max(3*gt,gt+150)&&(ie[ti.I_FRAME_DELAY]=nn)}return ie}(f._videoSSRC,n,r,f.videoTrack,E===!0,this.needUploadRenderFreezeTime,s):void 0;T&&(_.video=T)}if(g.has(Fe.AUDIO)&&f.audioTrack){const E=f.audioTrack?function(T,w,A,L,P){const D=w.audioRecv.find(Se=>Se.ssrc===T);if(!D)return;const G={},$=A&&A.audioRecv.find(Se=>Se.ssrc===T),{receivedFrames:X,droppedFrames:ie}=D;var Q,te;if(mt(G,Ss.JITTER,D.jitterMs),X!=null&&ie!=null&&(G[Ss.FREEZE]=(te=ie,(Q=X)===0||100*te/Q>20?1:0)),$){const Se=w.timestamp-A.timestamp||(P?ll:ll*Qu);D.packets!=null&&$.packets!=null&&mt(G,Ss.PACKAGE_RATE,1e3*(D.packets-$.packets)/Se),$.bytes!=null&&D.bytes!=null&&mt(G,Ss.BITRATE,8*(D.bytes-$.bytes)/Se),D.packetsLost!=null&&$.packetsLost!=null&&mt(G,Ss.PACKAGE_LOST,D.packetsLost-$.packetsLost)}if(P)return G;const ce=L._source.getAccurateVolumeLevel(),le=D.outputLevel;if(mt(G,T1.LEVEL,100*(le??ce)),mt(G,Ss.PCM_LEVEL,100*ce),L&&(G[Ss.DISABLED]=L._originMediaStreamTrack.enabled&&L._mediaStreamTrack.enabled?0:1),mt(G,Ss.JITTER_BUFFER,D.jitterBufferMs),mt(G,Ss.CURRENT_DELAY,D.jitterBufferMs),G[Ss.PLAYER_STATUS]=tA[Vi.getPlayerState(L.getTrackId())],$){const Se=D.concealedSamples-$.concealedSamples;Se>0&&mt(G,Ss.CONCEALED_SAMPLES,Se)}return G}(f._audioSSRC,n,r,f.audioTrack,s):void 0;E&&(_.audio=E)}(_.video||_.audio)&&d.push(_)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,d}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const n=(this.requestAllTracks()||[]).find(r=>r instanceof Fu);if(n&&n._external.getDenoiserStats){const r=n._external.getDenoiserStats();r&&this.requestUpload(Qc.DENOISER_STATS,r)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(n=>{n.getProcessorStats().forEach(r=>{this.requestUpload&&this.requestUpload(r.type,r.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(n=>{let[r,s]=n;s.has(Fe.VIDEO)&&r.videoTrack&&r.videoTrack.getProcessorStats().forEach(c=>{this.requestUpload&&this.requestUpload(c.type,c.stats)}),s.has(Fe.AUDIO)&&r.audioTrack&&r.audioTrack.getProcessorStats().forEach(c=>{this.requestUpload&&this.requestUpload(c.type,c.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const n=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const r=Date.now(),s={connectionInterval:Y("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:r};let c=[];const d=this.requestAllTracks&&this.requestAllTracks()||[];for(const _ of d)!_.muted&&_.enabled&&(c=c.concat(await _.getProcessorUsage()));const h=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[_,E]of h)E.has(Fe.VIDEO)&&_.videoTrack&&(c=c.concat(await _.videoTrack.getProcessorUsage())),E.has(Fe.AUDIO)&&_.audioTrack&&(c=c.concat(await _.audioTrack.getProcessorUsage()));if(c.length===0)return;s.details=function(_,E){const T={};for(const{id:P,value:D,level:G,direction:$}of _){var w;const X=(w=E.get(P))!==null&&w!==void 0?w:0,ie=D===2?X+Y("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:X;var A,L;E.set(P,ie),T[P]?(D===2&&(T[P].value=D),G>T[P].level&&(T[P].level=G),$==="remote"&&(T[P].remoteUidCount+=1),T[P].totalTs=(A=E.get(P))!==null&&A!==void 0?A:0):T[P]={value:D,level:G,remoteUidCount:$==="local"?0:1,totalTs:(L=E.get(P))!==null&&L!==void 0?L:0}}return Object.keys(T).map(P=>{const{level:D,value:G,totalTs:$}=T[P];return{id:P,level:D,value:G,totalTs:$}})}(c,n);const f=Date.now(),g=f>r?f:r+1;this.requestUpload&&this.requestUpload(Qc.EXTENSION_USAGE_STATS,{usageStats:s,sendTs:g})},Y("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}}class Br{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(n,r){I(this,"uid",void 0),I(this,"_uintid",void 0),I(this,"_trust_in_room_",!0),I(this,"_trust_audio_enabled_state_",!0),I(this,"_trust_video_enabled_state_",!0),I(this,"_trust_audio_mute_state_",!0),I(this,"_trust_video_mute_state_",!0),I(this,"_audio_muted_",!1),I(this,"_video_muted_",!1),I(this,"_audio_enabled_",!0),I(this,"_video_enabled_",!0),I(this,"_audio_added_",!1),I(this,"_video_added_",!1),I(this,"_is_pre_created",!1),I(this,"_video_pre_subscribed",!1),I(this,"_audio_pre_subscribed",!1),I(this,"_trust_video_stream_added_state_",!0),I(this,"_trust_audio_stream_added_state_",!0),I(this,"_audioTrack",void 0),I(this,"_videoTrack",void 0),I(this,"_dataChannels",[]),I(this,"_audioSSRC",void 0),I(this,"_videoSSRC",void 0),I(this,"_audioOrtc",void 0),I(this,"_videoOrtc",void 0),I(this,"_cname",void 0),I(this,"_rtxSsrcId",void 0),I(this,"_videoMid",void 0),I(this,"_audioMid",void 0),this.uid=n,this._uintid=r}}var Ts;function Cce(o,n){var r;let s;switch(n){case Ee.LocalAudioTrack:s=jt.Audio;break;case Ee.LocalVideoTrack:s=Le(r=o._hints).call(r,tn.SCREEN_TRACK)?jt.Screen:jt.High;break;case Ee.LocalVideoLowTrack:s=jt.Low}return s}function b1(o){const n=Lt();if(o.some(r=>r._bypassWebAudio))throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!n.webAudioMediaStreamDest)throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function C1(o,n){b1(o);const r=new lr;return o.forEach(s=>r.addAudioTrack(s)),r}function r4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function X0(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?r4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):r4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}(function(o){o.SEND_ONLY="SEND_ONLY",o.RECEIVE_ONLY="RECEIVE_ONLY"})(Ts||(Ts={}));class Er extends mn{get state(){return this._state}set state(n){const r=this._state;this._state=n,this.emit(Xe.StateChange,r,this._state)}constructor(n,r){super(),I(this,"store",void 0),I(this,"statsUploader",void 0),I(this,"sendConnection",void 0),I(this,"recvConnection",void 0),I(this,"localTrackMap",new Map),I(this,"remoteUserMap",new Map),I(this,"localDataChannels",[]),I(this,"pendingLocalTracks",[]),I(this,"pendingRemoteTracks",[]),I(this,"statsCollector",void 0),I(this,"dtlsFailedCount",0),I(this,"sendMutex",new Pr("P2PChannel2-send-mutex")),I(this,"recvMutex",new Pr("P2PChannel2-recv-mutex")),I(this,"_state",Vt.Disconnected),I(this,"_restartStates",["disconnected","failed"]),I(this,"reconnectInterval",void 0),I(this,"uploadUnplinkStarted",!1),I(this,"uploadDownlinkStarted",!1),I(this,"uplinkStateUploadInterval",void 0),I(this,"downlinkStatsUploadInterval",void 0),I(this,"handleMuteLocalTrack",async(s,c,d)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==Vt.Connected)return void d(new he(B.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const _=this.filterTobeMutedTracks(s);if(_.length===0)return void c();const E=_.find(L=>L[0]==="videoLowTrack");E&&E[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(_.map(L=>{let[,{id:P}]=L;return P}));let T=!1;var f,g;s.trackMediaType==="video"?T=!((f=this.localTrackMap.get(Ee.LocalAudioTrack))===null||f===void 0||!f.track._muted):T=((g=this.localTrackMap.get(Ee.LocalVideoTrack))===null||g===void 0?void 0:g.id)===void 0;const w=this.createMuteMessage(_);await Xt(this,Xe.RequestMuteLocal,w);const A=s.trackMediaType==="video"?rc.MUTE_LOCAL_VIDEO:rc.MUTE_LOCAL_AUDIO;await Xt(this,Xe.RequestP2PMuteLocal,{action:A,message:w,isMuteAll:T}),c()}catch(_){d(_)}finally{h()}}),I(this,"handleUnmuteLocalTrack",async(s,c,d)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==Vt.Connected)return void d(new he(B.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const f=this.filterTobeUnmutedTracks(s);if(f.length===0)return void c();await this.sendConnection.unmuteLocal(f.map(E=>{let[,{id:T}]=E;return T}));const g=this.createUnmuteMessage(f),_=s.trackMediaType==="video"?rc.UNMUTE_LOCAL_VIDEO:rc.UNMUTE_LOCAL_AUDIO;await Xt(this,Xe.RequestP2PMuteLocal,{action:_,message:g}),c()}catch(f){d(f)}finally{h()}}),I(this,"handleUpdateVideoEncoder",async(s,c,d)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{const f=this.localTrackMap.get(Ee.LocalVideoTrack);if(!this.sendConnection||!f||f.track!==s||this.state!==Vt.Connected)return void c();const{id:g,track:_}=f;g&&(await this.sendConnection.updateSendParameters(g,_),await this.sendConnection.updateEncoderConfig(g,_),this.emit(Xe.UpdateVideoEncoder,_)),c()}catch(f){d(f)}finally{h()}}),I(this,"handleSetOptimizationMode",async(s,c,d)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleSetOptimizationMode");try{const f=this.localTrackMap.get(Ee.LocalVideoTrack);if(!this.sendConnection||!f||f.track!==s||this.state!==Vt.Connected)return;const{id:g,track:_}=f;g&&await this.sendConnection.updateSendParameters(g,_),c()}catch(f){d(f)}finally{h()}}),I(this,"handleReplaceTrack",async(s,c,d,h)=>{let f;O.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof h=="boolean"&&h||(f=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var g;const E=Array.from(this.localTrackMap.entries()).find(T=>{let[,{track:w}]=T;return s===w});if(!this.sendConnection||!E||E[1].id===void 0||this.state!==Vt.Connected)return void c();if(await((g=this.sendConnection)===null||g===void 0?void 0:g.replaceTrack(s,E[1].id)),E[0]===Ee.LocalVideoTrack&&Lt().supportDualStreamEncoding){const T=this.localTrackMap.get(Ee.LocalVideoLowTrack);if(T){const w=s._mediaStreamTrack.clone();T.track._originMediaStreamTrack.stop(),T.track._mediaStreamTrack=w,T.track._originMediaStreamTrack=w,await new ae((A,L)=>{this.handleReplaceTrack(T.track,A,L,!0)})}}c()}catch(E){d(E)}finally{var _;(_=f)===null||_===void 0||_()}}),I(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),I(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),I(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),I(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=n,this.statsCollector=r,this.statsCollector.addP2PChannel(this),this.statsUploader=new n4(n),this.bindStatsUploaderEvents(),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(s=>{s&&(s.iceConnectionState!=="disconnected"&&s.iceConnectionState!=="failed"||this.handleDisconnect(s.direction))})},Y("ICE_RESTART_INTERVAL"))}async startP2PConnection(n,r){throw new he(B.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(n,r,s,c,d,h){throw new he(B.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(n,r){let s;try{if(r){this.recvConnection&&(O.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),s=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new qo(n,this.store,ui.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const c=await this.recvConnection.establish(r);return{iceParameters:c.iceParameters,dtlsParameters:c.dtlsParameters,sdp:c.sdp}}{this.state=Vt.New,this.sendConnection&&(O.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),s=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new qo(n,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const c=await this.sendConnection.establish();return{iceParameters:c.iceParameters,dtlsParameters:c.dtlsParameters,sdp:c.sdp}}}finally{s&&s()}}async p2pConnect(n){if(!this.sendConnection)throw new he(B.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(n),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Vt.Connected}async addRemoteCandidate(n,r){if(r===ui.RECEIVE_ONLY){if(!this.sendConnection)throw new he(B.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(n)}else{if(!this.recvConnection)throw new he(B.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(n)}}publish(n,r,s){var c=this;return Co(function*(){const d=yield ut(c.sendMutex.lock("From P2PChannel.publish"));try{if(!c.sendConnection||c.state!==Vt.Connected){c.throwIfTrackTypeNotMatch(n);const E=n.filter(T=>c.pendingLocalTracks.indexOf(T)===-1);return void(c.pendingLocalTracks=c.pendingLocalTracks.concat(E))}c.store.pubId=c.store.pubId+1,ei.markPublishStart(c.store.clientId,c.store.pubId);const h=c.filterTobePublishedTracks(n,r,s);if(h.length===0)return void(yield ut(c.tryToUnmuteAudio(n)));h.forEach(E=>{let{track:T,type:w}=E;const A=Date.now();c.store.publish(T.getTrackId(),w===Ee.LocalAudioTrack?"audio":"video",A)}),c.bindLocalTrackEvents(h);const f=yield ut(c.sendConnection.send(h.map(E=>{let{track:T}=E;return T}),c.store.codec,c.store.audioCodec)),g=(yield ut(f.next())).value,_=c.createGatewayPublishMessage(h,g);try{yield _}catch(E){throw f.throw(E),(E==null?void 0:E.code)===B.WS_ABORT&&h.forEach(T=>{let{track:w}=T;c.pendingLocalTracks.indexOf(w)===-1&&c.pendingLocalTracks.push(w)}),c.unbindLocalTrackEvents(h),E}yield ut(f.next()),h.forEach(E=>{let{type:T}=E;c.statsCollector.addLocalStats(T)}),c.statsUploader.startUploadOutboundStats(),c.assignLocalTracks(h,g),h.forEach(E=>{let{track:T,type:w}=E;const A=Date.now();c.store.publish(T.getTrackId(),w===Ee.LocalAudioTrack?"audio":"video",void 0,A)}),c.startUploadUplinkState()}finally{d()}})()}async unpublish(n){if(!this.sendConnection||this.state!==Vt.Connected)return void(n.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(d=>!Le(n).call(n,d)));const r=this.filterTobeUnpublishedTracks(n);if(r.length===0)return;const s=r.find(d=>d[0]==="videoLowTrack");s&&s[1].track.close();const c=this.createGatewayUnpublishMessage(r);if(await this.sendConnection.stopSending(r.map(d=>{let[,{id:h}]=d;return h})),this.withdrawLocalTracks(r),this.unbindLocalTrackEvents(r.map(d=>{let[h,{track:f}]=d;return{type:h,track:f}})),r.forEach(d=>{let[h]=d;this.statsCollector.removeLocalStats(h)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===Vt.Connected)return s&&s[1].track.close(),c;n.forEach(d=>{const h=this.pendingLocalTracks.indexOf(d);h!==-1&&this.pendingLocalTracks.splice(h,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const n=()=>{const r=[],s=[];Array.from(this.localTrackMap.entries()).forEach(c=>{let[d,{track:h,ssrcs:f}]=c;const g={stream_type:Cce(h,d),ssrcs:f};h._muted||!h._enabled?r.push(g):s.push(g)}),r.length>0&&r.forEach(c=>{Xt(this,Xe.RequestMuteLocal,[c])}),s.length>0&&s.forEach(c=>{Xt(this,Xe.RequestUnmuteLocal,[c])})};n(),this.uplinkStateUploadInterval=window.setInterval(()=>{n()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(n){return Co(function*(){throw new he(B.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(O.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await nr(this,Xe.RequestRePublish,this.pendingLocalTracks),this.emit(Xe.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new he(B.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(n,r,s,c){var d;if(!this.recvConnection)throw new he(B.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((d=this.remoteUserMap.get(n))!==null&&d!==void 0&&d.has(r))return;const{track:h,mid:f,transceiver:g}=await this.recvConnection.receive(r,[{ssrcId:s}],String(n.uid),c);r===Fe.AUDIO?(n._audioTrack?n._audioTrack._updateOriginMediaStreamTrack(h):(n._audioTrack=new Ys(h,n.uid,n._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(n._audioTrack.getTrackId()))),g&&n._audioTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(n,n._audioTrack)):(n._videoSSRC=s,n._videoTrack?n._videoTrack._updateOriginMediaStreamTrack(h):(n._videoTrack=new oc(h,n.uid,n._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(n._videoTrack.getTrackId()))),g&&n._videoTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(n,n._videoTrack));const _=this.remoteUserMap.get(n);_?_.set(r,f):this.remoteUserMap.set(n,new Map([[r,f]])),this.statsCollector.addRemoteStats(n.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const E=this.pendingRemoteTracks.findIndex(T=>{let{user:w,kind:A}=T;return w.uid===n.uid&&r===A});E!==-1&&(this.pendingRemoteTracks.splice(E,1),this.emit(Xe.MediaReconnectEnd,n.uid))}async mockSubscribe(n,r,s,c){if(!this.recvConnection)throw new he(B.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(r,[{ssrcId:s}],String(n.uid),c)}async unsubscribe(n,r,s){const c=this.pendingRemoteTracks.filter(h=>{let{user:f,kind:g}=h;return r!==void 0?f.uid===n.uid&&r===g:f.uid===n.uid});if(c.forEach(h=>{const f=this.pendingRemoteTracks.indexOf(h);this.pendingRemoteTracks.splice(f,1)}),this.recvConnection||s||c.forEach(h=>{let{kind:f}=h;var g;if(f===Fe.AUDIO)(g=n._audioTrack)===null||g===void 0||g._destroy(),n._audioTrack=void 0;else if(f===Fe.VIDEO){var _;(_=n._videoTrack)===null||_===void 0||_._destroy(),n._videoTrack=void 0}}),!this.recvConnection)return;const d=this.filterTobeUnSubscribedTracks(n,r);d.length!==0&&(await this.recvConnection.stopReceiving(d.map(h=>{let[,{id:f}]=h;return f})),this.withdrawRemoteTracks(d),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),d.forEach(h=>{let[f,{kind:g}]=h;var _,E;if(g===Fe.VIDEO&&f._videoSSRC&&((_=this.recvConnection)===null||_===void 0||_.setStatsRemoteVideoIsReady(f._videoSSRC,!1)),g===Fe.VIDEO)this.unbindRemoteTrackEvents(f._videoTrack),s||((E=f._videoTrack)===null||E===void 0||E._destroy(),f._videoTrack=void 0);else if(g===Fe.AUDIO){var T;this.unbindRemoteTrackEvents(f._audioTrack),!s&&((T=f._audioTrack)===null||T===void 0||T._destroy(),f._audioTrack=void 0)}}),d.forEach(h=>{let[,{kind:f}]=h;Xt(this,Xe.RequestP2PMuteRemote,f)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const n=()=>Array.from(this.remoteUserMap.entries()).forEach(r=>{let[,s]=r;[Fe.VIDEO,Fe.AUDIO].forEach(c=>{s.has(c)?Xt(this,Xe.RequestP2PUnmuteRemote,c):Xt(this,Xe.RequestP2PMuteRemote,c)})});n(),this.downlinkStatsUploadInterval=window.setInterval(()=>{n()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(n){throw new he(B.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(n){throw new he(B.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(n){throw new he(B.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(n){throw new he(B.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(n,r){if(!this.recvConnection)return;const s=this.remoteUserMap.get(n);if(!s)return void O.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(n.uid,"."));if(!s.get(r))return void O.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(n.uid," media type ").concat(r,"."));const c=r===Fe.VIDEO?n._videoSSRC:n._audioSSRC;c!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(c,!1)}async unmuteRemote(n,r){return this.unmuteRemoteNoLock(n,r)}async unmuteRemoteNoLock(n,r){if(!this.recvConnection)return;const s=this.remoteUserMap.get(n);if(!s)return void O.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(n.uid,"."));s.get(r)||O.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(n.uid," media type ").concat(r,"."))}getAllTracks(n){const r=this.localTrackMap.get(Ee.LocalAudioTrack);if((r==null?void 0:r.track)instanceof lr){const s=r.track;return Array.from(this.localTrackMap.entries()).filter(c=>{let[d]=c;return d!==Ee.LocalAudioTrack}).filter(c=>{let[d]=c;return!(n&&d===Ee.LocalVideoLowTrack)}).map(c=>{let[,{track:d}]=c;return d}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[c]=s;return!(n&&c===Ee.LocalVideoLowTrack)}).map(s=>{let[,{track:c}]=s;return c})}reportPublishEvent(n,r,s,c,d){if(n){const f=this.localTrackMap.get(Ee.LocalAudioTrack),g=c?this.localTrackMap.get(Ee.LocalVideoLowTrack):this.localTrackMap.get(Ee.LocalVideoTrack);Be.publish(this.store.sessionId,{eventElapse:ei.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:r,audioName:f==null?void 0:f.track.getTrackLabel(),videoName:g==null?void 0:g.track.getTrackLabel(),screenshare:(g==null?void 0:g.track._hints.indexOf(tn.SCREEN_TRACK))!==-1,audio:!!f,video:!!g,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}else{var h;s||(s=[]);const f=s.find(_=>_ instanceof Gt),g=c?(h=this.localTrackMap.get(Ee.LocalVideoTrack))===null||h===void 0?void 0:h.track:s.find(_=>_ instanceof ht);Be.publish(this.store.sessionId,{eventElapse:ei.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:r,audioName:f==null?void 0:f.getTrackLabel(),videoName:g==null?void 0:g.getTrackLabel(),screenshare:(g==null?void 0:g._hints.indexOf(tn.SCREEN_TRACK))!==-1,audio:!!f,video:!!g,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}}reportSubscribeEvent(n,r,s,c){const d=c===Fe.VIDEO?s._videoSSRC:s._audioSSRC;d&&Be.subscribe(this.store.sessionId,{succ:n,ec:r,video:c===Fe.VIDEO,audio:c===Fe.AUDIO,peerid:s.uid,subscribeRequestid:c===Fe.VIDEO?s._videoSSRC:s._audioSSRC,p2pid:this.store.p2pId,eventElapse:ei.measureFromSubscribeStart(this.store.clientId,d)})}reset(){O.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Pr("P2PChannel2-send-mutex"),this.sendMutex=new Pr("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const n=this.localTrackMap.get(Ee.LocalAudioTrack);if((n==null?void 0:n.track)instanceof lr){if(n.track.trackList.length>0){const r=n.track;n.track.trackList.forEach(s=>{r.removeAudioTrack(s)})}n.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=Vt.Disconnected}getStats(n){var r,s;return n?(s=this.recvConnection)===null||s===void 0?void 0:s.getStats():(r=this.sendConnection)===null||r===void 0?void 0:r.getStats()}getRemoteVideoIsReady(n){var r;return((r=this.recvConnection)===null||r===void 0?void 0:r.getRemoteVideoIsReady(n))||!1}getLocalAudioVolume(){const n=this.localTrackMap.get(Ee.LocalAudioTrack);if(n)return n.track.getVolumeLevel()}getLocalVideoSize(){const n=this.localTrackMap.get(Ee.LocalVideoTrack);if(n)return{width:n.track._videoWidth||0,height:n.track._videoHeight||0}}getEncoderConfig(n){const r=this.localTrackMap.get(n);return r&&r.track instanceof ht||r&&r.track instanceof Gt?r.track._encoderConfig:void 0}getLocalMedia(n){return this.localTrackMap.get(n)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(n,r){if(!n)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(n);return!!s&&(!r||s.has(r))}async hasRemoteMediaWithLock(n,r){if(!n)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(n);return!!s&&(!r||s.has(r))}getRemoteMedia(n){var r;const s=Array.from(jo(r=this.remoteUserMap).call(r)).find(c=>c.uid===n);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let n=Array.from(this.remoteUserMap.entries()).map(s=>{let[c]=s;return{uid:c.uid,level:c.audioTrack?100*c.audioTrack._source.getAccurateVolumeLevel():0}});const r=this.localTrackMap.get(Ee.LocalAudioTrack);return r&&n.push({level:100*r.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),n=cg(n).call(n,(s,c)=>s.level-c.level),n}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(O.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=Vt.Reconnecting,Y("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r]=n;var s;r._videoTrack&&r._videoTrack._player&&((s=r._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),r._videoTrack._player.isKeepLastFrame=!0,r._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(n=>{var r;let[s,{track:c}]=n;switch(s){case Ee.LocalVideoTrack:Le(r=c._hints).call(r,tn.LOW_STREAM)?c.close():this.pendingLocalTracks.push(c);break;case Ee.LocalAudioTrack:c instanceof lr?this.pendingLocalTracks=this.pendingLocalTracks.concat(c.trackList):this.pendingLocalTracks.push(c);case Ee.LocalVideoLowTrack:}}),this.emit(Xe.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r,s]=n;Array.from(jo(s).call(s)).forEach(c=>{this.setPendingRemoteMedia(r,c)}),this.emit(Xe.MediaReconnectStart,r.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),O.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(n,r){for(const s of this.pendingRemoteTracks){const{user:c,kind:d}=s;if((n instanceof Br?n.uid:n)===c.uid&&r===d)return!0}return!1}setPendingRemoteMedia(n,r){this.hasPendingRemoteMedia(n,r)||this.pendingRemoteTracks.push({user:n,kind:r})}async restartICE(n,r){let s,c;if(n===ui.SEND_ONLY){if(!this.sendConnection)throw new he(B.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");s=await this.sendMutex.lock("From P2PChannel.restartICE"),c=this.sendConnection}else{if(!this.recvConnection)throw new he(B.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");s=await this.recvMutex.lock("From P2PChannel.restartICE"),c=this.recvConnection}try{if(r){const d=await c.restartICE(r);return c.isInRestartIce=!1,d}{const d=await c.restartICE();if(d){const h=await nr(this,Xe.RequestP2PRestartICE,{direction:ui.RECEIVE_ONLY,iceParameter:d});await c.restartICE(h),c.isInRestartIce=!1}}}finally{s()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const n=this.sendConnection.getStats(),r=this.localTrackMap.get(Ee.LocalVideoTrack),s=this.localTrackMap.get(Ee.LocalAudioTrack),c=n.videoSend.find(L=>{var P;return L.ssrc===(r==null||(P=r.ssrcs)===null||P===void 0?void 0:P[0].ssrcId)}),d=n.audioSend.find(L=>{var P;return L.ssrc===(s==null||(P=s.ssrcs)===null||P===void 0?void 0:P[0].ssrcId)});if(!c||!d)return 1;const h=yo(this,Xe.NeedSignalRTT),f=c?c.rttMs:void 0,g=d?d.rttMs:void 0,_=f&&g?(f+g)/2:f||g,E=(_&&h?(_+h)/2:_||h)||0,T=100*n.sendPacketLossRate*.7/50+.3*E/1500,w=T<.17?1:T<.36?2:T<.59?3:T<.1?4:5,A=r==null?void 0:r.track;if(A&&A._encoderConfig&&A._hints.indexOf(tn.SCREEN_TRACK)===-1){const L=A._encoderConfig.bitrateMax,P=n.bitrate.actualEncoded;if(L&&P){const D=(1e3*L-P)/(1e3*L);return SF[D<.15?0:D<.3?1:D<.45?2:D<.6?3:4][w]}}return w}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const n=this.recvConnection.getStats();let r=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[c]=s;const d=c._audioSSRC,h=c._videoSSRC,f=n.audioRecv.find(P=>P.ssrc===d),g=n.videoRecv.find(P=>P.ssrc===h);if(!f&&!g)return void(r+=1);const _=yo(this,Xe.NeedSignalRTT),E=n.rtt,T=(E&&_?(E+_)/2:E||_)||0,w=f?f.jitterMs:void 0,A=n.recvPacketLossRate;let L=.7*A*100/50+.3*T/1500;w&&(L=.6*A*100/50+.2*T/1500+.2*w/400),r+=L<.1?1:L<.17?2:L<.36?3:L<.59?4:5}),this.remoteUserMap.size>0?Math.round(r/this.remoteUserMap.size):r}async muteLocalTrack(n){return new ae((r,s)=>{this.handleMuteLocalTrack(n,r,s)})}filterTobePublishedTracks(n,r,s){const c=[],d=Lt(),h=this.getAllTracks();n=Tp(n=n.filter(_=>h.indexOf(_)===-1));let f=!1,g=!1;for(const _ of n){if(_ instanceof ht&&(this.localTrackMap.has(Ee.LocalVideoTrack)||f?new he(B.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(c.push({track:_,type:Ee.LocalVideoTrack}),f=!0),r)){const E=this.getLowVideoTrack(_,s);c.push({track:E,type:Ee.LocalVideoLowTrack})}if(_ instanceof Gt){const E=this.localTrackMap.get(Ee.LocalAudioTrack);if(E){if(!(E.track instanceof lr))throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");E.track.addAudioTrack(_),this.bindLocalAudioTrackEvents(_,!0)}else if(g){const T=c.find(w=>{let{type:A}=w;return A===Ee.LocalAudioTrack});if(!(T.track instanceof lr))throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");T.track.addAudioTrack(_)}else{if(!d.webAudioMediaStreamDest||_ instanceof lr||_._bypassWebAudio)c.push({track:_,type:Ee.LocalAudioTrack});else{const T=new lr;T.addAudioTrack(_),c.push({track:T,type:Ee.LocalAudioTrack})}g=!0}}}return c}filterTobeUnpublishedTracks(n){const r=[],s=this.getAllTracks();n=Tp(n=n.filter(c=>s.indexOf(c)!==-1));for(const c of n){if(c instanceof Gt){const d=this.localTrackMap.get(Ee.LocalAudioTrack);if(!d)continue;d.track instanceof lr?(d.track.removeAudioTrack(c),this.unbindLocalAudioTrackEvents(c),d.track.trackList.length===0&&(r.push([Ee.LocalAudioTrack,d]),d.track.close())):r.push([Ee.LocalAudioTrack,d])}if(c instanceof ht){const d=this.localTrackMap.get(Ee.LocalVideoTrack);if(!d)continue;r.push([Ee.LocalVideoTrack,d]);const h=this.localTrackMap.get(Ee.LocalVideoLowTrack);h&&r.push([Ee.LocalVideoLowTrack,h])}}return r}bindLocalTrackEvents(n){n.forEach(r=>{let{track:s,type:c}=r;switch(c){case Ee.LocalVideoTrack:s.addListener(ke.GET_STATS,this.handleGetLocalVideoStats),s.addListener(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(ke.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(ke.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),s.addListener(ke.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ee.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case Ee.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(n,r){n instanceof lr?n.trackList.forEach(s=>{s.addListener(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(ke.GET_STATS,this.handleGetLocalAudioStats),s.addListener(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.addListener(ke.GET_STATS,this.handleGetLocalAudioStats),n.addListener(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),r||n.addListener(ke.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(n){n||(n=Array.from(this.localTrackMap.entries()).map(r=>{let[s,{track:c}]=r;return{track:c,type:s}})),n.forEach(r=>{let{track:s,type:c}=r;switch(c){case Ee.LocalVideoTrack:s.off(ke.GET_STATS,this.handleGetLocalVideoStats),s.off(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(ke.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(ke.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),s.off(ke.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ee.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case Ee.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(n){n instanceof lr?n.trackList.forEach(r=>{r.off(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(ke.GET_STATS,this.handleGetLocalAudioStats),r.off(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.off(ke.GET_STATS,this.handleGetLocalAudioStats),n.off(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(ke.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.off(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(n,r){r instanceof oc&&r.addListener(ke.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(n))}),r instanceof Ys&&r.addListener(ke.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(n))})}unbindRemoteTrackEvents(n){n&&n.removeAllListeners(ke.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r,s]=n;s.has(Fe.AUDIO)&&this.unbindRemoteTrackEvents(r._audioTrack),s.has(Fe.VIDEO)&&this.unbindRemoteTrackEvents(r._videoTrack)})}createGatewayPublishMessage(n,r){return n.map((s,c)=>{var d;let h,{track:f,type:g}=s;switch(g){case Ee.LocalAudioTrack:h=jt.Audio;break;case Ee.LocalVideoTrack:h=Le(d=f._hints).call(d,tn.SCREEN_TRACK)?jt.Screen:jt.High;break;case Ee.LocalVideoLowTrack:h=jt.Low}return{kind:g===Ee.LocalAudioTrack?Fe.AUDIO:Fe.VIDEO,stream_type:h,mid:r[c].id,ssrcs:r[c].localSSRC,isMuted:f.muted||!f.enabled}})}createGatewayUnpublishMessage(n){return n.map(r=>{var s;let c,[d,{track:h,ssrcs:f,id:g}]=r;switch(d){case Ee.LocalVideoTrack:c=Le(s=h._hints).call(s,tn.SCREEN_TRACK)?jt.Screen:jt.High;break;case Ee.LocalAudioTrack:c=jt.Audio;break;case Ee.LocalVideoLowTrack:c=jt.Low}return{stream_type:c,ssrcs:f,mid:g}})}assignLocalTracks(n,r){n.forEach((s,c)=>{let{track:d,type:h}=s;this.localTrackMap.set(h,{track:d,id:r[c].id,ssrcs:r[c].localSSRC})})}withdrawLocalTracks(n){n.forEach(r=>{let[s]=r;this.localTrackMap.delete(s)})}bindConnectionEvents(n){n.onConnectionStateChange=async r=>{var s;O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(n.name,".onConnectionStateChange(").concat(r,")")),this.emit(Xe.PeerConnectionStateChange,r),r!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),r==="connected"&&(n.isInRestartIce=!1),Le(s=this._restartStates).call(s,r)&&!n.isInRestartIce&&(r==="disconnected"&&await Nr(800),n.iceConnectionState!=="disconnected"&&n.iceConnectionState!=="failed"||this.handleDisconnect(n.direction))},n.onICEConnectionStateChange=r=>{r!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(r,")")),Be.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:r,tag:yn.TRACER}).onSuccess(),this.emit(Xe.IceConnectionStateChange,r)},n.onICETransportStateChange=r=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(r,")"))},n.onDTLSTransportStateChange=r=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(r,")"))},n.onDTLSTransportError=r=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(r,")"))},n.onFirstAudioDecoded=r=>{var s;const c=Array.from(jo(s=this.remoteUserMap).call(s)).find(h=>h._audioSSRC===r);var d;c&&(this.store.subscribe(c.uid,"audio",void 0,void 0,void 0,Date.now()),(d=c.audioTrack)===null||d===void 0||d.emit(pd.FIRST_FRAME_DECODED),Be.firstRemoteFrame(this.store.sessionId,gr.FIRST_AUDIO_DECODE,dn.FIRST_AUDIO_DECODE,{peer:c._uintid,subscribeElapse:ei.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId}))},n.onFirstAudioReceived=r=>{var s;const c=Array.from(jo(s=this.remoteUserMap).call(s)).find(d=>d._audioSSRC===r);c&&Be.firstRemoteFrame(this.store.sessionId,gr.FIRST_AUDIO_RECEIVED,dn.FIRST_AUDIO_RECEIVED,{peer:c._uintid,subscribeElapse:ei.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},n.onFirstVideoDecoded=(r,s,c)=>{this.reportVideoFirstFrameDecoded(r,s,c)},n.onFirstVideoReceived=r=>{var s;const c=Array.from(jo(s=this.remoteUserMap).call(s)).find(d=>d._videoSSRC===r);c&&Be.firstRemoteFrame(this.store.sessionId,gr.FIRST_VIDEO_RECEIVED,dn.FIRST_VIDEO_RECEIVED,{peer:c._uintid,subscribeElapse:ei.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},n.onSelectedLocalCandidateChanged=(r,s)=>{const c=r.candidateType==="relay",d=s.candidateType==="relay";s.candidateType!=="unknown"&&c===d||this.emit(Xe.ConnectionTypeChange,c),O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(ld(s))," -> ").concat(JSON.stringify(ld(r)),")"))},n.onSelectedRemoteCandidateChanged=(r,s)=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(ld(s))," -> ").concat(JSON.stringify(ld(r)),")"))},n.onFirstVideoDecodedTimeout=r=>{this.reportVideoFirstFrameDecoded(r,void 0,void 0,!0)},n.onLocalCandidate=r=>{this.emit(Xe.LocalCandidate,{candidate:r,direction:n.direction})}}unbindConnectionEvents(n){n.onConnectionStateChange=void 0,n.onICEConnectionStateChange=void 0,n.onICETransportStateChange=void 0,n.onDTLSTransportStateChange=void 0,n.onDTLSTransportError=void 0,n.onFirstAudioDecoded=void 0,n.onFirstAudioReceived=void 0,n.onFirstVideoDecoded=void 0,n.onFirstVideoReceived=void 0,n.onSelectedLocalCandidateChanged=void 0,n.onSelectedRemoteCandidateChanged=void 0,n.onFirstVideoDecodedTimeout=void 0,n.onLocalCandidate=void 0}async handleDisconnect(n){const r=n===ui.SEND_ONLY?this.sendConnection:this.recvConnection;r&&!r.isInRestartIce&&(r.isInRestartIce=!0,O.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(r.name,"] start use restartICE")),n===ui.SEND_ONLY?this.restartICE(n):nr(this,Xe.RequestP2PRestartICE,{direction:ui.SEND_ONLY}))}filterTobeMutedTracks(n){const r=[];if(this.getAllTracks().indexOf(n)===-1)return r;const s=this.localTrackMap.get(Ee.LocalAudioTrack);if(n instanceof Gt&&(s==null?void 0:s.track)instanceof lr)return s.track.isActive||r.push([Ee.LocalAudioTrack,s]),r;const c=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:h}]=d;return n===h});if(c&&(r.push(c),c[0]===Ee.LocalVideoTrack)){const d=this.localTrackMap.get(Ee.LocalVideoLowTrack);d&&r.push([Ee.LocalVideoLowTrack,d])}return r}filterTobeUnmutedTracks(n){const r=[],s=this.localTrackMap.get(Ee.LocalAudioTrack);if(n instanceof Gt&&(s==null?void 0:s.track)instanceof lr)return s.track.isActive&&r.push([Ee.LocalAudioTrack,s]),r;const c=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:h}]=d;return n===h});if(c)if(c[0]===Ee.LocalVideoTrack){r.push(c);const d=this.localTrackMap.get(Ee.LocalVideoLowTrack);d&&r.push([Ee.LocalVideoLowTrack,d])}else r.push(c);return r}createMuteMessage(n){return n.map(r=>{var s;let c,[d,{track:h,ssrcs:f,id:g}]=r;switch(d){case Ee.LocalAudioTrack:c=jt.Audio;break;case Ee.LocalVideoTrack:c=Le(s=h._hints).call(s,tn.SCREEN_TRACK)?jt.Screen:jt.High;break;case Ee.LocalVideoLowTrack:c=jt.Low}return{stream_type:c,ssrcs:f,mid:g}})}createUnmuteMessage(n){return n.map(r=>{var s;let c,[d,{track:h,ssrcs:f,id:g}]=r;switch(d){case Ee.LocalAudioTrack:c=jt.Audio;break;case Ee.LocalVideoTrack:c=Le(s=h._hints).call(s,tn.SCREEN_TRACK)?jt.Screen:jt.High;break;case Ee.LocalVideoLowTrack:c=jt.Low}return{stream_type:c,ssrcs:f,mid:g}})}filterTobeUnSubscribedTracks(n,r){const s=[],c=this.remoteUserMap.get(n);if(!c)return s;if(r){const d=c.get(r);if(!d)return s;s.push([n,{kind:r,id:d}])}else Array.from(c.entries()).forEach(d=>{let[h,f]=d;s.push([n,{kind:h,id:f}])});return s}createUnsubscribeMessage(n){const r=[];return n.forEach(s=>{let[c,{kind:d,id:h}]=s;switch(d){case Fe.VIDEO:return void(c._videoSSRC&&r.push({stream_type:Fe.VIDEO,ssrcId:c._videoSSRC}));case Fe.AUDIO:return void(c._audioSSRC&&r.push({stream_type:Fe.AUDIO,ssrcId:c._audioSSRC}))}}),r}withdrawRemoteTracks(n){n.forEach(r=>{let[s,{kind:c}]=r;const d=this.remoteUserMap.get(s);d&&(d.delete(c),Array.from(d.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(n){const r=this.localTrackMap.get(Ee.LocalVideoTrack),s=this.localTrackMap.get(Ee.LocalVideoLowTrack);r&&await r.track.setBitrateLimit(n.uplink),s&&n.low_stream_uplink&&await s.track.setBitrateLimit({max_bitrate:n.low_stream_uplink.bitrate,min_bitrate:n.low_stream_uplink.bitrate||0})}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const n=this.sendConnection.peerConnectionState,r=this.recvConnection.peerConnectionState;return n!=="connected"&&r!=="connected"}return!0}async tryToUnmuteAudio(n){for(let r=0;r<n.length;r++)if(n[r]instanceof Gt){const s=this.filterTobeUnmutedTracks(n[r]);if(s.length===0)continue;const c=this.createUnmuteMessage(s);return void await Xt(this,Xe.RequestUnmuteLocal,c)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=n=>this.getStats(n),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(n=>{let[,{ssrcs:r}]=n;return!!r}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=n=>{var r;return!((r=this.recvConnection)===null||r===void 0||!r.getRemoteVideoIsReady(n))},this.statsUploader.requestUpload=(n,r)=>this.emit(Xe.RequestUpload,n,r),this.statsUploader.requestUploadStats=n=>this.emit(Xe.RequestUploadStats,n),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Nr(zy(this.dtlsFailedCount,ir)),this.emit(Xe.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(Ee.LocalVideoTrack)||this.pendingLocalTracks.some(n=>n instanceof ht)}throwIfTrackTypeNotMatch(n){if(n.filter(r=>r instanceof ht).length>1)throw new he(B.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n.filter(r=>r instanceof Gt).length>1&&(n.some(r=>r instanceof Gt&&r._bypassWebAudio)||!Lt().webAudioMediaStreamDest))throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const r of n){if(r instanceof ht&&this.pendingLocalTracks.some(s=>s instanceof ht))throw new he(B.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r instanceof Gt&&this.pendingLocalTracks.some(s=>s instanceof Gt)&&(!Lt().webAudioMediaStreamDest||r._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof Gt&&s._bypassWebAudio)))throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(n,r){const s=!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&Lt().supportDualStreamEncoding,c=X0(X0({},{width:160,height:120,framerate:15,bitrate:50}),r);let d;d=s?n._mediaStreamTrack.clone():y1(n,c);const h=Qt(8,"track-low-"),f=new ht(d,X0(X0({},s&&{scaleResolutionDownBy:VI(c,n)}),{},{frameRate:c.framerate,bitrateMax:c.bitrate,bitrateMin:c.bitrate}),void 0,void 0,h);return f.on(ud.TRANSCEIVER_UPDATED,g=>{n._updateRtpTransceiver(g,dd.LOW_STREAM)}),f._hints.push(tn.LOW_STREAM),n.addListener(ke.NEED_CLOSE,()=>{f.close()}),f}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(n,r,s,c){var d;const h=Array.from(jo(d=this.remoteUserMap).call(d)).find(f=>f._videoSSRC===n);if(h){c||this.store.subscribe(h.uid,"video",void 0,void 0,void 0,void 0,Date.now());const f=this.store.keyMetrics,g=f.subscribe.find(_=>_.userId===h.uid&&_.type==="video");Be.firstRemoteVideoDecode(this.store.sessionId,gr.FIRST_VIDEO_DECODE,dn.FIRST_VIDEO_DECODE,{peer:h._uintid,videowidth:r,videoheight:s,subscribeElapse:ei.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId,apEnd:f.requestAPEnd||0,apStart:f.requestAPStart||0,joinGwEnd:f.joinGatewayEnd||0,joinGwStart:f.joinGatewayStart||0,pcEnd:f.peerConnectionEnd||0,pcStart:f.peerConnectionStart||0,subscriberEnd:(g==null?void 0:g.subscribeEnd)||0,subscriberStart:(g==null?void 0:g.subscribeStart)||0,videoAddNotify:(g==null?void 0:g.streamAdded)||0,state:c?1:0})}}async remoteMediaSsrcChanged(n,r,s){if(!this.recvConnection)return!1;const c=this.remoteUserMap.get(n);if(!c)return!1;const d=c.get(r);if(!d)return!1;const h=await this.recvConnection.getRemoteSSRC(d);return h!==void 0&&h!==s}resetConnection(n){O.debug("[".concat(this.store.clientId,"] [P2PChannel2] reset connection to ").concat(n)),this.state===Vt.Connected?(O.debug("[".concat(this.store.clientId,"] [P2PChannel2] fallback to websocket but P2PChannel2 state still connected, disconnect first")),this.disconnectForReconnect()):(this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0))}async publishDataChannel(n){throw new he(B.NOT_SUPPORTED)}async unpublishDataChannel(n){throw new he(B.NOT_SUPPORTED)}async subscribeDataChannel(n,r){throw new he(B.NOT_SUPPORTED)}async unsubscribeDataChannel(n,r){throw new he(B.NOT_SUPPORTED)}hasPendingRemoteDataChannel(n,r){throw new he(B.NOT_SUPPORTED)}setPendingRemoteDataChannel(n,r){throw new he(B.NOT_SUPPORTED)}async preConnect(n,r,s,c,d,h){throw new he(B.NOT_SUPPORTED)}getEstablishParams(){throw new he(B.NOT_SUPPORTED)}async reSubscribe(n){throw new he(B.NOT_SUPPORTED)}async updateVideoStreamParameter(n,r){throw new he(B.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(n=>{let[r,{track:s}]=n;r===Ee.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,dd.LOW_STREAM):s._updateRtpTransceiver(void 0)})}}function xa(o){return function(n,r,s){const c=n[r];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];switch(o){case Ts.SEND_ONLY:{const g=await this.sendMutex.lock("From P2PChannel2.".concat(r));try{return await c.apply(this,h)}finally{g()}}case Ts.RECEIVE_ONLY:{const g=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await c.apply(this,h)}finally{g()}}default:{const g=await this.sendMutex.lock("From P2PChannel2.".concat(r)),_=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await c.apply(this,h)}finally{g(),_()}}}},s}}function i4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function Zu(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?i4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):i4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}fe([xa(Ts.SEND_ONLY),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],Er.prototype,"p2pConnect",null),fe([xa(Ts.SEND_ONLY),j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],Er.prototype,"unpublish",null),fe([xa(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Er.prototype,"unpublishLowStream",null),fe([xa(Ts.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Br,String,Number,String]),j("design:returntype",ae)],Er.prototype,"subscribe",null),fe([xa(Ts.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Br,String,Number,String]),j("design:returntype",ae)],Er.prototype,"mockSubscribe",null),fe([xa(Ts.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Br,String,Boolean]),j("design:returntype",ae)],Er.prototype,"unsubscribe",null),fe([xa(Ts.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Br,String]),j("design:returntype",ae)],Er.prototype,"muteRemote",null),fe([xa(Ts.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Br,String]),j("design:returntype",ae)],Er.prototype,"unmuteRemote",null),fe([xa(Ts.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Br,String]),j("design:returntype",ae)],Er.prototype,"hasRemoteMediaWithLock",null),fe([xa(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Er.prototype,"disconnectForReconnect",null),fe([xa(Ts.RECEIVE_ONLY),j("design:type",Function),j("design:paramtypes",[Br,String,Number]),j("design:returntype",ae)],Er.prototype,"remoteMediaSsrcChanged",null);class l_{constructor(n){I(this,"store",void 0),I(this,"onStatsException",void 0),I(this,"onUploadPublishDuration",void 0),I(this,"onStatsChanged",void 0),I(this,"localStats",new Map),I(this,"remoteStats",new Map),I(this,"updateStatsInterval",void 0),I(this,"trafficStats",void 0),I(this,"trafficStatsPeerList",[]),I(this,"uplinkStats",void 0),I(this,"exceptionMonitor",void 0),I(this,"p2pChannel",void 0),I(this,"scalabilityMode",II.L1T1),I(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=n,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new oce,this.exceptionMonitor.on("exception",(r,s,c)=>{this.onStatsException&&this.onStatsException(r,s,c)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Ee.LocalAudioTrack)||Zu({},ZI)}getLocalVideoTrackStats(){return this.localStats.get(Ee.LocalVideoTrack)||Zu({},eA)}getRemoteAudioTrackStats(n){const r=(d,h)=>{if(!this.trafficStats)return h;const f=this.trafficStats.peer_delay.find(g=>g.peer_uid===d);return f&&(h.publishDuration=f.B_ppad+(Date.now()-this.trafficStats.timestamp)),h},s={};if(n){var c;const d=(c=this.remoteStats.get(n))===null||c===void 0?void 0:c.audioStats;d&&(s[n]=r(n,d))}else Array.from(this.remoteStats.entries()).forEach(d=>{let[h,{audioStats:f}]=d;f&&(s[h]=r(h,f))});return s}getRemoteNetworkQualityStats(n){const r={};if(n){var s;const c=(s=this.remoteStats.get(n))===null||s===void 0?void 0:s.networkStats;c&&(r[n]=c)}else Array.from(this.remoteStats.entries()).forEach(c=>{let[d,{networkStats:h}]=c;h&&(r[d]=h)});return r}getRemoteVideoTrackStats(n){const r=(d,h)=>{if(!this.trafficStats)return h;const f=this.trafficStats.peer_delay.find(g=>g.peer_uid===d);return f&&(h.publishDuration=f.B_ppvd+(Date.now()-this.trafficStats.timestamp)),h},s={};if(n){var c;const d=(c=this.remoteStats.get(n))===null||c===void 0?void 0:c.videoStats;d&&(s[n]=r(n,d))}else Array.from(this.remoteStats.entries()).forEach(d=>{let[h,{videoStats:f}]=d;f&&(s[h]=r(h,f))});return s}getRTCStats(){let n=0,r=0,s=0,c=0;const d=this.localStats.get(Ee.LocalAudioTrack);d&&(n+=d.sendBytes,r+=d.sendBitrate);const h=this.localStats.get(Ee.LocalVideoTrack);h&&(n+=h.sendBytes,r+=h.sendBitrate);const f=this.localStats.get(Ee.LocalVideoLowTrack);f&&(n+=f.sendBytes,r+=f.sendBitrate),this.remoteStats.forEach(_=>{let{audioStats:E,videoStats:T}=_;E&&(s+=E.receiveBytes,c+=E.receiveBitrate),T&&(s+=T.receiveBytes,c+=T.receiveBitrate)});let g=1;return this.trafficStats&&(g+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:g,SendBitrate:r,SendBytes:n,RecvBytes:s,RecvBitrate:c,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(n){this.localStats.set(n,void 0)}removeLocalStats(n){n?this.localStats.delete(n):this.localStats.clear()}addRemoteStats(n){this.remoteStats.set(n,{})}removeRemoteStats(n){n?this.remoteStats.delete(n):this.remoteStats.clear()}addP2PChannel(n){this.p2pChannel=n}updateTrafficStats(n){n.peer_delay=n.peer_delay.filter(r=>r.B_ppad!==void 0||r.B_ppvd!==void 0),n.peer_delay.filter(r=>this.trafficStatsPeerList.indexOf(r.peer_uid)===-1).forEach(r=>{var s;const c=(s=this.p2pChannel)===null||s===void 0?void 0:s.getRemoteMedia(r.peer_uid),d=c!=null&&c.videoSSRC?ei.measureFromSubscribeStart(this.store.clientId,c.videoSSRC):0,h=c!=null&&c.audioSSRC?ei.measureFromSubscribeStart(this.store.clientId,c.audioSSRC):0;r.B_ppad!==void 0&&r.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(r.peer_uid,r.B_ppad,r.B_ppvd,d>h?d:h),this.trafficStatsPeerList.push(r.peer_uid))}),this.trafficStats=n}updateUplinkStats(n){this.uplinkStats&&this.uplinkStats.B_fir!==n.B_fir&&O.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(n.B_fir)),this.uplinkStats=n}static isRemoteVideoFreeze(n,r,s){if(!n)return!1;const c=!!s&&r.framesDecodeFreezeTime>s.framesDecodeFreezeTime,d=!s||r.framesDecodeCount>s.framesDecodeCount;return c||!d}static isRemoteAudioFreeze(n){return!!n&&n._isFreeze()}isLocalVideoFreeze(n){return!(!n.inputFrame||!n.sentFrame)&&n.inputFrame.frameRate>5&&n.sentFrame.frameRate<3}updateLocalStats(n){Array.from(this.localStats.entries()).forEach(r=>{let[s,c]=r;switch(s){case Ee.LocalVideoTrack:case Ee.LocalVideoLowTrack:{const h=c,f=Zu({},eA),g=n.getStats(),_=n.getLocalMedia(s);if(g){const E=g.videoSend.find(T=>T.ssrc===(_==null?void 0:_.ssrcs[0].ssrcId));if(E){const T=n.getLocalVideoSize(),w=n.getEncoderConfig(Ee.LocalVideoTrack);E.codec!=="H264"&&E.codec!=="H265"&&E.codec!=="VP8"&&E.codec!=="VP9"&&E.codec!=="AV1X"&&E.codec!=="AV1"||(f.codecType=E.codec),f.sendBytes=E.bytes,f.sendBitrate=h?8*Math.max(0,f.sendBytes-h.sendBytes):0,E.inputFrame?(f.captureFrameRate=E.inputFrame.frameRate,f.captureResolutionHeight=E.inputFrame.height,f.captureResolutionWidth=E.inputFrame.width):T&&(f.captureResolutionWidth=T.width,f.captureResolutionHeight=T.height),E.sentFrame?(f.sendFrameRate=E.sentFrame.frameRate,f.sendResolutionHeight=E.sentFrame.height,f.sendResolutionWidth=E.sentFrame.width):T&&(f.sendResolutionWidth=T.width,f.sendResolutionHeight=T.height),E.avgEncodeMs&&(f.encodeDelay=E.avgEncodeMs),w&&w.bitrateMax&&(f.targetSendBitrate=1e3*w.bitrateMax),f.sendPackets=E.packets,f.sendPacketsLost=E.packetsLost,f.sendJitterMs=E.jitterMs,f.sendRttMs=E.rttMs,f.totalDuration=h?h.totalDuration+1:1,f.totalFreezeTime=h?h.totalFreezeTime:0,this.isLocalVideoFreeze(E)&&(f.totalFreezeTime+=1),E.scalabilityMode&&this.scalabilityMode!==E.scalabilityMode&&(O.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(E.scalabilityMode)),this.scalabilityMode=E.scalabilityMode)}this.trafficStats&&(f.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var d;this.localStats.set(s,f),((h==null?void 0:h.sendResolutionWidth)!==f.sendResolutionWidth||(h==null?void 0:h.sendResolutionHeight)!==f.sendResolutionHeight)&&((d=this.onStatsChanged)===null||d===void 0||d.call(this,"resolution",{width:f.sendResolutionWidth,height:f.sendResolutionHeight})),f&&_&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,_.track,f);break}case Ee.LocalAudioTrack:{const h=c,f=Zu({},ZI),g=n.getStats(),_=n.getLocalMedia(s);if(g){const E=g.audioSend.find(T=>T.ssrc===(_==null?void 0:_.ssrcs[0].ssrcId));if(E){if(E.codec!=="opus"&&E.codec!=="aac"&&E.codec!=="PCMU"&&E.codec!=="PCMA"&&E.codec!=="G722"||(f.codecType=E.codec),E.inputLevel)f.sendVolumeLevel=Math.round(32767*E.inputLevel);else{const T=n.getLocalAudioVolume();T&&(f.sendVolumeLevel=Math.round(32767*T))}f.sendBytes=E.bytes,f.sendPackets=E.packets,f.sendPacketsLost=E.packetsLost,f.sendJitterMs=E.jitterMs,f.sendRttMs=E.rttMs,f.sendBitrate=h?8*Math.max(0,f.sendBytes-h.sendBytes):0}}this.trafficStats&&(f.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(Ee.LocalAudioTrack,f),f&&_&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,_.track,f);break}}})}updateRemoteStats(n){Array.from(this.remoteStats.entries()).forEach(r=>{var s,c;let[d,{videoStats:h,audioStats:f,videoPcStats:g}]=r;const _=f,E=h,T=g,w=Zu({},dV),A=Zu({},uV),L=Zu({},ooe),{audioTrack:P,videoTrack:D,audioSSRC:G,videoSSRC:$}=n.getRemoteMedia(d);let X;X=n instanceof Er?n.getStats(!0):n.getStats();const ie=(s=X)===null||s===void 0?void 0:s.audioRecv.find(ce=>ce.ssrc===G),Q=(c=X)===null||c===void 0?void 0:c.videoRecv.find(ce=>ce.ssrc===$),te=this.trafficStats&&this.trafficStats.peer_delay.find(ce=>ce.peer_uid===d);if(ie&&(ie.codec!=="opus"&&ie.codec!=="aac"&&ie.codec!=="PCMU"&&ie.codec!=="PCMA"&&ie.codec!=="G722"||(w.codecType=ie.codec),ie.outputLevel?w.receiveLevel=Math.round(32767*ie.outputLevel):P&&(w.receiveLevel=Math.round(32767*P.getVolumeLevel())),w.receiveBytes=ie.bytes,w.receivePackets=ie.packets,w.receivePacketsLost=ie.packetsLost,w.packetLossRate=w.receivePacketsLost/(w.receivePackets+w.receivePacketsLost),w.receiveBitrate=_?8*Math.max(0,w.receiveBytes-_.receiveBytes):0,w.totalDuration=_?_.totalDuration+1:1,w.totalFreezeTime=_?_.totalFreezeTime:0,w.freezeRate=w.totalFreezeTime/w.totalDuration,w.receiveDelay=ie.jitterBufferMs,w.totalDuration>10&&l_.isRemoteAudioFreeze(P)&&(w.totalFreezeTime+=1)),Q){Q.codec!=="H264"&&Q.codec!=="H265"&&Q.codec!=="VP8"&&Q.codec!=="VP9"&&Q.codec!=="AV1X"&&Q.codec!=="AV1"||(A.codecType=Q.codec),A.receiveBytes=Q.bytes,A.receiveBitrate=E?8*Math.max(0,A.receiveBytes-E.receiveBytes):0,A.decodeFrameRate=Q.decodeFrameRate<0?0:Q.decodeFrameRate,A.renderFrameRate=Q.decodeFrameRate<0?0:Q.decodeFrameRate,Q.outputFrame&&(A.renderFrameRate=Q.outputFrame.frameRate),Q.receivedFrame?(A.receiveFrameRate=Q.receivedFrame.frameRate,A.receiveResolutionHeight=Q.receivedFrame.height,A.receiveResolutionWidth=Q.receivedFrame.width):D&&(A.receiveResolutionHeight=D._videoHeight||0,A.receiveResolutionWidth=D._videoWidth||0),Q.framesRateFirefox!==void 0&&(A.receiveFrameRate=Math.round(Q.framesRateFirefox)),A.receivePackets=Q.packets,A.receivePacketsLost=Q.packetsLost,A.packetLossRate=A.receivePacketsLost/(A.receivePackets+A.receivePacketsLost),A.totalDuration=E?E.totalDuration+1:1,A.totalFreezeTime=E?E.totalFreezeTime:0,A.receiveDelay=Q.jitterBufferMs||0;const ce=!!$&&n.getRemoteVideoIsReady($);D&&ce&&l_.isRemoteVideoFreeze(D,Q,T)&&(A.totalFreezeTime+=1),A.freezeRate=A.totalFreezeTime/A.totalDuration}te&&(w.end2EndDelay=te.B_ad,A.end2EndDelay=te.B_vd,w.transportDelay=te.B_ed,A.transportDelay=te.B_ed,w.currentPacketLossRate=te.B_ealr4/100,A.currentPacketLossRate=te.B_evlr4/100,L.uplinkNetworkQuality=te.B_punq?te.B_punq:0,L.downlinkNetworkQuality=te.B_pdnq?te.B_pdnq:0),this.remoteStats.set(d,{audioStats:w,videoStats:A,videoPcStats:Q,networkStats:L}),P&&this.exceptionMonitor.setRemoteAudioStats(P,w),D&&this.exceptionMonitor.setRemoteVideoStats(D,A)})}}function o4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function d_(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?o4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):o4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class wce extends mn{constructor(n,r,s,c){super(),I(this,"spec",void 0),I(this,"token",void 0),I(this,"websocket",void 0),I(this,"pingpongTimer",void 0),I(this,"reconnectMode","retry"),I(this,"serviceMode",void 0),I(this,"reqId",0),I(this,"commandReqId",0),I(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),I(this,"handleWebSocketMessage",d=>{if(!d.data)return;const h=JSON.parse(d.data);h.requestId?this.emit("@".concat(h.requestId,"-").concat(h.sid),h):this.serviceMode===_r.INJECT?this.emit(zs.INJECT_STREAM_STATUS,h):(Be.workerEvent(this.spec.sid,{actionType:"status",serverCode:h.code,workerType:this.serviceMode===_r.TRANSCODE?1:2}),this.emit(zs.PUBLISH_STREAM_STATUS,h))}),this.spec=r,this.token=n,this.serviceMode=c,this.websocket=new Ng("live-streaming",s),this.websocket.on(tt.CONNECTED,this.handleWebSocketOpen),this.websocket.on(tt.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(tt.REQUEST_NEW_URLS,(d,h)=>{nr(this,zs.REQUEST_NEW_ADDRESS).then(d).catch(h)}),this.websocket.on(tt.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(n){return this.websocket.init(n)}async request(n,r,s,c){this.reqId+=1,n==="request"&&(this.commandReqId+=1);const d=this.commandReqId,h=this.reqId;if(!h||!this.websocket)throw new Z(B.UNEXPECTED_ERROR);const f=d_({command:n,sdkVersion:ms==="4.20.2"?"0.0.1":ms,seq:h,requestId:h,allocate:s,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},r);if(this.websocket.state==="closed")throw new Z(B.WS_DISCONNECT);const g=()=>new ae((w,A)=>{this.websocket.once(tt.CLOSED,()=>A(new Z(B.WS_ABORT))),this.websocket.once(tt.CONNECTED,w)});this.websocket.state!=="connected"&&await g(),f.clientRequest&&(f.clientRequest.workerToken=this.token);const _=new ae((w,A)=>{const L=()=>{A(new Z(B.WS_ABORT))};this.websocket.once(tt.RECONNECTING,L),this.websocket.once(tt.CLOSED,L),this.once("@".concat(h,"-").concat(this.spec.sid),P=>{w(P)})});c&&Be.workerEvent(this.spec.sid,d_(d_({},c),{},{requestId:d,actionType:"request",payload:JSON.stringify(r.clientRequest),serverCode:0,code:0}));const E=Date.now();this.websocket.sendMessage(f);let T=null;try{T=await _}catch(w){if(this.websocket.state==="closed")throw w;return await g(),await this.request(n,r,s)}return c&&Be.workerEvent(this.spec.sid,d_(d_({},c),{},{requestId:d,actionType:"response",payload:JSON.stringify(T.serverResponse),serverCode:T.code,success:T.code===200,responseTime:Date.now()-E})),T.code!==200&&this.handleResponseError(T),T}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const n=ms==="4.20.2"?"0.0.1":ms;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:n,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(n){switch(n.code){case Yn.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void O.warning("live stream response already exists stream");case Yn.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case Yn.LIVE_STREAM_RESPONSE_BAD_STREAM:case Yn.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new Z(B.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:n.code}).throw();case Yn.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(n.serverResponse.command==="UnpublishStream"||n.serverResponse.command==="UninjectStream")return;throw new Z(B.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Yn.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new Z(B.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:n.code}).throw();case Yn.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const r=new Z(B.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(zs.WARNING,r,n.serverResponse.url)}case Yn.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const r=new Z(B.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(zs.WARNING,r,n.serverResponse.url)}case Yn.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new Z(B.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case Yn.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new Z(B.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:n.code}).throw();case Yn.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const r=new Z(B.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(zs.WARNING,r,n.serverResponse.url)}case Yn.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new Z(B.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:n.code}).throw();case Yn.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new Z(B.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case Yn.LIVE_STREAM_RESPONSE_WORKER_LOST:case Yn.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(n.serverResponse.command==="UnpublishStream"||n.serverResponse.command==="UninjectStream")return;throw new Z(B.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Yn.ERROR_FAIL_SEND_MESSAGE:if(n.serverResponse.command==="UnpublishStream"||n.serverResponse.command==="UninjectStream")return;if(n.serverResponse.command==="UpdateTranscoding"||n.serverResponse.command==="ControlStream")return new Z(B.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:n.code}).throw();throw new Z(B.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case Yn.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new Z(B.LIVE_STREAMING_CDN_ERROR,"",{code:n.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(By)},6e3)}}function s4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function Wi(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?s4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):s4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class Rce extends mn{constructor(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ir,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ir;super(),I(this,"onLiveStreamWarning",void 0),I(this,"onLiveStreamError",void 0),I(this,"onInjectStatusChange",void 0),I(this,"spec",void 0),I(this,"retryTimeout",1e4),I(this,"connection",void 0),I(this,"httpRetryConfig",void 0),I(this,"wsRetryConfig",void 0),I(this,"streamingTasks",new Map),I(this,"isStartingStreamingTask",!1),I(this,"taskMutex",new Pr("live-streaming")),I(this,"cancelToken",Qi.CancelToken.source()),I(this,"transcodingConfig",void 0),I(this,"injectConfig",Wi({},Tie)),I(this,"injectLoopTimes",0),I(this,"uapResponse",void 0),I(this,"lastTaskId",1),I(this,"statusError",new Map),this.spec=n,this.httpRetryConfig=s,this.wsRetryConfig=r}async setTranscodingConfig(n){const r=Wi(Wi({},Sie),n);r.videoCodecProfile!==66&&r.videoCodecProfile!==77&&r.videoCodecProfile!==100&&(O.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(r.videoCodecProfile," -> 100")),r.videoCodecProfile=100),r.transcodingUsers||(r.transcodingUsers=r.userConfigs),r.transcodingUsers&&(r.transcodingUsers=r.transcodingUsers.map(h=>Wi(Wi(Wi({},yie),h),{},{zOrder:h.zOrder?h.zOrder+1:1}))),function(h){wn(h.width)||Yt(h.width,"config.width",0,1e4),wn(h.height)||Yt(h.height,"config.height",0,1e4),wn(h.videoBitrate)||Yt(h.videoBitrate,"config.videoBitrate",1,1e6),wn(h.videoFrameRate)||Yt(h.videoFrameRate,"config.videoFrameRate"),wn(h.lowLatency)||$c(h.lowLatency,"config.lowLatency"),wn(h.audioSampleRate)||mr(h.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),wn(h.audioBitrate)||Yt(h.audioBitrate,"config.audioBitrate",1,128),wn(h.audioChannels)||mr(h.audioChannels,"config.audioChannels",[1,2,3,4,5]),wn(h.videoGop)||Yt(h.videoGop,"config.videoGop"),wn(h.videoCodecProfile)||mr(h.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),wn(h.userCount)||Yt(h.userCount,"config.userCount",0,17),wn(h.backgroundColor)||Yt(h.backgroundColor,"config.backgroundColor",0,16777215),wn(h.userConfigExtraInfo)||Xr(h.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),h.transcodingUsers&&!wn(h.transcodingUsers)&&(Kc(h.transcodingUsers,"config.transcodingUsers"),h.transcodingUsers.forEach((f,g)=>{NI(f.uid),wn(f.x)||Yt(f.x,"transcodingUser[".concat(g,"].x"),0,1e4),wn(f.y)||Yt(f.y,"transcodingUser[".concat(g,"].y"),0,1e4),wn(f.width)||Yt(f.width,"transcodingUser[".concat(g,"].width"),0,1e4),wn(f.height)||Yt(f.height,"transcodingUser[".concat(g,"].height"),0,1e4),wn(f.zOrder)||Yt(f.zOrder-1,"transcodingUser[".concat(g,"].zOrder"),0,100),wn(f.alpha)||Yt(f.alpha,"transcodingUser[".concat(g,"].alpha"),0,1,!1)})),wn(h.watermark)||kI(h.watermark,"watermark"),wn(h.backgroundImage)||kI(h.backgroundImage,"backgroundImage"),h.images&&!wn(h.images)&&(Kc(h.images,"config.images"),h.images.forEach((f,g)=>{kI(f,"images[".concat(g,"]"))}))}(r);const s=[];r.images&&s.push(...r.images.map(h=>Wi(Wi(Wi({},PI),h),{},{zOrder:255}))),r.backgroundImage&&(s.push(Wi(Wi(Wi({},PI),r.backgroundImage),{},{zOrder:0})),delete r.backgroundImage),r.watermark&&(s.push(Wi(Wi(Wi({},PI),r.watermark),{},{zOrder:255})),delete r.watermark),r.images=s,r.transcodingUsers&&(r.userConfigs=r.transcodingUsers.map(h=>Wi({},h)),r.userCount=r.transcodingUsers.length,delete r.transcodingUsers);const c=(r.userConfigs||[]).map(h=>typeof h.uid=="number"?ae.resolve(h.uid):rV(h.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await ae.all(c)).forEach((h,f)=>{r.userConfigs&&r.userConfigs[f]&&(r.userConfigs[f].uid=h)}),this.transcodingConfig=r,this.connection)try{var d;const h=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(Ia(d=this.streamingTasks).call(d)).map(f=>f.taskId).join("#")});O.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(h.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(h){if(!h.data||!h.data.retry)throw h;h.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(f=>{O.warning("[".concat(this.spec.clientId,"] live streaming receive error"),h.toString(),"try to republish",f.url),this.startLiveStreamingTask(f.url,f.mode,h).then(()=>{O.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(f.url," success"))}).catch(g=>{O.error("[".concat(this.spec.clientId,"] live streaming republish failed"),f.url,g.toString()),this.onLiveStreamError&&this.onLiveStreamError(f.url,g)})})}}setInjectStreamConfig(n,r){this.injectConfig=Object.assign({},this.injectConfig,n),this.injectLoopTimes=r}async startLiveStreamingTask(n,r,s){var c;if(Array.from(Ia(c=this.streamingTasks).call(c)).find(g=>g.mode===_r.INJECT)&&r===_r.INJECT)return new Z(B.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&r===_r.TRANSCODE)throw new Z(B.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let d={command:"PublishStream",ts:Date.now(),url:n,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};O.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(n,", mode: ").concat(r));const h=await this.taskMutex.lock();if(!this.connection&&s)return void h();if(this.streamingTasks.get(n)&&!s)return h(),new Z(B.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(r))}catch(g){throw h(),g}switch(r){case _r.TRANSCODE:d.transcodingConfig=Wi({},this.transcodingConfig);break;case _r.RAW:break;case _r.INJECT:d={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:n,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(d.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const f=this.lastTaskId++;try{const g=new ae((E,T)=>{Nr(this.retryTimeout).then(()=>{if(s)return T(s);const w=this.statusError.get(n);return w?(this.statusError.delete(n),T(w)):void 0})}),_=await ae.race([this.connection.request("request",{clientRequest:d},!0,{url:n,command:"PublishStream",workerType:r===_r.TRANSCODE?1:2,requestByUser:!s,tid:f.toString()}),g]);this.isStartingStreamingTask=!1,O.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(_.code)),this.streamingTasks.set(n,{clientRequest:d,mode:r,url:n,taskId:f}),h()}catch(g){if(h(),this.isStartingStreamingTask=!1,!g.data||!g.data.retry||s)throw g;return g.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(n,r,g)):await this.startLiveStreamingTask(n,r,g)}}stopLiveStreamingTask(n){return new ae((r,s)=>{const c=this.streamingTasks.get(n);if(!c||!this.connection)return new Z(B.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const d=c.mode;c.abortTask=()=>{O.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(n),r()},this.connection.request("request",{clientRequest:{command:d===_r.INJECT?"UninjectStream":"UnpublishStream",url:c.url}},!1,{url:n,command:"UnPublishStream",workerType:d===_r.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(h=>{O.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(h.code)),this.streamingTasks.delete(n),this.streamingTasks.size===0&&d!==_r.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),r(),d===_r.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(id.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,n)}).catch(s)})}async controlInjectStream(n,r,s,c){const d=this.streamingTasks.get(n);if(!d||!this.connection||d.mode!==_r.INJECT)throw new Z(B.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:n,control:r,audioVolume:s,position:c}})).serverResponse}resetAllTask(){var n;const r=Array.from(Ia(n=this.streamingTasks).call(n));this.terminate();for(const s of r)this.startLiveStreamingTask(s.url,s.mode).catch(c=>{this.onLiveStreamError&&this.onLiveStreamError(s.url,c)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=Qi.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(n){if(this.connection)throw new Z(B.UNEXPECTED_ERROR,"live streaming connection has already connected");const r=await nr(this,Np.REQUEST_WORKER_MANAGER_LIST,n);return this.uapResponse=r,this.connection=new wce(r.workerToken,this.spec,this.wsRetryConfig,n),this.connection.on(zs.WARNING,(s,c)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(c,s)),this.connection.on(zs.PUBLISH_STREAM_STATUS,s=>this.handlePublishStreamServer(s)),this.connection.on(zs.INJECT_STREAM_STATUS,s=>this.handleInjectStreamServerStatus(s)),this.connection.on(zs.REQUEST_NEW_ADDRESS,(s,c)=>{if(!this.connection)return c(new Z(B.UNEXPECTED_ERROR,"can not get new live streaming address list"));nr(this,Np.REQUEST_WORKER_MANAGER_LIST,n).then(d=>{this.uapResponse=d,s(d.addressList)}).catch(c)}),await this.connection.init(r.addressList),this.connection}handlePublishStreamServer(n){const r=n.serverStatus&&n.serverStatus.url||"empty_url",s=this.streamingTasks.get(r),c=n.reason;switch(n.code){case Yn.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case Yn.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const h=new Z(B.LIVE_STREAMING_CDN_ERROR,"",{code:n.code});if(s)return O.error(h.toString()),this.onLiveStreamError&&this.onLiveStreamError(r,h);if(!this.isStartingStreamingTask)return;this.statusError.set(r,h)}case Yn.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const h=new Z(B.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,c);return this.onLiveStreamWarning&&this.onLiveStreamWarning(r,h)}case Yn.LIVE_STREAM_RESPONSE_WORKER_LOST:case Yn.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var d;if(!this.connection)return;this.connection.tryNextAddress();const h=Array.from(Ia(d=this.streamingTasks).call(d));for(const f of h)f.abortTask?f.abortTask():(O.warning("[".concat(this.spec.clientId,"] publish stream status code"),n.code,"try to republish",f.url),this.startLiveStreamingTask(f.url,f.mode,new Z(B.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:n.code})).then(()=>{O.debug("[".concat(this.spec.clientId,"] republish live stream success"),f.url)}).catch(g=>{O.error(g.toString()),this.onLiveStreamError&&this.onLiveStreamError(f.url,g)}));return}}}handleInjectStreamServerStatus(n){const r=Number(n.uid),s=n.serverStatus&&n.serverStatus.url;switch(n.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(id.INJECT_STREAM_STATUS_START_SUCCESS,r,s));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(id.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,r,s),void this.streamingTasks.delete(s);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(id.INJECT_STREAM_STATUS_START_UNAUTHORIZED,r,s),void this.streamingTasks.delete(s);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(id.INJECT_STREAM_STATUS_BROKEN,r,s),void this.streamingTasks.delete(s);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(id.INJECT_STREAM_STATUS_START_TIMEOUT,r,s),void this.streamingTasks.delete(s);default:return void O.debug("inject stream server status",n)}}hasUrl(n){return this.streamingTasks.has(n)}}class Q0{constructor(){I(this,"destChannelMediaInfos",new Map),I(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(n){CF(n),this.srcChannelMediaInfo=n}addDestChannelInfo(n){CF(n),this.destChannelMediaInfos.set(n.channelName,n)}removeDestChannelInfo(n){OI(n),this.destChannelMediaInfos.delete(n)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function a4(o){if(!(o instanceof Q0))return new Z(B.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const n=o.getSrcChannelMediaInfo(),r=o.getDestChannelMediaInfo();if(!n)return new Z(B.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(r.size===0)return new Z(B.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class Ice extends mn{constructor(n,r,s){super(),I(this,"ws",void 0),I(this,"requestId",1),I(this,"heartBeatTimer",void 0),I(this,"joinInfo",void 0),I(this,"clientId",void 0),I(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),I(this,"onClose",c=>{this.emit("close"),this.dispose()}),I(this,"onMessage",c=>{const d=JSON.parse(c.data);if(!d||d.command!=="serverResponse"||!d.requestId)return d&&d.command==="serverStatus"&&d.serverStatus&&d.serverStatus.command?(this.emit("status",d.serverStatus),void this.emit(d.serverStatus.command,d.serverStatus)):void 0;this.emit("req_".concat(d.requestId),d)}),this.joinInfo=n,this.clientId=r,this.ws=new Ng("cross-channel-".concat(this.clientId),s),this.ws.on(tt.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(tt.CONNECTED,this.onOpen),this.ws.on(tt.ON_MESSAGE,this.onMessage),this.ws.on(tt.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(n){const r=this.requestId++;return n.requestId=r,n.seq=r,this.ws.sendMessage(n),r}waitStatus(n){return new ae((r,s)=>{const c=window.setTimeout(()=>{s(new Z(B.TIMEOUT,"wait status timeout, status: ".concat(n)))},5e3);this.once(n,d=>{window.clearTimeout(c),d.state&&d.state!==0?s(new Z(B.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(n))):r(void 0)}),this.once("dispose",()=>{window.clearTimeout(c),s(new Z(B.WS_ABORT))})})}async request(n){if(this.ws.state==="closed")throw new Z(B.WS_DISCONNECT);const r=()=>new ae((h,f)=>{this.ws.once(tt.CLOSED,()=>f(new Z(B.WS_ABORT))),this.ws.once(tt.CONNECTED,h)});this.ws.state!=="connected"&&await r();const s=this.sendMessage(n),c=new ae((h,f)=>{const g=()=>{f(new Z(B.WS_ABORT))};this.ws.once(tt.RECONNECTING,g),this.ws.once(tt.CLOSED,g),this.once("req_".concat(s),h),Nr(3e3).then(()=>{this.removeAllListeners("req_".concat(s)),this.ws.off(tt.RECONNECTING,g),this.ws.off(tt.CLOSED,g),f(new Z(B.TIMEOUT,"cross channel ws request timeout"))})}),d=await c;if(!d||d.code!==200)throw new Z(B.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(d)));return d}async connect(n){this.ws.removeAllListeners(tt.REQUEST_NEW_URLS),this.ws.on(tt.REQUEST_NEW_URLS,r=>{r(n)}),await this.ws.init(n)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(n){const r=this.requestId++;return n.requestId=r,this.ws.sendMessage(n),r}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class Ace extends mn{set state(n){n!==this._state&&(n!==ki.RELAY_STATE_FAILURE&&(this.errorCode=od.RELAY_OK),this.emit("state",n,this.errorCode),this._state=n)}get state(){return this._state}constructor(n,r,s,c,d){super(),I(this,"joinInfo",void 0),I(this,"sid",void 0),I(this,"clientId",void 0),I(this,"cancelToken",Qi.CancelToken.source()),I(this,"workerToken",void 0),I(this,"requestId",0),I(this,"signal",void 0),I(this,"prevChannelMediaConfig",void 0),I(this,"httpRetryConfig",void 0),I(this,"_resolution",void 0),I(this,"_state",ki.RELAY_STATE_IDLE),I(this,"errorCode",od.RELAY_OK),I(this,"onStatus",h=>{O.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(h))),h&&h.command&&(h.command==="onAudioPacketReceived"&&this.emit("event",Aa.PACKET_RECEIVED_AUDIO_FROM_SRC),h.command==="onVideoPacketReceived"&&this.emit("event",Aa.PACKET_RECEIVED_VIDEO_FROM_SRC),h.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=od.SRC_TOKEN_EXPIRED,this.state=ki.RELAY_STATE_FAILURE),h.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=od.DEST_TOKEN_EXPIRED,this.state=ki.RELAY_STATE_FAILURE))}),I(this,"onReconnect",async()=>{O.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",Aa.NETWORK_DISCONNECTED),this.state=ki.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(h=>{this.state!==ki.RELAY_STATE_IDLE&&(O.error("auto restart channel media relay failed",h.toString()),this.errorCode=od.SERVER_CONNECTION_LOST,this.state=ki.RELAY_STATE_FAILURE)})}),this.joinInfo=n,this.clientId=r,this.sid=rI(),this.signal=new Ice(this.joinInfo,this.clientId,s),this.httpRetryConfig=c,this._resolution=d}async startChannelMediaRelay(n){if(this.state!==ki.RELAY_STATE_IDLE)throw new Z(B.INVALID_OPERATION);this.state=ki.RELAY_STATE_CONNECTING,await this.connect(),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(n)}catch(r){throw r.data&&r.data.serverResponse&&r.data.serverResponse.command==="SetSourceChannel"?new Z(B.CROSS_CHANNEL_FAILED_JOIN_SRC):r.data&&r.data.serverResponse&&r.serverResponse.command==="SetDestChannelStatus"?new Z(B.CROSS_CHANNEL_FAILED_JOIN_DEST):r.data&&r.data.serverResponse&&r.serverResponse.command==="StartPacketTransfer"?new Z(B.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):r}this.prevChannelMediaConfig=n}async updateChannelMediaRelay(n){if(this.state!==ki.RELAY_STATE_RUNNING)throw new Z(B.INVALID_OPERATION);await this.sendUpdateMessage(n),this.prevChannelMediaConfig=n}async setVideoProfile(n){if(this._resolution=n,this.state!==ki.RELAY_STATE_RUNNING)throw new Z(B.INVALID_OPERATION);const r=this.genMessage(hi.SetVideoProfile);await this.signal.request(r),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),O.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=ki.RELAY_STATE_IDLE,this.dispose()}dispose(){O.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Qi.CancelToken.source(),this.state=ki.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const n=await Qie(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=n.workerToken,await this.signal.connect(n.addressList),this.emit("event",Aa.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(n){const r=this.genMessage(hi.StopPacketTransfer);await this.signal.request(r),await this.signal.waitStatus("Normal Quit"),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const s=this.genMessage(hi.SetSdkProfile,n);await this.signal.request(s),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const c=this.genMessage(hi.SetSourceChannel,n);await this.signal.request(c),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",Aa.PACKET_JOINED_SRC_CHANNEL),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const d=this.genMessage(hi.SetSourceUserId,n);await this.signal.request(d),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const h=this.genMessage(hi.SetDestChannel,n);await this.signal.request(h),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",Aa.PACKET_JOINED_DEST_CHANNEL),O.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const f=this.genMessage(hi.StartPacketTransfer,n);await this.signal.request(f),this.emit("event",Aa.PACKET_SENT_TO_DEST_CHANNEL),this.state=ki.RELAY_STATE_RUNNING,O.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(n){const r=this.genMessage(hi.UpdateDestChannel,n);await this.signal.request(r),this.emit("event",Aa.PACKET_UPDATE_DEST_CHANNEL),O.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const n=this.genMessage(hi.StopPacketTransfer);await this.signal.request(n),O.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(n,r){const s=[],c=[],d=[];this.requestId+=1;const h={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:ms,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};h.sdkVersion==="4.20.2"&&(h.sdkVersion="0.0.1");let f=null,g=null;switch(n){case hi.SetSdkProfile:return h.clientRequest={command:"SetSdkProfile",type:"multi_channel"},h;case hi.SetSourceChannel:if(g=r&&r.getSrcChannelMediaInfo(),!g)throw new Z(B.UNEXPECTED_ERROR,"can not find source config");return h.clientRequest={command:"SetSourceChannel",uid:"0",channelName:g.channelName,token:g.token||this.joinInfo.appId},h;case hi.SetSourceUserId:if(g=r&&r.getSrcChannelMediaInfo(),!g)throw new Z(B.UNEXPECTED_ERROR,"can not find source config");return h.clientRequest={command:"SetSourceUserId",uid:g.uid+""},h;case hi.SetDestChannel:if(f=r&&r.getDestChannelMediaInfo(),!f)throw new Z(B.UNEXPECTED_ERROR,"can not find dest config");return f.forEach(_=>{s.push(_.channelName),c.push(_.uid+""),d.push(_.token||this.joinInfo.appId)}),h.clientRequest={command:"SetDestChannel",channelName:s,uid:c,token:d},h;case hi.StartPacketTransfer:return h.clientRequest={command:"StartPacketTransfer"},h;case hi.Reconnect:return h.clientRequest={command:"Reconnect"},h;case hi.StopPacketTransfer:return h.clientRequest={command:"StopPacketTransfer"},h;case hi.UpdateDestChannel:if(f=r&&r.getDestChannelMediaInfo(),!f)throw new Z(B.UNEXPECTED_ERROR,"can not find dest config");return f.forEach(_=>{s.push(_.channelName),c.push(_.uid+""),d.push(_.token||this.joinInfo.appId)}),h.clientRequest={command:"UpdateDestChannel",channelName:s,uid:c,token:d},h;case hi.SetVideoProfile:h.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return h}}function Z0(o){var n={},r=!1;function s(c,d){return r=!0,{done:!1,value:new d1(d=new u1(function(h){h(o[c](d))}),1)}}return n[hp!==void 0&&jM||"@@iterator"]=function(){return this},n.next=function(c){return r?(r=!1,c):s("next",c)},typeof o.throw=="function"&&(n.throw=function(c){if(r)throw r=!1,c;return s("throw",c)}),typeof o.return=="function"&&(n.return=function(c){return r?(r=!1,c):s("return",c)}),n}var c4=u(k3);function l4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function d4(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?l4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):l4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}function u4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function h4(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?u4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):u4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class xr extends o0{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(n=>n.rtpMap&&n.rtpMap.encodingName.toLowerCase()||"").filter(n=>{var r;return Le(r=Object.keys(nd)).call(r,n)}))]}constructor(n,r){super(n,r),I(this,"store",void 0),I(this,"peerConnection",void 0),I(this,"remoteSDP",void 0),I(this,"initialOffer",void 0),I(this,"statsFilter",void 0),I(this,"useRTX",!1),I(this,"localCapabilities",void 0),I(this,"localCandidateCount",0),I(this,"allCandidatesReceived",!1),I(this,"establishPromise",void 0),I(this,"mutex",new Pr("P2PConnection-mutex")),this.store=r,this.peerConnection=new RTCPeerConnection(xr.resolvePCConfiguration(n),{optional:[{googDscp:!0}]}),this.statsFilter=Y0(this.peerConnection,Y("STATS_UPDATE_INTERVAL"),void 0,Jt()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const n=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!n.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const r=ka(n.sdp),s=s_(n.sdp,{filterRTX:!this.useRTX,filterVideoFec:Y("FILTER_VIDEO_FEC"),filterAudioFec:Y("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=s,this.initialOffer=n,h4(h4({},r),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:s},offerSDP:n.sdp})}catch(n){throw new he(B.GET_LOCAL_CONNECTION_PARAMS_FAILED,n.toString())}}async connect(n,r,s,c,d,h){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{constructor(g){I(this,"sessionDesc",void 0),I(this,"localCapabilities",void 0),I(this,"rtpCapabilities",void 0),I(this,"candidates",void 0),I(this,"iceParameters",void 0),I(this,"dtlsParameters",void 0),I(this,"setup",void 0),I(this,"currentMidIndex",void 0),I(this,"cname",void 0),g=en(g);const{remoteIceParameters:_,remoteDtlsParameters:E,candidates:T,remoteRTPCapabilities:w,remoteSetup:A,localCapabilities:L,sdkCodec:P,cname:D}=g,G=gn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=w,this.candidates=T,this.iceParameters=_,this.dtlsParameters=E,this.setup=A,this.localCapabilities=L,this.cname=D;for(let $=0;$<G.mediaDescriptions.length;$++){const X=G.mediaDescriptions[$];if(X.attributes.iceUfrag=_.iceUfrag,X.attributes.icePwd=_.icePwd,X.attributes.fingerprints=E.fingerprints,X.attributes.candidates=T,X.attributes.setup=A,X.media.mediaType==="video"){X.media.fmts=w.videoCodecs.map(Q=>Q.payloadType.toString(10));let ie=w.videoCodecs.filter(Q=>{var te,ce;return(te=Q.rtpMap)===null||te===void 0?void 0:Le(ce=te.encodingName.toLowerCase()).call(ce,P)});ie.length===0&&(ie=w.videoCodecs),X.attributes.payloads=ie,X.attributes.extmaps=w.videoExtensions}X.media.mediaType==="audio"&&(X.media.fmts=w.audioCodecs.map(ie=>ie.payloadType.toString(10)),X.attributes.payloads=w.audioCodecs,X.attributes.extmaps=w.audioExtensions),G.mediaDescriptions[$]=this.mungMediaDesc(X)}this.sessionDesc=G,this.currentMidIndex=G.mediaDescriptions.length-1}toString(){return gn.print(this.sessionDesc)}send(g,_,E){const{ssrcs:T,ssrcGroups:w}=no(_,this.cname),A=this.sessionDesc.mediaDescriptions.find(D=>g===Fe.VIDEO?D.media.mediaType==="video":D.media.mediaType==="audio"),L=T[0].attributes.label,P=T[0].attributes.mslabel;return A.attributes.ssrcs=A.attributes.ssrcs.concat(T),A.attributes.ssrcGroups=A.attributes.ssrcGroups.concat(w),{id:L,mslabel:P}}batchSend(g){return g.map(_=>{let{kind:E,ssrcMsg:T}=_;return this.send(E,T,void 0)})}stopSending(g){this.sessionDesc.mediaDescriptions.forEach(_=>{const E=[],T=[],w=[];_.attributes.ssrcs.forEach(A=>{Le(g).call(g,A.attributes.label||"")?w.push(A):E.push(A)}),_.attributes.ssrcGroups.forEach(A=>{var L;Le(L=w.map(P=>P.ssrcId)).call(L,A.ssrcIds[0])||T.push(A)}),_.attributes.ssrcs=E,_.attributes.ssrcGroups=T})}mute(g){const _=this.sessionDesc.mediaDescriptions.find(E=>E.attributes.mid===g);if(!_)throw new Error("mediaDescription not found with ".concat(g," in remote SDP when calling RemoteSDP.mute."));_.attributes.direction="inactive"}unmute(g){const _=this.sessionDesc.mediaDescriptions.find(E=>E.attributes.mid===g);if(!_)throw new Error("mediaDescription not found with ".concat(g," in remote SDP when calling RemoteSDP.unmute."));_.attributes.direction="sendonly"}receive(g,_,E){g.forEach((T,w)=>{const A=T._mediaStreamTrack,L=this.sessionDesc.mediaDescriptions.findIndex(D=>D.attributes.mid===A.kind),P=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[L],T);this.sessionDesc.mediaDescriptions[L]=P})}stopReceiving(g){}updateCandidates(g){g===Qr.TCP?this.candidates.forEach(_=>{this.candidates.findIndex(E=>E.transport==="tcp"&&E.connectionAddress===_.connectionAddress&&E.port===_.port)===-1&&this.candidates.push(d4(d4({},_),{},{foundation:"tcpcandidate",priority:Number(_.priority)-1+"",transport:"tcp",port:Number(_.port)+90+""}))}):this.candidates=this.candidates.filter(_=>_.transport!=="tcp");for(const _ of this.sessionDesc.mediaDescriptions)_.attributes.candidates=this.candidates}restartICE(g){g=en(g),this.iceParameters=g,this.sessionDesc.mediaDescriptions.forEach(_=>{_.attributes.iceUfrag=g.iceUfrag,_.attributes.icePwd=g.icePwd})}predictReceivingMids(g){const _=[];for(let E=0;E<g;E++)_.push((this.currentMidIndex+E+1).toString(10));return _}mungRecvMediaDsec(g,_){const E=en(g);return Td(E,_),J0(E,_),E}updateRecvMedia(g,_){const E=this.sessionDesc.mediaDescriptions.findIndex(T=>T.attributes.mid===g);if(E!==-1){const T=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[E],_);this.sessionDesc.mediaDescriptions[E]=T}}bumpMid(g){this.currentMidIndex+=g}updateTrackLabel(g,_,E){const T=this.sessionDesc.mediaDescriptions.find(A=>g===Fe.VIDEO?A.attributes.mid==="video":A.attributes.mid==="audio");if(T){const A=T.attributes.ssrcs.find(L=>L.attributes.label===_);var w;A&&(A.attributes.label=E,(w=A.attributes.msid)===null||w===void 0||w.replace(_,E))}}mungMediaDesc(g){const _=en(g);return q0(_),function(E){const T=E.attributes.extmaps.find(w=>w.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");T&&E.attributes.extmaps.splice(E.attributes.extmaps.indexOf(T),1),E.attributes.payloads.forEach(w=>{const A=w.rtcpFeedbacks.findIndex(L=>L.type==="transport-cc");A!==-1&&w.rtcpFeedbacks.splice(A,1)})}(_),_}getSSRC(g){for(const _ of this.sessionDesc.mediaDescriptions)for(const E of _.attributes.ssrcs)if(E.attributes.label===g)return[E]}}({remoteIceParameters:n,remoteDtlsParameters:r,candidates:s,remoteRTPCapabilities:c.send,remoteSetup:d,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:h});const f=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(f){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(f.toString()))}}async updateRemoteRTPCapabilities(n,r){throw new he(B.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}send(n,r){var s=this;return Co(function*(){const c=yield ut(s.mutex.lock());try{if(!s.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const d=n.map(w=>s.peerConnection.addTrack(w._mediaStreamTrack)),h=yield ut(s.peerConnection.createOffer()),f=gn.parse(h.sdp),g=n.map(w=>{const A=w._mediaStreamTrack,L=f.mediaDescriptions.find(P=>P.attributes.mid===A.kind);if(!L)throw new Error("Cannot extract ssrc from mediaDescription.");return function(P,D,G){const $=P.attributes.ssrcs.filter(ie=>ie.attributes.label===D),X=P.attributes.ssrcGroups;if($.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(X&&$.length>1){const ie=X.find(Q=>Q.ssrcIds.indexOf($[0].ssrcId)!==-1);return ie?[{ssrcId:ie.ssrcIds[0],rtx:G?ie.ssrcIds[1]:void 0}]:[{ssrcId:$[0].ssrcId}]}return[{ssrcId:$[0].ssrcId}]}(L,A.id,s.useRTX)});let _;try{_=yield g}catch(w){throw d.forEach(A=>{Fr()&&A.replaceTrack(null),s.peerConnection.removeTrack(A)}),w}const E=s.mungSendOfferSDP(h.sdp,n);s.remoteSDP.receive(n,r,_);const T=s.remoteSDP.toString();return yield ut(s.peerConnection.setLocalDescription({type:"offer",sdp:E})),yield ut(s.applySendEncodings(d,n)),yield ut(s.peerConnection.setRemoteDescription({type:"answer",sdp:T})),n.map((w,A)=>{const L=w._mediaStreamTrack.id;return{localSSRC:g[A],id:L}})}catch(d){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(d.toString()))}finally{c()}})()}async stopSending(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const r=this.peerConnection.getSenders().filter(d=>{var h;return n.indexOf(((h=d.track)===null||h===void 0?void 0:h.id)||"")!==-1});if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");r.map(d=>{Fr()&&d.replaceTrack(null),this.peerConnection.removeTrack(d)});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s),this.remoteSDP.stopReceiving(n);const c=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:c})}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(r.toString()))}}async receive(n,r,s,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(n," before remoteSDP created."));const{id:d,mslabel:h}=this.remoteSDP.send(n,r,c),f=new ae((E,T)=>{const w=setTimeout(()=>{T(new Error("Cannot receive track, id: ".concat(d)))},1e4),A=L=>{const P=xt();if((P.name==="Safari"&&Number(P.version)===11||Ti())&&L.track.id!==d&&L.streams[0].id===h){var D;const G=L.streams[0].getTracks()[0];return(D=this.remoteSDP)===null||D===void 0||D.updateTrackLabel(n,d,L.track.id),this.peerConnection.removeEventListener("track",A),clearTimeout(w),void E(G)}if(L.track.id===d)return this.peerConnection.removeEventListener("track",A),clearTimeout(w),void E(L.track)};this.peerConnection.addEventListener("track",A)}),g=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const _=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(_),{track:await f,id:d}}catch(d){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(d.toString()))}}async stopReceiving(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(n);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const s=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(s)}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(n){}async unmuteRemote(n){}async muteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(s=>{var c;return n.indexOf(((c=s.track)===null||c===void 0?void 0:c.id)||"")!==-1});if(r.length!==n.length)throw new Error("sender' length doesn't match mids' length.");r.map(s=>{if(Fr()&&s.track)s.track.enabled=!1;else{const c=s.getParameters();c.encodings.forEach(d=>d.active=!1),s.setParameters(c)}})}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(d=>{var h;return n.indexOf(((h=d.track)===null||h===void 0?void 0:h.id)||"")!==-1});if(r.length!==n.length)throw new Error("Senders' length doesn't match mids' length.");r.map(async d=>{if(Fr()&&d.track)d.track.enabled=!0;else{const h=d.getParameters();h.encodings.forEach(f=>f.active=!0),await d.setParameters(h)}});const s=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(s);const c=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:c})}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(n){var r=this;return Co(function*(){const s=yield ut(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Lt().supportPCSetConfiguration){const g=r.peerConnection.getConfiguration(),_=n===Qr.RELAY?"relay":"all";g.iceTransportPolicy!==_&&(O.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(g.iceTransportPolicy,"] to [").concat(_,"]")),g.iceTransportPolicy=_,r.peerConnection.setConfiguration(g))}else if(n===Qr.RELAY)return;n!==Qr.RELAY&&r.remoteSDP.updateCandidates(n);const c=yield ut(r.peerConnection.createOffer({iceRestart:!0}));if(!c.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const d=ka(c.sdp),{remoteIceParameters:h}=yield d.iceParameters;r.remoteSDP.restartICE(h);const f=r.remoteSDP.toString();yield ut(r.peerConnection.setLocalDescription(c)),yield ut(r.peerConnection.setRemoteDescription({type:"answer",sdp:f}))}catch(c){O.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),c)}finally{s()}})()}close(){var n;this.peerConnection.close(),(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(n){return this.statsFilter.getVideoIsReady(n)}async updateEncoderConfig(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(s.sdp,[r]);this.remoteSDP.updateRecvMedia(r._mediaStreamTrack.kind,r);const d=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(s){throw new he(B.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(n,r){const s=this.peerConnection.getSenders().filter(c=>{var d;return((d=c.track)===null||d===void 0?void 0:d.id)===n});s.length===1&&await this.applySendEncodings(s,[r])}setStatsRemoteVideoIsReady(n,r){this.statsFilter.setVideoIsReady2(n,r)}async replaceTrack(n,r){const s=this.peerConnection.getSenders().find(c=>{var d;return((d=c.track)===null||d===void 0?void 0:d.id)===r});s&&await s.replaceTrack(n._mediaStreamTrack)}createDataChannels(n,r){throw new he(B.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(n){throw new he(B.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var n;(n=this.onICEConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=n=>{n.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Y("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(n){const r={iceServers:[],sdpSemantics:"plan-b"};return n.iceServers?r.iceServers=n.iceServers:n.turnServer&&n.turnServer.mode!=="off"&&(Sp(n.turnServer.servers)?r.iceServers=n.turnServer.servers:(r.iceServers&&r.iceServers.push(...xr.turnServerConfigToIceServers(n.turnServer.servers)),Y("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&n.turnServer.serversFromGateway&&r.iceServers.push(...xr.turnServerConfigToIceServers(n.turnServer.serversFromGateway)),n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(n){const r=[];return n.forEach(s=>{s.security?s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),r}async updateRtpSenderEncodings(n,r){var s;if(r||(r=this.peerConnection.getSenders().find(_=>{var E;return((E=_.track)===null||E===void 0?void 0:E.id)===n._mediaStreamTrack.id})),!r)return O.warn("[".concat(n.getTrackId(),"] no rtpSender found}"));if(!Lt().supportSetRtpSenderParameters)return O.warn("Browser not support set rtp-sender parameters");const c={},d={};if(n instanceof ht)switch(n._optimizationMode){case"motion":c.degradationPreference="maintain-framerate";break;case"detail":c.degradationPreference="maintain-resolution";break;default:c.degradationPreference="balanced"}if(Y("DSCP_TYPE")&&Zl()){var h;const _=Y("DSCP_TYPE");Le(h=["very-low","low","medium","high"]).call(h,_)&&(d.networkPriority=_)}const f=r.getParameters(),g=(s=f.encodings)===null||s===void 0?void 0:s[0];g&&Object.assign(g,d),Object.assign(f,c),O.debug("[".concat(n.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(f.encodings))),await r.setParameters(f)}async applySendEncodings(n,r){try{if(!Lt().supportSetRtpSenderParameters||n.length!==r.length)return;for(let s=0;s<n.length;s++){const c=n[s],d=r[s];c&&d&&await this.updateRtpSenderEncodings(d,c)}}catch{O.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(n,r){const s=gn.parse(n);return r.forEach((c,d)=>{const h=c._mediaStreamTrack,f=s.mediaDescriptions.find(g=>g.attributes.mid===h.kind);f&&Td(f,c)}),gn.print(s)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=n=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoReceived=n=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstAudioDecoded=n=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoDecoded=(n,r,s)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,n,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(n,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,n,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(n,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,n,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const r=this.remoteSDP.batchSend(n).map((d,h)=>{let{id:f,mslabel:g}=d;const{kind:_}=n[h];return new ae((E,T)=>{const w=setTimeout(()=>{T(new Error("Cannot receive track, id: ".concat(f)))},1e4),A=L=>{const P=xt();if(P.name==="Safari"&&Number(P.version)===11&&L.track.id!==f&&L.streams[0].id===g){var D;const G=L.streams[0].getTracks()[0];return(D=this.remoteSDP)===null||D===void 0||D.updateTrackLabel(_,f,L.track.id),this.peerConnection.removeEventListener("track",A),clearTimeout(w),void E({track:G,id:f})}if(L.track.id===f)return this.peerConnection.removeEventListener("track",A),clearTimeout(w),void E({track:L.track,id:f})};this.peerConnection.addEventListener("track",A)})}),s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const c=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(c),await ae.all(r)}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async getRemoteSSRC(n){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(n);return r==null?void 0:r[0].ssrcId}setConfiguration(n){if(Lt().supportPCSetConfiguration){const r=xr.resolvePCConfiguration(n);this.peerConnection.setConfiguration(r)}}}function bs(o,n,r){const s=o[n];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,d=await c.lock("Locking from P2PConnection.".concat(n));try{for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return await s.apply(this,f)}finally{d()}},r}function p4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function wd(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?p4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):p4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}fe([bs,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",ae)],xr.prototype,"connect",null),fe([bs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],xr.prototype,"stopSending",null),fe([bs,j("design:type",Function),j("design:paramtypes",[String,Array,String,Object]),j("design:returntype",ae)],xr.prototype,"receive",null),fe([bs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],xr.prototype,"stopReceiving",null),fe([bs,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],xr.prototype,"muteRemote",null),fe([bs,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],xr.prototype,"unmuteRemote",null),fe([bs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],xr.prototype,"muteLocal",null),fe([bs,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],xr.prototype,"unmuteLocal",null),fe([bs,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],xr.prototype,"close",null),fe([bs,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],xr.prototype,"updateEncoderConfig",null),fe([bs,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],xr.prototype,"updateSendParameters",null),fe([bs,j("design:type",Function),j("design:paramtypes",[Zr,String]),j("design:returntype",ae)],xr.prototype,"replaceTrack",null),fe([bs,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],xr.prototype,"getRemoteSSRC",null);const u_="9",f4=4e4;function m4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function nf(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?m4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):m4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class kn extends o0{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var n,r;return(n=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&n!==void 0?n:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(n=>n.rtpMap&&n.rtpMap.encodingName.toLowerCase()||"").filter(n=>{var r;return Le(r=Object.keys(nd)).call(r,n)}))]}constructor(n,r){super(n,r),I(this,"store",void 0),I(this,"peerConnection",void 0),I(this,"remoteSDP",void 0),I(this,"initialOffer",void 0),I(this,"transportEventReceiver",void 0),I(this,"statsFilter",void 0),I(this,"useXR",Y("USE_XR")),I(this,"localCapabilities",void 0),I(this,"remoteCodecs",void 0),I(this,"localCandidateCount",0),I(this,"allCandidatesReceived",!1),I(this,"dataStreamChannelMap",new Map),I(this,"establishPromise",void 0),I(this,"recoveredDataChannelIds",[]),I(this,"currentDataChannelId",1),I(this,"mutex",new Pr("P2PConnection-mutex")),this.store=r,this.peerConnection=new RTCPeerConnection(kn.resolvePCConfiguration(n),{optional:[{googDscp:!0}]}),this.statsFilter=Y0(this.peerConnection,Y("STATS_UPDATE_INTERVAL"),void 0,Jt()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async updateRemoteRTPCapabilities(n,r){if(this.remoteCodecs=r,!this.remoteSDP)return void O.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(r));if(this.remoteSDP.updateRemoteCodec(n,r,this.store.codec)){const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s);const d=this.remoteSDP.toString();c==null||c(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}else O.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const n=await this.peerConnection.createOffer();if(!n.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const r=ka(n.sdp),s=await E1({filterRTX:!Y("USE_PUB_RTX")&&!Y("USE_SUB_RTX"),filterVideoFec:Y("FILTER_VIDEO_FEC"),filterAudioFec:Y("FILTER_AUDIO_FEC"),filterVideoCodec:Y("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=ef(s),this.initialOffer=n,nf(nf({},r),{},{rtpCapabilities:s,offerSDP:n.sdp})}catch(n){throw new he(B.GET_LOCAL_CONNECTION_PARAMS_FAILED,n.toString())}}async connect(n,r,s,c,d,h){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{get localCapabilities(){return en(this._localCapabilities)}get rtpCapabilities(){return en(this._rtpCapabilities)}get candidates(){return en(this._candidates)}get iceParameters(){return en(this._iceParameters)}get dtlsParameters(){return en(this._dtlsParameters)}constructor(A){I(this,"sessionDesc",void 0),I(this,"_localCapabilities",void 0),I(this,"_rtpCapabilities",void 0),I(this,"_candidates",void 0),I(this,"_iceParameters",void 0),I(this,"_dtlsParameters",void 0),I(this,"setup",void 0),I(this,"currentMidIndex",void 0),I(this,"cname",void 0),I(this,"firefoxSsrcMidMap",new Map),A=en(A);const{remoteIceParameters:L,remoteDtlsParameters:P,candidates:D,remoteRTPCapabilities:G,remoteSetup:$,localCapabilities:X,cname:ie}=A,Q=gn.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=G,this._candidates=D,this._iceParameters=L,this._dtlsParameters=P,this._localCapabilities=X,this.setup=$,this.cname=ie;const te=this.rtpCapabilities.send;for(const ce of Q.mediaDescriptions){if(ce.attributes.iceUfrag=L.iceUfrag,ce.attributes.icePwd=L.icePwd,ce.attributes.fingerprints=P.fingerprints,ce.attributes.candidates=D,ce.attributes.setup=$,ce.media.mediaType==="video"&&(ce.media.fmts=te.videoCodecs.map(le=>le.payloadType.toString(10)),ce.attributes.payloads=te.videoCodecs,ce.attributes.extmaps=te.videoExtensions,Y("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:le,ssrcGroups:Se}=no([{ssrcId:f4,rtx:Y("USE_SUB_RTX")?40001:void 0}],this.cname);ce.attributes.ssrcs=le,ce.attributes.ssrcGroups=Se}if(ce.media.mediaType==="audio"&&(ce.media.fmts=te.audioCodecs.map(le=>le.payloadType.toString(10)),ce.attributes.payloads=te.audioCodecs,ce.attributes.extmaps=te.audioExtensions,Da(ce),Y("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:le,ssrcGroups:Se}=no([{ssrcId:2e4}],this.cname);ce.attributes.ssrcs=le,ce.attributes.ssrcGroups=Se}}this.sessionDesc=Q,this.currentMidIndex=Q.mediaDescriptions.length-1}preloadRemoteMedia(){const A=Y("PRELOAD_MEDIA_COUNT");this.rtpCapabilities;const L=this.candidates,P=this.dtlsParameters,D=this.iceParameters,G=this.rtpCapabilities.send;for(let $=1;$<A;$++){const X=2*$+2e4,ie=2*$+f4,{ssrcs:Q,ssrcGroups:te}=no([{ssrcId:X}],this.cname),{ssrcs:ce,ssrcGroups:le}=no([{ssrcId:ie,rtx:Y("USE_SUB_RTX")?ie+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:u_,protos:["UDP","TLS","RTP","SAVPF"],fmts:G.videoCodecs.map(Se=>Se.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:D.iceUfrag,icePwd:D.icePwd,unrecognized:[],candidates:L,extmaps:G.videoExtensions,fingerprints:P.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:ce,ssrcGroups:le,rtcpFeedbackWildcards:[],payloads:G.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*$)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:u_,protos:["UDP","TLS","RTP","SAVPF"],fmts:G.audioCodecs.map(Se=>Se.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:D.iceUfrag,icePwd:D.icePwd,unrecognized:[],candidates:L,extmaps:G.audioExtensions,fingerprints:P.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:Q,ssrcGroups:te,rtcpFeedbackWildcards:[],payloads:G.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*$+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return gn.print(this.sessionDesc)}send(A,L,P,D){const{ssrcs:G,ssrcGroups:$}=no(L,this.cname,Y("SYNC_GROUP")?P:void 0),X=this.findPreloadMediaDesc(G);if(X){if(Jt()&&this.firefoxSsrcMidMap.set(G[0].ssrcId,X.attributes.mid),D&&(D.twcc||D.remb)){const ie=this.sessionDesc.mediaDescriptions.indexOf(X);return this.sessionDesc.mediaDescriptions[ie]=this.mungSendMediaDesc(X,D),{mid:X.attributes.mid,needExchangeSDP:!0}}return{mid:X.attributes.mid,needExchangeSDP:!1}}{const ie=this.findAvailableMediaIndex(A,G);let Q;return ie===-1||ie===1&&(Fr()||aj())||ie===0&&Y("USE_SUB_RTX")||cj()?(Q=this.createOrRecycleSendMedia(A,G,$,"sendonly",D),this.updateBundleMids()):(Q=en(this.sessionDesc.mediaDescriptions[ie]),Q.attributes.direction="sendonly",Q.attributes.ssrcs=G,Q.attributes.ssrcGroups=$,this.sessionDesc.mediaDescriptions[ie]=this.mungSendMediaDesc(Q,D)),Jt()&&this.firefoxSsrcMidMap.set(G[0].ssrcId,Q.attributes.mid),{mid:Q.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:A,needExchangeSDP:L}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:A.attributes.mid,needExchangeSDP:L}}batchSend(A){const L=A.map(G=>{let{kind:$,ssrcMsg:X,mslabel:ie}=G;return this.send($,X,ie)}),P=[];let D=!1;return L.forEach(G=>{let{mid:$,needExchangeSDP:X}=G;X&&(D=!0),P.push($)}),{mids:P,needExchangeSDP:D}}stopSending(A){const L=this.sessionDesc.mediaDescriptions.filter(P=>P.attributes.mid&&A.indexOf(P.attributes.mid)!==-1);if(L.length!==A.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");L.forEach(P=>{P.attributes.mid==="0"||Jt()||cj()?P.attributes.ssrcs=[]:(P.attributes.ssrcs=[],P.attributes.direction="inactive",P.media.port="0")}),this.updateBundleMids()}mute(A){const L=this.sessionDesc.mediaDescriptions.find(P=>P.attributes.mid===A);if(!L)throw new Error("mediaDescription not found with ".concat(A," in remote SDP when calling RemoteSDP.mute."));L.attributes.direction="inactive"}unmute(A){const L=this.sessionDesc.mediaDescriptions.find(P=>P.attributes.mid===A);if(!L)throw new Error("mediaDescription not found with ".concat(A," in remote SDP when calling RemoteSDP.unmute."));L.attributes.direction="sendonly"}muteRemote(A){const L=this.sessionDesc.mediaDescriptions.filter(P=>Le(A).call(A,P.attributes.mid||""));if(L.length!==A.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");L.forEach(P=>{P.attributes.direction="inactive"})}unmuteRemote(A){const L=this.sessionDesc.mediaDescriptions.filter(P=>Le(A).call(A,P.attributes.mid||""));if(L.length!==A.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");L.forEach(P=>{P.attributes.direction="recvonly"})}receive(A,L,P,D){A.forEach((G,$)=>{this.createOrRecycleRecvMedia(G,[],"recvonly",L,P,D[$])}),this.updateBundleMids()}stopReceiving(A){const L=this.sessionDesc.mediaDescriptions.filter(P=>A.indexOf(P.attributes.mid)!==-1);if(L.length!==A.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");L.forEach(P=>{P.media.port="0",P.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(A){const L=this._candidates.filter(P=>P.transport==="udp");if(A===Qr.TCP){if(L.length===0)return;if(Y("TCP_CANDIDATE_ONLY")){const P=this._candidates.filter(D=>D.transport==="tcp");L.forEach(D=>{P.findIndex(G=>G.connectionAddress===D.connectionAddress)===-1&&P.push(wd(wd({},D),{},{foundation:"tcpcandidate",priority:Number(D.priority)-1+"",transport:"tcp",port:Number(D.port)+90+""}))}),this._candidates=P}else{const P=[];L.forEach(D=>{P.push(wd(wd({},D),{},{foundation:"tcpcandidate",priority:Number(D.priority)-1+"",transport:"tcp",port:Number(D.port)+90+""}))}),this._candidates=[...L,...P]}}else if(A===Qr.RELAY){if(L.length!==0)return;{const P=this._candidates.filter(D=>D.transport==="tcp");P.forEach(D=>{L.push(wd(wd({},D),{},{foundation:"udpcandidate",priority:Number(D.priority)+1+"",transport:"udp",port:Number(D.port)-90+""}))}),this._candidates=[...L,...P]}}else L.length===0?(this._candidates.filter(P=>P.transport==="tcp").forEach(P=>{L.push(wd(wd({},P),{},{foundation:"udpcandidate",priority:Number(P.priority)+1+"",transport:"udp",port:Number(P.port)-90+""}))}),this._candidates=L):this._candidates=this._candidates.filter(P=>P.transport!=="tcp");for(const P of this.sessionDesc.mediaDescriptions)P.attributes.candidates=this.candidates}restartICE(A){A=en(A),this._iceParameters=A,this.sessionDesc.mediaDescriptions.forEach(L=>{L.attributes.iceUfrag=A.iceUfrag,L.attributes.icePwd=A.icePwd})}predictReceivingMids(A){const L=[];for(let P=0;P<A;P++)L.push((this.currentMidIndex+P+1).toString(10));return L}findAvailableMediaIndex(A,L){return this.sessionDesc.mediaDescriptions.findIndex(P=>{const D=P.media.mediaType===A&&P.media.port!=="0"&&(P.attributes.direction==="sendonly"||P.attributes.direction==="sendrecv")&&P.attributes.ssrcs.length===0;if(Jt()){if(D){const G=this.firefoxSsrcMidMap.get(L[0].ssrcId);return!(G||P.attributes.mid!=="0"&&P.attributes.mid!=="1")||!(!G||G!==P.attributes.mid)}return!1}return D})}createOrRecycleDataChannel(){for(const P of this.sessionDesc.mediaDescriptions)if(P.media.mediaType==="application")return{mediaDesc:P,needExchangeSDP:!1};this.currentMidIndex+=1;const A="".concat(this.currentMidIndex),L={media:{mediaType:"application",port:u_,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(A),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(L),{mediaDesc:L,needExchangeSDP:!0}}createOrRecycleRecvMedia(A,L,P,D,G,$){const X=A._mediaStreamTrack.kind,ie=this.rtpCapabilities.recv,Q=Xu(X,ie,this.localCapabilities.send,X===Fe.VIDEO?D:G),te=X===Fe.VIDEO?ie.videoExtensions:ie.audioExtensions;this.currentMidIndex+=1;const ce="".concat(this.currentMidIndex);let le={media:{mediaType:X,port:u_,protos:["UDP","TLS","RTP","SAVPF"],fmts:Q.map(Ae=>Ae.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:te,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:L,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:Q,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:P,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(ce)}};le=this.mungRecvMediaDsec(le,A,$);const Se=this.findFirstClosedMedia(X);if(Se){const Ae=this.sessionDesc.mediaDescriptions.indexOf(Se);this.sessionDesc.mediaDescriptions[Ae]=le}else this.sessionDesc.mediaDescriptions.push(le);return le}updateRemoteCodec(A,L,P){const D=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(le=>le.rtpMap&&le.rtpMap.encodingName.toLowerCase()||"").filter(le=>{var Se;return Le(Se=Object.keys(nd)).call(Se,le)}))],G=new Set(L);if(D.every(le=>G.has(le)))return O.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(L)),!1;const $=this._rtpCapabilities.recv.videoCodecs.filter(le=>L.some(Se=>{var Ae;return Le(Ae=le.rtpMap&&le.rtpMap.encodingName.toLowerCase()||"").call(Ae,Se)}));if($.length===0)return O.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(D," codecs: ").concat(L)),!1;const X=[...new Set($.map(le=>le.rtpMap&&le.rtpMap.encodingName.toLowerCase()||""))];let ie;if(O.debug("updateRemoteCodec, from ".concat(D," to ").concat(X)),A.length===0)ie=this.sessionDesc.mediaDescriptions.filter(le=>le.media.mediaType==="video"&&le.attributes.direction==="recvonly");else if(ie=this.sessionDesc.mediaDescriptions.filter(le=>le.attributes.mid&&Le(A).call(A,le.attributes.mid)&&le.attributes.direction==="recvonly"),ie.length!==A.length)return O.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(A,", codecs: ").concat(L)),!1;this._rtpCapabilities.recv.videoCodecs=$;const Q=this.localCapabilities.send,te=this.rtpCapabilities.recv,ce=Xu(Fe.VIDEO,te,Q,P);return ie.forEach(le=>{const Se=ce.map(Ae=>Ae.payloadType.toString(10));O.debug("updateRemoteCodec mid: ".concat(le.attributes.mid,", from ").concat(le.attributes.payloads," to ").concat(ce)),le.attributes.payloads=ce,le.media.fmts=Se}),!0}createOrRecycleSendMedia(A,L,P,D,G){const $=this.rtpCapabilities.send,X=A===Fe.VIDEO?$.videoCodecs:$.audioCodecs,ie=A===Fe.VIDEO?$.videoExtensions:$.audioExtensions;this.currentMidIndex+=1;const Q="".concat(this.currentMidIndex);let te={media:{mediaType:A,port:u_,protos:["UDP","TLS","RTP","SAVPF"],fmts:X.map(le=>le.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:ie,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:L,ssrcGroups:P,rtcpFeedbackWildcards:[],payloads:X,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:D,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(Q)}};te=this.mungSendMediaDesc(te,G);const ce=this.findFirstClosedMedia(A);if(ce){const le=this.sessionDesc.mediaDescriptions.indexOf(ce);this.sessionDesc.mediaDescriptions[le]=te}else this.sessionDesc.mediaDescriptions.push(te);return te}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(A=>A.media.port!=="0").map(A=>A.attributes.mid)}mungRecvMediaDsec(A,L,P){const D=en(A);return q0(D),Td(D,L),J0(D,L),_1(D),Zp(D,P,this.localCapabilities.send),D}mungSendMediaDesc(A,L){const P=en(A);return Zp(P,L,this.localCapabilities.recv),Da(P),P}updateRecvMedia(A,L){const P=this.sessionDesc.mediaDescriptions.findIndex(D=>D.attributes.mid===A);if(P!==-1){const D=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[P],L);this.sessionDesc.mediaDescriptions[P]=D}}bumpMid(A){this.currentMidIndex+=A}findFirstClosedMedia(A){return this.sessionDesc.mediaDescriptions.find(L=>Jt()?L.media.port==="0"&&L.media.mediaType===A:L.media.port==="0")}findPreloadMediaDesc(A){return this.sessionDesc.mediaDescriptions.find(L=>{var P;return((P=L.attributes)===null||P===void 0||(P=P.ssrcs[0])===null||P===void 0?void 0:P.ssrcId)===A[0].ssrcId})}getSSRC(A){var L;return(L=this.sessionDesc.mediaDescriptions.find(P=>P.attributes.mid===A))===null||L===void 0?void 0:L.attributes.ssrcs}}({remoteIceParameters:n,remoteDtlsParameters:r,candidates:s,remoteRTPCapabilities:c,remoteSetup:d,localCapabilities:this.localCapabilities,cname:h}),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const f=this.remoteSDP.toString(),g=gn.parse(this.initialOffer.sdp),_=g.mediaDescriptions.find(A=>A.media.mediaType==="audio");_&&Da(_),this.useXR&&a_(g);const E=gn.print(g),T=this.logSDPExchange(E||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:E}),T==null||T(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f});const w=this.peerConnection.getTransceivers()[0];if(w!=null&&w.receiver&&this.tryBindTransportEvents(w.receiver),Y("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const A=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:A});const L=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(L)}}catch(f){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(f.toString()))}}send(n,r,s){var c=this;return Co(function*(){const d=yield ut(c.mutex.lock("From P2PConnection.send"));try{if(!c.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const h=[];n.forEach(P=>{const D=c.peerConnection.addTransceiver(P._mediaStreamTrack,{direction:"sendonly"});h.push(D),P._updateRtpTransceiver(D)}),Jt()&&Y("SIMULCAST")===!0&&(yield ut(c.applySimulcastForFirefox(h,n)));const f=yield ut(c.peerConnection.createOffer()),g=c.remoteSDP.predictReceivingMids(n.length),_=c.mungSendOfferSDP(f.sdp,n,g),E=gn.parse(_),T=g.map(P=>{const D=E.mediaDescriptions.find(G=>G.attributes.mid===P);if(!D)throw new Error("Cannot extract ssrc from mediaDescription.");return g1(D,Y("USE_PUB_RTX"))});let w;try{w=yield T}catch(P){w=[],c.remoteSDP.receive(n,r,s,w);const D=c.remoteSDP.toString();throw yield ut(c.peerConnection.setLocalDescription({type:"offer",sdp:_})),yield ut(c.peerConnection.setRemoteDescription({type:"answer",sdp:D})),yield ut(c.stopSending(g,!0)),P}c.remoteSDP.receive(n,r,s,w);const A=c.remoteSDP.toString(),L=c.logSDPExchange(_,"offer","local","send");return yield ut(c.peerConnection.setLocalDescription({type:"offer",sdp:_})),yield ut(c.applySimulcastEncodings(h,n)),yield ut(c.applySendEncodings(h,n)),L==null||L(A),yield ut(c.peerConnection.setRemoteDescription({type:"answer",sdp:A})),h.map((P,D)=>{const G=g[D];return{localSSRC:T[D],id:G,transceiver:P}})}catch(h){throw h instanceof he?h:new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(h.toString()))}finally{d()}})()}async createDataChannels(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let s=this.dataStreamChannelMap.get(n);if(s&&s.readyState==="open")O.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const d=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof d!="number")throw new Error("create DataChannel error, because cannot get dc id");s=this.peerConnection.createDataChannel("datastream-channel",{id:d,negotiated:!0,ordered:!1,maxRetransmits:Y("DATASTREAM_MAX_RETRANSMITS")}),s.binaryType="arraybuffer",this.dataStreamChannelMap.set(n,s)}r.forEach(d=>{d._updateOriginDataChannel(s)});const{needExchangeSDP:c}=this.remoteSDP.sendDataChannel();if(c){const d=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:d});const h=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(h),O.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else O.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(s){throw s instanceof he?s:new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(s.toString()))}}async stopDataChannels(n){try{const r=this.dataStreamChannelMap.get(n);return r&&(r.id&&this.recoveredDataChannelIds.push(r.id),r.close()),void this.dataStreamChannelMap.delete(n)}catch(r){throw r instanceof he?r:new he(B.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(r.toString()))}}async stopSending(n,r){const s=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const c=this.peerConnection.getTransceivers().filter(g=>n.indexOf(g.mid)!==-1);if(c.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");c.map(g=>{var _;g.direction="inactive",(_=g.stop)===null||_===void 0||_.call(g)});const d=await this.peerConnection.createOffer(),h=this.logSDPExchange(d.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(d),this.remoteSDP.stopReceiving(n);const f=this.remoteSDP.toString();h==null||h(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(c){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(c.toString()))}finally{s&&s()}}async receive(n,r,s,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(n," before remoteSDP created."));const{mid:d,needExchangeSDP:h}=this.remoteSDP.send(n,r,s,c);if(h){const g=this.remoteSDP.toString(),_=this.logSDPExchange(g,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const E=await this.peerConnection.createAnswer(),T=this.mungReceiveAnswerSDP(E.sdp,d,n);_==null||_(T||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:T}),O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," by exchanging SDP."))}else O.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," no need to exchange SDP."));const f=this.peerConnection.getTransceivers().find(g=>g.mid===d);if(!f)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,id:d,transceiver:f}}catch(d){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(d.toString()))}}async batchReceive(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:r,needExchangeSDP:s}=this.remoteSDP.batchSend(n);if(s){const c=this.remoteSDP.toString(),d=this.logSDPExchange(c,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:c});const h=await this.peerConnection.createAnswer();d==null||d(h.sdp||""),await this.peerConnection.setLocalDescription(h),O.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))}else O.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive no need to exchange SDP."));return r.map(c=>{const d=this.peerConnection.getTransceivers().find(h=>h.mid===c);if(!d)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:d.receiver.track,id:c,transceiver:d}})}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async stopReceiving(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(n);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(n," before remote SDP created."));this.remoteSDP.mute(n);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(r.toString()))}}async unmuteRemote(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(n," before remote SDP created."));this.remoteSDP.unmute(n);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(r.toString()))}}async muteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&n.indexOf(h.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(h=>{h.direction="inactive"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(n);const d=this.remoteSDP.toString();c==null||c(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&n.indexOf(h.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async(h,f)=>{h.direction="sendonly"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(n);const d=this.remoteSDP.toString();c==null||c(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(r){throw new he(B.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(n){var r=this;return Co(function*(){const s=yield ut(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Lt().supportPCSetConfiguration){const _=r.peerConnection.getConfiguration(),E=n===Qr.RELAY?"relay":"all";_.iceTransportPolicy!==E&&(O.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(_.iceTransportPolicy,"] to [").concat(E,"]")),_.iceTransportPolicy=E,r.peerConnection.setConfiguration(_))}else if(n===Qr.RELAY)return;r.remoteSDP.updateCandidates(n);const c=yield ut(r.peerConnection.createOffer({iceRestart:!0}));if(!c.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const d=ka(c.sdp),{remoteIceParameters:h}=yield d.iceParameters;r.remoteSDP.restartICE(h);const f=r.remoteSDP.toString(),g=r.logSDPExchange(c.sdp||"","offer","local","restartICE");r.store.descriptionStart(),yield ut(r.peerConnection.setLocalDescription(c)),g==null||g(f),yield ut(r.peerConnection.setRemoteDescription({type:"answer",sdp:f}))}catch(c){O.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),c)}finally{s()}})()}close(){var n;this.peerConnection.close(),(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(n){return this.statsFilter.getVideoIsReady(n)}async updateEncoderConfig(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(s.sdp,[r],[n]);this.remoteSDP.updateRecvMedia(n,r);const d=this.remoteSDP.toString(),h=this.logSDPExchange(c,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),h==null||h(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(s){throw new he(B.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(n,r){const s=this.peerConnection.getTransceivers().filter(c=>c.mid===n);s.length===1&&(this.isVP8Simulcast(r)?Jt()||await this.applySimulcastEncodings(s,[r]):await this.applySendEncodings(s,[r]))}setStatsRemoteVideoIsReady(n,r){this.statsFilter.setVideoIsReady2(n,r)}async replaceTrack(n,r){const s=this.peerConnection.getTransceivers().find(c=>c.mid===r);s&&await s.sender.replaceTrack(n._mediaStreamTrack)}async getSelectedCandidatePair(){const n=this.peerConnection.getReceivers();if(n.length>0&&n[0].transport&&n[0].transport.iceTransport&&n[0].transport.iceTransport.getSelectedCandidatePair&&n[0].transport.iceTransport.getSelectedCandidatePair()){const r=n[0].transport.iceTransport,{local:s,remote:c}=r.getSelectedCandidatePair();return{local:nf(nf({},hc),{},{candidateType:s.type,protocol:s.protocol,address:s.address,port:s.port}),remote:nf(nf({},hc),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var n;(n=this.onICEConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=n=>{n.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,O.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Y("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(n){const r={iceServers:[]};return n.iceServers?r.iceServers=n.iceServers:n.turnServer&&n.turnServer.mode!=="off"&&(Sp(n.turnServer.servers)?r.iceServers=n.turnServer.servers:(r.iceServers&&r.iceServers.push(...kn.turnServerConfigToIceServers(n.turnServer.servers)),Y("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&n.turnServer.serversFromGateway&&r.iceServers.push(...kn.turnServerConfigToIceServers(n.turnServer.serversFromGateway)),Y("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(r.iceTransportPolicy="relay")}))),Y("ENABLE_ENCODED_TRANSFORM")&&Lt().supportWebRTCEncodedTransform&&(r.encodedInsertableStreams=!0),r}static turnServerConfigToIceServers(n){const r=[];return n.forEach(s=>{s.security?s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(cd(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!Y("FORCE_TURN_TCP")&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),r}tryBindTransportEvents(n){const r=n.transport;if(r){this.transportEventReceiver=n,r.onstatechange=()=>{var c;r!=null&&r.state&&((c=this.onDTLSTransportStateChange)===null||c===void 0||c.call(this,r.state))},r.onerror=c=>{var d;(d=this.onDTLSTransportError)===null||d===void 0||d.call(this,"error"in c?c.error:c)};const s=r.iceTransport;s&&(s.onstatechange=()=>{const c=r==null?void 0:r.iceTransport.state;var d;c&&((d=this.onICETransportStateChange)===null||d===void 0||d.call(this,c))},s.getSelectedCandidatePair&&(s.onselectedcandidatepairchange=()=>{if(s.getSelectedCandidatePair()){const{local:c,remote:d}=s.getSelectedCandidatePair();O.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:c.type,protocol:c.protocol}),", remote ").concat(JSON.stringify({candidateType:d.type,protocol:d.protocol,address:d.address,port:d.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(n,r){var s;if(r||(r=this.peerConnection.getSenders().find(E=>E.track===n._mediaStreamTrack)),!r)return O.warn("[".concat(n.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(n))return O.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Lt().supportSetRtpSenderParameters)return O.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const c={},d={};switch(n._optimizationMode){case"motion":c.degradationPreference="maintain-framerate";break;case"detail":c.degradationPreference="maintain-resolution";break;default:c.degradationPreference="balanced"}if(n._encoderConfig){var h;const{bitrateMax:E,frameRate:T,scaleResolutionDownBy:w}=n._encoderConfig;E&&(d.maxBitrate=1e3*E),(Le(h=n._hints).call(h,tn.LOW_STREAM)||n.isUseScaleResolutionDownBy)&&(T&&(d.maxFramerate=Wo(T)),w&&w>=1&&(d.scaleResolutionDownBy=w))}if(Y("DSCP_TYPE")&&Zl()){var f;const E=Y("DSCP_TYPE");Le(f=["very-low","low","medium","high"]).call(f,E)&&(d.networkPriority=E)}const g=r.getParameters(),_=(s=g.encodings)===null||s===void 0?void 0:s[0];Jt()&&!_&&(c.encodings=[d]),_&&Object.assign(_,d),Object.assign(g,c),O.debug("[".concat(n.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(g.encodings))),await r.setParameters(g)}async applySendEncodings(n,r){try{if(!Lt().supportSetRtpSenderParameters||n.length!==r.length)return;for(let s=0;s<n.length;s++){const c=n[s],d=r[s];d instanceof ht&&!this.isVP8Simulcast(d)&&await this.updateRtpSenderEncodings(d,c.sender)}}catch{O.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(n,r,s){const c=gn.parse(n);return r.forEach((d,h)=>{const f=s[h],g=c.mediaDescriptions.find(_=>_.attributes.mid===f);g&&(Td(g,d),v1(g,d,this.store.codec))}),gn.print(c)}mungReceiveAnswerSDP(n,r,s){const c=gn.parse(n),d=c.mediaDescriptions.find(h=>h.attributes.mid===r);return d&&(s===Fe.AUDIO&&d.media.mediaType==="audio"&&Da(d),this.useXR&&a_(c)),gn.print(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=n=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoReceived=n=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstAudioDecoded=n=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoDecoded=(n,r,s)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,n,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(n,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,n,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(n,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,n,r)},this.statsFilter.onFirstVideoDecodedTimeout=n=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,n)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(n,r){if(n.length===r.length)for(let g=0;g<n.length;g++){var s,c,d,h,f;const _=n[g],E=r[g];if(E instanceof ht&&!Le(s=E._hints).call(s,tn.LOW_STREAM)&&(c=E._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((d=E._encoderConfig)===null||d===void 0?void 0:d.bitrateMax)>200&&(h=E._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((f=E._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1&&this.store.codec==="vp8"){const T={},w={high:1e3*(E._encoderConfig.bitrateMax-50),medium:5e4};T.encodings=[{rid:"m",active:!0,maxBitrate:w.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:w.high}];const A=_.sender.getParameters();await _.sender.setParameters(Object.assign(A,T))}}}async applySimulcastEncodings(n,r){if(!Jt()&&n.length===r.length)for(let s=0;s<n.length;s++){const c=r[s];if(c instanceof ht&&this.isVP8Simulcast(c)){const d=n[s],h={},f={high:1e3*(c._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:f.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:f.medium,scaleResolutionDownBy:4}];const g=d.sender.getParameters();await d.sender.setParameters(Object.assign(g,h))}}}isVP8Simulcast(n){var r,s,c,d,h;return!!(n instanceof ht&&Y("SIMULCAST")&&this.store.codec==="vp8"&&!Le(r=n._hints).call(r,tn.LOW_STREAM)&&(s=n._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((c=n._encoderConfig)===null||c===void 0?void 0:c.bitrateMax)>200&&(d=n._scalabilityMode)!==null&&d!==void 0&&d.numSpatialLayers&&((h=n._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(n,r,s,c){if(Y("SDP_LOGGING"))return O.upload("[".concat(this.store.clientId,"] exchanging ").concat(s," ").concat(r," SDP during P2PConnection.").concat(c,`
`),n),r==="offer"?d=>{this.logSDPExchange(d,"answer",s==="local"?"remote":"local",c)}:void 0}async getRemoteSSRC(n){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(n);return r==null?void 0:r[0].ssrcId}setConfiguration(n){if(Lt().supportPCSetConfiguration){const r=kn.resolvePCConfiguration(n);this.peerConnection.setConfiguration(r)}}}function wo(o,n,r){const s=o[n];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,d=await c.lock("From P2PConnection.".concat(n));try{for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return await s.apply(this,f)}finally{d()}},r}function g4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function _4(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?g4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):g4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}fe([wo,j("design:type",Function),j("design:paramtypes",[Array,Array]),j("design:returntype",ae)],kn.prototype,"updateRemoteRTPCapabilities",null),fe([wo,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",ae)],kn.prototype,"connect",null),fe([wo,j("design:type",Function),j("design:paramtypes",[Object,Array]),j("design:returntype",ae)],kn.prototype,"createDataChannels",null),fe([wo,j("design:type",Function),j("design:paramtypes",[String,Array,String,Object]),j("design:returntype",ae)],kn.prototype,"receive",null),fe([wo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],kn.prototype,"batchReceive",null),fe([wo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],kn.prototype,"stopReceiving",null),fe([wo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],kn.prototype,"muteRemote",null),fe([wo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],kn.prototype,"unmuteRemote",null),fe([wo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],kn.prototype,"muteLocal",null),fe([wo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],kn.prototype,"unmuteLocal",null),fe([wo,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],kn.prototype,"close",null),fe([wo,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],kn.prototype,"updateEncoderConfig",null),fe([wo,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],kn.prototype,"updateSendParameters",null),fe([wo,j("design:type",Function),j("design:paramtypes",[Zr,String]),j("design:returntype",ae)],kn.prototype,"replaceTrack",null),fe([wo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],kn.prototype,"getRemoteSSRC",null);const v4=`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0
a=msid-semantic: WMS
a=ice-lite
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 127.0.0.1
a=mid:0
`,eS="9",w1=2e4,R1=4e4;class Oce{get localCapabilities(){return en(this._localCapabilities)}get rtpCapabilities(){return en(this._rtpCapabilities)}get candidates(){return en(this._candidates)}get iceParameters(){return en(this._iceParameters)}get dtlsParameters(){return en(this._dtlsParameters)}constructor(n){I(this,"sessionDesc",void 0),I(this,"_localCapabilities",void 0),I(this,"_rtpCapabilities",void 0),I(this,"_candidates",void 0),I(this,"_iceParameters",void 0),I(this,"_dtlsParameters",void 0),I(this,"setup",void 0),I(this,"currentMidIndex",void 0),I(this,"cname",void 0),I(this,"firefoxSsrcMidMap",new Map),n=en(n);const{remoteIceParameters:r,remoteDtlsParameters:s,candidates:c,remoteRTPCapabilities:d,remoteSetup:h,localCapabilities:f,cname:g}=n,_=gn.parse(v4);this._rtpCapabilities=d,this._candidates=c,this._iceParameters=r,this._dtlsParameters=s,this._localCapabilities=f,this.setup=h,this.cname=g;const E=this.rtpCapabilities.send;for(const T of _.mediaDescriptions){if(T.attributes.iceUfrag=r.iceUfrag,T.attributes.icePwd=r.icePwd,T.attributes.fingerprints=s.fingerprints,T.attributes.candidates=c,T.attributes.setup=h,T.media.mediaType==="application"&&(T.attributes.sctpPort="5000"),T.media.mediaType==="video"&&(T.media.fmts=E.videoCodecs.map(w=>w.payloadType.toString(10)),T.attributes.payloads=E.videoCodecs,T.attributes.extmaps=E.videoExtensions,Y("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:w,ssrcGroups:A}=no([{ssrcId:R1,rtx:Y("USE_SUB_RTX")?40001:void 0}],this.cname);T.attributes.ssrcs=w,T.attributes.ssrcGroups=A}if(T.media.mediaType==="audio"&&(T.media.fmts=E.audioCodecs.map(w=>w.payloadType.toString(10)),T.attributes.payloads=E.audioCodecs,T.attributes.extmaps=E.audioExtensions,Da(T),Y("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:w,ssrcGroups:A}=no([{ssrcId:w1}],this.cname);T.attributes.ssrcs=w,T.attributes.ssrcGroups=A}}this.sessionDesc=_,this.currentMidIndex=_.mediaDescriptions.length-1}updateRemoteRTPCapabilities(n){const r=gn.parse(v4);this._rtpCapabilities=n;const s=this.rtpCapabilities.send;for(const c of r.mediaDescriptions){if(c.attributes.iceUfrag=this._iceParameters.iceUfrag,c.attributes.icePwd=this._iceParameters.icePwd,c.attributes.fingerprints=this._dtlsParameters.fingerprints,c.attributes.candidates=this._candidates,c.attributes.setup=this.setup,c.media.mediaType==="application"&&(c.attributes.sctpPort="5000"),c.media.mediaType==="video"&&(c.media.fmts=s.videoCodecs.map(d=>d.payloadType.toString(10)),c.attributes.payloads=s.videoCodecs,c.attributes.extmaps=s.videoExtensions,Y("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:d,ssrcGroups:h}=no([{ssrcId:R1,rtx:Y("USE_SUB_RTX")?40001:void 0}],this.cname);c.attributes.ssrcs=d,c.attributes.ssrcGroups=h}if(c.media.mediaType==="audio"&&(c.media.fmts=s.audioCodecs.map(d=>d.payloadType.toString(10)),c.attributes.payloads=s.audioCodecs,c.attributes.extmaps=s.audioExtensions,Y("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:d,ssrcGroups:h}=no([{ssrcId:w1}],this.cname);c.attributes.ssrcs=d,c.attributes.ssrcGroups=h}}this.sessionDesc=r,this.currentMidIndex=r.mediaDescriptions.length-1}preloadRemoteMedia(n){this.rtpCapabilities;const r=this.candidates,s=this.dtlsParameters,c=this.iceParameters,d=this.rtpCapabilities.send;for(let h=1;h<n;h++){const f=2*h+w1,g=2*h+R1,{ssrcs:_,ssrcGroups:E}=no([{ssrcId:f}],this.cname),{ssrcs:T,ssrcGroups:w}=no([{ssrcId:g,rtx:Y("USE_SUB_RTX")?g+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:eS,protos:["UDP","TLS","RTP","SAVPF"],fmts:d.videoCodecs.map(A=>A.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:c.iceUfrag,icePwd:c.icePwd,unrecognized:[],candidates:r,extmaps:d.videoExtensions,fingerprints:s.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:T,ssrcGroups:w,rtcpFeedbackWildcards:[],payloads:d.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*h-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:eS,protos:["UDP","TLS","RTP","SAVPF"],fmts:d.audioCodecs.map(A=>A.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:c.iceUfrag,icePwd:c.icePwd,unrecognized:[],candidates:r,extmaps:d.audioExtensions,fingerprints:s.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_,ssrcGroups:E,rtcpFeedbackWildcards:[],payloads:d.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*h)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return gn.print(this.sessionDesc)}send(n,r,s,c){const{ssrcs:d,ssrcGroups:h}=no(r,this.cname,Y("SYNC_GROUP")?s:void 0),f=this.findPreloadMediaDesc(d);if(f){if(Jt()&&this.firefoxSsrcMidMap.set(d[0].ssrcId,f.attributes.mid),c&&(c.twcc||c.remb)){const g=this.sessionDesc.mediaDescriptions.indexOf(f);return this.sessionDesc.mediaDescriptions[g]=this.mungSendMediaDesc(f,c),{mid:f.attributes.mid,needExchangeSDP:!0}}return{mid:f.attributes.mid,needExchangeSDP:!1}}{const g=this.findAvailableMediaIndex(n,d);let _;return g===-1||Fr()||Ti()||aj()||g===0&&Y("USE_SUB_RTX")?(_=this.createOrRecycleSendMedia(n,d,h,"sendonly",c),this.updateBundleMids()):(_=en(this.sessionDesc.mediaDescriptions[g]),_.attributes.direction="sendonly",_.attributes.ssrcs=d,_.attributes.ssrcGroups=h,this.sessionDesc.mediaDescriptions[g]=this.mungSendMediaDesc(_,c)),Jt()&&this.firefoxSsrcMidMap.set(d[0].ssrcId,_.attributes.mid),{mid:_.attributes.mid,needExchangeSDP:!0}}}batchSend(n){const r=n.map(d=>{let{kind:h,ssrcMsg:f,mslabel:g}=d;return this.send(h,f,g)}),s=[];let c=!1;return r.forEach(d=>{let{mid:h,needExchangeSDP:f}=d;f&&(c=!0),s.push(h)}),{mids:s,needExchangeSDP:c}}stopSending(n){const r=this.sessionDesc.mediaDescriptions.filter(s=>s.attributes.mid&&n.indexOf(s.attributes.mid)!==-1);if(r.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");r.forEach(s=>{s.attributes.mid==="0"||Jt()||Fr()||Ti()?s.attributes.ssrcs=[]:(s.attributes.ssrcs=[],s.attributes.direction="inactive",s.media.port="0")}),this.updateBundleMids()}mute(n){const r=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===n);if(!r)throw new Error("mediaDescription not found with ".concat(n," in remote SDP when calling RemoteSDP.mute."));r.attributes.direction="inactive"}unmute(n){const r=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===n);if(!r)throw new Error("mediaDescription not found with ".concat(n," in remote SDP when calling RemoteSDP.unmute."));r.attributes.direction="sendonly"}muteRemote(n){const r=this.sessionDesc.mediaDescriptions.filter(s=>Le(n).call(n,s.attributes.mid||""));if(r.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(s=>{s.attributes.direction="inactive"})}unmuteRemote(n){const r=this.sessionDesc.mediaDescriptions.filter(s=>Le(n).call(n,s.attributes.mid||""));if(r.length!==n.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");r.forEach(s=>{s.attributes.direction="recvonly"})}receive(n,r,s,c){n.forEach((d,h)=>{this.createOrRecycleRecvMedia(d,[],"recvonly",r,s,c[h])}),this.updateBundleMids()}stopReceiving(n){const r=this.sessionDesc.mediaDescriptions.filter(s=>n.indexOf(s.attributes.mid)!==-1);if(r.length!==n.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");r.forEach(s=>{s.media.port="0",s.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(n){n===Qr.TCP?this._candidates.forEach(r=>{this._candidates.findIndex(s=>s.transport==="tcp"&&s.connectionAddress===r.connectionAddress&&s.port===r.port)===-1&&this._candidates.push(_4(_4({},r),{},{foundation:"tcpcandidate",priority:Number(r.priority)-1+"",transport:"tcp",port:Number(r.port)+90+""}))}):this._candidates=this._candidates.filter(r=>r.transport!=="tcp");for(const r of this.sessionDesc.mediaDescriptions)r.attributes.candidates=this.candidates}restartICE(n){n=en(n),this._iceParameters=n,this.sessionDesc.mediaDescriptions.forEach(r=>{r.attributes.iceUfrag=n.iceUfrag,r.attributes.icePwd=n.icePwd})}predictReceivingMids(n){const r=[];for(let s=0;s<n;s++)r.push((this.currentMidIndex+s+1).toString(10));return r}findAvailableMediaIndex(n,r){return this.sessionDesc.mediaDescriptions.findIndex(s=>{const c=s.media.mediaType===n&&s.media.port!=="0"&&(s.attributes.direction==="sendonly"||s.attributes.direction==="sendrecv")&&s.attributes.ssrcs.length===0;if(Jt()){if(c){const d=this.firefoxSsrcMidMap.get(r[0].ssrcId);return!(d||s.attributes.mid!=="0"&&s.attributes.mid!=="1")||!(!d||d!==s.attributes.mid)}return!1}return c})}createOrRecycleRecvMedia(n,r,s,c,d,h){const f=n._mediaStreamTrack.kind,g=this.rtpCapabilities.recv,_=Xu(f,g,this.localCapabilities.send,f===Fe.VIDEO?c:d),E=f===Fe.VIDEO?g.videoExtensions:g.audioExtensions;this.currentMidIndex+=1;const T="".concat(this.currentMidIndex);let w={media:{mediaType:f,port:eS,protos:["UDP","TLS","RTP","SAVPF"],fmts:_.map(L=>L.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:E,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:_,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(T)}};w=this.mungRecvMediaDsec(w,n,h);const A=this.findFirstClosedMedia(f);if(A){const L=this.sessionDesc.mediaDescriptions.indexOf(A);this.sessionDesc.mediaDescriptions[L]=w}else this.sessionDesc.mediaDescriptions.push(w);return w}updateRemoteCodec(n,r,s){const c=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(w=>w.rtpMap&&w.rtpMap.encodingName.toLowerCase()||"").filter(w=>{var A;return Le(A=Object.keys(nd)).call(A,w)}))],d=new Set(r);if(c.every(w=>d.has(w)))return O.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(r)),!1;const h=this._rtpCapabilities.recv.videoCodecs.filter(w=>r.some(A=>{var L;return Le(L=w.rtpMap&&w.rtpMap.encodingName.toLowerCase()||"").call(L,A)}));if(h.length===0)return O.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(c," codecs: ").concat(r)),!1;const f=[...new Set(h.map(w=>w.rtpMap&&w.rtpMap.encodingName.toLowerCase()||""))];let g;if(O.debug("updateRemoteCodec, from ".concat(c," to ").concat(f)),n.length===0)g=this.sessionDesc.mediaDescriptions.filter(w=>w.media.mediaType==="video"&&w.attributes.direction==="recvonly");else if(g=this.sessionDesc.mediaDescriptions.filter(w=>w.attributes.mid&&Le(n).call(n,w.attributes.mid)&&w.attributes.direction==="recvonly"),g.length!==n.length)return O.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(n,", codecs: ").concat(r)),!1;this._rtpCapabilities.recv.videoCodecs=h;const _=this.localCapabilities.send,E=this.rtpCapabilities.recv,T=Xu(Fe.VIDEO,E,_,s);return g.forEach(w=>{const A=T.map(L=>L.payloadType.toString(10));O.debug("updateRemoteCodec mid: ".concat(w.attributes.mid,", from ").concat(w.attributes.payloads," to ").concat(T)),w.attributes.payloads=T,w.media.fmts=A}),!0}createOrRecycleSendMedia(n,r,s,c,d){const h=this.rtpCapabilities.send,f=n===Fe.VIDEO?h.videoCodecs:h.audioCodecs,g=n===Fe.VIDEO?h.videoExtensions:h.audioExtensions;this.currentMidIndex+=1;const _="".concat(this.currentMidIndex);let E={media:{mediaType:n,port:eS,protos:["UDP","TLS","RTP","SAVPF"],fmts:f.map(w=>w.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:g,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:r,ssrcGroups:s,rtcpFeedbackWildcards:[],payloads:f,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:c,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_)}};E=this.mungSendMediaDesc(E,d);const T=this.findFirstClosedMedia(n);if(T){const w=this.sessionDesc.mediaDescriptions.indexOf(T);this.sessionDesc.mediaDescriptions[w]=E}else this.sessionDesc.mediaDescriptions.push(E);return E}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(n=>n.media.port!=="0").map(n=>n.attributes.mid)}mungRecvMediaDsec(n,r,s){const c=en(n);return q0(c),Td(c,r),J0(c,r),_1(c),Zp(c,s,this.localCapabilities.send),c}mungSendMediaDesc(n,r){const s=en(n);return Zp(s,r,this.localCapabilities.recv),Da(s),s}updateRecvMedia(n,r){const s=this.sessionDesc.mediaDescriptions.findIndex(c=>c.attributes.mid===n);if(s!==-1){const c=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],r);this.sessionDesc.mediaDescriptions[s]=c}}bumpMid(n){this.currentMidIndex+=n}findFirstClosedMedia(n){return this.sessionDesc.mediaDescriptions.find(r=>Jt()?r.media.port==="0"&&r.media.mediaType===n:r.media.port==="0")}findPreloadMediaDesc(n){return this.sessionDesc.mediaDescriptions.find(r=>{var s;return((s=r.attributes)===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId)===n[0].ssrcId})}getSSRC(n){var r;return(r=this.sessionDesc.mediaDescriptions.find(s=>s.attributes.mid===n))===null||r===void 0?void 0:r.attributes.ssrcs}}function E4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function tS(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?E4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}class ni extends o0{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){let n;return this.localCapabilities&&(n=ef(this.localCapabilities)),[...new Set(n&&n.send.videoCodecs.map(r=>r.rtpMap&&r.rtpMap.encodingName.toLowerCase()||"").filter(r=>{var s;return Le(s=Object.keys(nd)).call(s,r)}))]}constructor(n,r,s){super(n,r),I(this,"store",void 0),I(this,"peerConnection",void 0),I(this,"remoteSDP",void 0),I(this,"initialOffer",void 0),I(this,"transportEventReceiver",void 0),I(this,"statsFilter",void 0),I(this,"useXR",Y("USE_XR")),I(this,"localCapabilities",void 0),I(this,"localCandidateCount",0),I(this,"allCandidatesReceived",!1),I(this,"remoteCodecs",void 0),I(this,"dataStreamChannelMap",new Map),I(this,"establishPromise",void 0),I(this,"mutex",new Pr("NVExtentionsConnection-mutex")),I(this,"rtcMedia",void 0),this.store=r,this.peerConnection=s,this.statsFilter=Y0(this.peerConnection,Y("STATS_UPDATE_INTERVAL"),void 0,Jt()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(n){try{const r=await this.peerConnection.createOffer();if(!r.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=ka(r.sdp),c=await E1({filterRTX:!Y("USE_PUB_RTX")&&!Y("USE_SUB_RTX"),filterVideoFec:Y("FILTER_VIDEO_FEC"),filterAudioFec:Y("FILTER_AUDIO_FEC"),filterVideoCodec:Y("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=c,this.initialOffer=r,tS(tS({},s),{},{rtpCapabilities:c,offerSDP:r.sdp})}catch(r){throw new Z(B.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async connect(n,r,s,c,d,h){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");this.remoteSDP=new Oce({remoteIceParameters:n,remoteDtlsParameters:r,candidates:s,remoteRTPCapabilities:c,remoteSetup:d,localCapabilities:ef(this.localCapabilities),cname:h});const f=this.remoteSDP.toString(),g=gn.parse(this.initialOffer.sdp),_=g.mediaDescriptions.find(w=>w.media.mediaType==="audio");_&&Da(_),this.useXR&&a_(g);const E=gn.print(g),T=this.logSDPExchange(E||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:E}),T==null||T(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(f){throw new Z(B.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(f.toString()))}}async updateRemoteRTPCapabilities(n,r){if(this.remoteCodecs=r,!this.remoteSDP)return void O.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(r));if(this.remoteSDP.updateRemoteCodec(n,r,this.store.codec)){const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s);const d=this.remoteSDP.toString();c==null||c(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}else O.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async updateRemoteConnect(n){var r,s,c,d;(r=this.remoteSDP)===null||r===void 0||r.updateRemoteRTPCapabilities(n),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&((d=this.remoteSDP)===null||d===void 0||d.updateRemoteCodec([],this.remoteCodecs,this.store.codec)),(s=this.remoteSDP)===null||s===void 0||s.preloadRemoteMedia(2);const h=(c=this.remoteSDP)===null||c===void 0?void 0:c.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const f=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(f),O.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")}send(n,r,s){var c=this;return Co(function*(){const d=yield ut(c.mutex.lock("From NVExtentionsConnection.send"));try{if(!c.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const h=[];n.forEach(P=>{const D=c.peerConnection.addTransceiver(P._mediaStreamTrack,{direction:"sendonly"});h.push(D)}),Jt()&&Y("SIMULCAST")===!0&&(yield ut(c.applySimulcastForFirefox(h,n)));const f=yield ut(c.peerConnection.createOffer()),g=c.remoteSDP.predictReceivingMids(n.length),_=c.mungSendOfferSDP(f.sdp,n,g),E=gn.parse(_),T=g.map(P=>{const D=E.mediaDescriptions.find(G=>G.attributes.mid===P);if(!D)throw new Error("Cannot extract ssrc from mediaDescription.");return g1(D,Y("USE_PUB_RTX"))});let w;try{w=yield T}catch(P){w=[],c.remoteSDP.receive(n,r,s,w);const D=c.remoteSDP.toString();throw yield ut(c.peerConnection.setLocalDescription({type:"offer",sdp:_})),yield ut(c.peerConnection.setRemoteDescription({type:"answer",sdp:D})),yield ut(c.stopSending(g,!0)),P}c.remoteSDP.receive(n,r,s,w);const A=c.remoteSDP.toString(),L=c.logSDPExchange(_,"offer","local","send");return yield ut(c.peerConnection.setLocalDescription({type:"offer",sdp:_})),yield ut(c.applySimulcastEncodings(h,n)),yield ut(c.applySendEncodings(h,n)),L==null||L(A),yield ut(c.peerConnection.setRemoteDescription({type:"answer",sdp:A})),h.map((P,D)=>{const G=g[D];return{localSSRC:T[D],id:G,transceiver:P}})}catch(h){throw h instanceof Z?h:new Z(B.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(h.toString()))}finally{d()}})()}async stopSending(n,r){const s=r?void 0:await this.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const c=this.peerConnection.getTransceivers().filter(g=>n.indexOf(g.mid)!==-1);if(c.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");c.map(g=>{var _;g.direction="inactive",(_=g.stop)===null||_===void 0||_.call(g)});const d=await this.peerConnection.createOffer(),h=this.logSDPExchange(d.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(d),this.remoteSDP.stopReceiving(n);const f=this.remoteSDP.toString();h==null||h(f),await this.peerConnection.setRemoteDescription({type:"answer",sdp:f})}catch(c){throw new Z(B.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(c.toString()))}finally{s&&s()}}async createDataChannels(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.createDataChannels before remote SDP created");let s=this.dataStreamChannelMap.get(n);return s&&s.readyState==="open"?O.debug("[P2PConnection] Channels are already available and can be reused directly."):(s=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:Y("DATASTREAM_MAX_RETRANSMITS")}),s.binaryType="arraybuffer",this.dataStreamChannelMap.set(n,s)),void r.forEach(c=>{c._updateOriginDataChannel(s)})}catch(s){throw s instanceof Z?s:new Z(B.DATACHANNEL_FAILED,"NVExtentionsConnection.createDataChannels failed; ".concat(s.toString()))}}async stopDataChannels(n){try{const r=this.dataStreamChannelMap.get(n);return r==null||r.close(),void this.dataStreamChannelMap.delete(n)}catch(r){throw r instanceof Z?r:new Z(B.DATACHANNEL_FAILED,"NVExtentionsConnection.stopDataChannels failed; ".concat(r.toString()))}}async receive(n,r,s,c){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(n," before remoteSDP created."));const{mid:d,needExchangeSDP:h}=this.remoteSDP.send(n,r,s,c);if(h){const g=this.remoteSDP.toString(),_=this.logSDPExchange(g,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const E=await this.peerConnection.createAnswer(),T=this.mungReceiveAnswerSDP(E.sdp,d,n);_==null||_(T||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:T}),O.debug("[NVExtentionsConnection] receive ".concat(n," by exchanging SDP."))}else O.debug("[NVExtentionsConnection] receive ".concat(n," no need to exchange SDP."));const f=this.peerConnection.getTransceivers().find(g=>g.mid===d);if(!f)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:f.receiver.track,id:d}}catch(d){throw new Z(B.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(d.toString()))}}async batchReceive(n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:r,needExchangeSDP:s}=this.remoteSDP.batchSend(n);if(s){const c=this.remoteSDP.toString(),d=this.logSDPExchange(c,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:c});const h=await this.peerConnection.createAnswer();d==null||d(h.sdp||""),await this.peerConnection.setLocalDescription(h),O.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else O.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return r.map(c=>{const d=this.peerConnection.getTransceivers().find(h=>h.mid===c);if(!d)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:d.receiver.track,id:c}})}catch(r){throw new Z(B.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(r.toString()))}}async stopReceiving(n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(n);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new Z(B.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(n," before remote SDP created."));this.remoteSDP.mute(n);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new Z(B.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(r.toString()))}}async unmuteRemote(n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(n," before remote SDP created."));this.remoteSDP.unmute(n);const r=this.remoteSDP.toString(),s=this.logSDPExchange(r,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();s==null||s(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new Z(B.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(r.toString()))}}async muteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&n.indexOf(h.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(h=>{h.direction="inactive"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.muteRemote(n);const d=this.remoteSDP.toString();c==null||c(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(r){throw new Z(B.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(h=>h.mid&&n.indexOf(h.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async(h,f)=>{h.direction="sendonly"});const s=await this.peerConnection.createOffer(),c=this.logSDPExchange(s.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(s),this.remoteSDP.unmuteRemote(n);const d=this.remoteSDP.toString();c==null||c(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(r){throw new Z(B.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(n){var r=this;return Co(function*(){const s=yield ut(r.mutex.lock("From NVExtentionsConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(Lt().supportPCSetConfiguration){const _=r.peerConnection.getConfiguration(),E=n===Qr.RELAY?"relay":"all";_.iceTransportPolicy!==E&&(O.debug("restartICE change iceTransportPolicy from [".concat(_.iceTransportPolicy,"] to [").concat(E,"]")),_.iceTransportPolicy=E,r.peerConnection.setConfiguration(_))}else if(n===Qr.RELAY)return;n!==Qr.RELAY&&r.remoteSDP.updateCandidates(n);const c=yield ut(r.peerConnection.createOffer({iceRestart:!0}));if(!c.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const d=ka(c.sdp),{remoteIceParameters:h}=yield d.iceParameters;r.remoteSDP.restartICE(h);const f=r.remoteSDP.toString(),g=r.logSDPExchange(c.sdp||"","offer","local","restartICE");yield ut(r.peerConnection.setLocalDescription(c)),g==null||g(f),yield ut(r.peerConnection.setRemoteDescription({type:"answer",sdp:f}))}catch(c){O.warning("restart ICE failed, abort operation",c)}finally{s()}})()}close(){var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(n){return this.statsFilter.getVideoIsReady(n)}async updateEncoderConfig(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const s=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(s.sdp,[r],[n]);this.remoteSDP.updateRecvMedia(n,r);const d=this.remoteSDP.toString(),h=this.logSDPExchange(c,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),h==null||h(d),await this.peerConnection.setRemoteDescription({type:"answer",sdp:d})}catch(s){throw new Z(B.EXCHANGE_SDP_FAILED,s.toString())}}async updateSendParameters(n,r){const s=this.peerConnection.getTransceivers().filter(c=>c.mid===n);s.length===1&&(this.isVP8Simulcast(r)?Jt()||await this.applySimulcastEncodings(s,[r]):await this.applySendEncodings(s,[r]))}setStatsRemoteVideoIsReady(n,r){this.statsFilter.setVideoIsReady2(n,r)}async replaceTrack(n,r){const s=this.peerConnection.getTransceivers().find(c=>c.mid===r);s&&await s.sender.replaceTrack(n._mediaStreamTrack)}getP2PConnectionParams(){var n;if((n=this.peerConnection.currentLocalDescription)===null||n===void 0||!n.sdp||!this.localCapabilities)throw new Error;return tS(tS({},ka(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var n;(n=this.onICEConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=n=>{n.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,O.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,O.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},Y("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(n){const r={iceServers:[]};return n.iceServers?r.iceServers=n.iceServers:n.turnServer&&n.turnServer.mode!=="off"&&(Sp(n.turnServer.servers)?r.iceServers=n.turnServer.servers:(r.iceServers&&r.iceServers.push(...ni.turnServerConfigToIceServers(n.turnServer.servers)),Y("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&n.turnServer.serversFromGateway&&r.iceServers.push(...ni.turnServerConfigToIceServers(n.turnServer.serversFromGateway)),Y("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(n){const r=[];return n.forEach(s=>{s.security?s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(cd(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!Y("FORCE_TURN_TCP")&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),r}async applySendEncodings(n,r){try{if(!Lt().supportSetRtpSenderParameters||n.length!==r.length)return;for(let T=0;T<n.length;T++){const w=n[T],A=r[T];if(A&&A instanceof ht){var s,c,d;if(this.isVP8Simulcast(A))continue;const L={},P={};switch(A._optimizationMode){case"motion":L.degradationPreference="maintain-framerate";break;case"detail":L.degradationPreference="maintain-resolution";break;default:L.degradationPreference="balanced"}var h,f,g,_;if((s=A._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&(P.maxBitrate=1e3*((h=A._encoderConfig)===null||h===void 0?void 0:h.bitrateMax)),Le(c=A._hints).call(c,tn.LOW_STREAM)&&((f=A._encoderConfig)!==null&&f!==void 0&&f.frameRate&&(P.maxFramerate=Wo(A._encoderConfig.frameRate)),(g=A._encoderConfig)!==null&&g!==void 0&&g.scaleResolutionDownBy&&((_=A._encoderConfig)===null||_===void 0?void 0:_.scaleResolutionDownBy)>1&&(P.scaleResolutionDownBy=A._encoderConfig.scaleResolutionDownBy)),Y("DSCP_TYPE")&&Zl()){var E;const $=Y("DSCP_TYPE");Le(E=["very-low","low","medium","high"]).call(E,$)&&(P.networkPriority=$)}const D=w.sender.getParameters(),G=(d=D.encodings)===null||d===void 0?void 0:d[0];Jt()&&!G&&(L.encodings=[P]),G&&Object.assign(G,P),Object.assign(D,L),await w.sender.setParameters(D)}}}catch{O.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(n,r,s){const c=gn.parse(n);return r.forEach((d,h)=>{const f=s[h],g=c.mediaDescriptions.find(_=>_.attributes.mid===f);g&&(Td(g,d),v1(g,d,this.store.codec))}),gn.print(c)}mungReceiveAnswerSDP(n,r,s){const c=gn.parse(n),d=c.mediaDescriptions.find(h=>h.attributes.mid===r);return d&&s===Fe.AUDIO&&d.media.mediaType==="audio"&&Da(d),this.useXR&&a_(c),gn.print(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=n=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoReceived=n=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstAudioDecoded=n=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoDecoded=(n,r,s)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,n,r,s)},this.statsFilter.onSelectedLocalCandidateChanged=(n,r)=>{var s;(s=this.onSelectedLocalCandidateChanged)===null||s===void 0||s.call(this,n,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(n,r)=>{var s;(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0||s.call(this,n,r)},this.statsFilter.onFirstVideoDecodedTimeout=n=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,n)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(n,r){if(n.length===r.length)for(let g=0;g<n.length;g++){var s,c,d,h,f;const _=n[g],E=r[g];if(E instanceof ht&&!Le(s=E._hints).call(s,tn.LOW_STREAM)&&(c=E._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((d=E._encoderConfig)===null||d===void 0?void 0:d.bitrateMax)>200&&(h=E._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((f=E._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1&&this.store.codec==="vp8"){const T={},w={high:1e3*(E._encoderConfig.bitrateMax-50),medium:5e4};T.encodings=[{rid:"m",active:!0,maxBitrate:w.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:w.high}];const A=_.sender.getParameters();await _.sender.setParameters(Object.assign(A,T))}}}async applySimulcastEncodings(n,r){if(!Jt()&&n.length===r.length)for(let s=0;s<n.length;s++){const c=r[s];if(c instanceof ht&&this.isVP8Simulcast(c)){const d=n[s],h={},f={high:1e3*(c._encoderConfig.bitrateMax-50),medium:5e4};h.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:f.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:f.medium,scaleResolutionDownBy:4}];const g=d.sender.getParameters();await d.sender.setParameters(Object.assign(g,h))}}}isVP8Simulcast(n){var r,s,c,d,h;return!!(n instanceof ht&&Y("SIMULCAST")&&this.store.codec==="vp8"&&!Le(r=n._hints).call(r,tn.LOW_STREAM)&&(s=n._encoderConfig)!==null&&s!==void 0&&s.bitrateMax&&((c=n._encoderConfig)===null||c===void 0?void 0:c.bitrateMax)>200&&(d=n._scalabilityMode)!==null&&d!==void 0&&d.numSpatialLayers&&((h=n._scalabilityMode)===null||h===void 0?void 0:h.numSpatialLayers)>1)}logSDPExchange(n,r,s,c){if(Y("SDP_LOGGING"))return O.upload("exchanging ".concat(s," ").concat(r," SDP during NVExtentionsConnection.").concat(c,`
`),n),r==="offer"?d=>{this.logSDPExchange(d,"answer",s==="local"?"remote":"local",c)}:void 0}async getRemoteSSRC(n){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(n);return r==null?void 0:r[0].ssrcId}setConfiguration(n){if(Lt().supportPCSetConfiguration){const r=ni.resolvePCConfiguration(n);this.peerConnection.setConfiguration(r)}}}function ro(o,n,r){const s=o[n];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,d=await c.lock("From NVExtentionsConnection.".concat(n));try{for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return await s.apply(this,f)}finally{d()}},r}function y4(o){var n,r,s,c=2;for(typeof Symbol<"u"&&(r=c4,s=Symbol.iterator);c--;){if(r&&(n=o[r])!=null)return n.call(o);if(s&&(n=o[s])!=null)return new nS(n.call(o));r="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function nS(o){function n(r){if(Object(r)!==r)return ae.reject(new TypeError(r+" is not an object."));var s=r.done;return ae.resolve(r.value).then(function(c){return{value:c,done:s}})}return nS=function(r){this.s=r,this.n=r.next},nS.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(r){var s=this.s.return;return s===void 0?ae.resolve({value:r,done:!0}):n(s.apply(this.s,arguments))},throw:function(r){var s=this.s.return;return s===void 0?ae.reject(r):n(s.apply(this.s,arguments))}},new nS(o)}fe([ro,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",ae)],ni.prototype,"connect",null),fe([ro,j("design:type",Function),j("design:paramtypes",[Array,Array]),j("design:returntype",ae)],ni.prototype,"updateRemoteRTPCapabilities",null),fe([ro,j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],ni.prototype,"updateRemoteConnect",null),fe([ro,j("design:type",Function),j("design:paramtypes",[Object,Array]),j("design:returntype",ae)],ni.prototype,"createDataChannels",null),fe([ro,j("design:type",Function),j("design:paramtypes",[String,Array,String,Object]),j("design:returntype",ae)],ni.prototype,"receive",null),fe([ro,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],ni.prototype,"batchReceive",null),fe([ro,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],ni.prototype,"stopReceiving",null),fe([ro,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],ni.prototype,"muteRemote",null),fe([ro,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],ni.prototype,"unmuteRemote",null),fe([ro,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],ni.prototype,"muteLocal",null),fe([ro,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],ni.prototype,"unmuteLocal",null),fe([ro,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],ni.prototype,"close",null),fe([ro,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],ni.prototype,"updateEncoderConfig",null),fe([ro,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],ni.prototype,"updateSendParameters",null),fe([ro,j("design:type",Function),j("design:paramtypes",[Zr,String]),j("design:returntype",ae)],ni.prototype,"replaceTrack",null),fe([ro,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],ni.prototype,"getRemoteSSRC",null);class yr extends o0{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){return this._p2pConnection.localCodecs}constructor(n,r){super(n,r),I(this,"store",void 0),I(this,"peerConnection",void 0),I(this,"cname",void 0),I(this,"mutex",new Pr("DataChannelConnection-mutex")),I(this,"dataChannel",void 0),I(this,"_p2pConnection",void 0),I(this,"establishPromise",void 0),I(this,"_nvMedia",void 0),this.store=r,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(yr.resolvePCConfiguration(n),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new ni(n,r,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}async establish(){var n;const r=(n=this._nvMedia)===null||n===void 0?void 0:n.getLocalRtpCapabilities();return await this._p2pConnection.establish(r)}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}async connect(n,r,s,c,d,h){return this.cname=h,await this._p2pConnection.connect(n,r,s,c,d,h),await new ae((f,g)=>{const _=setTimeout(()=>{this.closeSignal(),g(new Z(B.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(s))))},2e3);this.dataChannel.onopen=()=>{if(this.dataChannel.readyState==="open")return clearTimeout(_),void f()},this.dataChannel.onerror=E=>{this.closeSignal(),g(E)}}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}async updateRemoteRTPCapabilities(n,r){return this._p2pConnection.updateRemoteRTPCapabilities(n,r)}send(n,r,s){var c=this;return Co(function*(){const d=yield ut(c.mutex.lock("From DataChannelConnection.send"));try{return yield*Z0(y4(c._p2pConnection.send(n,r,s)))}finally{d()}})()}async stopSending(n,r){return this._p2pConnection.stopSending(n,r)}async createDataChannels(n,r){return this._p2pConnection.createDataChannels(n,r)}async stopDataChannels(n){return this._p2pConnection.stopDataChannels(n)}async receive(n,r,s,c){return this._nvMedia?(O.debug("[DataChannelConnection] receive ".concat(n," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(n,r,this.cname)):(O.debug("[DataChannelConnection] receive ".concat(n," by WebRTC.")),await this._p2pConnection.receive(n,r,s,c))}async batchReceive(n){return[...await this._p2pConnection.batchReceive(n)]}async stopReceiving(n){return await this._p2pConnection.stopReceiving(n)}async muteRemote(n){return await this._p2pConnection.muteRemote(n)}async unmuteRemote(n){return await this._p2pConnection.unmuteRemote(n)}async muteLocal(n){return await this._p2pConnection.muteLocal(n)}async unmuteLocal(n){return await this._p2pConnection.unmuteLocal(n)}restartICE(n){var r=this;return Co(function*(){return yield*Z0(y4(r._p2pConnection.restartICE(n)))})()}close(){var n;(n=this._nvMedia)===null||n===void 0||n.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(n){return this._p2pConnection.getRemoteVideoIsReady(n)}updateRemoteConnect(n){var r;(r=this._nvMedia)===null||r===void 0||r.setRemoteRtpCapabilities(n),this._p2pConnection.updateRemoteConnect(n)}async updateEncoderConfig(n,r){return await this._p2pConnection.updateEncoderConfig(n,r)}async updateSendParameters(n,r){return await this._p2pConnection.updateSendParameters(n,r)}setStatsRemoteVideoIsReady(n,r){this._p2pConnection.setStatsRemoteVideoIsReady(n,r)}async replaceTrack(n,r){return await this._p2pConnection.replaceTrack(n,r)}async getRemoteSSRC(n){return this._p2pConnection.getRemoteSSRC(n)}logSDPExchange(n,r,s,c){if(Y("SDP_LOGGING"))return O.upload("exchanging ".concat(s," ").concat(r," SDP during DataChannelConnection.").concat(c,`
`),n),r==="offer"?d=>{this.logSDPExchange(d,"answer",s==="local"?"remote":"local",c)}:void 0}static resolvePCConfiguration(n){const r={iceServers:[]};return n.iceServers?r.iceServers=n.iceServers:n.turnServer&&n.turnServer.mode!=="off"&&(Sp(n.turnServer.servers)?r.iceServers=n.turnServer.servers:(r.iceServers&&r.iceServers.push(...yr.turnServerConfigToIceServers(n.turnServer.servers)),Y("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&n.turnServer.serversFromGateway&&r.iceServers.push(...yr.turnServerConfigToIceServers(n.turnServer.serversFromGateway)),Y("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).forEach(s=>{s.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(n){const r=[];return n.forEach(s=>{s.security?s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turns:".concat(cd(s.turnServerURL),":").concat(s.tcpport,"?transport=tcp")}):(s.udpport&&!Y("FORCE_TURN_TCP")&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.udpport,"?transport=udp")}),s.tcpport&&r.push({username:s.username,credential:s.password,credentialType:"password",urls:"turn:".concat(s.turnServerURL,":").concat(s.tcpport,"?transport=tcp")}))}),r}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=n=>{var r;return(r=this.onICEConnectionStateChange)===null||r===void 0?void 0:r.call(this,n)},this._p2pConnection.onConnectionStateChange=n=>{var r;return(r=this.onConnectionStateChange)===null||r===void 0?void 0:r.call(this,n)},this._p2pConnection.onDTLSTransportStateChange=n=>{var r;return(r=this.onDTLSTransportStateChange)===null||r===void 0?void 0:r.call(this,n)},this._p2pConnection.onDTLSTransportError=n=>{var r;return(r=this.onDTLSTransportError)===null||r===void 0?void 0:r.call(this,n)},this._p2pConnection.onICETransportStateChange=n=>{var r;return(r=this.onICETransportStateChange)===null||r===void 0?void 0:r.call(this,n)},this._p2pConnection.onFirstAudioReceived=n=>{var r;return(r=this.onFirstAudioReceived)===null||r===void 0?void 0:r.call(this,n)},this._p2pConnection.onFirstVideoReceived=n=>{var r;return(r=this.onFirstVideoReceived)===null||r===void 0?void 0:r.call(this,n)},this._p2pConnection.onFirstAudioDecoded=n=>{var r;return(r=this.onFirstAudioDecoded)===null||r===void 0?void 0:r.call(this,n)},this._p2pConnection.onFirstVideoDecoded=(n,r,s)=>{var c;return(c=this.onFirstVideoDecoded)===null||c===void 0?void 0:c.call(this,n,r,s)},this._p2pConnection.onFirstVideoDecodedTimeout=n=>{var r;return(r=this.onFirstVideoDecodedTimeout)===null||r===void 0?void 0:r.call(this,n)},this._p2pConnection.onSelectedLocalCandidateChanged=(n,r)=>{var s;return(s=this.onSelectedLocalCandidateChanged)===null||s===void 0?void 0:s.call(this,n,r)},this._p2pConnection.onSelectedRemoteCandidateChanged=(n,r)=>{var s;return(s=this.onSelectedRemoteCandidateChanged)===null||s===void 0?void 0:s.call(this,n,r)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(n){n.onConnectionStateChange=void 0,n.onICEConnectionStateChange=void 0,n.onICETransportStateChange=void 0,n.onDTLSTransportStateChange=void 0,n.onDTLSTransportError=void 0,n.onFirstAudioDecoded=void 0,n.onFirstAudioReceived=void 0,n.onFirstVideoDecoded=void 0,n.onFirstVideoReceived=void 0,n.onSelectedLocalCandidateChanged=void 0,n.onSelectedRemoteCandidateChanged=void 0,n.onFirstVideoDecodedTimeout=void 0}setConfiguration(n){this._p2pConnection.setConfiguration(n)}}function Xo(o,n,r){const s=o[n];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,d=await c.lock("From DataChannelConnection.".concat(n));try{for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return await s.apply(this,f)}finally{d()}},r}function S4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function Rd(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?S4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):S4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}function T4(o){var n,r,s,c=2;for(typeof Symbol<"u"&&(r=c4,s=Symbol.iterator);c--;){if(r&&(n=o[r])!=null)return n.call(o);if(s&&(n=o[s])!=null)return new rS(n.call(o));r="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function rS(o){function n(r){if(Object(r)!==r)return ae.reject(new TypeError(r+" is not an object."));var s=r.done;return ae.resolve(r.value).then(function(c){return{value:c,done:s}})}return rS=function(r){this.s=r,this.n=r.next},rS.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(r){var s=this.s.return;return s===void 0?ae.resolve({value:r,done:!0}):n(s.apply(this.s,arguments))},throw:function(r){var s=this.s.return;return s===void 0?ae.reject(r):n(s.apply(this.s,arguments))}},new rS(o)}fe([Xo,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",ae)],yr.prototype,"connect",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[Array,Array]),j("design:returntype",ae)],yr.prototype,"updateRemoteRTPCapabilities",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[Object,Array]),j("design:returntype",ae)],yr.prototype,"createDataChannels",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[String,Array,String,Object]),j("design:returntype",ae)],yr.prototype,"receive",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],yr.prototype,"stopReceiving",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],yr.prototype,"muteRemote",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],yr.prototype,"unmuteRemote",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],yr.prototype,"muteLocal",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],yr.prototype,"unmuteLocal",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],yr.prototype,"close",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],yr.prototype,"updateEncoderConfig",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[String,Zr]),j("design:returntype",ae)],yr.prototype,"updateSendParameters",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[Zr,String]),j("design:returntype",ae)],yr.prototype,"replaceTrack",null),fe([Xo,j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],yr.prototype,"getRemoteSSRC",null);class Lr extends mn{get state(){return this._state}set state(n){const r=this._state;this._state=n,this.emit(Xe.StateChange,r,this._state)}constructor(n,r){super(),I(this,"store",void 0),I(this,"statsUploader",void 0),I(this,"connection",void 0),I(this,"localTrackMap",new Map),I(this,"remoteUserMap",new Map),I(this,"localDataChannels",[]),I(this,"remoteDataChannelMap",new Map),I(this,"pendingLocalTracks",[]),I(this,"pendingRemoteTracks",[]),I(this,"pendingLocalDataChannels",[]),I(this,"pendingRemoteDataChannels",[]),I(this,"statsCollector",void 0),I(this,"isPlanB",!1),I(this,"shouldForwardP2PCreation",void 0),I(this,"iceFailedCount",0),I(this,"dtlsFailedCount",0),I(this,"mutex",new Pr("P2PChannel-mutex")),I(this,"_state",Vt.Disconnected),I(this,"_pcStatsUploadType",Y("NEW_ICE_RESTART")?Oa.FIRST_CONNECTION:Oa.OLD_FIRST_CONNECTION),I(this,"_isInRestartIce",!1),I(this,"_isStartRestartIce",!1),I(this,"_restartStates",["disconnected","failed"]),I(this,"_restartTimer",void 0),I(this,"_isFirstConnected",!0),I(this,"handleMuteLocalTrack",async(s,c,d)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==Vt.Connected)return void d(new he(B.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const f=this.filterTobeMutedTracks(s);if(f.length===0)return void c();const g=f.find(E=>E[0]==="videoLowTrack");g&&g[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(f.map(E=>{let[,{id:T}]=E;return T}));const _=this.createMuteMessage(f);await Xt(this,Xe.RequestMuteLocal,_),c()}catch(f){d(f)}finally{h()}}),I(this,"handleUnmuteLocalTrack",async(s,c,d)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==Vt.Connected)return void d(new he(B.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const f=this.filterTobeUnmutedTracks(s);if(f.length===0)return void c();const g=f.find(E=>E[0]==="videoLowTrack");if(g){const E=g[1];if(E.track._originMediaStreamTrack.stop(),!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&Lt().supportDualStreamEncoding){const T=s._mediaStreamTrack.clone();E.track._mediaStreamTrack=T,E.track._originMediaStreamTrack=T}else{const T=y1(s,Nu(this,Xe.RequestLowStreamParameter));E.track._mediaStreamTrack=T,E.track._originMediaStreamTrack=T}await new ae((T,w)=>{this.handleReplaceTrack(E.track,T,w,!0)})}await this.connection.unmuteLocal(f.map(E=>{let[,{id:T}]=E;return T}));const _=this.createUnmuteMessage(f);await Xt(this,Xe.RequestUnmuteLocal,_),c()}catch(f){d(f)}finally{h()}}),I(this,"handleUpdateVideoEncoder",async(s,c,d)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const f=this.localTrackMap.get(Ee.LocalVideoTrack);if(!this.connection||!f||f.track!==s||this.state!==Vt.Connected)return void c();const{id:g,track:_}=f;await this.connection.updateSendParameters(g,_),await this.connection.updateEncoderConfig(g,_),this.emit(Xe.UpdateVideoEncoder,_),c()}catch(f){d(f)}finally{h()}}),I(this,"handleSetOptimizationMode",async(s,c,d)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const f=this.localTrackMap.get(Ee.LocalVideoTrack);if(!this.connection||!f||f.track!==s||this.state!==Vt.Connected)return;const{id:g,track:_}=f;await this.connection.updateSendParameters(g,_),c()}catch(f){d(f)}finally{h()}}),I(this,"handleReplaceMixingTrack",async(s,c,d,h)=>{if(!this.connection||this.state!==Vt.Connected)return void c();const f=C1([s]);let g;O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(f.getTrackId(),"]")),typeof h=="boolean"&&h||(g=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(s,f),c()}catch(E){d(E)}finally{var _;(_=g)===null||_===void 0||_()}}),I(this,"handleReplaceTrack",async(s,c,d,h)=>{let f;O.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof h=="boolean"&&h||(f=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var g;const E=Array.from(this.localTrackMap.entries()).find(T=>{let[,{track:w}]=T;return s===w});if(!this.connection||!E||this.state!==Vt.Connected)return void c();if(await((g=this.connection)===null||g===void 0?void 0:g.replaceTrack(s,E[1].id)),this.isPlanB){const T=E[1];T.id=s._mediaStreamTrack.id,this.localTrackMap.set(E[0],T)}if(E[0]===Ee.LocalVideoTrack&&!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&Lt().supportDualStreamEncoding){const T=this.localTrackMap.get(Ee.LocalVideoLowTrack);if(T){const w=s._mediaStreamTrack.clone();T.track._originMediaStreamTrack.stop(),T.track._mediaStreamTrack=w,T.track._originMediaStreamTrack=w,await new ae((A,L)=>{this.handleReplaceTrack(T.track,A,L,!0)})}}c()}catch(E){d(E)}finally{var _;(_=f)===null||_===void 0||_()}}),I(this,"handleGetRTCStats",s=>{s(this.statsCollector.getRTCStats())}),I(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),I(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),I(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),I(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=n,this.statsCollector=r,this.statsCollector.addP2PChannel(this),this.statsUploader=new n4(this.store),this.bindStatsUploaderEvents(),this.isPlanB=!Lt().supportUnifiedPlan||Y("CHROME_FORCE_PLAN_B")&&Zl(),this.shouldForwardP2PCreation=Y("FORWARD_P2P_CREATION")&&Lt().supportPCSetConfiguration&&function(){const s=Ly();return s===fr.ANDROID||s===fr.IOS||s===fr.HARMONY_OS}(),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new yr({},this.store):this.isPlanB?new xr({},this.store):new kn({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection(n,r){var s;this.state=Vt.New;const c=this.shouldForwardP2PCreation&&((s=this.connection)===null||s===void 0?void 0:s.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!c||(c&&this.connection&&(O.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.store.useDataChannel?new yr(n,this.store):this.isPlanB?new xr(n,this.store):new kn(n,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new he(B.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=Y("NEW_ICE_RESTART")?Oa.FIRST_CONNECTION:Oa.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration(n),this.connection.establishPromise}async connect(n,r,s,c,d,h){if(!this.connection)throw new he(B.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.connection instanceof yr?this.connection.updateRemoteConnect(c):(this.store.peerConnectionStart(),await this.connection.connect(n,r,s,c,d,h),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Vt.Connected)}updateRemoteRTPCapabilities(n){const r=Array.from(this.localTrackMap.entries()).filter(d=>{var h;let[f]=d;return Le(h=[Ee.LocalVideoLowTrack,Ee.LocalVideoTrack]).call(h,f)}),s=r.map(d=>{let[,{id:h}]=d;return h}),c=r.map(d=>{let[h]=d;return h});if(this.connection instanceof kn){if(Be.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(c),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(n)}),!Le(n).call(n,this.store.codec)){const d=["vp8","h264"].find(h=>Le(n).call(n,h));d&&(this.store.codec=d,O.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(d,".")))}this.connection.updateRemoteRTPCapabilities(s,n)}}async preConnect(n,r,s,c,d,h){if(!this.connection)throw new he(B.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart();const f=await this.connection.connect(n,r,s,c,d,h);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=Vt.Connected,f}getEstablishParams(){if(this.connection instanceof yr)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}async publishDataChannel(n){if(!this.connection||this.state!==Vt.Connected){if(this.state===Vt.Disconnected)throw new he(B.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return void n.forEach(s=>{var c;Le(c=this.pendingLocalDataChannels).call(c,s)||this.pendingLocalDataChannels.push(s)})}const r=this.filterTobePublishedDataChannels(n);r.length!==0&&(r.forEach(s=>{const c=Date.now();this.store.publish(s.id.toString(),"datachannel",c)}),await this.connection.createDataChannels(this.store.uid,r),r.forEach(s=>{this.localDataChannels.push(s);const c=Date.now();this.store.publish(s.id+"","datachannel",void 0,c)}))}publish(n,r,s){var c=this;return Co(function*(){const d=yield ut(c.mutex.lock("From P2PChannel.publish"));try{if(!c.connection||c.state!==Vt.Connected){if(c.state===Vt.Disconnected)throw new he(B.UNEXPECTED_ERROR,"PeerConnection already disconnected.");c.throwIfTrackTypeNotMatch(n);const f=n.filter(g=>c.pendingLocalTracks.indexOf(g)===-1);return void(c.pendingLocalTracks=c.pendingLocalTracks.concat(f))}c.store.pubId=c.store.pubId+1,ei.markPublishStart(c.store.clientId,c.store.pubId);const h=c.filterTobePublishedTracks(n,r,s);if(h.length===0)return void(yield ut(c.tryToUnmuteAudio(n)));yield*Z0(T4(c.doPublish(c.connection,h)))}finally{d()}})()}doPublish(n,r){var s=this;return Co(function*(){r.forEach(w=>{let{track:A,type:L}=w;const P=Date.now();s.store.publish(A.getTrackId(),L===Ee.LocalAudioTrack?"audio":"video",P)}),s.bindLocalTrackEvents(r);const c=r.map(w=>{let{track:A}=w;return A}),d=yield ut(n.send(r.map(w=>{let{track:A}=w;return A}),s.store.codec,s.store.audioCodec)),h=(yield ut(d.next())).value,f=s.createGatewayPublishMessage(r,h);let g;try{g=yield f}catch(w){throw d.throw(w),(w==null?void 0:w.code)===B.WS_ABORT&&r.forEach(A=>{let{track:L}=A;s.pendingLocalTracks.indexOf(L)===-1&&s.pendingLocalTracks.push(L)}),s.unbindLocalTrackEvents(r),w}const _=s.mapPubResToRemoteConfig(f,g),E=(yield ut(d.next(_))).value,T=Y("ENABLE_VIDEO_SEI");c.forEach(async w=>{const A=w.getRTCRtpTransceiver();A&&T&&(w.trackMediaType===Fe.VIDEO?await async function(L,P){if(!Lt().supportWebRTCEncodedTransform)return void O.warning("browser not support video encoded transform");if(K0.has(L)||!L.track)return;const D={track:L.track};if(Hc()){if(!L.createEncodedStreams)return void O.warning("browser not support createEncodedStreams() API");let $=null;try{$=L.createEncodedStreams()}catch(Q){return void O.error("create video-encoded-streams error",Q&&Q.message)}let X=[];P.on("sei-to-send",Q=>{X.push(Q)});const ie=new TransformStream({transform(Q,te){D.controller||(D.controller=te),L.track&&L.track.id!==D.track.id&&(O.debug("video track changed: ".concat(D.track.id," => ").concat(L.track.id)),D.track.removeEventListener("ended",G),D.track=L.track,D.track.addEventListener("ended",G));const ce=X.shift();ce&&(Q.data=rce(Q.data,ce)),te.enqueue(Q)}});$.readable.pipeThrough(ie).pipeTo($.writable)}else{if(!Fr())return;{if(typeof RTCRtpScriptTransform>"u")return void O.warning("browser not support RTCRtpScriptTransform");const $=G0(),X=new MessageChannel;await new ae(Q=>$.onmessage=te=>{te.data==="registered"&&Q(void 0)});const ie=new RTCRtpScriptTransform($,{name:"tx",port:X.port2},[X.port2]);L.transform=ie,await new ae(Q=>$.onmessage=te=>{te.data==="started"&&Q(void 0)}),P.on("sei-to-send",Q=>{X.port1.postMessage({sei:Q})}),X.port1.onmessage=Q=>{var te;Q.data.transformed&&L.track&&((te=L.track)===null||te===void 0?void 0:te.id)!==D.track.id&&(O.debug("video track changed: ".concat(D.track.id," => ").concat(L.track.id)),D.track.removeEventListener("ended",G),D.track=L.track,D.track.addEventListener("ended",G))},D.worker=$}}function G(){if(L.track){if(this.id!==L.track.id)return;L.track.removeEventListener("ended",G)}const $=K0.get(L);if($){K0.delete(L);try{var X,ie;(X=$.controller)===null||X===void 0||X.terminate(),(ie=$.worker)===null||ie===void 0||ie.terminate()}catch(Q){O.warning(Q&&Q.message)}}}K0.set(L,D),L.track.addEventListener("ended",G)}(A.sender,w):w.trackMediaType===Fe.AUDIO&&await async function(L){if(!Lt().supportWebRTCEncodedTransform)return void O.warning("browser not support audio encoded transform");if(H0.has(L)||!L.track)return;const P={track:L.track};if(Hc()){if(!L.createEncodedStreams)return void O.warning("browser not support createEncodedStreams() API");let G=null;try{G=L.createEncodedStreams()}catch(X){return void O.error("create audio-encoded-streams error",X&&X.message)}const $=new TransformStream({transform(X,ie){P.controller||(P.controller=ie),L.track&&L.track.id!==P.track.id&&(O.debug("audio track changed: ".concat(P.track.id," => ").concat(L.track.id)),P.track.removeEventListener("ended",D),P.track=L.track,P.track.addEventListener("ended",D)),ie.enqueue(X)}});G.readable.pipeThrough($).pipeTo(G.writable)}else if(Fr()){if(typeof RTCRtpScriptTransform>"u")return void O.warning("browser not support RTCRtpScriptTransform");const G=G0(),$=new MessageChannel;await new ae(ie=>G.onmessage=Q=>{Q.data==="registered"&&ie(void 0)});const X=new RTCRtpScriptTransform(G,{name:"tx",port:$.port2},[$.port2]);L.transform=X,await new ae(ie=>G.onmessage=Q=>{Q.data==="started"&&ie(void 0)}),$.port1.onmessage=ie=>{var Q;ie.data.transformed&&L.track&&((Q=L.track)===null||Q===void 0?void 0:Q.id)!==P.track.id&&(O.debug("audio track changed: ".concat(P.track.id," => ").concat(L.track.id)),P.track.removeEventListener("ended",D),P.track=L.track,P.track.addEventListener("ended",D))},P.worker=G}function D(){if(L.track){if(this.id!==L.track.id)return;L.track.removeEventListener("ended",D)}const G=H0.get(L);if(G){H0.delete(L);try{var $,X;($=G.controller)===null||$===void 0||$.terminate(),(X=G.worker)===null||X===void 0||X.terminate()}catch(ie){O.warning(ie&&ie.message)}}}H0.set(L,P),L.track.addEventListener("ended",D)}(A.sender))}),r.forEach(w=>{let{type:A}=w;s.statsCollector.addLocalStats(A)}),s.assignLocalTracks(r,E),s.statsUploader.startUploadOutboundStats(),r.forEach(w=>{let{track:A,type:L}=w;const P=Date.now();s.store.publish(A.getTrackId(),L===Ee.LocalAudioTrack?"audio":"video",void 0,P)})})()}async updateVideoStreamParameter(n,r){const s=this.localTrackMap.get(r);if(!s)return;if(!(s.track instanceof ht))return O.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(this.connection instanceof kn||this.connection instanceof xr))return O.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");const{track:c}=s,d=function(h,f){const g={};return h.height&&h.width&&(g.scaleResolutionDownBy=VI(h,f)),g.maxFramerate=h.framerate?Wo(h.framerate):void 0,g.maxBitrate=h.bitrate?1e3*h.bitrate:void 0,g}(n,c);if(c._encoderConfig||(c._encoderConfig={}),r!==Ee.LocalVideoLowTrack||!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&Lt().supportDualStreamEncoding)d.scaleResolutionDownBy!=null&&(c._encoderConfig.scaleResolutionDownBy=d.scaleResolutionDownBy);else{const h=c._originMediaStreamTrack;if(!h.canvas)return O.warn("[".concat(c.getTrackId(),"] no canvas on track"));(function(f,g){const _=f.canvas;g.width&&(_.width=Wo(g.width)),g.height&&(_.height=Wo(g.height)),g.framerate&&(_.stopCapture&&_.stopCapture(),_.stopCapture=rA(()=>{!_.startCapture&&_.stopCapture&&_.stopCapture(),_.startCapture&&_.startCapture()},Wo(g.framerate)))})(h,n)}d.maxBitrate!=null&&(c._encoderConfig.bitrateMax=d.maxBitrate/1e3),d.maxFramerate!=null&&(c._encoderConfig.frameRate&&typeof c._encoderConfig.frameRate=="object"?c._encoderConfig.frameRate.max=d.maxFramerate:c._encoderConfig.frameRate={max:d.maxFramerate}),O.debug("[".concat(c.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(c._encoderConfig))),await this.connection.updateRtpSenderEncodings(c)}publishLowStream(n){var r=this;return Co(function*(){if(!r.connection||r.state!==Vt.Connected)return;const s=yield ut(r.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const d=r.localTrackMap.get(Ee.LocalVideoTrack);if(!d)throw new he(B.UNEXPECTED_ERROR,"Could not find high stream");if(r.localTrackMap.has(Ee.LocalVideoLowTrack))throw new he(B.UNEXPECTED_ERROR,"[".concat(r.store.clientId,"] Can't publish low stream when stream already publish"));const h=[{track:r.getLowVideoTrack(d.track,n),type:Ee.LocalVideoLowTrack}];if(yield*Z0(T4(r.doPublish(r.connection,h))),d.track.muted||!d.track.enabled){var c;const f=(c=r.localTrackMap.get(Ee.LocalVideoLowTrack))===null||c===void 0?void 0:c.id;f!==void 0&&(yield ut(r.connection.muteLocal([f])))}}finally{s()}})()}async republish(){this.pendingLocalTracks.length>0&&(O.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await nr(this,Xe.RequestRePublish,this.pendingLocalTracks),this.emit(Xe.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(O.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await nr(this,Xe.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[])}async reSubscribe(n){for(let r=this.pendingRemoteTracks.length-1;r>=0;r--){const{user:s,kind:c}=this.pendingRemoteTracks[r];(c!==Fe.AUDIO||s._audio_added_&&s._audioSSRC)&&(c!==Fe.VIDEO||s._video_added_&&s._videoSSRC)||this.pendingRemoteTracks.splice(r,1)}if(n)await nr(this,Xe.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:r,kind:s}of this.pendingRemoteTracks)await this.subscribe(r,s,s===Fe.VIDEO?r._videoSSRC:r._audioSSRC);this.pendingRemoteTracks.forEach(r=>{let{user:s}=r;this.emit(Xe.MediaReconnectEnd,s.uid)}),this.pendingRemoteTracks=[]}async unpublish(n){if(!this.connection||this.state!==Vt.Connected)return void n.forEach(c=>{const d=this.pendingLocalTracks.indexOf(c);d!==-1&&this.pendingLocalTracks.splice(d,1)});const r=this.filterTobeUnpublishedTracks(n);if(r.length===0)return;const s=r.find(c=>c[0]==="videoLowTrack");return s&&s[1].track.close(),this.doUnpublish(this.connection,r)}async unpublishDataChannel(n){if(!this.connection||this.state!==Vt.Connected)return void n.forEach(s=>{const c=this.pendingLocalDataChannels.indexOf(s);c!==-1&&this.pendingLocalDataChannels.splice(c,1)});const r=this.filterTobeUnpublishedDataChannels(n);return r.length!==0?(r.forEach(s=>{const c=this.localDataChannels.indexOf(s);c!==-1&&this.localDataChannels.splice(c,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),r.map(s=>s.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==Vt.Connected)return;const n=this.localTrackMap.get(Ee.LocalVideoLowTrack);if(!n)return;n.track.close();const r=[[Ee.LocalVideoLowTrack,n]];return this.doUnpublish(this.connection,r)}async doUnpublish(n,r){const s=this.createGatewayUnpublishMessage(r);return await n.stopSending(r.map(c=>{let[,{id:d}]=c;return d})),this.withdrawLocalTracks(r),this.unbindLocalTrackEvents(r.map(c=>{let[d,{track:h}]=c;return{type:d,track:h}})),r.forEach(c=>{let[d]=c;this.statsCollector.removeLocalStats(d)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),s}async subscribeDataChannel(n,r){if(!this.connection||this.state!==Vt.Connected)throw new he(B.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const s=r.filter(c=>{var d;return!((d=this.remoteDataChannelMap.get(n))!==null&&d!==void 0&&d.get(c.id))});if(s.length!==0)return await this.connection.createDataChannels(n.uid,s),s.forEach(c=>{var d;this.remoteDataChannelMap.has(n)?(d=this.remoteDataChannelMap.get(n))===null||d===void 0||d.set(c.id,c):this.remoteDataChannelMap.set(n,new Map([[c.id,c]]));const h=this.pendingRemoteDataChannels.findIndex(f=>{let{user:g,id:_}=f;return g.uid===n.uid&&_===c.id});h!==-1&&this.pendingRemoteDataChannels.splice(h,1)}),s.map(c=>c.id)}async subscribe(n,r,s,c,d){var h;if(!this.connection||this.state!==Vt.Connected)throw new he(B.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((h=this.remoteUserMap.get(n))!==null&&h!==void 0&&h.has(r))return;let f,g,_;if(d){const w=d.find(L=>{let{stream_type:P}=L;return P===r});if(!w)throw new he(B.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(r," for user: ").concat(n.uid," because subscribe answer from gateway does not contain stream_type: ").concat(r,"."));const A=await this.connection.receive(r,w.ssrcs,String(n._uintid),w.attributes);this.connection instanceof kn&&(_=A.transceiver),f=A.track,g=A.id}else{const w=await this.connection.receive(r,[{ssrcId:s,rtx:c}],String(n._uintid),void 0);this.connection instanceof kn&&(_=w.transceiver),f=w.track,g=w.id}r===Fe.AUDIO?(n._audioTrack?n._audioTrack._updateOriginMediaStreamTrack(f):(n._audioTrack=new Ys(f,n.uid,n._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(n._audioTrack.getTrackId()))),_&&n._audioTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(n,n._audioTrack)):(n._videoTrack?n._videoTrack._updateOriginMediaStreamTrack(f):(n._videoTrack=new oc(f,n.uid,n._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(n._videoTrack.getTrackId()))),_&&n._videoTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(n,n._videoTrack)),Y("ENABLE_VIDEO_SEI")&&_&&(r==Fe.VIDEO?await ice(_.receiver,{onSei:w=>{var A;(A=n._videoTrack)===null||A===void 0||A._onSei(w)}}):r==Fe.AUDIO&&await tce(_.receiver));const E=this.remoteUserMap.get(n);E?E.set(r,g):this.remoteUserMap.set(n,new Map([[r,g]])),this.statsCollector.addRemoteStats(n.uid),this.statsUploader.startUploadInboundStats();const T=this.pendingRemoteTracks.findIndex(w=>{let{user:A,kind:L}=w;return A.uid===n.uid&&r===L});T!==-1&&(this.pendingRemoteTracks.splice(T,1),this.emit(Xe.MediaReconnectEnd,n.uid))}async massSubscribe(n){return this.massSubscribeNoLock(n)}async massSubscribeNoLock(n){if(!this.connection||this.state!==Vt.Connected)throw new he(B.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");n=n.filter(s=>{var c;let{user:d,mediaType:h}=s;return!((c=this.remoteUserMap.get(d))!==null&&c!==void 0&&c.has(h))});const r=await this.connection.batchReceive(n.map(s=>{let{user:c,mediaType:d,ssrcId:h,rtxSsrcId:f}=s;return{kind:d,ssrcMsg:[{ssrcId:h,rtx:f}],mslabel:String(c._uintid)}}));n.forEach((s,c)=>{let{user:d,mediaType:h}=s;const{track:f,id:g,transceiver:_}=r[c];h===Fe.AUDIO?(d._audioTrack?d._audioTrack._updateOriginMediaStreamTrack(f):(d._audioTrack=new Ys(f,d.uid,d._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(d._audioTrack.getTrackId()))),_&&d._audioTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(d,d._audioTrack)):(d._videoTrack?d._videoTrack._updateOriginMediaStreamTrack(f):(d._videoTrack=new oc(f,d.uid,d._uintid,this.store),O.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(d._videoTrack.getTrackId()))),_&&d._videoTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(d,d._videoTrack));const E=this.remoteUserMap.get(d);E?E.set(h,g):this.remoteUserMap.set(d,new Map([[h,g]])),this.statsCollector.addRemoteStats(d.uid),this.statsUploader.startUploadInboundStats();const T=this.pendingRemoteTracks.findIndex(w=>{let{user:A,kind:L}=w;return A.uid===d.uid&&h===L});T!==-1&&(this.pendingRemoteTracks.splice(T,1),this.emit(Xe.MediaReconnectEnd,d.uid))})}async unsubscribe(n,r,s){const c=this.pendingRemoteTracks.filter(f=>{let{user:g,kind:_}=f;return r!==void 0?g.uid===n.uid&&r===_:g.uid===n.uid});if(c.forEach(f=>{const g=this.pendingRemoteTracks.indexOf(f);this.pendingRemoteTracks.splice(g,1)}),this.connection&&this.state===Vt.Connected||s||c.forEach(f=>{let{kind:g}=f;var _;if(g===Fe.AUDIO)(_=n._audioTrack)===null||_===void 0||_._destroy(),n._audioTrack=void 0;else if(g===Fe.VIDEO){var E;(E=n._videoTrack)===null||E===void 0||E._destroy(),n._videoTrack=void 0}}),!this.connection||this.state!==Vt.Connected)return;const d=this.filterTobeUnSubscribedTracks(n,r);if(d.length===0)return;await this.connection.stopReceiving(d.map(f=>{let[,{id:g}]=f;return g}));const h=this.createUnsubscribeMessage(d);return this.withdrawRemoteTracks(d),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),d.forEach(f=>{let[g,{kind:_}]=f;var E,T;if(_===Fe.VIDEO&&g._videoSSRC&&((E=this.connection)===null||E===void 0||E.setStatsRemoteVideoIsReady(g._videoSSRC,!1)),_===Fe.VIDEO)this.unbindRemoteTrackEvents(g._videoTrack),s||((T=g._videoTrack)===null||T===void 0||T._destroy(),g._videoTrack=void 0);else if(_===Fe.AUDIO){var w;this.unbindRemoteTrackEvents(g._audioTrack),!s&&((w=g._audioTrack)===null||w===void 0||w._destroy(),g._audioTrack=void 0)}}),h}async unsubscribeDataChannel(n,r){if(r.forEach(d=>{const h=this.pendingRemoteDataChannels.findIndex(f=>f.id===d.id);h!==-1&&this.pendingRemoteDataChannels.splice(h,1)}),!this.connection)return;const s=this.filterTobeUnSubscribedDataChannels(n,r);if(s.length===0)return;r.forEach(d=>{d._close()});const c=this.remoteDataChannelMap.get(n);return s.forEach(d=>{c&&c.delete(d.id)}),c&&c.size===0&&(this.remoteDataChannelMap.delete(n),await this.connection.stopDataChannels(n.uid)),s.map(d=>d.id)}async massUnsubscribe(n){return this.massUnsubscribeNoLock(n)}async massUnsubscribeNoLock(n){let r=[];for(const{user:d,mediaType:h}of n){const f=this.pendingRemoteTracks.filter(g=>{let{user:_,kind:E}=g;return h!==void 0?_.uid===d.uid&&h===E:_.uid===d.uid});f.forEach(g=>{const _=this.pendingRemoteTracks.indexOf(g);this.pendingRemoteTracks.splice(_,1)}),r=r.concat(f)}if(!this.connection||this.state!==Vt.Connected)return void r.forEach(d=>{let{user:h,kind:f}=d;var g;if(f===Fe.AUDIO)(g=h._audioTrack)===null||g===void 0||g._destroy(),h._audioTrack=void 0;else if(f===Fe.VIDEO){var _;(_=h._videoTrack)===null||_===void 0||_._destroy(),h._videoTrack=void 0}});const s=qc(n).call(n,(d,h)=>{let{user:f,mediaType:g}=h;const _=this.filterTobeUnSubscribedTracks(f,g);return d.concat(_)},[]);if(s.length===0)return;await this.connection.stopReceiving(s.map(d=>{let[,{id:h}]=d;return h}));const c=this.createUnsubscribeAllMessage(s);return this.withdrawRemoteTracks(s),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),s.forEach(d=>{let[h,{kind:f}]=d;var g,_;if(f===Fe.VIDEO&&h._videoSSRC&&((g=this.connection)===null||g===void 0||g.setStatsRemoteVideoIsReady(h._videoSSRC,!1)),f===Fe.VIDEO)this.unbindRemoteTrackEvents(h._videoTrack),(_=h._videoTrack)===null||_===void 0||_._destroy(),h._videoTrack=void 0;else if(f===Fe.AUDIO){var E;this.unbindRemoteTrackEvents(h._audioTrack),(E=h._audioTrack)===null||E===void 0||E._destroy(),h._audioTrack=void 0}}),c}async muteRemote(n,r){if(!this.connection)return;const s=this.remoteUserMap.get(n);if(!s)return void O.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(n.uid,"."));if(!s.get(r))return void O.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(n.uid," media type ").concat(r,"."));const c=r===Fe.VIDEO?n._videoSSRC:n._audioSSRC;c!==void 0&&this.connection.setStatsRemoteVideoIsReady(c,!1)}async unmuteRemote(n,r){return this.unmuteRemoteNoLock(n,r)}async unmuteRemoteNoLock(n,r){if(!this.connection)return;const s=this.remoteUserMap.get(n);if(!s)return void O.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(n.uid,"."));s.get(r)||O.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(n.uid," media type ").concat(r,"."))}getAllTracks(n){const r=this.localTrackMap.get(Ee.LocalAudioTrack);if((r==null?void 0:r.track)instanceof lr){const s=r.track;return Array.from(this.localTrackMap.entries()).filter(c=>{let[d]=c;return d!==Ee.LocalAudioTrack}).filter(c=>{let[d]=c;return!(n&&d===Ee.LocalVideoLowTrack)}).map(c=>{let[,{track:d}]=c;return d}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[c]=s;return!(n&&c===Ee.LocalVideoLowTrack)}).map(s=>{let[,{track:c}]=s;return c})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(n,r,s,c,d){if(n){const f=this.localTrackMap.get(Ee.LocalAudioTrack),g=c?this.localTrackMap.get(Ee.LocalVideoLowTrack):this.localTrackMap.get(Ee.LocalVideoTrack);Be.publish(this.store.sessionId,{eventElapse:ei.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:r,audioName:f==null?void 0:f.track.getTrackLabel(),videoName:g==null?void 0:g.track.getTrackLabel(),screenshare:(g==null?void 0:g.track._hints.indexOf(tn.SCREEN_TRACK))!==-1,audio:!!f,video:!!g,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}else{var h;s||(s=[]);const f=s.find(_=>_ instanceof Gt),g=c?(h=this.localTrackMap.get(Ee.LocalVideoTrack))===null||h===void 0?void 0:h.track:s.find(_=>_ instanceof ht);Be.publish(this.store.sessionId,{eventElapse:ei.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:n,ec:r,audioName:f==null?void 0:f.getTrackLabel(),videoName:g==null?void 0:g.getTrackLabel(),screenshare:(g==null?void 0:g._hints.indexOf(tn.SCREEN_TRACK))!==-1,audio:!!f,video:!!g,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:d})}}reportSubscribeEvent(n,r,s,c){const d=c===Fe.VIDEO?s._videoSSRC:s._audioSSRC;d&&Be.subscribe(this.store.sessionId,{succ:n,ec:r,video:c===Fe.VIDEO,audio:c===Fe.AUDIO,peerid:s.uid,subscribeRequestid:c===Fe.VIDEO?s._videoSSRC:s._audioSSRC,p2pid:this.store.p2pId,eventElapse:ei.measureFromSubscribeStart(this.store.clientId,d)})}reset(){O.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Pr("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new yr({},this.store):this.isPlanB?new xr({},this.store):new kn({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const n=this.localTrackMap.get(Ee.LocalAudioTrack);if((n==null?void 0:n.track)instanceof lr){if(n.track.trackList.length>0){const r=n.track;n.track.trackList.forEach(s=>{r.removeAudioTrack(s)})}n.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=Vt.Disconnected}getStats(){var n;return(n=this.connection)===null||n===void 0?void 0:n.getStats()}getRemoteVideoIsReady(n){var r;return((r=this.connection)===null||r===void 0?void 0:r.getRemoteVideoIsReady(n))||!1}getLocalAudioVolume(){const n=this.localTrackMap.get(Ee.LocalAudioTrack);if(n)return n.track.getVolumeLevel()}getLocalVideoSize(){const n=this.localTrackMap.get(Ee.LocalVideoTrack);if(n)return{width:n.track._videoWidth||0,height:n.track._videoHeight||0}}getEncoderConfig(n){const r=this.localTrackMap.get(n);return r&&r.track instanceof ht||r&&r.track instanceof Gt?r.track._encoderConfig:void 0}getLocalMedia(n){return this.localTrackMap.get(n)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(n,r){if(!n)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(n);return!!s&&(!r||s.has(r))}async hasRemoteMediaWithLock(n,r){if(!n)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(n);return!!s&&(!r||s.has(r))}getRemoteMedia(n){var r;const s=Array.from(jo(r=this.remoteUserMap).call(r)).find(c=>c.uid===n);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let n=Array.from(this.remoteUserMap.entries()).map(s=>{let[c]=s;return{uid:c.uid,level:c.audioTrack?100*c.audioTrack._source.getAccurateVolumeLevel():0}});const r=this.localTrackMap.get(Ee.LocalAudioTrack);return r&&n.push({level:100*r.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),n=cg(n).call(n,(s,c)=>s.level-c.level),n}async disconnectForReconnect(){this.connection&&(O.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=Vt.Reconnecting,Y("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r]=n;var s;r._videoTrack&&r._videoTrack._player&&((s=r._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),r._videoTrack._player.isKeepLastFrame=!0,r._videoTrack._originMediaStreamTrack.stop())}),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new yr({},this.store):this.isPlanB?new xr({},this.store):new kn({},this.store),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(n=>{var r;let[s,{track:c}]=n;switch(s){case Ee.LocalVideoTrack:Le(r=c._hints).call(r,tn.LOW_STREAM)?c.close():this.pendingLocalTracks.push(c);break;case Ee.LocalAudioTrack:c instanceof lr?this.pendingLocalTracks=this.pendingLocalTracks.concat(c.trackList):this.pendingLocalTracks.push(c);case Ee.LocalVideoLowTrack:}}),this.emit(Xe.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r,s]=n;Array.from(jo(s).call(s)).forEach(c=>{this.setPendingRemoteMedia(r,c)}),this.emit(Xe.MediaReconnectStart,r.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(n=>{this.pendingLocalDataChannels.push(n)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(n=>{let[r,s]=n;Array.from(jo(s).call(s)).forEach(c=>{this.setPendingRemoteDataChannel(r,c)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),O.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(n,r){for(const s of this.pendingRemoteDataChannels){const{user:c,id:d}=s;if((n instanceof Br?n.uid:n)===c.uid&&d===r)return!0}return!1}setPendingRemoteDataChannel(n,r){this.hasPendingRemoteDataChannel(n,r)||this.pendingRemoteDataChannels.push({user:n,id:r})}hasPendingRemoteMedia(n,r){for(const s of this.pendingRemoteTracks){const{user:c,kind:d}=s;if((n instanceof Br?n.uid:n)===c.uid&&r===d)return!0}return!1}setPendingRemoteMedia(n,r){this.hasPendingRemoteMedia(n,r)||this.pendingRemoteTracks.push({user:n,kind:r})}restartICE(n){var r=this;return Co(function*(){if(!r.connection||r.state!==Vt.Connected||r.connection instanceof yr)return;const s=yield ut(r.mutex.lock("From P2PChannel.restartICE"));let c;try{c=yield ut(r.connection.restartICE(n));const h=yield ut(c.next());if(h.done)return;const f=h.value,g=yield f;switch(r.reportPCDisconnectedOrFailed(n),n){case Qr.TCP:r._pcStatsUploadType=Oa.TCP_RESTART;break;case Qr.RELAY:r._pcStatsUploadType=Oa.RELAY_RESTART;break;default:r._pcStatsUploadType=Oa.OLD_RESTART}r._isInRestartIce=!0,c.next(g)}catch(h){var d;(d=c)===null||d===void 0||d.throw(h)}finally{s()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const n=this.connection.getStats(),r=this.localTrackMap.get(Ee.LocalVideoTrack),s=this.localTrackMap.get(Ee.LocalAudioTrack),c=n.videoSend.find(L=>L.ssrc===(r==null?void 0:r.ssrcs[0].ssrcId)),d=n.audioSend.find(L=>L.ssrc===(s==null?void 0:s.ssrcs[0].ssrcId));if(!c||!d)return 1;const h=yo(this,Xe.NeedSignalRTT),f=c?c.rttMs:void 0,g=d?d.rttMs:void 0,_=f&&g?(f+g)/2:f||g,E=(_&&h?(_+h)/2:_||h)||0,T=100*n.sendPacketLossRate*.7/50+.3*E/1500,w=T<.17?1:T<.36?2:T<.59?3:T<.1?4:5,A=r==null?void 0:r.track;if(A&&A._encoderConfig&&A._hints.indexOf(tn.SCREEN_TRACK)===-1){const L=A._encoderConfig.bitrateMax,P=n.bitrate.actualEncoded;if(L&&P){const D=(1e3*L-P)/(1e3*L);return SF[D<.15?0:D<.3?1:D<.45?2:D<.6?3:4][w]}}return w}getDownlinkNetworkQuality(){if(!this.connection)return 0;const n=this.connection.getStats();let r=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[c]=s;const d=c._audioSSRC,h=c._videoSSRC,f=n.audioRecv.find(P=>P.ssrc===d),g=n.videoRecv.find(P=>P.ssrc===h);if(!f&&!g)return void(r+=1);const _=yo(this,Xe.NeedSignalRTT),E=n.rtt,T=(E&&_?(E+_)/2:E||_)||0,w=f?f.jitterMs:void 0,A=n.recvPacketLossRate;let L=.7*A*100/50+.3*T/1500;w&&(L=.6*A*100/50+.2*T/1500+.2*w/400),r+=L<.1?1:L<.17?2:L<.36?3:L<.59?4:5}),this.remoteUserMap.size>0?Math.round(r/this.remoteUserMap.size):r}async muteLocalTrack(n){return new ae((r,s)=>{this.handleMuteLocalTrack(n,r,s)})}async replaceTrack(n,r){var s;if(O.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(n.getTrackId(),"] to [").concat(r.getTrackId(),"]")),!this.connection||this.state!==Vt.Connected)return;const c=Array.from(this.localTrackMap.entries()).find(h=>{let[,{track:f}]=h;return n===f});if(!c)return;const d=c[0];if(n!==r&&(this.unbindLocalTrackEvents([{track:n,type:d}]),this.bindLocalTrackEvents([{track:r,type:d}]),c[1].track=r),await((s=this.connection)===null||s===void 0?void 0:s.replaceTrack(r,c[1].id)),this.isPlanB){const h=c[1];h.id=r._mediaStreamTrack.id,this.localTrackMap.set(d,h)}if(d===Ee.LocalVideoTrack&&!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&Lt().supportDualStreamEncoding){const h=this.localTrackMap.get(Ee.LocalVideoLowTrack);if(h){const f=n._mediaStreamTrack.clone();h.track._originMediaStreamTrack.stop(),h.track._mediaStreamTrack=f,h.track._originMediaStreamTrack=f,await new ae((g,_)=>{this.handleReplaceTrack(h.track,g,_,!0)})}}}filterTobePublishedTracks(n,r,s){const c=[],d=this.getAllTracks();n=Tp(n=n.filter(_=>d.indexOf(_)===-1));let h,f=!1;const g=this.localTrackMap.get(Ee.LocalAudioTrack);for(const _ of n){if(_ instanceof ht&&(this.localTrackMap.has(Ee.LocalVideoTrack)||f?new he(B.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(c.push({track:_,type:Ee.LocalVideoTrack}),f=!0),r)){const E=this.getLowVideoTrack(_,s);c.push({track:E,type:Ee.LocalVideoLowTrack})}if(_ instanceof Gt)if(g){const E=g.track;if(E instanceof lr)b1([_]),E.addAudioTrack(_),this.bindLocalAudioTrackEvents(_,!0);else{const T=C1([E,_]);O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(T.getTrackId(),"]")),this.replaceTrack(E,T)}}else h instanceof lr?(b1([_]),h.addAudioTrack(_)):h||!_._useAudioElement&&Lt().webAudioMediaStreamDest&&!_._bypassWebAudio?h=C1(h?[_,h]:[_]):h=_}return h&&(O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(h.getTrackId(),"]")),c.push({track:h,type:Ee.LocalAudioTrack})),c}filterTobeUnpublishedTracks(n){const r=[],s=this.getAllTracks();n=Tp(n=n.filter(c=>s.indexOf(c)!==-1));for(const c of n){if(c instanceof Gt){const d=this.localTrackMap.get(Ee.LocalAudioTrack);if(!d)continue;d.track instanceof lr?(d.track.removeAudioTrack(c),this.unbindLocalAudioTrackEvents(c),d.track.trackList.length===0&&(r.push([Ee.LocalAudioTrack,d]),d.track.close())):r.push([Ee.LocalAudioTrack,d])}if(c instanceof ht){const d=this.localTrackMap.get(Ee.LocalVideoTrack);if(!d)continue;r.push([Ee.LocalVideoTrack,d]);const h=this.localTrackMap.get(Ee.LocalVideoLowTrack);h&&r.push([Ee.LocalVideoLowTrack,h])}}return r}filterTobePublishedDataChannels(n){return n=(n=Tp(n)).filter(r=>this.localDataChannels.findIndex(s=>s.id===r.id)===-1)}filterTobeUnpublishedDataChannels(n){return n=(n=(n=Tp(n)).filter(r=>this.localDataChannels.indexOf(r)!==-1)).filter(r=>r._originDataChannel)}bindLocalTrackEvents(n){n.forEach(r=>{let{track:s,type:c}=r;switch(c){case Ee.LocalVideoTrack:s.addListener(ke.GET_STATS,this.handleGetLocalVideoStats),s.addListener(ke.GET_RTC_STATS,this.handleGetRTCStats),s.addListener(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(ke.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(ke.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),s.addListener(ke.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ee.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case Ee.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(n,r){n instanceof lr?n.trackList.forEach(s=>{s.addListener(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(ke.GET_STATS,this.handleGetLocalAudioStats),s.addListener(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.addListener(ke.GET_STATS,this.handleGetLocalAudioStats),n.addListener(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.addListener(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.addListener(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.addListener(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),r||(n.addListener(ke.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.addListener(ke.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(n){n||(n=Array.from(this.localTrackMap.entries()).map(r=>{let[s,{track:c}]=r;return{track:c,type:s}})),n.forEach(r=>{let{track:s,type:c}=r;switch(c){case Ee.LocalVideoTrack:s.off(ke.GET_STATS,this.handleGetLocalVideoStats),s.off(ke.GET_RTC_STATS,this.handleGetRTCStats),s.off(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(ke.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(ke.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),s.off(ke.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Ee.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case Ee.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(n){n instanceof lr?n.trackList.forEach(r=>{r.off(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(ke.GET_STATS,this.handleGetLocalAudioStats),r.off(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(n.off(ke.GET_STATS,this.handleGetLocalAudioStats),n.off(ke.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(ke.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(ke.NEED_REPLACE_TRACK,this.handleReplaceTrack),n.off(ke.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),n.off(ke.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(ke.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(n,r){r instanceof oc&&r.addListener(ke.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(n))}),r instanceof Ys&&r.addListener(ke.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(n))})}unbindRemoteTrackEvents(n){n&&n.removeAllListeners(ke.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(n=>{let[r,s]=n;s.has(Fe.AUDIO)&&this.unbindRemoteTrackEvents(r._audioTrack),s.has(Fe.VIDEO)&&this.unbindRemoteTrackEvents(r._videoTrack)})}createGatewayPublishMessage(n,r){return n.map((s,c)=>{var d;let h,f,{track:g,type:_}=s;switch(_){case Ee.LocalAudioTrack:h=jt.Audio,f={dtx:g instanceof Fu&&g._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Ee.LocalVideoTrack:h=Le(d=g._hints).call(d,tn.SCREEN_TRACK)?jt.Screen:jt.High,f=Rd(Rd({},WF(g)),{},{codec:this.store.codec});break;case Ee.LocalVideoLowTrack:h=jt.Low,f=Rd(Rd({},WF(g)),{},{codec:this.store.codec})}return{stream_type:h,attributes:f,ssrcs:r[c]}})}createGatewayUnpublishMessage(n){return n.map(r=>{var s;let c,[d,{track:h,ssrcs:f,id:g}]=r;switch(d){case Ee.LocalVideoTrack:c=Le(s=h._hints).call(s,tn.SCREEN_TRACK)?jt.Screen:jt.High;break;case Ee.LocalAudioTrack:c=jt.Audio;break;case Ee.LocalVideoLowTrack:c=jt.Low}return{stream_type:c,ssrcs:f,mid:g}})}assignLocalTracks(n,r){n.forEach((s,c)=>{let{track:d,type:h}=s;this.localTrackMap.set(h,{track:d,id:r[c].id,ssrcs:r[c].localSSRC})})}withdrawLocalTracks(n){n.forEach(r=>{let[s]=r;this.localTrackMap.delete(s)})}bindConnectionEvents(n){n.onConnectionStateChange=async r=>{if(O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(r,")")),this.emit(Xe.PeerConnectionStateChange,r),r!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),r==="connected"&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),Y("NEW_ICE_RESTART")){var s;if(Le(s=this._restartStates).call(s,r)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const c=f=>{(n.iceConnectionState==="disconnected"||n.iceConnectionState==="checking"||n.iceConnectionState==="failed")&&(O.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(f)),yo(this,Xe.QueryClientConnectionState)==="CONNECTED"&&this.emit(Xe.RequestRestartICE,f))},d=()=>{n.iceConnectionState!=="disconnected"&&n.iceConnectionState!=="checking"&&n.iceConnectionState!=="failed"||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),O.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Xe.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},h=Y("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout(()=>{if(Y("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Lt().supportPCSetConfiguration)c(Qr.RELAY),this._restartTimer=window.setTimeout(d,h);else if(Jt())c(Qr.UDP),this._restartTimer=window.setTimeout(d,4e3);else{if(c(Qr.TCP),Lt().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout(()=>{c(Qr.RELAY),this._restartTimer=window.setTimeout(d,h)},h));this._restartTimer=window.setTimeout(d,h)}},800))}}else{if(r==="disconnected"&&n.iceConnectionState==="disconnected")return setTimeout(()=>{n.iceConnectionState==="disconnected"&&Y("ICE_RESTART")&&yo(this,Xe.QueryClientConnectionState)==="CONNECTED"&&this.emit(Xe.RequestRestartICE)},800),void setTimeout(()=>{n.peerConnectionState==="disconnected"&&(O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout(()=>this.emit(Xe.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);r==="failed"&&(O.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout(()=>this.emit(Xe.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},n.onICEConnectionStateChange=r=>{r!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(r,")")),Be.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:r,tag:yn.TRACER}).onSuccess(),this.emit(Xe.IceConnectionStateChange,r)},n.onICETransportStateChange=r=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(r,")"))},n.onDTLSTransportStateChange=r=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(r,")"))},n.onDTLSTransportError=r=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(r,")"))},n.onFirstAudioDecoded=r=>{var s;const c=Array.from(jo(s=this.remoteUserMap).call(s)).find(h=>h._audioSSRC===r);var d;c&&(this.store.subscribe(c.uid,"audio",void 0,void 0,void 0,Date.now()),(d=c.audioTrack)===null||d===void 0||d.emit(pd.FIRST_FRAME_DECODED),Be.firstRemoteFrame(this.store.sessionId,gr.FIRST_AUDIO_DECODE,dn.FIRST_AUDIO_DECODE,{peer:c._uintid,subscribeElapse:ei.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId}))},n.onFirstAudioReceived=r=>{var s;const c=Array.from(jo(s=this.remoteUserMap).call(s)).find(d=>d._audioSSRC===r);c&&Be.firstRemoteFrame(this.store.sessionId,gr.FIRST_AUDIO_RECEIVED,dn.FIRST_AUDIO_RECEIVED,{peer:c._uintid,subscribeElapse:ei.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},n.onFirstVideoDecoded=(r,s,c)=>{this.reportVideoFirstFrameDecoded(r,s,c)},n.onFirstVideoReceived=r=>{var s;const c=Array.from(jo(s=this.remoteUserMap).call(s)).find(d=>d._videoSSRC===r);c&&Be.firstRemoteFrame(this.store.sessionId,gr.FIRST_VIDEO_RECEIVED,dn.FIRST_VIDEO_RECEIVED,{peer:c._uintid,subscribeElapse:ei.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId})},n.onSelectedLocalCandidateChanged=(r,s)=>{const c=r.candidateType==="relay",d=s.candidateType==="relay";s.candidateType!=="unknown"&&c===d||this.emit(Xe.ConnectionTypeChange,c),O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(ld(s))," -> ").concat(JSON.stringify(ld(r)),")"))},n.onSelectedRemoteCandidateChanged=(r,s)=>{O.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(ld(s))," -> ").concat(JSON.stringify(ld(r)),")"))},n.onFirstVideoDecodedTimeout=r=>{this.reportVideoFirstFrameDecoded(r,void 0,void 0,!0)}}unbindConnectionEvents(n){n.onConnectionStateChange=void 0,n.onICEConnectionStateChange=void 0,n.onICETransportStateChange=void 0,n.onDTLSTransportStateChange=void 0,n.onDTLSTransportError=void 0,n.onFirstAudioDecoded=void 0,n.onFirstAudioReceived=void 0,n.onFirstVideoDecoded=void 0,n.onFirstVideoReceived=void 0,n.onSelectedLocalCandidateChanged=void 0,n.onSelectedRemoteCandidateChanged=void 0,n.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(n){const r=[];if(this.getAllTracks().indexOf(n)===-1)return r;const s=this.localTrackMap.get(Ee.LocalAudioTrack);if(n instanceof Gt&&(s==null?void 0:s.track)instanceof lr)return s.track.isActive||r.push([Ee.LocalAudioTrack,s]),r;const c=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:h}]=d;return n===h});if(c&&(r.push(c),c[0]===Ee.LocalVideoTrack)){const d=this.localTrackMap.get(Ee.LocalVideoLowTrack);d&&r.push([Ee.LocalVideoLowTrack,d])}return r}filterTobeUnmutedTracks(n){const r=[],s=this.localTrackMap.get(Ee.LocalAudioTrack);if(n instanceof Gt&&(s==null?void 0:s.track)instanceof lr)return s.track.isActive&&r.push([Ee.LocalAudioTrack,s]),r;const c=Array.from(this.localTrackMap.entries()).find(d=>{let[,{track:h}]=d;return n===h});if(c)if(c[0]===Ee.LocalVideoTrack){r.push(c);const d=this.localTrackMap.get(Ee.LocalVideoLowTrack);d&&r.push([Ee.LocalVideoLowTrack,d])}else r.push(c);return r}createMuteMessage(n){return n.map(r=>{var s;let c,[d,{track:h,ssrcs:f,id:g}]=r;switch(d){case Ee.LocalAudioTrack:c=jt.Audio;break;case Ee.LocalVideoTrack:c=Le(s=h._hints).call(s,tn.SCREEN_TRACK)?jt.Screen:jt.High;break;case Ee.LocalVideoLowTrack:c=jt.Low}return{stream_type:c,ssrcs:f,mid:g}})}createUnmuteMessage(n){return n.map(r=>{var s;let c,[d,{track:h,ssrcs:f,id:g}]=r;switch(d){case Ee.LocalAudioTrack:c=jt.Audio;break;case Ee.LocalVideoTrack:c=Le(s=h._hints).call(s,tn.SCREEN_TRACK)?jt.Screen:jt.High;break;case Ee.LocalVideoLowTrack:c=jt.Low}return{stream_type:c,ssrcs:f,mid:g}})}filterTobeUnSubscribedTracks(n,r){const s=[],c=this.remoteUserMap.get(n);if(!c)return s;if(r){const d=c.get(r);if(!d)return s;s.push([n,{kind:r,id:d}])}else Array.from(c.entries()).forEach(d=>{let[h,f]=d;s.push([n,{kind:h,id:f}])});return s}filterTobeUnSubscribedDataChannels(n,r){const s=[];return r.forEach(c=>{var d;(d=this.remoteDataChannelMap.get(n))!==null&&d!==void 0&&d.has(c.id)&&s.push(c)}),s}createUnsubscribeMessage(n){const r=[];return n.forEach(s=>{let[c,{kind:d,id:h}]=s;switch(d){case Fe.VIDEO:return void(c._videoSSRC&&r.push({stream_type:Fe.VIDEO,ssrcId:c._videoSSRC}));case Fe.AUDIO:return void(c._audioSSRC&&r.push({stream_type:Fe.AUDIO,ssrcId:c._audioSSRC}))}}),r}createUnsubscribeAllMessage(n){const r=new Map;return n.forEach(s=>{let[c,{kind:d}]=s;if(r.has(c)){let h=r.get(c);d===Fe.VIDEO?h|=cr.Video:h|=cr.Audio,r.set(c,h)}else d===Fe.VIDEO?r.set(c,cr.Video):r.set(c,cr.Audio)}),{users:Array.from(r.entries()).map(s=>{let[c,d]=s;return{stream_id:c.uid,stream_type:d}})}}withdrawRemoteTracks(n){n.forEach(r=>{let[s,{kind:c}]=r;const d=this.remoteUserMap.get(s);d&&(d.delete(c),Array.from(d.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(n){const r=this.localTrackMap.get(Ee.LocalVideoTrack),s=this.localTrackMap.get(Ee.LocalVideoLowTrack);r&&await r.track.setBitrateLimit(n.uplink),s&&n.low_stream_uplink&&await s.track.setBitrateLimit({max_bitrate:n.low_stream_uplink.bitrate,min_bitrate:n.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(n,r){return n.map((s,c)=>{var d;let{stream_type:h}=s;return(d=r.find(f=>{let{stream_type:g}=f;return h===g}))===null||d===void 0?void 0:d.attributes})}async tryToUnmuteAudio(n){for(let s=0;s<n.length;s++)if(n[s]instanceof Gt){var r;const c=this.filterTobeUnmutedTracks(n[s]);if(c.length===0)continue;await((r=this.connection)===null||r===void 0?void 0:r.unmuteLocal(c.map(h=>{let[,{id:f}]=h;return f})));const d=this.createUnmuteMessage(c);return void await Xt(this,Xe.RequestUnmuteLocal,d)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=n=>{var r;return!((r=this.connection)===null||r===void 0||!r.getRemoteVideoIsReady(n))},this.statsUploader.requestUpload=(n,r)=>this.emit(Xe.RequestUpload,n,r),this.statsUploader.requestUploadStats=n=>this.emit(Xe.RequestUploadStats,n),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Nr(zy(this.dtlsFailedCount,ir)),this.emit(Xe.RequestReconnect)}async reconnectP2P(){const n=Array.from(this.localTrackMap.entries()),r=this.createGatewayUnpublishMessage(n);Array.from(this.remoteUserMap.entries()),r.length>0&&await nr(this,Xe.RequestUnpublishForReconnectPC,r),this.disconnectForReconnect(),this.emit(Xe.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Ee.LocalVideoTrack)||this.pendingLocalTracks.some(n=>n instanceof ht)}throwIfTrackTypeNotMatch(n){if(n.filter(r=>r instanceof ht).length>1)throw new he(B.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n.filter(r=>r instanceof Gt).length>1&&(n.some(r=>r instanceof Gt&&r._bypassWebAudio)||!Lt().webAudioMediaStreamDest))throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const r of n){if(r instanceof ht&&this.pendingLocalTracks.some(s=>s instanceof ht))throw new he(B.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r instanceof Gt&&this.pendingLocalTracks.some(s=>s instanceof Gt)&&(!Lt().webAudioMediaStreamDest||r._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof Gt&&s._bypassWebAudio)))throw new he(B.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(n,r){const s=!Y("DISABLE_DUAL_STREAM_USE_ENCODING")&&Lt().supportDualStreamEncoding,c=Rd(Rd({},{width:160,height:120,framerate:15,bitrate:50}),r);let d;d=s?n._mediaStreamTrack.clone():y1(n,c);const h=Qt(8,"track-low-"),f=new ht(d,Rd(Rd({},s&&{scaleResolutionDownBy:VI(c,n)}),{},{frameRate:c.framerate,bitrateMax:c.bitrate,bitrateMin:c.bitrate}),void 0,void 0,h);return f.on(ud.TRANSCEIVER_UPDATED,g=>{n._updateRtpTransceiver(g,dd.LOW_STREAM)}),f._hints.push(tn.LOW_STREAM),n.on("sei-to-send",g=>{f.emit("sei-to-send",g)}),n.addListener(ke.NEED_CLOSE,()=>{f.close()}),f}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(n,r,s){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof kn){var d,h,f,g;const _=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:E,dtlsTransportState:T,peerConnectionState:w}=this.connection,{local:A,remote:L}=await this.connection.getSelectedCandidatePair();Be.pcStats(this.store.sessionId,{startTime:_,eventElapse:n-_||0,iceconnectionsate:E,dtlsstate:T,connectionstate:w,intSucc:r?1:2,error:c,selectedLocalCandidateProtocol:(d=A==null?void 0:A.protocol)!==null&&d!==void 0?d:"",selectedLocalCandidateType:(h=A.candidateType)!==null&&h!==void 0?h:"",selectedLocalCandidateAddress:"".concat(A.address,":").concat(A.port),selectedRemoteCandidateProtocol:(f=L.protocol)!==null&&f!==void 0?f:"",selectedRemoteCandidateType:(g=L.candidateType)!==null&&g!==void 0?g:"",selectedRemoteCandidateAddress:"".concat(L.address,":").concat(L.port),restartCnt:s})}}reportVideoFirstFrameDecoded(n,r,s,c){var d;const h=Array.from(jo(d=this.remoteUserMap).call(d)).find(f=>f._videoSSRC===n);if(h){c||this.store.subscribe(h.uid,"video",void 0,void 0,void 0,void 0,Date.now());const f=this.store.keyMetrics,g=f.subscribe.find(_=>_.userId===h.uid&&_.type==="video");Be.firstRemoteVideoDecode(this.store.sessionId,gr.FIRST_VIDEO_DECODE,dn.FIRST_VIDEO_DECODE,{peer:h._uintid,videowidth:r,videoheight:s,subscribeElapse:ei.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId,apEnd:f.requestAPEnd||0,apStart:f.requestAPStart||0,joinGwEnd:f.joinGatewayEnd||0,joinGwStart:f.joinGatewayStart||0,pcEnd:f.peerConnectionEnd||0,pcStart:f.peerConnectionStart||0,subscriberEnd:(g==null?void 0:g.subscribeEnd)||0,subscriberStart:(g==null?void 0:g.subscribeStart)||0,videoAddNotify:(g==null?void 0:g.streamAdded)||0,state:c?1:0})}}async remoteMediaSsrcChanged(n,r,s){if(!this.connection)return!1;const c=this.remoteUserMap.get(n);if(!c)return!1;const d=c.get(r);if(!d)return!1;const h=await this.connection.getRemoteSSRC(d);return h!==void 0&&h!==s}resetConnection(n){O.debug("[".concat(this.store.clientId,"] [P2PChannel] reset connection to ").concat(n)),this.state===Vt.Connected?(O.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=n===r0.datachannel?new yr({},this.store):this.isPlanB?new xr({},this.store):new kn({},this.store),this.bindConnectionEvents(this.connection)))}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(n=>{let[r,{track:s}]=n;r===Ee.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,dd.LOW_STREAM):s._updateRtpTransceiver(void 0)})}reportPCDisconnectedOrFailed(n){this.connection&&this.connection instanceof kn&&(this.connection.iceConnectionState!=="disconnected"&&this.connection.iceConnectionState!=="checking"&&this.connection.iceConnectionState!=="failed"||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===Oa.TCP_RESTART&&n===Qr.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,Oa.DISCONNECTED_OR_FAILED)))}}function gi(o,n,r){const s=o[n];if(typeof s!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,d=await c.lock("From P2PChannel.".concat(n));try{for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return await s.apply(this,f)}finally{d()}},r}function Nce(o){let n=w4();return function(r,s){let c=r.appId;c!==void 0&&(Wt(s,10),pc(s,c));let d=r.cid;d!==void 0&&(Wt(s,16),Wt(s,d));let h=r.cname;h!==void 0&&(Wt(s,26),pc(s,h));let f=r.deviceId;f!==void 0&&(Wt(s,34),pc(s,f));let g=r.elapse;g!==void 0&&(Wt(s,40),Id(s,g));let _=r.fileSize;_!==void 0&&(Wt(s,48),Id(s,rf(_)));let E=r.height;E!==void 0&&(Wt(s,56),Id(s,rf(E)));let T=r.jpg;T!==void 0&&(Wt(s,66),Wt(s,T.length),function(Ro,ve){let we=of(Ro,ve.length);Ro.bytes.set(ve,we)}(s,T));let w=r.networkType;w!==void 0&&(Wt(s,72),Id(s,rf(w)));let A=r.osType;A!==void 0&&(Wt(s,80),Id(s,rf(A)));let L=r.requestId;L!==void 0&&(Wt(s,90),pc(s,L));let P=r.sdkVersion;P!==void 0&&(Wt(s,98),pc(s,P));let D=r.sequence;D!==void 0&&(Wt(s,104),Id(s,rf(D)));let G=r.sid;G!==void 0&&(Wt(s,114),pc(s,G));let $=r.timestamp;$!==void 0&&(Wt(s,120),Id(s,$));let X=r.uid;X!==void 0&&(Wt(s,128),Wt(s,X));let ie=r.vid;ie!==void 0&&(Wt(s,136),Wt(s,ie));let Q=r.width;Q!==void 0&&(Wt(s,144),Id(s,rf(Q)));let te=r.service;te!==void 0&&(Wt(s,152),Wt(s,te));let ce=r.callbackData;ce!==void 0&&(Wt(s,162),pc(s,ce));let le=r.jpgEncryption;le!==void 0&&(Wt(s,168),Wt(s,le));let Se=r.requestType;Se!==void 0&&(Wt(s,176),Wt(s,Se));let Ae=r.scorePorn;Ae!==void 0&&(Wt(s,185),P1(s,Ae));let st=r.scoreSexy;st!==void 0&&(Wt(s,193),P1(s,st));let gt=r.scoreNeutral;gt!==void 0&&(Wt(s,201),P1(s,gt));let nn=r.scene;nn!==void 0&&(Wt(s,208),Wt(s,nn));let dr=r.ossFilePrefix;dr!==void 0&&(Wt(s,218),pc(s,dr));let un=r.serviceVendor;if(un!==void 0)for(let Ro of un){Wt(s,226);let ve=w4();Dce(Ro,ve),Wt(s,ve.limit),Uce(s,ve),Mce(ve)}}(o,n),function(r){let s=r.bytes,c=r.limit;return s.length===c?s:s.subarray(0,c)}(n)}function Pce(o){return function(r){let s={};e:for(;!R4(r);){let c=fc(r);switch(c>>>3){case 0:break e;case 1:s.code=fc(r);break;case 2:s.msg=I4(r,fc(r));break;case 3:{let d=xce(r);s.data=kce(r),r.limit=d;break}default:b4(r,7&c)}}return s}({bytes:n=o,offset:0,limit:n.length});var n}function kce(o){let n={};e:for(;!R4(o);){let r=fc(o);switch(r>>>3){case 0:break e;case 1:n.requestId=I4(o,fc(o));break;case 2:n.requestType=fc(o)>>>0;break;case 3:n.scorePorn=N1(o);break;case 4:n.scoreSexy=N1(o);break;case 5:n.scoreNeutral=N1(o);break;case 6:n.requestScene=fc(o)>>>0;break;case 7:n.scene=fc(o)>>>0;break;default:b4(o,7&r)}}return n}function Dce(o,n){let r=o.service;r!==void 0&&(Wt(n,8),Wt(n,r));let s=o.vendor;s!==void 0&&(Wt(n,16),Wt(n,s));let c=o.token;c!==void 0&&(Wt(n,26),pc(n,c));let d=o.callbackUrl;d!==void 0&&(Wt(n,34),pc(n,d))}function xce(o){let n=fc(o),r=o.limit;return o.limit=o.offset+n,r}function b4(o,n){switch(n){case 0:for(;128&A4(o););break;case 2:A1(o,fc(o));break;case 5:A1(o,4);break;case 1:A1(o,8);break;default:throw new Error("Unimplemented type: "+n)}}fe([gi,j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",ae)],Lr.prototype,"startP2PConnection",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",ae)],Lr.prototype,"connect",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",void 0)],Lr.prototype,"updateRemoteRTPCapabilities",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Object,Object,Array,Object,String,String]),j("design:returntype",ae)],Lr.prototype,"preConnect",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],Lr.prototype,"publishDataChannel",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],Lr.prototype,"unpublish",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],Lr.prototype,"unpublishDataChannel",null),fe([gi,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Lr.prototype,"unpublishLowStream",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Br,Array]),j("design:returntype",ae)],Lr.prototype,"subscribeDataChannel",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Br,String,Number,Number,Array]),j("design:returntype",ae)],Lr.prototype,"subscribe",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],Lr.prototype,"massSubscribe",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Br,String,Boolean]),j("design:returntype",ae)],Lr.prototype,"unsubscribe",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Br,Array]),j("design:returntype",ae)],Lr.prototype,"unsubscribeDataChannel",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],Lr.prototype,"massUnsubscribe",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Br,String]),j("design:returntype",ae)],Lr.prototype,"muteRemote",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Br,String]),j("design:returntype",ae)],Lr.prototype,"unmuteRemote",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Br,String]),j("design:returntype",ae)],Lr.prototype,"hasRemoteMediaWithLock",null),fe([gi,j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Lr.prototype,"disconnectForReconnect",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],Lr.prototype,"updateBitrateLimit",null),fe([gi,j("design:type",Function),j("design:paramtypes",[Br,String,Number]),j("design:returntype",ae)],Lr.prototype,"remoteMediaSsrcChanged",null);let Lce=new Float32Array(1);new Uint8Array(Lce.buffer);let I1=new Float64Array(1),io=new Uint8Array(I1.buffer);function rf(o){return{low:o|=0,high:o>>31,unsigned:o>=0}}let C4=[];function w4(){const o=C4.pop();return o?(o.offset=o.limit=0,o):{bytes:new Uint8Array(64),offset:0,limit:0}}function Mce(o){C4.push(o)}function A1(o,n){if(o.offset+n>o.limit)throw new Error("Skip past limit");o.offset+=n}function R4(o){return o.offset>=o.limit}function of(o,n){let r=o.bytes,s=o.offset,c=o.limit,d=s+n;if(d>r.length){let h=new Uint8Array(2*d);h.set(r),o.bytes=h}return o.offset=d,d>c&&(o.limit=d),s}function O1(o,n){let r=o.offset;if(r+n>o.limit)throw new Error("Read past limit");return o.offset+=n,r}function I4(o,n){let r=O1(o,n),s=String.fromCharCode,c=o.bytes,d="�",h="";for(let f=0;f<n;f++){let g,_,E,T,w=c[f+r];128&w?(224&w)==192?f+1>=n?h+=d:(g=c[f+r+1],(192&g)!=128?h+=d:(T=(31&w)<<6|63&g,T<128?h+=d:(h+=s(T),f++))):(240&w)==224?f+2>=n?h+=d:(g=c[f+r+1],_=c[f+r+2],(49344&(g|_<<8))!=32896?h+=d:(T=(15&w)<<12|(63&g)<<6|63&_,T<2048||T>=55296&&T<=57343?h+=d:(h+=s(T),f+=2))):(248&w)==240?f+3>=n?h+=d:(g=c[f+r+1],_=c[f+r+2],E=c[f+r+3],(12632256&(g|_<<8|E<<16))!=8421504?h+=d:(T=(7&w)<<18|(63&g)<<12|(63&_)<<6|63&E,T<65536||T>1114111?h+=d:(T-=65536,h+=s(55296+(T>>10),56320+(1023&T)),f+=3))):h+=d:h+=s(w)}return h}function pc(o,n){let r=n.length,s=0;for(let h=0;h<r;h++){let f=n.charCodeAt(h);f>=55296&&f<=56319&&h+1<r&&(f=(f<<10)+n.charCodeAt(++h)-56613888),s+=f<128?1:f<2048?2:f<65536?3:4}Wt(o,s);let c=of(o,s),d=o.bytes;for(let h=0;h<r;h++){let f=n.charCodeAt(h);f>=55296&&f<=56319&&h+1<r&&(f=(f<<10)+n.charCodeAt(++h)-56613888),f<128?d[c++]=f:(f<2048?d[c++]=f>>6&31|192:(f<65536?d[c++]=f>>12&15|224:(d[c++]=f>>18&7|240,d[c++]=f>>12&63|128),d[c++]=f>>6&63|128),d[c++]=63&f|128)}}function Uce(o,n){let r=of(o,n.limit),s=o.bytes,c=n.bytes;for(let d=0,h=n.limit;d<h;d++)s[d+r]=c[d]}function A4(o){return o.bytes[O1(o,1)]}function O4(o,n){let r=of(o,1);o.bytes[r]=n}function N1(o){let n=O1(o,8),r=o.bytes;return io[0]=r[n++],io[1]=r[n++],io[2]=r[n++],io[3]=r[n++],io[4]=r[n++],io[5]=r[n++],io[6]=r[n++],io[7]=r[n++],I1[0]}function P1(o,n){let r=of(o,8),s=o.bytes;I1[0]=n,s[r++]=io[0],s[r++]=io[1],s[r++]=io[2],s[r++]=io[3],s[r++]=io[4],s[r++]=io[5],s[r++]=io[6],s[r++]=io[7]}function fc(o){let n,r=0,s=0;do n=A4(o),r<32&&(s|=(127&n)<<r),r+=7;while(128&n);return s}function Wt(o,n){for(n>>>=0;n>=128;)O4(o,127&n|128),n>>>=7;O4(o,n)}function Id(o,n){let r=n.low>>>0,s=(n.low>>>28|n.high<<4)>>>0,c=n.high>>>24,d=c===0?s===0?r<16384?r<128?1:2:r<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:c<128?9:10,h=of(o,d),f=o.bytes;switch(d){case 10:f[h+9]=c>>>7&1;case 9:f[h+8]=d!==9?128|c:127&c;case 8:f[h+7]=d!==8?s>>>21|128:s>>>21&127;case 7:f[h+6]=d!==7?s>>>14|128:s>>>14&127;case 6:f[h+5]=d!==6?s>>>7|128:s>>>7&127;case 5:f[h+4]=d!==5?128|s:127&s;case 4:f[h+3]=d!==4?r>>>21|128:r>>>21&127;case 3:f[h+2]=d!==3?r>>>14|128:r>>>14&127;case 2:f[h+1]=d!==2?r>>>7|128:r>>>7&127;case 1:f[h]=d!==1?128|r:127&r}}function N4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}const jce=new Map([["moderation",1],["supervise",2]]);class iS extends mn{get connectionState(){return this._connectionState}set connectionState(n){if(this._connectionState===n)return;const r=this._connectionState;this._connectionState=n,this.emit(vr.CONNECTION_STATE_CHANGE,r,n)}get inspectType(){return this._inspectType}set inspectType(n){var r;this._inspectMode=qc(r=n.map(s=>jce.get(s)||0)).call(r,(s,c)=>s+c),this._inspectType=n}get quality(){return this._quality}set quality(n){this._quality=n>1?1:n<.1?.1:n,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(n){super(),I(this,"name","AgoraRTCVideoContentInspect"),I(this,"_connectionState",Vo.CONNECTING),I(this,"_innerConnectionState",void 0),I(this,"sequence",0),I(this,"inspectStartTime",void 0),I(this,"workerManagerConnection",void 0),I(this,"workerConnection",void 0),I(this,"workerMessageLengthLimit",void 0),I(this,"inspectIntervalMinimum",void 0),I(this,"qualityRatio",void 0),I(this,"_connectInfo",void 0),I(this,"_cancelTokenSource",Qi.CancelToken.source()),I(this,"_retryConfig",void 0),I(this,"wmSequence",0),I(this,"inspectInterval",void 0),I(this,"inspectTimer",null),I(this,"ossFilePrefix",void 0),I(this,"extraInfo",void 0),I(this,"_inspectType",void 0),I(this,"_inspectMode",void 0),I(this,"_quality",1),I(this,"qualityTimer",null),I(this,"_inspectId",void 0),I(this,"_needWorkUrlOnly",!1),I(this,"inspectImage",()=>{if(this.connectionState!==Vo.CONNECTED)throw new Z(B.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===Vo.CONNECTED?this.requestToInspectImage():O.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=Qt(5,"inspect-"),this.workerMessageLengthLimit=Y("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=Y("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=Y("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=n.interval,this.ossFilePrefix=n.ossFilePrefix,this.extraInfo=n.extraInfo,this.inspectType=n.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new Ng("worker-manager-"+this._inspectId,ir),this.on(vr.STATE_CHANGE,(r,s)=>{this._innerConnectionState=r,O.debug("[".concat(this._inspectId,"] Inspect operation :").concat(Bo[r]," ").concat(s||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new Ng("worker-"+this._inspectId,ir),this.handleWorkerEvents()}async init(n,r){this.emit(vr.STATE_CHANGE,Bo.CONNECT_AP),this._connectInfo=n;const s=this._cancelTokenSource.token;return this._retryConfig=r,new ae((c,d)=>{this.on(vr.CONNECTION_STATE_CHANGE,(h,f)=>{f===Vo.CONNECTED&&c()}),this.requestAP(n,s,r).then(h=>{this.connectWorkerManager(h)}).catch(h=>{d(h)})})}async requestAP(n,r,s){const c=Y("WEBCS_DOMAIN").map(f=>"https://".concat(f,"/api/v1")),d=await function(f,g,_,E){let{appId:T,areaCode:w,cname:A,sid:L,token:P,uid:D}=g;Pp++;const G="image_moderation_api",$={service_name:G,json_body:JSON.stringify({appId:T,areaCode:w,cname:A,command:"allocateEdge",requestId:Pp,seq:Pp,sid:L,token:P,ts:Date.now(),uid:D+""})};let X,ie,Q=f[0];return Ra(async()=>{X=Date.now();const te=await el(Q,{data:$,cancelToken:_,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(ie=Date.now()-X,te.code!==0){const Ae=new Z(B.UNEXPECTED_RESPONSE,"image inspect ap error, code"+te.code,{retry:!0,responseTime:ie});throw O.error(Ae.toString()),Ae}const ce=JSON.parse(te.json_body);if(ce.code!==200){const Ae=new Z(B.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(ce.code,", reason: ").concat(ce.reason),{code:ce.code,responseTime:ie});throw O.error(Ae.toString()),Ae}if(!ce.servers||!Array.isArray(ce.servers)||ce.servers.length===0){const Ae=new Z(B.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:ce.code,responseTime:ie});throw O.error(Ae.toString()),Ae}const le=Y("VIDEO_INSPECT_WORKER_MANAGER_HOST"),Se=Y("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:ce.servers.map(Ae=>{let{address:st,wss:gt}=Ae;if(st&&gt)return"wss://".concat(st.replace(/\./g,"-"),".").concat(le,":").concat(Se||gt)}).filter(Ae=>!!Ae),workerToken:ce.workerToken,vid:ce.vid,responseTime:ie}},(te,ce)=>(Be.apworkerEvent(L,{success:!0,sc:200,serviceName:G,responseDetail:JSON.stringify(te.addressList),firstSuccess:ce===0,responseTime:ie,serverIp:f[ce%f.length]}),!1),(te,ce)=>(Be.apworkerEvent(L,{success:!1,sc:te.data&&te.data.code||200,serviceName:G,responseTime:ie,serverIp:f[ce%f.length]}),!!(te.code!==B.OPERATION_ABORTED&&te.code!==B.UNEXPECTED_RESPONSE||te.data&&te.data.retry)&&(Q=f[(ce+1)%f.length],!0)),E)}(c,n,r,s);this.emit(vr.STATE_CHANGE,Bo.AP_CONNECTED);const{addressList:h}=d;return this.wmSequence++,h}async connectWorkerManager(n){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=r,this.emit(vr.STATE_CHANGE,Bo.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(n,1e4)}async connectWorker(n){await this.workerConnection.init([n])}handleWorkerManagerEvents(){this.workerManagerConnection.on(tt.CONNECTED,async()=>{this.emit(vr.STATE_CHANGE,Bo.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.20.2",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(tt.CLOSED,()=>{this._innerConnectionState<Bo.GET_WORKER_MANAGER_RESPONSE&&O.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(tt.FAILED,()=>{this._innerConnectionState<Bo.GET_WORKER_MANAGER_RESPONSE&&O.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(tt.RECONNECTING,()=>{this._innerConnectionState<Bo.GET_WORKER_MANAGER_RESPONSE&&O.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(tt.ON_MESSAGE,async n=>{this.emit(vr.STATE_CHANGE,Bo.GET_WORKER_MANAGER_RESPONSE);const r=this.workerManagerConnection.url;this.workerManagerConnection.close();const s=JSON.parse(n.data);if(s.code!==200)throw O.error("[".concat(this._inspectId,"] Unexpected code ").concat(s.code," from worker manager")),new Z(B.UNEXPECTED_RESPONSE,"response code of worker is unexpected",s);if(!(s.serverResponse&&s.serverResponse.portWss&&r))throw O.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(s))),new Z(B.UNEXPECTED_RESPONSE,"response content of worker is unexpected",s);{const c=Y("VIDEO_INSPECT_WORKER_PORT")||s.serverResponse.portWss,d=r.replace(/:\d+\/?$/,":".concat(c));this.emit(vr.STATE_CHANGE,Bo.CONNECT_WORKER,d),this._needWorkUrlOnly?this.emit(vr.REQUEST_NEW_WORKER_URL,d):await this.connectWorker(d)}}),this.workerManagerConnection.on(tt.WILL_RECONNECT,(n,r,s)=>{s(n)}),this.workerManagerConnection.on(tt.REQUEST_NEW_URLS,(n,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(n).catch(r)})}handleWorkerEvents(){this.workerConnection.on(tt.CONNECTED,async()=>{this.emit(vr.STATE_CHANGE,Bo.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=Vo.CONNECTED}),this.workerConnection.on(tt.ON_MESSAGE,async n=>{if(n.data instanceof ArrayBuffer){const s=Pce(new Uint8Array(n.data));if(Y("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&O.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(s)),s.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(vr.INSPECT_RESULT,void 0,void 0);if(s.data&&s.data.scorePorn&&s.data.scoreSexy&&s.data.scoreNeutral){var r;const c={porn:s.data.scorePorn,sexy:s.data.scoreSexy,neutral:s.data.scoreNeutral},d=qc(r=Object.keys(c)).call(r,(f,g)=>c[f]>c[g]?f:g,"porn"),h=Object.keys(c).find(f=>f===d);this.emit(vr.INSPECT_RESULT,h)}else this.emit(vr.INSPECT_RESULT,void 0,new Z(B.UNEXPECTED_RESPONSE,s.code+"","There is an unexpected data on message"))}else this.emit(vr.INSPECT_RESULT,void 0,new Z(B.UNEXPECTED_RESPONSE,s.code+"",s.msg))}else O.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(vr.INSPECT_RESULT,void 0,new Z(B.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(tt.CLOSED,()=>{this.connectionState=Vo.CLOSED}),this.workerConnection.on(tt.FAILED,()=>{this.connectionState=Vo.CLOSED}),this.workerConnection.on(tt.RECONNECTING,()=>{this.connectionState=this.connectionState===Vo.CONNECTED?Vo.RECONNECTING:Vo.CONNECTING}),this.workerConnection.on(tt.WILL_RECONNECT,(n,r,s)=>{n==="recover"&&s(n),s("tryNext")}),this.workerConnection.on(tt.REQUEST_NEW_URLS,(n,r)=>{this.workerManagerConnection.close(),this.once(vr.REQUEST_NEW_WORKER_URL,s=>{n([s])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(s=>{this.connectWorkerManager(s,!0)}).catch(s=>{r(s)})})}static intToLong(n){return{low:n|=0,high:n>>31,unsigned:n>=0}}async requestToInspectImage(){this.sequence++;const n=yo(this,vr.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(n){if(!n.isPlaying)return void this.emit(vr.INSPECT_RESULT,void 0,new Z(B.INVALID_OPERATION,"Only the track being played can be inspected"));const s=await this.generateRequestData(n,r);this.workerConnection.sendMessage(s,!0,!0)}else this.emit(vr.INSPECT_RESULT,void 0,new Z(B.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(n,r){let{appId:s,cname:c,cid:d,vid:h,sid:f,uid:g}=r;const _=Date.now(),E=await n.getCurrentFrameImage("image/jpeg",this.quality),T=await BV(E,s,c),w=this.sequence+"-"+d+"-"+g+"-"+_+"-"+Qt(12,""),A={appId:s,cid:d,cname:c,deviceId:"",elapse:iS.intToLong(Number(_-this.inspectStartTime)),fileSize:T.byteLength,jpgEncryption:2,height:E.height,width:E.width,jpg:T,networkType:6,osType:7,requestId:w,sdkVersion:"4.20.2",sequence:this.sequence,sid:f,timestamp:iS.intToLong(_),uid:g,vid:h,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};this.extraInfo===void 0&&delete A.callbackData,this.ossFilePrefix===void 0&&delete A.ossFilePrefix;const L=Nce(A);if(L.byteLength<this.workerMessageLengthLimit){if(Y("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const P=function(D){for(var G=1;G<arguments.length;G++){var $=arguments[G]!=null?arguments[G]:{};G%2?N4(Object($),!0).forEach(function(X){I(D,X,$[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors($)):N4(Object($)).forEach(function(X){Object.defineProperty(D,X,Object.getOwnPropertyDescriptor($,X))})}return D}({},A);delete P.jpg,O.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(P))}return L}{const P=this.quality*this.qualityRatio;return this.quality=P,await this.generateRequestData(n,{appId:s,cname:c,cid:d,vid:h,sid:f,uid:g})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Qi.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=Vo.CLOSED,this.emit(vr.STATE_CHANGE,Bo.CLOSED)}}function Fce(o){let n=function(){const r=Wce.pop();return r?(r.offset=r.limit=0,r):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(r,s){let c=r.appId;c!==void 0&&(qn(s,10),Ad(s,c));let d=r.cid;d!==void 0&&(qn(s,16),qn(s,d));let h=r.cname;h!==void 0&&(qn(s,26),Ad(s,h));let f=r.deviceId;f!==void 0&&(qn(s,34),Ad(s,f));let g=r.elapse;g!==void 0&&(qn(s,40),Od(s,g));let _=r.fileSize;_!==void 0&&(qn(s,48),Od(s,sf(_)));let E=r.height;E!==void 0&&(qn(s,56),Od(s,sf(E)));let T=r.jpg;T!==void 0&&(qn(s,66),qn(s,T.length),k4(s,T));let w=r.networkType;w!==void 0&&(qn(s,72),Od(s,sf(w)));let A=r.osType;A!==void 0&&(qn(s,80),Od(s,sf(A)));let L=r.requestId;L!==void 0&&(qn(s,90),Ad(s,L));let P=r.sdkVersion;P!==void 0&&(qn(s,98),Ad(s,P));let D=r.sequence;D!==void 0&&(qn(s,104),Od(s,sf(D)));let G=r.sid;G!==void 0&&(qn(s,114),Ad(s,G));let $=r.timestamp;$!==void 0&&(qn(s,120),Od(s,$));let X=r.uid;X!==void 0&&(qn(s,128),qn(s,X));let ie=r.vid;ie!==void 0&&(qn(s,136),qn(s,ie));let Q=r.width;Q!==void 0&&(qn(s,144),Od(s,sf(Q)));let te=r.service;te!==void 0&&(qn(s,152),qn(s,te));let ce=r.callbackData;ce!==void 0&&(qn(s,162),qn(s,ce.length),k4(s,ce));let le=r.ticket;le!==void 0&&(qn(s,170),Ad(s,le));let Se=r.vendorConfigs;Se!==void 0&&(qn(s,178),Ad(s,Se))}(o,n),function(r){let s=r.bytes,c=r.limit;return s.length===c?s:s.subarray(0,c)}(n)}function Vce(o){return function(r){let s={};e:for(;!zce(r);){let c=h_(r);switch(c>>>3){case 0:break e;case 1:s.code=h_(r);break;case 2:s.msg=D4(r,h_(r));break;case 3:s.requestId=D4(r,h_(r));break;case 4:s.timestamp=Gce(r,!1);break;default:Bce(r,7&c)}}return s}({bytes:n=o,offset:0,limit:n.length});var n}function Bce(o,n){switch(n){case 0:for(;128&sa(o););break;case 2:k1(o,h_(o));break;case 5:k1(o,4);break;case 1:k1(o,8);break;default:throw new Error("Unimplemented type: "+n)}}function sf(o){return{low:o|=0,high:o>>31,unsigned:o>=0}}let Wce=[];function k1(o,n){if(o.offset+n>o.limit)throw new Error("Skip past limit");o.offset+=n}function zce(o){return o.offset>=o.limit}function oS(o,n){let r=o.bytes,s=o.offset,c=o.limit,d=s+n;if(d>r.length){let h=new Uint8Array(2*d);h.set(r),o.bytes=h}return o.offset=d,d>c&&(o.limit=d),s}function P4(o,n){let r=o.offset;if(r+n>o.limit)throw new Error("Read past limit");return o.offset+=n,r}function k4(o,n){let r=oS(o,n.length);o.bytes.set(n,r)}function D4(o,n){let r=P4(o,n),s=String.fromCharCode,c=o.bytes,d="�",h="";for(let f=0;f<n;f++){let g,_,E,T,w=c[f+r];128&w?(224&w)==192?f+1>=n?h+=d:(g=c[f+r+1],(192&g)!=128?h+=d:(T=(31&w)<<6|63&g,T<128?h+=d:(h+=s(T),f++))):(240&w)==224?f+2>=n?h+=d:(g=c[f+r+1],_=c[f+r+2],(49344&(g|_<<8))!=32896?h+=d:(T=(15&w)<<12|(63&g)<<6|63&_,T<2048||T>=55296&&T<=57343?h+=d:(h+=s(T),f+=2))):(248&w)==240?f+3>=n?h+=d:(g=c[f+r+1],_=c[f+r+2],E=c[f+r+3],(12632256&(g|_<<8|E<<16))!=8421504?h+=d:(T=(7&w)<<18|(63&g)<<12|(63&_)<<6|63&E,T<65536||T>1114111?h+=d:(T-=65536,h+=s(55296+(T>>10),56320+(1023&T)),f+=3))):h+=d:h+=s(w)}return h}function Ad(o,n){let r=n.length,s=0;for(let h=0;h<r;h++){let f=n.charCodeAt(h);f>=55296&&f<=56319&&h+1<r&&(f=(f<<10)+n.charCodeAt(++h)-56613888),s+=f<128?1:f<2048?2:f<65536?3:4}qn(o,s);let c=oS(o,s),d=o.bytes;for(let h=0;h<r;h++){let f=n.charCodeAt(h);f>=55296&&f<=56319&&h+1<r&&(f=(f<<10)+n.charCodeAt(++h)-56613888),f<128?d[c++]=f:(f<2048?d[c++]=f>>6&31|192:(f<65536?d[c++]=f>>12&15|224:(d[c++]=f>>18&7|240,d[c++]=f>>12&63|128),d[c++]=f>>6&63|128),d[c++]=63&f|128)}}function sa(o){return o.bytes[P4(o,1)]}function x4(o,n){let r=oS(o,1);o.bytes[r]=n}function h_(o){let n,r=0,s=0;do n=sa(o),r<32&&(s|=(127&n)<<r),r+=7;while(128&n);return s}function qn(o,n){for(n>>>=0;n>=128;)x4(o,127&n|128),n>>>=7;x4(o,n)}function Gce(o,n){let r,s=0,c=0,d=0;return r=sa(o),s=127&r,128&r&&(r=sa(o),s|=(127&r)<<7,128&r&&(r=sa(o),s|=(127&r)<<14,128&r&&(r=sa(o),s|=(127&r)<<21,128&r&&(r=sa(o),c=127&r,128&r&&(r=sa(o),c|=(127&r)<<7,128&r&&(r=sa(o),c|=(127&r)<<14,128&r&&(r=sa(o),c|=(127&r)<<21,128&r&&(r=sa(o),d=127&r,128&r&&(r=sa(o),d|=(127&r)<<7))))))))),{low:s|c<<28,high:c>>>4|d<<24,unsigned:n}}function Od(o,n){let r=n.low>>>0,s=(n.low>>>28|n.high<<4)>>>0,c=n.high>>>24,d=c===0?s===0?r<16384?r<128?1:2:r<1<<21?3:4:s<16384?s<128?5:6:s<1<<21?7:8:c<128?9:10,h=oS(o,d),f=o.bytes;switch(d){case 10:f[h+9]=c>>>7&1;case 9:f[h+8]=d!==9?128|c:127&c;case 8:f[h+7]=d!==8?s>>>21|128:s>>>21&127;case 7:f[h+6]=d!==7?s>>>14|128:s>>>14&127;case 6:f[h+5]=d!==6?s>>>7|128:s>>>7&127;case 5:f[h+4]=d!==5?128|s:127&s;case 4:f[h+3]=d!==4?r>>>21|128:r>>>21&127;case 3:f[h+2]=d!==3?r>>>14|128:r>>>14&127;case 2:f[h+1]=d!==2?r>>>7|128:r>>>7&127;case 1:f[h]=d!==1?128|r:127&r}}const L4={},M4={},sS=4294967296,Hce=sS*sS,U4=Hce/2;F4(0,!0);const j4=F4(0),$ce=p_(0,-2147483648,!1),Kce=p_(-1,2147483647,!1);function F4(o,n){let r,s,c;return n?(c=0<=(o>>>=0)&&o<256)&&(s=M4[o],s)?s:(r=p_(o,0,!0),c&&(M4[o]=r),r):(c=-128<=(o|=0)&&o<128)&&(s=L4[o],s)?s:(r=p_(o,o<0?-1:0,!1),c&&(L4[o]=r),r)}function p_(o,n,r){return{low:0|o,high:0|n,unsigned:!!r}}function Yce(o,n){if(isNaN(o))return j4;{if(o<=-U4)return $ce;if(o+1>=U4)return Kce}return o<0?j4:p_(o%sS|0,o/sS|0,n)}function V4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}class D1 extends mn{get connectionState(){return this._connectionState}set connectionState(n){if(this._connectionState===n)return;const r=this._connectionState;this._connectionState=n,this.emit(_s.CONNECTION_STATE_CHANGE,n,r)}get quality(){return this._quality}set quality(n){this._quality=n>1?1:n<.1?.1:n,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(n){var r;super(),I(this,"name","AgoraRTCImageModeration"),I(this,"_connectionState",So.CONNECTING),I(this,"_sequence",0),I(this,"_moderationStartTime",void 0),I(this,"_workerConnection",void 0),I(this,"_workerMessageLengthLimit",void 0),I(this,"_qualityRatio",void 0),I(this,"_connectInfo",void 0),I(this,"_cancelTokenSource",Qi.CancelToken.source()),I(this,"_retryConfig",void 0),I(this,"_moderationInterval",void 0),I(this,"_moderationTimer",null),I(this,"_moderationMode",1),I(this,"_quality",1),I(this,"_qualityTimer",null),I(this,"_ticket",void 0),I(this,"_moderationIntervalMinimum",void 0),I(this,"_uploadFailedNum",0),I(this,"_uploadNum",0),I(this,"_uploadTimer",null),I(this,"_extraInfo",void 0),I(this,"_vendor",""),I(this,"_encoder",new TextEncoder),I(this,"_moderationId",void 0),I(this,"inspectImage",()=>{if(this.connectionState!==So.CONNECTED)throw new Z(B.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===So.CONNECTED?this.requestToInspectImage():O.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=Qt(5,"image-moderation-"),this._workerMessageLengthLimit=Y("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=Y("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(r=n.interval)!==null&&r!==void 0?r:1e3,n.extraInfo&&(this._extraInfo=this._encoder.encode(n.extraInfo)),n.vendor&&(this._vendor=n.vendor),this._qualityRatio=Y("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new Ng("worker-"+this._moderationId,ir),this.on(_s.STATE_CHANGE,(s,c)=>{O.debug("[".concat(this._moderationId,"] Moderation operation :").concat(sd[s]," ").concat(c||""))}),this.handleWorkerEvents()}async init(n,r){this.emit(_s.STATE_CHANGE,sd.CONNECT_AP),this._connectInfo=n;const s=this._cancelTokenSource.token;return this._retryConfig=r,new ae((c,d)=>{this.on(_s.CONNECTION_STATE_CHANGE,(h,f)=>{h===So.CONNECTED&&c()}),this.requestAP(n,s,r).then(h=>{this.connectWorker(h)}).catch(h=>{d(h)})})}updateConfig(n){var r;this._moderationInterval=(r=n.interval)!==null&&r!==void 0?r:1e3,n.extraInfo&&(this._extraInfo=this._encoder.encode(n.extraInfo)),n.vendor&&(this._vendor=n.vendor),O.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(n))),this.connectionState===So.CONNECTED&&this.inspectImage()}async requestAP(n,r,s){const c=Y("WEBCS_DOMAIN").map(g=>"https://".concat(g,"/api/v1")),d=await function(g,_,E,T){let{appId:w,areaCode:A,cname:L,sid:P,token:D,uid:G}=_;Pp++;const $="moderation_plugin",X={service_name:$,json_body:JSON.stringify({appId:w,areaCode:A,cname:L,command:"allocateEdge",requestId:Pp,seq:Pp,sid:P,appToken:D,ts:Date.now(),uid:G+""})};let ie,Q,te=g[0];return Ra(async()=>{ie=Date.now();const ce=await el(te,{data:X,cancelToken:E,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(Q=Date.now()-ie,ce.code!==0){const Ae=new Z(B.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+ce.code,{retry:!0,responseTime:Q});throw O.error(Ae.toString()),Ae}const le=JSON.parse(ce.json_body);if(le.code!==200){const Ae=new Z(B.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(le.code,", reason: ").concat(le.reason),{code:le.code,responseTime:Q});throw O.error(Ae.toString()),Ae}if(!le.servers||!Array.isArray(le.servers)||le.servers.length===0){const Ae=new Z(B.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:le.code,responseTime:Q});throw O.error(Ae.toString()),Ae}if(!le.servers.some(Ae=>!!Ae.wss)){const Ae=new Z(B.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:le.code,responseTime:Q});throw O.error(Ae.toString()),Ae}const Se=Y("IMAGE_MODERATION_WORKER_HOST");return{addressList:le.servers.map(Ae=>{let{address:st,wss:gt}=Ae;if(st&&gt)return"wss://".concat(st.replace(/\./g,"-"),".").concat(Se,":").concat(gt,"/moderation")}).filter(Ae=>!!Ae),workerToken:le.workerToken,vid:le.vid,ticket:le.appTicket,responseTime:Q}},(ce,le)=>(Be.apworkerEvent(P,{success:!0,sc:200,serviceName:$,responseDetail:JSON.stringify(ce.addressList),firstSuccess:le===0,responseTime:Q,serverIp:g[le%g.length]}),!1),(ce,le)=>(Be.apworkerEvent(P,{success:!1,sc:ce.data&&ce.data.code||200,serviceName:$,responseTime:Q,serverIp:g[le%g.length]}),!!(ce.code!==B.OPERATION_ABORTED&&ce.code!==B.UNEXPECTED_RESPONSE||ce.data&&ce.data.retry)&&(te=g[(le+1)%g.length],!0)),T)}(c,n,r,s);this.emit(_s.STATE_CHANGE,sd.AP_CONNECTED);const{addressList:h,ticket:f}=d;return this._ticket=f,h}async connectWorker(n){this.emit(_s.STATE_CHANGE,sd.CONNECT_WORKER),await this._workerConnection.init(n,1e4)}handleWorkerEvents(){this._workerConnection.on(tt.CONNECTED,async()=>{this.emit(_s.STATE_CHANGE,sd.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=So.CONNECTED}),this._workerConnection.on(tt.CLOSED,()=>{this.connectionState=So.CLOSED}),this._workerConnection.on(tt.FAILED,()=>{this.connectionState=So.CLOSED}),this._workerConnection.on(tt.RECONNECTING,()=>{this.connectionState=this.connectionState===So.CONNECTED?So.RECONNECTING:So.CONNECTING}),this._workerConnection.on(tt.ON_MESSAGE,async n=>{if(n.data instanceof ArrayBuffer){const r=Vce(new Uint8Array(n.data));Y("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&O.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(r)),this._uploadNum++,r.code===void 0||r.code===0||(this._uploadFailedNum++,O.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(r.code,", msg is ").concat(r.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{Be.reportApiInvoke(this._connectInfo.sid||null,{name:tr.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,r.code],tag:yn.TRACER}).onError(new Z(B.IMAGE_MODERATION_UPLOAD_FAILED,r.msg)),this._uploadTimer=null},Y("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else O.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(tt.WILL_RECONNECT,(n,r,s)=>{n==="recover"&&s(n),s("tryNext")}),this._workerConnection.on(tt.REQUEST_NEW_URLS,(n,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(n).catch(r)})}static intToLong(n){return{low:n|=0,high:n>>31,unsigned:n>=0}}async requestToInspectImage(){const n=yo(this,_s.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(n){if(!n.isPlaying)return void(Y("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&O.debug("Only the track being played can be inspected"));this._sequence++;const s=await this.generateRequestData(n,r);this._workerConnection.sendMessage(s,!0,!0)}else Y("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&O.debug("Only the track being published can be inspected")}async generateRequestData(n,r){let{appId:s,cname:c,cid:d,vid:h,sid:f,uid:g}=r;const _=Date.now(),E=await n.getCurrentFrameImage("image/jpeg",this.quality),T=await BV(E,s,c),w=this._sequence+"-"+d+"-"+g+"-"+_+"-"+Qt(12,""),A={appId:s,cid:d,cname:c,deviceId:"",elapse:D1.intToLong(Number(_-this._moderationStartTime)),fileSize:E.buffer.byteLength,height:E.height,width:E.width,jpg:T,networkType:6,osType:7,requestId:w,sdkVersion:"4.20.2",sequence:this._sequence,sid:f,timestamp:Yce(_),uid:g,vid:h,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete A.callbackData;const L=Fce(A);if(L.byteLength<this._workerMessageLengthLimit){if(Y("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const P=function(D){for(var G=1;G<arguments.length;G++){var $=arguments[G]!=null?arguments[G]:{};G%2?V4(Object($),!0).forEach(function(X){I(D,X,$[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors($)):V4(Object($)).forEach(function(X){Object.defineProperty(D,X,Object.getOwnPropertyDescriptor($,X))})}return D}({},A);delete P.jpg,O.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(P))}return L}{const P=this.quality*this._qualityRatio;return this.quality=P,await this.generateRequestData(n,{appId:s,cname:c,cid:d,vid:h,sid:f,uid:g})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Qi.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=So.CLOSED,this.emit(_s.STATE_CHANGE,sd.CLOSED)}}function B4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function W4(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?B4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):B4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}const qce=Date.now(),Jce=20,x1=new Map,aS=new Map;async function z4(o){const n=x1.get(o),r=Array.isArray(n)&&n[n.length-1],s=aS.get(o);if(!r)return void(s.isSyncing=!1);const c={uid:r.uid,payload:r.payload};s.firstRecvTs===0&&(s.firstRecvTs=r.recvTs,s.firstSendTs=r.sendTs);const d=r.sendTs-s.firstSendTs,h=d-(Date.now()-s.firstRecvTs);h>0&&(s.firstRecvTs=Date.now()-d);let f=r.mediaDelay+h;f<=0?(n.pop(),G4(r.context,c),f=0):f=Math.min(f,Jce),setTimeout(()=>n.length&&z4(o),f)}function G4(o,n){o.safeEmit(Et.STREAM_MESSAGE,n.uid,n.payload),o.onStreamMessage&&o.onStreamMessage(n)}function Xce(o){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(!o.syncWithAudio)return G4(r,{uid:o.uid,payload:o.payload});const s="".concat(r.id,"-").concat(o.uid),c=x1.get(s)||[],d=c.findIndex(_=>o.sendTs>=_.sendTs),h=W4(W4({},o),{},{context:r,mediaDelay:n,recvTs:Date.now()});d===-1?c.push(h):c.splice(d,0,h),x1.set(s,c);let f=!1;var g;aS.has(s)?f=!((g=aS.get(s))===null||g===void 0||!g.isSyncing):aS.set(s,{isSyncing:f,firstRecvTs:0,firstSendTs:0}),f||z4(s)}const Qce=xt().name;function Zce(){return!function(o,n,r){const s=xt();if(s.os!==fr.IOS||!s.osVersion)return!1;const c=s.osVersion.split(".");return Number(c[0])<o}(16)&&!function(o,n,r){const s=xt();if(s.name!==Ft.SAFARI||!s.osVersion)return!1;const c=s.version.split(".");return Number(c[0])<o}(16)}function H4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function La(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?H4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):H4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}Pr.setLogger(O);class Ht extends mn{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var n;return((n=this._config)===null||n===void 0?void 0:n.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(n){let r;if(super(),I(this,"store",void 0),I(this,"_uid",void 0),I(this,"_channelName",void 0),I(this,"_uintUid",void 0),I(this,"_users",[]),I(this,"_config",void 0),I(this,"_clientId",void 0),I(this,"_appId",void 0),I(this,"_sessionId",null),I(this,"_key",void 0),I(this,"_rtmConfig",{}),I(this,"_joinInfo",void 0),I(this,"_gateway",void 0),I(this,"_statsCollector",void 0),I(this,"_configDistribute",void 0),I(this,"_leaveMutex",new Pr("client-leave")),I(this,"_publishMutex",new Pr("client-publish")),I(this,"_renewTokenMutex",new Pr("client-renewtoken")),I(this,"_subscribeMutex",new Pr("client-subscribe")),I(this,"_encryptionMode","none"),I(this,"_encryptionSecret",null),I(this,"_encryptionSalt",null),I(this,"_encryptDataStream",!1),I(this,"_encryptDataStreamKey",null),I(this,"_encryptDataStreamIv",null),I(this,"_proxyServer",void 0),I(this,"_turnServer",{servers:[],mode:"auto"}),I(this,"_cloudProxyServerMode","disabled"),I(this,"_isDualStreamEnabled",!1),I(this,"_defaultStreamFallbackType",void 0),I(this,"_lowStreamParameter",void 0),I(this,"_streamFallbackTypeCacheMap",new Map),I(this,"_remoteStreamTypeCacheMap",new Map),I(this,"_axiosCancelSource",Qi.CancelToken.source()),I(this,"_audioVolumeIndicationInterval",void 0),I(this,"_networkQualityInterval",void 0),I(this,"_userOfflineTimeout",void 0),I(this,"_streamRemovedTimeout",void 0),I(this,"_injectStreamingClient",void 0),I(this,"_liveTranscodeStreamingClient",void 0),I(this,"_liveRawStreamingClient",void 0),I(this,"_channelMediaRelayClient",void 0),I(this,"_networkQualitySensitivity","normal"),I(this,"_p2pChannel",void 0),I(this,"_useLocalAccessPoint",!1),I(this,"_setLocalAPVersion",void 0),I(this,"_joinAndNotLeaveYet",!1),I(this,"_numberOfJoinCount",0),I(this,"_remoteDefaultVideoStreamType",void 0),I(this,"_inspect",void 0),I(this,"_moderation",void 0),I(this,"_license",void 0),I(this,"_pendingPublishedUsers",[]),I(this,"ntpAlignErrorCount",0),I(this,"remoteInboundOffset",0),I(this,"_handleLocalTrackEnable",(s,c,d)=>{this.publish(s,!1).then(c).catch(d)}),I(this,"_handleLocalTrackDisable",(s,c,d)=>{this.unpublish(s).then(c).catch(d)}),I(this,"_handleUserOnline",s=>{if(Y("BLOCK_LOCAL_CLIENT")&&Du(s.uid,this.channelName))return void O.debug("[".concat(s.uid,"] will be ignored in local"));this.isStringUID&&typeof s.uid!="string"&&O.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const c=this._users.find(d=>d.uid===s.uid);if(c)c._trust_in_room_=!0,c._is_pre_created&&(c._is_pre_created=!1,this.safeEmit(Et.USER_JOINED,c));else{const d=new Br(s.uid,s.uint_id||s.uid);this._users.push(d),O.debug("[".concat(this._clientId,"] user online"),s.uid),this.safeEmit(Et.USER_JOINED,d)}}),I(this,"_handleUserOffline",s=>{if(Y("BLOCK_LOCAL_CLIENT")&&Du(s.uid,this.channelName))return;const c=this._users.find(d=>d.uid===s.uid);c&&(this._handleRemoveStream(s),this._handleRemoveDataChannels(s),c._audio_pre_subscribed||c._video_pre_subscribed?c._is_pre_created=!0:Fy(this._users,c),this._remoteStreamTypeCacheMap.delete(c.uid),this._streamFallbackTypeCacheMap.delete(c.uid),O.debug("[".concat(this._clientId,"] user offline"),s.uid,"reason:",s.reason),this.safeEmit(Et.USER_LEAVED,c,s.reason))}),I(this,"_handleAddAudioOrVideoStream",(s,c,d,h,f,g,_)=>{if(Y("BLOCK_LOCAL_CLIENT")&&Du(c,this.channelName))return;const E=this._users.find(w=>w.uid===c);if(!E)return void O.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));O.debug("[".concat(this._clientId,"] stream added with uid ").concat(c,", type ").concat(s)),this.store.subscribe(E.uid,s,void 0,void 0,void 0,Date.now());const T=s==="audio"?E.hasAudio:E.hasVideo;E._uintid||(E._uintid=f||c),s==="audio"?E._trust_audio_stream_added_state_=!0:E._trust_video_stream_added_state_=!0,s==="audio"?(E._audio_added_=!0,d!==void 0&&(E._audioSSRC=d),h!==void 0&&(E._cname=h),g&&(E._audioOrtc=g)):(E._video_added_=!0,d!==void 0&&(E._videoSSRC=d),h!==void 0&&(E._cname=h),_!==void 0&&(E._rtxSsrcId=_),g&&(E._videoOrtc=g)),(s==="audio"?E.hasAudio:E.hasVideo)&&!T&&(O.info("[".concat(this._clientId,"] remote user ").concat(E.uid," published ").concat(s)),this.safeEmit(Et.USER_PUBLISHED,E,s)),s==="video"?Be.onGatewayStream(this._sessionId,gr.ON_ADD_VIDEO_STREAM,dn.ON_ADD_VIDEO_STREAM,{peer:f||c,ssrc:E._videoSSRC}):Be.onGatewayStream(this._sessionId,gr.ON_ADD_AUDIO_STREAM,dn.ON_ADD_AUDIO_STREAM,{peer:f||c,ssrc:E._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(E,s,d).then(w=>{if(w&&(O.debug("[".concat(this._clientId,"] resubscribe ").concat(s," for user ").concat(E.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof Lr))return this._p2pChannel.unsubscribe(E,s,!0).then(()=>this._subscribe(E,s,!0).catch(A=>{O.error("[".concat(this._clientId,"] resubscribe error"),A.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(E,s)&&(O.debug("[".concat(this._clientId,"] resubscribe ").concat(s," for user ").concat(E.uid," after reconnect.")),this._subscribe(E,s,!0).catch(w=>{O.error("[".concat(this._clientId,"] resubscribe error"),w.toString())}))}),I(this,"_handleRemoveStream",s=>{if(Y("BLOCK_LOCAL_CLIENT")&&Du(s.uid,this.channelName))return;const c=this._users.find(h=>h.uid===s.uid);if(!c)return void O.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));O.debug("[".concat(this._clientId,"] stream removed with uid ").concat(s.uid));let d=()=>{};c.hasAudio&&c.hasVideo?d=()=>{O.info("[".concat(this._clientId,"] remote user ").concat(c.uid," unpublished audio track")),this.safeEmit(Et.USER_UNPUBLISHED,c,"audio"),O.info("[".concat(this._clientId,"] remote user ").concat(c.uid," unpublished video track")),this.safeEmit(Et.USER_UNPUBLISHED,c,"video")}:c.hasVideo?d=()=>{O.info("[".concat(this._clientId,"] remote user ").concat(c.uid," unpublished video track")),this.safeEmit(Et.USER_UNPUBLISHED,c,"video")}:c.hasAudio&&(d=()=>{O.info("[".concat(this._clientId,"] remote user ").concat(c.uid," unpublished audio track")),this.safeEmit(Et.USER_UNPUBLISHED,c,"audio")}),c._video_pre_subscribed||c._audio_pre_subscribed||(c._trust_audio_stream_added_state_=!0,c._trust_video_stream_added_state_=!0,c._audio_added_=!1,c._video_added_=!1,this._p2pChannel instanceof Lr&&this._p2pChannel.unsubscribe(c).then(h=>{if(h)return this._gateway.unsubscribe(h,c.uid)}),c._audioSSRC=void 0,c._videoSSRC=void 0,c._audioOrtc=void 0,c._videoOrtc=void 0,c._rtxSsrcId=void 0),Be.onGatewayStream(this._sessionId,gr.ON_REMOVE_STREAM,dn.ON_REMOVE_STREAM,{peer:s.uint_id||s.uid}),d()}),I(this,"_handleSetStreamLocalEnable",(s,c,d)=>{if(Y("BLOCK_LOCAL_CLIENT")&&Du(c,this.channelName))return;const h=this._users.find(_=>_.uid===c);if(!h)return void O.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));O.debug("[".concat(this._clientId,"] local ").concat(s," ").concat(d?"enabled":"disabled"," with uid ").concat(c));const f=s==="audio"?h.hasAudio:h.hasVideo;if(s==="audio"){h._trust_audio_enabled_state_=!0;const _=h._audio_enabled_;if(h._audio_enabled_=d,h._audio_enabled_===_)return;{const E=h._audio_enabled_?"enable-local-audio":"disable-local-audio";O.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(c,", msg: ").concat(E)),this.safeEmit(Et.USER_INFO_UPDATED,c,E)}}else{h._trust_video_enabled_state_=!0;const _=h._video_enabled_;if(h._video_enabled_=d,h._video_enabled_===_)return;{const E=h._video_enabled_?"enable-local-video":"disable-local-video";O.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(c,", msg: ").concat(E)),this.safeEmit(Et.USER_INFO_UPDATED,c,E)}}const g=s==="audio"?h.hasAudio:h.hasVideo;return f!==g?!f&&g?(O.info("[".concat(this._clientId,"] remote user ").concat(c," published ").concat(s)),void this.safeEmit(Et.USER_PUBLISHED,h,s)):(s==="video"&&h._videoTrack&&h._videoTrack._destroy(),s==="audio"&&h._audioTrack,this._p2pChannel.muteRemote(h,s),O.info("[".concat(this._clientId,"] remote user ").concat(c," unpublished ").concat(s)),void this.safeEmit(Et.USER_UNPUBLISHED,h,s)):void 0}),I(this,"_handleMuteStream",(s,c,d)=>{if(Y("BLOCK_LOCAL_CLIENT")&&Du(s,this.channelName))return;O.debug("[".concat(this._clientId,"] receive mute message"),s,c,d);const h=this._users.find(_=>_.uid===s);if(!h)return void O.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(s));const f=c==="audio"?h.hasAudio:h.hasVideo;if(c==="audio"){h._trust_audio_mute_state_=!0;const _=h._audio_muted_;if(h._audio_muted_=d,h._audio_muted_===_)return;{const E=h._audio_muted_?"mute-audio":"unmute-audio";O.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(s,", msg: ").concat(E)),this.safeEmit(Et.USER_INFO_UPDATED,s,E)}}else{h._trust_video_mute_state_=!0;const _=h._video_muted_;if(h._video_muted_=d,h._video_muted_===_)return;{const E=h._video_muted_?"mute-video":"unmute-video";O.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(s,", msg: ").concat(E)),this.safeEmit(Et.USER_INFO_UPDATED,s,E)}}const g=c==="audio"?h.hasAudio:h.hasVideo;if(f!==g){if(!f&&g)return(c==="audio"?h._audioSSRC:h._videoSSRC)?(O.info("[".concat(this._clientId,"] remote user ").concat(s," published ").concat(c)),void this.safeEmit(Et.USER_PUBLISHED,h,c)):void O.warning("[".concat(this._clientId,"] remote user ").concat(s," receive ").concat(c," unmute message  before add stream message, ").concat(c," SSRC doesn't exist yet."));c==="video"&&h._videoTrack&&!h._video_pre_subscribed&&h._videoTrack._destroy(),c==="audio"&&h._audioTrack,this._p2pChannel.muteRemote(h,c),O.info("[".concat(this._clientId,"] remote user ").concat(s," unpublished ").concat(c)),this.safeEmit(Et.USER_UNPUBLISHED,h,c)}}),I(this,"_handleP2PLost",async s=>{O.debug("[".concat(this._clientId,"] receive p2p lost"),s),parseInt(s.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():O.warning("[".concat(this._clientId,"] P2PLost stream not found"),s)}),I(this,"_handleTokenWillExpire",()=>{O.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Et.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),I(this,"_handleBeforeUnload",s=>{s.type==="beforeunload"&&s.returnValue!==void 0&&s.returnValue!==""||(this.leave(),O.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),I(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Et.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const s={downlinkNetworkQuality:0,uplinkNetworkQuality:0};s.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),s.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Et.NETWORK_QUALITY,s)}),I(this,"_handleP2PAddAudioOrVideoStream",(s,c,d,h)=>{const f=this._users.find(_=>_.uid===c);if(!f)return void O.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));O.debug("[".concat(this._clientId,"] stream added with uid ").concat(c,", type ").concat(s)),this.store.subscribe(f.uid,s,void 0,void 0,void 0,Date.now());const g=s==="audio"?f.hasAudio:f.hasVideo;s==="audio"?f._trust_audio_stream_added_state_=!0:f._trust_video_stream_added_state_=!0,s==="audio"?(f._audio_added_=!0,d!==void 0&&(f._audioSSRC=d),h!==void 0&&(f._audioMid=h)):(f._video_added_=!0,d!==void 0&&(f._videoSSRC=d),h!==void 0&&(f._videoMid=h)),(s==="audio"?f.hasAudio:f.hasVideo)&&!g&&(O.info("[".concat(this._clientId,"] remote user ").concat(f.uid," published ").concat(s)),this.safeEmit(Et.USER_PUBLISHED,f,s)),this._p2pChannel.hasPendingRemoteMedia(f,s)&&(O.debug("[".concat(this._clientId,"] resubscribe ").concat(s," for user ").concat(f.uid," after reconnect.")),this._subscribe(f,s,!0).catch(_=>{O.error("[".concat(this._clientId,"] resubscribe error"),_.toString())}))}),this._config=n,this._clientId=Qt(5,"client-"),this.store=new aie(n.codec,n.audioCodec,n.mode,this._clientId),this.store.clientCreated(),n.proxyServer&&this.setProxyServer(n.proxyServer,!0),n.turnServer&&this.setTurnServer(n.turnServer,!0),O.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(ms," build: ").concat(wI,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),n.clientRoleOptions)try{yj(n.clientRoleOptions),r=Object.assign({},n.clientRoleOptions)}catch(s){O.warning("[".concat(this._clientId,"] ").concat(s.toString()))}this._statsCollector=new l_(this.store),this._statsCollector.onStatsException=(s,c,d)=>{O.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(s,", msg: ").concat(c,", uid: ").concat(d)),this.safeEmit(Et.EXCEPTION,{code:s,msg:c,uid:d})},this._statsCollector.onUploadPublishDuration=(s,c,d,h)=>{const f=this._users.find(g=>g.uid===s);f&&Be.peerPublishStatus(this._sessionId,{subscribeElapse:h,audioPublishDuration:c,videoPublishDuration:d,peer:f._uintid})},this.store.useDataChannel=Lt().supportDataChannel&&Y("SIGNAL_CHANNEL"),this.store.useP2P=n.mode==="p2p",this._gateway=new Hie(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:n.websocketRetryConfig||ir,httpRetryConfig:n.httpRetryConfig||ir,forceWaitGatewayResponse:n.forceWaitGatewayResponse===void 0||n.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:n.role,clientRoleOptions:r}),this._configDistribute=new eoe,this.store.useP2P?(this._p2pChannel=new Er(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new Lr(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(n,r,s,c,d){let h=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],f=arguments.length>6&&arguments[6]!==void 0&&arguments[6];qt("JOIN_GATEWAY_USE_443PORT_ONLY",h),qt("JOIN_GATEWAY_USE_DUAL_DOMAIN",f);const g=this._gateway.signal.websocket;return g instanceof Og&&(g.use443PortOnly=h,g.tryDoubleDomain=f),async function(_,E,T){Dy.get(_)||Dy.set(_,[]),xy.get(_)||xy.set(_,E),Xa.get(_)||Xa.set(_,0);const w=Dy.get(_),A=xy.get(_);if(!w||!A)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(Xa.get(_)===A){const $=_g();w.push($),await $.promise}Xa.set(_,Xa.get(_)+1);for(var L=arguments.length,P=new Array(L>3?L-3:0),D=3;D<L;D++)P[D-3]=arguments[D];const G=await T(...P);return Xa.set(_,Xa.get(_)-1),Xa.get(_)===A-1&&w.length>0&&(w[0].resolve(),w.shift()),Xa.get(_)===0&&(Dy.set(_,[]),xy.set(_,0),Xa.set(_,0)),G}("client.join",Y("JOIN_MAX_CONCURRENCY"),this.join.bind(this),n,r,s,c,d)}async join(n,r,s,c,d){const h=++this._numberOfJoinCount;this.store.joinStart(),c&&(this.store.uid=c);const f=sie(),g=dF()?window.isSecureContext:"Browser Not Support";(!dF()&&!f||!window.isSecureContext)&&O.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser");const _=rI();this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),O.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const E=Be.reportApiInvoke(_,{name:tr.JOIN,options:[n,r,s,c],states:{isHttps:f,isSecureContext:g},tag:yn.TRACER});Be.setAppId(n);try{if(!s&&s!==null)throw new Z(B.INVALID_PARAMS,"Invalid token: ".concat(s,". If you don not use token, set it to null"));s&&Xr(s,"token",1,2047),Xr(n,"appid",1,2047),OI(r),c&&NI(c),d&&Xr(d,"optionalInfo",1,2047)}catch(P){throw E.onError(P),P}if(O.info("[".concat(this._clientId,"] start join channel ").concat(r,", join number: ").concat(h)),this._leaveMutex.isLocked&&(O.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),O.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const P=new Z(B.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw E.onError(P),P}this._sessionId||(this._sessionId=_,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const T=La(La({},this._rtmConfig),{},{clientId:this._clientId,appId:n,sid:this._sessionId,cname:r,uid:typeof c!="string"?c:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:s||n,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:d,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(T.setLocalAPVersion=this._setLocalAPVersion),typeof c=="string"&&(T.stringUid=c,this._uintUid?(T.uid=this._uintUid,this._uintUid=void 0):T.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(T.aesmode=this._encryptionMode,T.aespassword=await Cre(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new Z(B.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(T.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const P=new TextEncoder,D=Y("USE_PURE_ENCRYPTION_MASTER_KEY")?P.encode(T.appId+this._encryptionSecret+this._encryptionSecret):P.encode(T.appId+T.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(G,$,X){const ie=await window.crypto.subtle.importKey("raw",$,"PBKDF2",!1,["deriveBits","deriveKey"]),Q=G==="aes-128-gcm2"?128:256,te=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:fF,hash:"SHA-256",salt:X},ie,Q+cie);return new Uint8Array(te).subarray(Q/8)}(this._encryptionMode,D,yg(this._encryptionSalt)),this._encryptDataStreamKey=await async function(G,$,X){const ie=await window.crypto.subtle.importKey("raw",$,"PBKDF2",!1,["deriveBits","deriveKey"]),Q=G==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:fF,hash:"SHA-256",salt:X},ie,{name:"AES-GCM",length:Q},!0,["encrypt","decrypt"])}(this._encryptionMode,D,yg(this._encryptionSalt))}else g?O.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):O.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,O.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:r,appId:n,stringUid:T.stringUid});const w=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&w===this._sessionId&&Be.joinChannelTimeout(this._sessionId,5)},5e3);try{var A;let P;const D=T.cloudProxyServer;if(Le(A=["proxy3","proxy4","proxy5"]).call(A,D)){const Q=Y("PROXY_SERVER_TYPE3");Array.isArray(Q)?T.proxyServer=Q[0]:T.proxyServer=Q}if(Be.setProxyServer(T.proxyServer),O.setProxyServer(T.proxyServer),this.store.requestAPStart(),T.stringUid&&!T.uid){let Q;[Q,P]=await ae.all([rV(T.stringUid,T,this._axiosCancelSource.token,this._config.httpRetryConfig||ir,this.store),nV(T,this._axiosCancelSource.token,this._config.httpRetryConfig||ir,!0,this.store)]),O.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(T.stringUid," => ").concat(Q)),T.uid=Q,P.gatewayInfo.uid=Q,P.gatewayInfo.res.uid=Q}else P=await nV(T,this._axiosCancelSource.token,this._config.httpRetryConfig||ir,!0,this.store);if(!this._joinAndNotLeaveYet)throw new Z(B.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(T,this._axiosCancelSource.token),this._configDistribute.on(Ag.UPDATE_BITRATE_LIMIT,Q=>{this._p2pChannel.updateBitrateLimit(Q)})},0),this._key=s||n;const G=P.gatewayInfo,$=T.uid?T.uid:G.uid;this._joinInfo=La(La({},T),{},{cid:G.cid,uid:$,vid:G.vid,apResponse:G.res,uni_lbs_ip:G.uni_lbs_ip,gatewayAddrs:G.gatewayAddrs}),this.store.intUid=$;const X=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new Z(B.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));E.onSuccess(X),this._appId=n,this._channelName=T.cname,this._uid=X,this.store.uid=X,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(Fr()?"beforeunload":"pagehide",this._handleBeforeUnload)},0);const ie=T.stringUid?"string uid: ".concat(T.stringUid,",uid: ").concat(T.uid):"uid: ".concat(this._uid);return O.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(r,",").concat(ie)),setTimeout(()=>{O.startUpload()},5e3),this.store.joinEnd(),L=this,Le(rd).call(rd,L)||rd.push(L),X}catch(P){const D=Array.isArray(P)?P[0]:P;throw D&&D.code===B.OPERATION_ABORTED?O.warning("[".concat(this._clientId,"] join number: ").concat(h,", Joining channel failed, rollback"),D):O.error("[".concat(this._clientId,"] join number: ").concat(h,", Joining channel failed, rollback"),D),D.code!==B.OPERATION_ABORTED&&this._numberOfJoinCount===h&&(this._gateway.state="DISCONNECTED",this._reset()),E.onError(D),D}var L}_joinGateway(){if(!this._joinInfo||!this._key)throw new Z(B.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!Y("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(n=>n).catch(n=>{if(n.code===B.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,vt.FALLBACK),n;if(n.code===B.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,vt.FALLBACK),n;throw n}).then(n=>{if(n instanceof Z){if(n.code===B.INIT_WEBSOCKET_TIMEOUT){if(O.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new Z(B.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const r=Y("PROXY_SERVER_TYPE3");if(Array.isArray(r))if(this._joinInfo.apUrl){const c=/^https?:\/\/(.+?)(\/.*)?$/.exec(this._joinInfo.apUrl)[1].split("."),d=c.slice(c.length-2).join(".");r.forEach(h=>{this._joinInfo&&Le(h).call(h,d)&&(this._joinInfo.proxyServer=h)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=r[0])}else this._joinInfo.proxyServer=r[0];else this._joinInfo.proxyServer=r;const s=Y("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return s&&s[1]&&s[1]!=="443"&&O.setProxyServer(this._joinInfo.proxyServer),Y("STATS_COLLECTOR_PORT").toString()!=="443"&&Be.setProxyServer(this._joinInfo.proxyServer),Be.reportApiInvoke(this._sessionId,{name:tr.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:yn.TRACER}).onSuccess(),this.safeEmit(Et.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),Y("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&this._joinInfo.turnServer.servers.forEach(c=>{"forceturn"in c&&(c.forceturn=!0)}),this._gateway.join(this._joinInfo,this._key)}if(O.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new Z(B.INVALID_OPERATION);return Be.reportApiInvoke(this._sessionId,{name:tr.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:yn.TRACER}).onSuccess(),this._joinGateway()}return n}).then(n=>n)}async leave(){O.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(Fr()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(r){const s=rd.indexOf(r);s!==-1&&rd.splice(s,1)}(this);const n=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return O.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void n();await this._gateway.leave(this.connectionState!=="CONNECTED"),O.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),n()}async publish(n){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(n)){if(!(n instanceof Zr))return this._publishDataChannel(n);n=[n]}if(n.length===0)throw new Z(B.INVALID_PARAMS,"param list is empty");const s=n;if(this._gateway.role==="audience")throw new Z(B.INVALID_OPERATION,"audience can not publish stream");for(const d of s){if(!(d instanceof Zr))throw new Z(B.INVALID_PARAMS,"parameter is not local track");if(!d._enabled&&r)throw new Z(B.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(d.getTrackId()))}O.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(s.map(d=>"".concat(d.getTrackId()," "))));const c=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),r&&s.forEach(d=>{const h=this._configDistribute.getBitrateLimit();d instanceof ht&&h&&d.setBitrateLimit(h.uplink)});try{await this._publishHighStream(s),O.info("[".concat(this._clientId,"] Publish success, id ").concat(s.map(d=>"".concat(d.getTrackId()," "))))}catch(d){throw O.error("[".concat(this._clientId,"] publish error"),d.toString()),d}finally{c()}}async _publishDataChannel(n){Yt(n.id,"id",0,65535,!0),$c(n.ordered,"ordered"),Xr(n.metadata,"metadata",0,512),O.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(n.id));const r=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(c=>c.id===n.id)!==-1)throw new Z(B.INVALID_PARAMS,"Invalid id: ".concat(n.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new Z(B.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Y("FORCE_TURN")&&!Y("TURN_ENABLE_TCP")&&!Y("TURN_ENABLE_UDP"))throw new Z(B.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const s=new DB(n);if(await this._p2pChannel.publishDataChannel([s]),!this._p2pChannel.isP2PDisconnected()){if(typeof s._originDataChannelId!="number")throw O.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new Z(B.CREATE_DATACHANNEL_ERROR);try{const c={streamId:n.id,ordered:n.ordered,maxRetransmits:Y("DATASTREAM_MAX_RETRANSMITS"),metadata:n.metadata,channelId:s._originDataChannelId};await this._gateway.publishDataChannel(this._uid,c,!0),await s._waitTillOpen()}catch(c){if(c.code!==B.DISCONNECT_P2P)throw c}}return O.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(s.id)),s}catch(s){throw O.error("[".concat(this._clientId,"] publish datachannels error"),s.toString()),s}finally{r()}}async unpublish(n){if(!this._joinInfo||this._uid===void 0)throw new Z(B.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let r=[];if(n)if(Array.isArray(n))r=n;else{if(!(n instanceof Zr))return this._unpublishDataChannel([n]);r=[n]}else this.store.useP2P||await this._unpublishDataChannel(),r=this._p2pChannel.getAllTracks(!0);O.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(r.map(c=>"".concat(c.getTrackId()," "))," "));const s=await this._publishMutex.lock();try{if(this._p2pChannel instanceof Er){const c=await this._p2pChannel.unpublish(r);c&&await this._gateway.sendExtensionMessage(An.UNPUBLISH,{unpubMsg:c},!0)}else{const c=await this._p2pChannel.unpublish(r);c&&await this._gateway.unpublish(c,this._uid),O.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(r.map(d=>"".concat(d.getTrackId()))))}}catch(c){throw O.error("[".concat(this._clientId,"] unpublish error"),c.toString()),c}finally{s&&s()}}async _unpublishDataChannel(n){n!==void 0&&n.length!==0||(n=this._p2pChannel.getAllDataChannels()),O.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(n.map(s=>"".concat(s.id," "))," "));const r=await this._publishMutex.lock();try{const s=await this._p2pChannel.unpublishDataChannel(n);s&&await this._gateway.unpublishDataChannel(s),O.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(n.map(c=>"".concat(c.id))))}catch(s){throw O.error("[".concat(this._clientId,"] unpublish dataChannel error"),s.toString()),s}finally{r&&r()}}async subscribe(n,r,s){return r==="datachannel"?this._subscribeDataChannel(n,s):this._subscribe(n,r)}async presubscribe(n,r){if(mr(r,"mediaType",["audio","video"]),this._p2pChannel instanceof Er)throw new Z(B.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new Z(B.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const s=r===Fe.AUDIO,c=r===Fe.VIDEO,d=await this._subscribeMutex.lock();try{const{ssrcId:h,ortc:f,rtxSsrcId:g,cname:_,uint_id:E}=await this._gateway.presubscribe(n,r,!0);if(h==null)throw new Z(B.UNEXPECTED_RESPONSE,"no ssrc id");let T=this._users.find(A=>A.uid===n);T||(T=new Br(n,E||n),T._is_pre_created=!0,this._users.push(T)),_&&(T._cname=_),T._uintid||(T._uintid=E||n),s&&(T._audioSSRC=h,T._audio_pre_subscribed=!0,f&&(T._audioOrtc=f)),c&&(T._videoSSRC=h,T._video_pre_subscribed=!0,f&&(T._videoOrtc=f),g!=null&&(T._rtxSsrcId=g)),O.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(h)),await this._p2pChannel.subscribe(T,r,h,g,f);const w=s?T._audioTrack:T._videoTrack;if(!w)throw new Z(B.UNEXPECTED_ERROR,"can not find remote track in user");return s&&(T._trust_audio_stream_added_state_=!0,T._audio_added_=!0),c&&(T._trust_video_stream_added_state_=!0,T._video_added_=!0),w}catch(h){throw O.error("[".concat(this._clientId,"] presub user ").concat(n," error"),h),h}finally{d()}}async _subscribeDataChannel(n,r){var s;if(Yt(r,"channelId",0,65535,!0),!this._joinInfo)throw new Z(B.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(f=>f===n))throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", this user is not in the channel")),new Z(B.INVALID_REMOTE_USER,"user is not in the channel");if(!n.hasAudio&&!n.hasVideo&&n._dataChannels.length===0)throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", user is not published")),new Z(B.INVALID_REMOTE_USER,"user is not published");const c=(s=n._dataChannels)===null||s===void 0?void 0:s.find(f=>f.id===r);if(!c)throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType datachannel, remote datachannel is not published")),new Z(B.REMOTE_USER_IS_NOT_PUBLISHED);const d=await this._subscribeMutex.lock();O.info("[".concat(this._clientId,"] subscribe user ").concat(n.uid,", mediaType: datachannel"));try{const f=await this._p2pChannel.subscribeDataChannel(n,[c]);if(f&&Le(f).call(f,c.id))try{var h;if(typeof c._originDataChannelId!="number")throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType datachannel, cannot get RTCDatachannel")),new Z(B.CREATE_DATACHANNEL_ERROR);const g={id:c.id,datachannelId:c._originDataChannelId,ordered:c.ordered,maxRetransmits:c.maxRetransmits,metadata:(h=c.metadata)!==null&&h!==void 0?h:""};await this._gateway.subscribeDataChannel(n.uid,g,!0),await c._waitTillOpen()}catch(g){if((g==null?void 0:g.code)!==B.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(n,[c]),g;await this._p2pChannel.unsubscribeDataChannel(n,[c]),this._p2pChannel.setPendingRemoteDataChannel(n,c.id)}return O.info("[".concat(this._clientId,"] subscribe success user ").concat(n.uid,", mediaType: datachannel")),c}finally{d()}}async _p2pSubscribe(n,r,s){if(mr(r,"mediaType",["audio","video"]),!this._joinInfo)throw new Z(B.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(d=>d===n)){const d=new Z(B.INVALID_REMOTE_USER,"user is not in the channel");throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", this user is not in the channel")),d}if(!n.hasAudio&&!n.hasVideo){const d=new Z(B.INVALID_REMOTE_USER,"user is not published");throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", user is not published")),d}if(!s&&(r==="audio"&&!n.hasAudio||r==="video"&&!n.hasVideo)){const d=new Z(B.REMOTE_USER_IS_NOT_PUBLISHED);throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType ").concat(r,", remote track is not published")),d}const c=await this._subscribeMutex.lock();O.info("[".concat(this._clientId,"] subscribe user ").concat(n.uid,", mediaType: ").concat(r));try{if(await this._p2pChannel.hasRemoteMediaWithLock(n,r))await this._p2pChannel.unmuteRemote(n,r);else try{const h=r==="audio"?n._audioSSRC:n._videoSSRC,f=r==="audio"?n._audioMid:n._videoMid;this.store.subscribe(n.uid,r,Date.now()),this._p2pChannel instanceof Er&&await this._p2pChannel.subscribe(n,r,h,f)}catch(h){throw h}O.info("[".concat(this._clientId,"] subscribe success user ").concat(n.uid,", mediaType: ").concat(r)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(n.uid,this._defaultStreamFallbackType).catch(h=>{O.warning("[".concat(this._clientId,"] auto set fallback failed"),h)});const d=r==="audio"?n._audioTrack:n._videoTrack;if(!d)throw new Z(B.UNEXPECTED_ERROR,"can not find remote track in user object");return d}catch(d){throw O.error("[".concat(this._clientId,"] subscribe user ").concat(n.uid," error"),d),d}finally{c()}}async _subscribe(n,r,s){if(this._p2pChannel instanceof Er)return this._p2pSubscribe(n,r);if(mr(r,"mediaType",["audio","video"]),!this._joinInfo)throw new Z(B.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(_=>_===n)){const _=new Z(B.INVALID_REMOTE_USER,"user is not in the channel");throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", this user is not in the channel")),_}if(!n.hasAudio&&!n.hasVideo){const _=new Z(B.INVALID_REMOTE_USER,"user is not published");throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid,", user is not published")),_}if(!(s||(r!=="audio"||n.hasAudio&&n._audioSSRC!==void 0)&&(r!=="video"||n.hasVideo&&n._videoSSRC!==void 0))){const _=new Z(B.REMOTE_USER_IS_NOT_PUBLISHED);throw O.error("[".concat(this._clientId,"] can not subscribe ").concat(n.uid," with mediaType ").concat(r,", remote track is not published")),_}let c=r==="audio"?n._audioSSRC:n._videoSSRC,d=r==="audio"?n._audioOrtc:n._videoOrtc,h=r==="video"?n._rtxSsrcId:void 0,f={stream_type:r==="audio"?Fe.AUDIO:Fe.VIDEO,ssrcId:c};const g=await this._subscribeMutex.lock();O.info("[".concat(this._clientId,"] subscribe user ").concat(n.uid,", mediaType: ").concat(r));try{if(await this._p2pChannel.hasRemoteMediaWithLock(n,r))await this._p2pChannel.unmuteRemote(n,r);else try{const E=r==="audio"?n._audioSSRC:n._videoSSRC;E!==void 0&&E!==c&&(c=E,d=r==="audio"?n._audioOrtc:n._videoOrtc,h=r==="video"?n._rtxSsrcId:void 0,f={stream_type:r==="audio"?Fe.AUDIO:Fe.VIDEO,ssrcId:c}),ei.markSubscribeStart(this.store.clientId,c),this.store.subscribe(n.uid,r,Date.now()),await this._p2pChannel.subscribe(n,r,c,h,d);try{await this._gateway.subscribe(n.uid,f,!0)}catch(T){if((T==null?void 0:T.code)!==B.WS_ABORT)throw await this._p2pChannel.unsubscribe(n,r),T;await this._p2pChannel.unsubscribe(n,r,!0),this._p2pChannel.setPendingRemoteMedia(n,r)}this.store.subscribe(n.uid,r,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,n,r)}catch(E){throw this._p2pChannel.reportSubscribeEvent(!1,E==null?void 0:E.code,n,r),E}O.info("[".concat(this._clientId,"] subscribe success user ").concat(n.uid,", mediaType: ").concat(r)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(n.uid,this._defaultStreamFallbackType).catch(E=>{O.warning("[".concat(this._clientId,"] auto set fallback failed"),E)});const _=r==="audio"?n._audioTrack:n._videoTrack;if(!_)throw new Z(B.UNEXPECTED_ERROR,"can not find remote track in user object");return _}catch(_){throw O.error("[".concat(this._clientId,"] subscribe user ").concat(n.uid," error"),_),_}finally{g()}}async massSubscribe(n){if(Kc(n,"subscribeList"),!this._joinInfo)throw new Z(B.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const r=Date.now(),s=new Map,c=await this._subscribeMutex.lock();O.info("[".concat(this._clientId,"]start massSubscribe user ").concat(n.map(g=>{let{user:_,mediaType:E}=g;return"user: ".concat(_==null?void 0:_.uid,", mediaType: ").concat(E)}).join("; ")));const d=(n=[...n]).map(g=>{let{user:_,mediaType:E}=g;return{user:_,mediaType:E}}),h=await this._p2pChannel.globalLock();try{var f;for(let _=n.length-1;_>=0;_--){const E=n[_],{user:T,mediaType:w}=E;if(mr(w,"mediaType",["audio","video"]),!T){const P=new Z(B.INVALID_PARAMS,"user property does not exist in subscribeList item");throw O.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),P}if(!this._users.find(P=>P===T)){const P=new Z(B.INVALID_REMOTE_USER,"user is not in the channel");O.error("[".concat(this._clientId,"] can not massSubscribe ").concat(T.uid,", this user is not in the channel")),d[_].error=P,n.splice(_,1);continue}if(w==="audio"&&(!T.hasAudio||T._audioSSRC===void 0)||w==="video"&&(!T.hasVideo||T._videoSSRC===void 0)){const P=new Z(B.REMOTE_USER_IS_NOT_PUBLISHED);O.error("[".concat(this._clientId,"] can not subscribe ").concat(T.uid," with mediaType ").concat(w,", remote user is not published")),d[_].error=P,n.splice(_,1);continue}const A=cr.Video|cr.LwoVideo,L=s.get(T);if(L){if(w==="video"?L&A:L&cr.Audio){n.splice(_,1),O.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(T.uid,", mediaType:").concat(w," twice"));continue}s.set(T,L|(w==="video"?A:cr.Audio))}else s.set(T,w==="video"?A:cr.Audio)}for(let _=n.length-1;_>=0;_--){const E=n[_],{user:T,mediaType:w}=E,A=cr.Video|cr.LwoVideo;if(this._p2pChannel.hasRemoteMedia(T,w)){await this._p2pChannel.unmuteRemoteNoLock(T,w);const L=s.get(T);s.set(T,w==="video"?L^A:L^cr.Audio),n.splice(_,1)}}this.store.massSubscribe(n.map(_=>({userId:_.user.uid,type:_.mediaType})),r);const g=qc(f=Array.from(s.entries())).call(f,(_,E)=>{let[T,w]=E;if(w===0)return _;const A={stream_id:T.uid,stream_type:w};return w&cr.Audio&&(A.audio_ssrc=T._audioSSRC),w&cr.Video&&(A.video_ssrc=T._videoSSRC),_.push(A),_},[]);try{n.length>0&&await this._p2pChannel.massSubscribeNoLock(n.map(E=>{let{user:T,mediaType:w}=E;return{user:T,mediaType:w,ssrcId:w===Fe.VIDEO?T._videoSSRC:T._audioSSRC,rtxSsrcId:w===Fe.VIDEO?T._rtxSsrcId:void 0}}));const _=new Map;if(g.length>0){const E=await this._gateway.subscribeAll(g,!0);((E==null?void 0:E.users)||[]).forEach(T=>{let{stream_id:w,video_error_code:A,audio_error_code:L,error_code:P}=T;(A||L||P)&&_.set(w,{video_error_code:A,audio_error_code:L,error_code:P})})}if(Array.from(_.entries()).length>0){const E=[];Array.from(_.entries()).forEach(T=>{let[w,A]=T;const L=this.remoteUsers.find(P=>P.uid===w);if(L){let P;A.error_code||A.video_error_code&&A.audio_error_code?P=void 0:A.video_error_code?P=Fe.VIDEO:A.audio_error_code&&(P=Fe.AUDIO),E.push({user:L,mediaType:P})}}),E.length>0&&await this._p2pChannel.massUnsubscribeNoLock(E)}for(const E of d){const T=_.get(E.user.uid);if(T){const w=T.error_code||E.mediaType==="audio"&&T.audio_error_code||E.mediaType==="video"&&T.video_error_code;if(w){const A=Lu(w);O.error("user:".concat(E.user.uid," mediaType:").concat(E.mediaType," has massSubscribe error ").concat(A.desc)),E.error=new Z(B.SUBSCRIBE_FAILED,"code ".concat(w,": ").concat(A.desc))}}E.error||(E.mediaType==="video"?E.track=E.user.videoTrack:E.track=E.user.audioTrack)}return this.store.massSubscribe(d.filter(E=>!E.error).map(E=>({userId:E.user.uid,type:E.mediaType})),void 0,Date.now()),d.forEach(E=>{var T;Be.subscribe(this.store.sessionId,{succ:!!E.error,ec:((T=E.error)===null||T===void 0?void 0:T.code)||null,video:E.mediaType===Fe.VIDEO,audio:E.mediaType===Fe.AUDIO,peerid:E.user.uid,subscribeRequestid:E.mediaType===Fe.VIDEO?E.user._videoSSRC:E.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-r)},!0)}),O.info("[".concat(this._clientId,"] massSubscribe success ").concat(n.map(E=>{let{user:T,mediaType:w}=E;return"user: ".concat(T==null?void 0:T.uid,", mediaType: ").concat(w)}).join("; "))),d}catch(_){throw await this._p2pChannel.massUnsubscribeNoLock(n),_}}finally{h(),c()}}async unsubscribe(n,r,s){if(r||this.store.useP2P){if(r==="datachannel")return this._unsubscribeDataChannel(n,s)}else await this._unsubscribeDataChannel(n,s);if(r&&mr(r,"mediaType",["audio","video"]),!this._joinInfo)throw new Z(B.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(d=>d===n)){const d=new Z(B.INVALID_REMOTE_USER,"user is not in the channel");throw O.error("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid,", user is not in the channel")),d}O.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(n.uid,", mediaType: ").concat(r));const c=await this._subscribeMutex.lock();try{if(this._p2pChannel instanceof Er)await this._p2pChannel.unsubscribe(n,r);else{const d=await this._p2pChannel.unsubscribe(n,r);d&&await this._gateway.unsubscribe(d,n.uid),r&&r!=="audio"||(n._audio_pre_subscribed=!1),r&&r!=="video"||(n._video_pre_subscribed=!1),n._is_pre_created&&Fy(this._users,n),O.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(n.uid,", mediaType: ").concat(r))}}catch(d){if(d.code===B.DISCONNECT_P2P)return void O.warning("disconnecting p2p, abort unsubscribe request.");throw O.error("[".concat(this._clientId,"] unsubscribe user ").concat(n.uid," error"),d.toString()),d}finally{c()}}async _unsubscribeDataChannel(n,r){if(r&&Yt(r,"id",0,65535,!0),!this._joinInfo)throw new Z(B.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(c=>c===n)){const c=new Z(B.INVALID_REMOTE_USER,"user is not in the channel");throw O.error("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid,", user is not in the channel")),c}let s;if(typeof r=="number"){const c=n._dataChannels.find(d=>d.id===r);c&&(s=[c])}else s=n._dataChannels;if(s===void 0){const c=new Z(B.REMOTE_USER_IS_NOT_PUBLISHED);throw O.error("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid," with channelId ").concat(r,", remote datachannel is not published")),c}O.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(n.uid,", mediaType: datachannel, ids: ").concat(s.map(c=>c.id)));try{const c=await this._p2pChannel.unsubscribeDataChannel(n,s);c&&await this._gateway.unsubscribeDataChannel(c,n.uid),O.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(n.uid,", mediaType: datachannel, ids: ").concat(c))}catch(c){if(c.code===B.DISCONNECT_P2P)return void O.warning("disconnecting p2p, abort unsubscribe request.");throw O.error("[".concat(this._clientId,"] unsubscribe user ").concat(n.uid," error"),c.toString()),c}}async massUnsubscribe(n){if(Kc(n,"unsubscribeList"),!this._joinInfo)throw new Z(B.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");O.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(n.map(s=>{let{user:c,mediaType:d}=s;return"user: ".concat(c==null?void 0:c.uid,", mediaType: ").concat(d,";")}).join())),n=[...n];const r=new Map;for(let s=n.length-1;s>=0;s--){const{user:c,mediaType:d}=n[s];if(!c){const f=new Z(B.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw O.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),f}if(mr(d,"mediaType",["video","audio",void 0]),!this._users.find(f=>f===c)){O.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(c.uid,", user is not in the channel")),n.splice(s,1);continue}const h=cr.Video|cr.LwoVideo;if(r.has(c)){const f=r.get(c);let g;switch(d){case"video":g=f&h;break;case"audio":g=f&cr.Audio;break;default:g=f&(cr.Audio|h)}if(g){O.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(c.uid,",mediaType:").concat(d," twice.")),n.splice(s,1);continue}d?d==="audio"?r.set(c,f|cr.Audio):d==="video"&&r.set(c,f|h):r.set(c,f|cr.Audio|h)}else d?d==="audio"?r.set(c,cr.Audio):d==="video"&&r.set(c,h):r.set(c,cr.Audio|h)}try{const s=await this._p2pChannel.massUnsubscribe(n);s&&await this._gateway.massUnsubscribe(s),O.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(n.map(c=>{let{user:d,mediaType:h}=c;return"user: ".concat(d==null?void 0:d.uid,", mediaType: ").concat(h,";")}).join()))}catch(s){if(s.code===B.DISCONNECT_P2P)return void O.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw O.error("[".concat(this._clientId,"] massUnsubscribe error"),s.toString()),s}}async setLowStreamParameter(n){(function(s){if(!s)throw new he(B.INVALID_PARAMS);wn(s.width)||QR(s.width,"streamParameter.width"),wn(s.height)||QR(s.height,"streamParameter.height"),wn(s.framerate)||QR(s.framerate,"streamParameter.framerate"),wn(s.bitrate)||Yt(s.bitrate,"streamParameter.bitrate")})(n),(!n.width&&n.height||n.width&&!n.height)&&O.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),O.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(n));const r=this._configDistribute.getLowStreamConfigDistribute();if(r&&r.bitrate&&n.bitrate&&r.bitrate<n.bitrate&&(n.bitrate=r.bitrate),this._lowStreamParameter=n,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(n,Ee.LocalVideoLowTrack)}async enableDualStream(){if(!Lt().supportDualStream)throw Be.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new Z(B.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new Z(B.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(n){throw Be.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),n}this._isDualStreamEnabled=!0,Be.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),O.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new Z(B.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(Ee.LocalVideoLowTrack))try{const n=await this._p2pChannel.unpublishLowStream();n&&await this._gateway.unpublish(n,this._joinInfo.stringUid||this._joinInfo.uid)}catch(n){throw Be.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),n}this._isDualStreamEnabled=!1,Be.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),O.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(n,r){if(function(s){mr(s,"role",["audience","host"])}(n),r&&yj(r),this.mode==="rtc"||this.mode==="p2p")throw O.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new Z(B.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(r&&r.level&&n==="host")throw new Z(B.INVALID_OPERATION,"host mode can not set audience latency level");if(n==="audience"&&this._p2pChannel.hasLocalMedia())throw new Z(B.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(n,r),this._config.role=n,O.info("[".concat(this._clientId,"] set client role to ").concat(n,", level: ").concat(r&&r.level))}getRemoteInboundOffset(){var n;const r=(n=this._p2pChannel.getStats())===null||n===void 0?void 0:n.audioSend[0];if(!r||!r.timestamp)return 0;const s=r.timestamp-Date.now();return Math.abs(s)>1e3+r.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?s:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(n,r){if(Xr(n,"proxyServer"),!r){if(this.connectionState!=="DISCONNECTED")throw new Z(B.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Z(B.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=n,Be.setProxyServer(this._proxyServer),O.setProxyServer(this._proxyServer),O.info("[".concat(this._clientId,"] Set proxy server ").concat(r?"by initialize call":""," success."))}setTurnServer(n,r){if(Array.isArray(n)||(n=[n]),!r){if(this.connectionState!=="DISCONNECTED")throw new Z(B.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Z(B.INVALID_OPERATION,"You have already set the proxy")}if(Sp(n))return this._turnServer={servers:n,mode:"original-manual"},void O.info("[".concat(this._clientId,"] Set original turnserver ").concat(r?"by initialize call":""," success: ").concat(n.map(s=>s.urls).join(","),"."));n.forEach(s=>Ej(s)),this._turnServer={servers:n,mode:"manual"},O.info("[".concat(this._clientId,"] Set turnserver ").concat(r?"by initialize call":""," success."))}setLicense(n){if(this.connectionState!=="DISCONNECTED")throw new Z(B.INVALID_OPERATION,"you should set license before join channel");if(Xr(n,"license",32,32),!/^[A-Za-z\d]+$/.test(n))throw new Z(B.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=n,O.info("[".concat(this._clientId,"] set license success"),n)}startProxyServer(n){if(this.connectionState!=="DISCONNECTED")throw new Z(B.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new Z(B.INVALID_OPERATION,"You have already set the proxy");const r=[3,4,5];let s;switch(n===void 0&&(n=3),n){case 1:case 2:throw new Z(B.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:s="proxy3";break;case 4:s="proxy4";break;case 5:s="proxy5";break;default:throw new Z(B.INVALID_PARAMS,"proxy server mode must be ".concat(r.join("|")))}this._cloudProxyServerMode=s,this.store.cloudProxyServerMode=s,O.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new Z(B.INVALID_OPERATION,"Stop proxy server after leave channel");Be.setProxyServer(),O.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",O.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(n){if(!n.accessPoints)throw new Z(B.INVALID_PARAMS,"accessPoints is required.");Kc(n.accessPoints.serverList,"accessPoints.serverList"),Xr(n.accessPoints.domain,"accessPoints.domain");const r=(A,L)=>{Yt(A,L,0,65535,!0)};let s=443;if(n.accessPoints.port&&(r(n.accessPoints.port,"accessPoints.port"),s=n.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Z(B.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");Y("CLOSE_AFB_FOR_LOCAL_AP")&&(qt("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),qt("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const c=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,d=n.accessPoints.domain,h=n.accessPoints.serverList.map(A=>c.test(A)?"".concat(A.replace(/\./g,"-"),".").concat(d):A),f=h.map(A=>"".concat(A,":").concat(s));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,qt("WEBCS_DOMAIN",f),qt("WEBCS_DOMAIN_BACKUP_LIST",f),qt("GATEWAY_DOMAINS",[d]),n.report&&n.report.hostname&&Array.isArray(n.report.hostname)&&n.report.hostname.length?(Kc(n.report.hostname,"report.hostname"),qt("EVENT_REPORT_DOMAIN",n.report.hostname[0]),qt("EVENT_REPORT_BACKUP_DOMAIN",n.report.hostname[1]||n.report.hostname[0])):(qt("EVENT_REPORT_DOMAIN",h[0]),qt("EVENT_REPORT_BACKUP_DOMAIN",h[1]||h[0]));let g=6443;n.report&&n.report.port&&(r(n.report.port,"report.port"),g=n.report.port),qt("STATS_COLLECTOR_PORT",g),n.report?qt("ENABLE_EVENT_REPORT",!0):qt("ENABLE_EVENT_REPORT",!1);let _="";n.log&&n.log.hostname&&Array.isArray(n.log.hostname)&&n.log.hostname.length?(Kc(n.log.hostname,"log.hostname"),_=n.log.hostname[0]):_=h[0];let E=6444;n.log&&n.log.port&&(r(n.log.port,"log.port"),E=n.log.port),qt("LOG_UPLOAD_SERVER","".concat(_,":").concat(E));let T=[];n.cds&&n.cds.hostname&&Array.isArray(n.cds.hostname)&&n.cds.hostname.length?(Kc(n.cds.hostname,"cds.hostname"),T=n.cds.hostname):T=h;let w=443;n.cds&&n.cds.port&&(r(n.cds.port,"cds.port"),w=n.cds.port),qt("CDS_AP",T.map(A=>"".concat(A,":").concat(w))),n.cds?qt("ENABLE_CONFIG_DISTRIBUTE",!0):qt("ENABLE_CONFIG_DISTRIBUTE",!1),O.info("set local access point v2 success")}setLocalAccessPoints(n,r){if(Kc(n,"serverList"),Xr(r,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Z(B.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const s=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;n=n.map(c=>s.test(c)?"".concat(c.replace(/\./g,"-"),".").concat(r):c),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,qt("WEBCS_DOMAIN",n),qt("WEBCS_DOMAIN_BACKUP_LIST",n),qt("GATEWAY_DOMAINS",[r]),qt("EVENT_REPORT_DOMAIN",n[0]),qt("EVENT_REPORT_BACKUP_DOMAIN",n[1]||n[0]),qt("LOG_UPLOAD_SERVER","".concat(n[0],":6444")),O.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(n){if(mr(n,"streamType",[0,1]),this._remoteDefaultVideoStreamType=n,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(n),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(r){throw O.error("[".concat(this._clientId,"] set default remote video stream type error"),r.toString()),r}else O.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(n))}async setRemoteVideoStreamType(n,r){mr(r,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(n,r),setTimeout(()=>{const s=this._users.find(c=>c.uid===n);s&&s.videoTrack&&s.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(s){throw O.error("[".concat(this._clientId,"] set remote video stream type error"),s.toString()),s}O.info("[".concat(this._clientId,"] set remote ").concat(n," video stream type to ").concat(r)),this._remoteStreamTypeCacheMap.set(n,r)}async setStreamFallbackOption(n,r){mr(r,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(n,r)}catch(s){throw O.error("[".concat(this._clientId,"] set stream fallback option"),s.toString()),s}O.info("[".concat(this._clientId,"] set remote ").concat(n," stream fallback type to ").concat(r)),this._streamFallbackTypeCacheMap.set(n,r)}setEncryptionConfig(n,r,s,c){(function(h){mr(h,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(n),Xr(r,"secret");const d=["aes-128-gcm2","aes-256-gcm2"];if(Le(d).call(d,n)){if(!s||!(s instanceof Uint8Array&&s.length===32))throw new Z(B.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(s)throw new Z(B.INVALID_PARAMS,"current encrypt mode does not need salt");if(c){if($c(c,"encryptDataStream"),!Le(d).call(d,n))throw new Z(B.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(r)||O.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=n,this._encryptionSecret=r,s&&(this._encryptionSalt=Cp(s))}async renewToken(n){if(Xr(n,"token",1,2047),!this._key||!this._joinInfo)throw new Z(B.INVALID_OPERATION,"renewToken should not be called before user join");const r=this._key;this._key=n,this._joinInfo&&(this._joinInfo.token=n);const s=await this._renewTokenMutex.lock();try{if(Y("USE_NEW_TOKEN")){O.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const c=await Zie(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||ir);O.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:n,ticket:c})}else O.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:n});O.debug("[".concat(this._clientId,"] renewToken success"))}catch(c){throw this._key=r,this._joinInfo.token=r,O.error("[".concat(this._clientId,"] renewToken failed"),c.toString()),c}finally{s()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?O.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const n=this._p2pChannel.getAudioLevels();this.safeEmit(Et.VOLUME_INDICATOR,n)},Y("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const n=this._statsCollector.getRTCStats(),r=this._gateway.getInChannelInfo();return n.Duration=Math.round(r.duration/1e3),n}async startLiveStreaming(n,r){if(!r){if(this.codec!=="h264")throw new Z(B.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new Z(B.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(n)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(n))throw new Z(B.LIVE_STREAMING_TASK_CONFLICT);const s=r?_r.TRANSCODE:_r.RAW;return this._createLiveStreamingClient(s).startLiveStreamingTask(n,s)}setLiveTranscoding(n){return this._createLiveStreamingClient(_r.TRANSCODE).setTranscodingConfig(n)}async stopLiveStreaming(n){const r=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(s=>s&&s.hasUrl(n));if(!r.length)throw new Z(B.INVALID_PARAMS,"can not find live streaming url to stop");await ae.all(r.map(s=>s&&s.stopLiveStreamingTask(n)))}async addInjectStreamUrl(n,r){if(!this._joinInfo)throw new Z(B.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const s=this._createLiveStreamingClient(_r.INJECT);s.setInjectStreamConfig(r,0),await s.startLiveStreamingTask(n,_r.INJECT)}async removeInjectStreamUrl(){var n;const r=this._createLiveStreamingClient(_r.INJECT),s=Array.from(Ia(n=r.streamingTasks).call(n)).find(c=>c.mode===_r.INJECT);if(!this._joinInfo||!s)throw new Z(B.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await r.stopLiveStreamingTask(s.url)}async startChannelMediaRelay(n){a4(n),await this._createChannelMediaRelayClient().startChannelMediaRelay(n)}async updateChannelMediaRelay(n){a4(n),await this._createChannelMediaRelayClient().updateChannelMediaRelay(n)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}async sendStreamMessage(n){var r;let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new Z(B.INVALID_OPERATION,"can not send data stream, not joined");if((typeof n=="string"||n instanceof Uint8Array)&&(n={payload:n}),typeof n.payload=="string"){const d=new TextEncoder;n.payload=d.encode(n.payload)}let c=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Le(r=["aes-128-gcm2","aes-256-gcm2"]).call(r,this._encryptionMode)&&(c=!0,n.payload=await async function(d,h,f){var g;const _=qc(g=Array.from(f)).call(g,(D,G)=>D+G,0),E={serverTs:0,seq:lie++,length:f.length,checkSum:_},T=new Uint8Array(Oj(_,2)),w=new ArrayBuffer(Ap),A=new DataView(w);A.setUint32(0,E.serverTs),A.setUint16(4,E.seq),A.setUint16(6,E.length),A.setUint16(8,E.checkSum);const L=16-f.length%16;f=Cj(f,new Uint8Array(L));const P=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:d,tagLength:pF,additionalData:T},h,f);return Cj(new Uint8Array(w),new Uint8Array(P))}(this._encryptDataStreamIv,this._encryptDataStreamKey,n.payload)),new Blob([n.payload]).size>1024)throw new Z(B.INVALID_PARAMS,c?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(We.DATA_STREAM,{payload:Cp(n.payload),syncWithAudio:n.syncWithAudio,sendTs:Date.now()-qce},!s)}sendMetadata(n){if(!this._joinInfo)throw new Z(B.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([n]).size>1024)throw new Z(B.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(We.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Cp(n)})}async sendCustomReportMessage(n){if(Array.isArray(n)||(n=[n]),n.forEach(uie),!this._joinInfo)throw new Z(B.INVALID_OPERATION,"can not send custom report, not joined");await Be.sendCustomReportMessage(this._joinInfo.sid,n)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(n,r){mr(r.spatialLayer,"spatialLayer",[0,1,2,3]),mr(r.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(n,r)}catch(s){throw O.error("[".concat(this._clientId,"] pick SVC layer failed"),s.toString()),s}}async setRTMConfig(n){const{apRTM:r=!1,rtmFlag:s}=n;if($c(r,"apRTM"),Yt(s,"rtmFlag",0),this._rtmConfig.apRTM=r,this._rtmConfig.rtmFlag=s,O.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(n)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=r,this._joinInfo.rtmFlag=s,this._gateway.setRTM2Flag(s)}_reset(){if(O.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=Qi.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(n=>{n._audioTrack&&n._audioTrack._destroy(),n._videoTrack&&n._videoTrack._destroy(),n._dataChannels&&(n._dataChannels.forEach(r=>r._close()),n._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Pr("client-publish"),this._subscribeMutex=new Pr("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(n,r){var s;const c=n||rI();n?O.debug("[".concat(this._clientId,"] new Session ").concat(c)):O.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(c));const d=n?"":this._sessionId||"";this._sessionId=c,this.store.sessionId=c;const h={lts:new Date().getTime(),mode:this.mode,stringUid:(r==null?void 0:r.stringUid)||((s=this._joinInfo)===null||s===void 0?void 0:s.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:d,clientRole:this.role==="audience"?2:1};r?Be.sessionInit(this._sessionId,La({cname:r.channel,appid:r.appId},h)):this._joinInfo?Be.sessionInit(this._sessionId,La({cname:this._joinInfo.cname,appid:this._joinInfo.appId},h)):this._gateway.joinInfo&&Be.sessionInit(this._sessionId,La({cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId},h)),this._joinInfo&&(this._joinInfo.sid=c),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=c)}async _publishHighStream(n){if(!this._joinInfo||this._uid===void 0)throw new Z(B.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&Y("FORCE_TURN")&&!Y("TURN_ENABLE_TCP")&&!Y("TURN_ENABLE_UDP"))throw new Z(B.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");O.debug("[".concat(this._clientId,"] publish high stream"));try{const s=await this._p2pChannel.publish(n,this._isDualStreamEnabled,this._lowStreamParameter);if(this._p2pChannel instanceof Er){const c=(await s.next()).value;if(c){try{await this._gateway.sendExtensionMessage(An.PUBLISH,c,!0)}catch(d){throw s.throw(d),d}await s.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const c=(await s.next()).value;if(c){var r;let d;try{d=await this._gateway.publish(this._uid,c,!0)}catch(h){if(h.code!==B.DISCONNECT_P2P)throw s.throw(h),h}await s.next(((r=d)===null||r===void 0?void 0:r.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const d of n)d instanceof ht&&d._encoderConfig&&this._gateway.setVideoProfile(d._encoderConfig),!d.muted&&d.enabled||await this._p2pChannel.muteLocalTrack(d)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,n),(s==null?void 0:s.code)===B.WS_ABORT)return;throw s}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new Z(B.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Z(B.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));O.debug("[".concat(this._clientId,"] publish low stream"));const n=this._configDistribute.getLowStreamConfigDistribute();n&&n.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&n.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=n.bitrate));try{const s=await this._p2pChannel.publishLowStream(this._lowStreamParameter),c=(await s.next()).value;if(c){var r;let d;try{d=await this._gateway.publish(this._uid,c,!0)}catch(h){if(h.code!==B.DISCONNECT_P2P)throw s.throw(h),h}s.next(((r=d)===null||r===void 0?void 0:r.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,void 0,!0),(s==null?void 0:s.code)===B.WS_ABORT)return;throw s}}_createLiveStreamingClient(n){if(!this._joinInfo||!this._appId)return new Z(B.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const r=()=>new Rce(this._joinInfo,this._config.websocketRetryConfig||ir,this._config.httpRetryConfig||ir),s=c=>{c.onLiveStreamError=(d,h)=>{Be.reportApiInvoke(this._sessionId,{name:tr.ON_LIVE_STREAM_ERROR,options:[d,h],tag:yn.TRACER}).onSuccess(),this.safeEmit(Et.LIVE_STREAMING_ERROR,d,h)},c.onLiveStreamWarning=(d,h)=>{Be.reportApiInvoke(this._sessionId,{name:tr.ON_LIVE_STREAM_WARNING,options:[d,h],tag:yn.TRACER}).onSuccess(),this.safeEmit(Et.LIVE_STREAMING_WARNING,d,h)},c.on(Np.REQUEST_WORKER_MANAGER_LIST,(d,h,f)=>{if(!this._joinInfo)return f(new Z(B.INVALID_OPERATION,"can not find join info to get worker manager"));oV(d,this._joinInfo,this._axiosCancelSource.token,ir).then(h).catch(f)})};switch(n){case _r.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=r(),s(this._liveRawStreamingClient)),this._liveRawStreamingClient;case _r.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=r(),s(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case _r.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=r(),this._injectStreamingClient.on(Np.REQUEST_WORKER_MANAGER_LIST,(c,d,h)=>{if(!this._joinInfo)return h(new Z(B.INVALID_OPERATION,"can not find join info to get worker manager"));oV(c,this._joinInfo,this._axiosCancelSource.token,ir).then(d).catch(h)}),this._injectStreamingClient.onInjectStatusChange=(c,d,h)=>{this.safeEmit(Et.INJECT_STREAM_STATUS,c,d,h)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){if(!this._joinInfo)return new Z(B.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:n,sendResolutionHeight:r}=this.getLocalVideoStats(),s={width:n,height:r};this._channelMediaRelayClient=new Ace(this._joinInfo,this._clientId,this._config.websocketRetryConfig||ir,this._config.httpRetryConfig||ir,s),this._channelMediaRelayClient.on("state",c=>{c===ki.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.safeEmit(Et.CHANNEL_MEDIA_RELAY_STATE,c)}),this._channelMediaRelayClient.on("event",c=>{this.safeEmit(Et.CHANNEL_MEDIA_RELAY_EVENT,c)}),this._statsCollector.onStatsChanged=(c,d)=>{var h;c==="resolution"&&((h=this._channelMediaRelayClient)===null||h===void 0||h.setVideoProfile(d))}}return this._channelMediaRelayClient}_handleUpdateDataChannel(n,r){const{added:s,deleted:c}=n,d=[];Array.isArray(s)&&s.length>0&&s.forEach(h=>{const{uid:f,stream_id:g,ordered:_,max_retrans_times:E,metadata:T}=h,w=this._users.find(A=>A._uintid===f);if(!w)return void O.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(O.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(f)),Le(d).call(d,w)||d.push(w),w._uintid||(w._uintid=f),w._dataChannels.findIndex(A=>A.id===h.stream_id)===-1){const A={id:g,ordered:!!_,maxRetransmits:E,metadata:T},L=new Ese(A);w._dataChannels.push(L),O.info("[".concat(this._clientId,"] remote user ").concat(w.uid," published datachannel")),r||this.safeEmit(Et.USER_PUBLISHED,w,"datachannel",A)}this._p2pChannel.hasPendingRemoteDataChannel(w,h.stream_id)&&(O.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(w.uid," after reconnect.")),this._subscribeDataChannel(w,h.stream_id).catch(A=>{O.error("[".concat(this._clientId,"] resubscribe datachannel error"),A.toString())}))}),r&&(this.safeEmit(Et.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(c)&&c.length>0&&c.forEach(h=>{const{uid:f,stream_id:g}=h,_=this._users.find(T=>T._uintid===f);if(!_)return void O.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const E=_._dataChannels.find(T=>T.id===h.stream_id);E&&(O.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(f)),this._p2pChannel.unsubscribeDataChannel(_,[E]).then(T=>{if(_._dataChannels=_._dataChannels.filter(w=>w!==E),T)return this._gateway.unsubscribeDataChannel(T,_.uid)}),O.info("[".concat(this._clientId,"] remote user ").concat(f," unpublished datachannel ,id:").concat(E.id)),this.safeEmit(Et.USER_UNPUBLISHED,_,"datachannel",E._config))})}_handleRemoveDataChannels(n){const r=this._users.find(s=>s.uid===n.uid);if(r){if(r._dataChannels!==void 0&&r._dataChannels.length>0){O.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(n.uid));const s=()=>{O.info("[".concat(this._clientId,"] remote user ").concat(r.uid," unpublished datachannel")),r._dataChannels.forEach(c=>{this.safeEmit(Et.USER_UNPUBLISHED,r,"datachannel",c._config)})};this._p2pChannel.unsubscribeDataChannel(r,r._dataChannels).then(c=>{if(c)return this._gateway.unsubscribeDataChannel(c,r.uid)}),s()}}else O.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(In.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(In.CONNECTION_STATE_CHANGE,(n,r,s)=>{var c;if(s===vt.FALLBACK)return;const d=()=>{this.safeEmit(Et.CONNECTION_STATE_CHANGE,n,r,s)};if(Be.reportApiInvoke(this._sessionId||((c=this._gateway.joinInfo)===null||c===void 0?void 0:c.sid)||null,{name:tr.CONNECTION_STATE_CHANGE,options:[n,r,s],tag:yn.TRACER}).onSuccess(JSON.stringify({cur:n,prev:r,reason:s})),O.info("[".concat(this._clientId,"] connection state change: ").concat(r," -> ").concat(n)),n==="DISCONNECTED")return this._reset(),void d();if(n==="RECONNECTING")this._users.forEach(f=>{f._trust_in_room_=!1,f._trust_audio_enabled_state_=!1,f._trust_video_enabled_state_=!1,f._trust_audio_mute_state_=!1,f._trust_video_mute_state_=!1,f._trust_audio_stream_added_state_=!1,f._trust_video_stream_added_state_=!1,f._is_pre_created||(f._audio_pre_subscribed||(f._audioSSRC=void 0,f._audioOrtc=void 0),f._video_pre_subscribed||(f._videoSSRC=void 0,f._videoOrtc=void 0,f._rtxSsrcId=void 0),f._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(n==="CONNECTED"){var h;this._streamFallbackTypeCacheMap.forEach((f,g)=>{this._gateway.setStreamFallbackOption(g,f).catch(_=>{O.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),_)})}),this._remoteStreamTypeCacheMap.forEach((f,g)=>{this._gateway.setRemoteVideoStreamType(g,f).catch(_=>{O.warning("[".concat(this._clientId,"] auto set remote stream type failed"),_)})}),this._remoteDefaultVideoStreamType!==void 0&&((h=this._joinInfo)===null||h===void 0?void 0:h.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{O.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(f=>{O.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(f))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(f=>!f._trust_in_room_).forEach(f=>{O.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(f.uid)),this._handleUserOffline({uid:f.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(f=>{f._trust_audio_mute_state_||(O.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(f.uid)),this._handleMuteStream(f.uid,Fe.AUDIO,!1)),f._trust_video_mute_state_||(O.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(f.uid)),this._handleMuteStream(f.uid,Fe.VIDEO,!1)),f._trust_audio_enabled_state_||(O.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(f.uid)),this._handleSetStreamLocalEnable("audio",f.uid,!0)),f._trust_video_enabled_state_||(O.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(f.uid)),this._handleSetStreamLocalEnable("video",f.uid,!0)),f._trust_video_stream_added_state_||(O.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(f.uid)),this._handleResetAddStream(f,"video")),f._trust_audio_stream_added_state_||(O.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(f.uid)),this._handleResetAddStream(f,"audio")),f._video_added_||f._audio_added_||(O.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(f.uid)),this._handleRemoveStream({uid:f.uid,uint_id:f._uintid}))}))},1e3))}d()}),this._gateway.on(In.REQUEST_NEW_GATEWAY_LIST,(n,r)=>{if(!this._joinInfo)return r(new Z(B.UNEXPECTED_ERROR,"can not recover, no join info"));YI(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||ir,this.store).then(s=>{this._joinInfo&&(this._joinInfo.apResponse=s.gatewayInfo.res,this._joinInfo.gatewayAddrs=s.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=s.gatewayInfo.uni_lbs_ip);const c=[];s.gatewayInfo.gatewayAddrs.forEach(d=>{let{address:h}=d;const[f,g]=h.split(":");this._joinInfo&&this._joinInfo.proxyServer?c.push({proxy:this._joinInfo.proxyServer,host:f,port:g}):c.push({host:f,port:g})}),n(c)}).catch(r)}),this._gateway.on(In.NETWORK_QUALITY,n=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Et.NETWORK_QUALITY,n)}),this._gateway.on(In.STREAM_TYPE_CHANGE,(n,r)=>{this.safeEmit(Et.STREAM_TYPE_CHANGED,n,r),Be.reportApiInvoke(this._sessionId,{name:tr.STREAM_TYPE_CHANGE,options:[n,r],tag:yn.TRACER}).onSuccess(JSON.stringify({uid:n,streamType:r}))}),this._gateway.on(In.IS_P2P_DISCONNECTED,n=>{this._p2pChannel.isP2PDisconnected()?n(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?n(!1):n(!0)}),this._gateway.on(In.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(In.REQUEST_P2P_CONNECTION_PARAMS,async(n,r,s)=>{try{r(await this._p2pChannel.startP2PConnection(n))}catch(c){s(c)}}),this._gateway.on(In.JOIN_RESPONSE,(n,r)=>{if(this.store.useP2P)return;const{dtlsParameters:s,iceParameters:c,candidates:d,rtpCapabilities:h,setup:f,cname:g}=J3(n.ortc,r);this._p2pChannel.connect(c,s,d,h,f,g)}),this._gateway.on(In.REQUEST_DC_CONNECTION_PARAMS,n=>{n(this._p2pChannel.getEstablishParams())}),this._gateway.on(In.RESET_SIGNAL,n=>{this._p2pChannel.resetConnection(n),this._handleGatewaySignalEvents()}),this._gateway.on(In.DATACHANNEL_FAILBACK,()=>{this._joinGateway()}),this._gateway.on(In.DATACHANNEL_PRECONNECT,async(n,r,s,c)=>{var d,h,f,g,_,E;await this._p2pChannel.startP2PConnection({turnServer:(d=this._joinInfo)===null||d===void 0?void 0:d.turnServer},!0);const T=function(w,A){let L;return A&&A.ip&&typeof A.port=="number"?(L=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:A.ip,port:A.port.toString(),type:"host",extension:{}}],O.debug("Using remote candidate from AP ".concat(A.ip,":").concat(A.port)),A.ip6&&(L.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:A.ip6,port:A.port.toString(),type:"host",extension:{}}),O.debug("Using IPV6 remote candidate from AP ".concat(A.ip6,":").concat(A.port)))):L=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:w.ip,port:w.port.toString(),type:"host",extension:{}}],L}(n,r);return this._p2pChannel.preConnect({iceUfrag:"".concat((h=this._joinInfo)===null||h===void 0?void 0:h.apResponse.cid,"_").concat((f=this._joinInfo)===null||f===void 0?void 0:f.apResponse.cert),icePwd:"".concat((g=this._joinInfo)===null||g===void 0?void 0:g.apResponse.cid,"_").concat((_=this._joinInfo)===null||_===void 0?void 0:_.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:(E=Y("FINGERPRINT"))!==null&&E!==void 0?E:n.fingerprint}]},T,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(s).catch(c)})}_handleGatewaySignalEvents(){this._gateway.signal.on(nt.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(nt.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(nt.ON_ADD_AUDIO_STREAM,n=>this._handleAddAudioOrVideoStream("audio",n.uid,n.ssrcId,n.cname,n.uint_id,n.ortc)),this._gateway.signal.on(nt.ON_ADD_VIDEO_STREAM,n=>this._handleAddAudioOrVideoStream("video",n.uid,n.ssrcId,n.cname,n.uint_id,n.ortc,n.rtxSsrcId)),this._gateway.signal.on(nt.ON_REMOTE_DATASTREAM_UPDATE,n=>{this._handleUpdateDataChannel(n)}),this._gateway.signal.on(nt.ON_REMOTE_FULL_DATASTREAM_INFO,n=>{this._handleUpdateDataChannel({added:n.datastreams,deleted:[]},!0)}),this._gateway.signal.on(nt.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(nt.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(nt.MUTE_AUDIO,n=>this._handleMuteStream(n.uid,Fe.AUDIO,!0)),this._gateway.signal.on(nt.UNMUTE_AUDIO,n=>this._handleMuteStream(n.uid,Fe.AUDIO,!1)),this._gateway.signal.on(nt.MUTE_VIDEO,n=>this._handleMuteStream(n.uid,Fe.VIDEO,!0)),this._gateway.signal.on(nt.UNMUTE_VIDEO,n=>this._handleMuteStream(n.uid,Fe.VIDEO,!1)),this._gateway.signal.on(nt.RECEIVE_METADATA,n=>{const r=yg(n.metadata);this.safeEmit(Et.RECEIVE_METADATA,n.uid,r)}),this._gateway.signal.on(nt.ON_DATA_STREAM,async n=>{var r;if(!n)return;let s=yg(n.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Le(r=["aes-128-gcm2","aes-256-gcm2"]).call(r,this._encryptionMode)){if(n.payload.length<Ap)throw new Z(B.UNEXPECTED_RESPONSE,"payload length ".concat(n.payload.length," is less than header length ").concat(Ap));s=await async function(h,f,g){const _=g.subarray(0,Ap),E=_.slice(8,Ap),T=(E[0]<<8)+E[1],w=(_[6]<<8)+_[7],A=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:h,tagLength:pF,additionalData:new Uint8Array(Oj(T,2))},f,g.subarray(Ap));return new Uint8Array(A).subarray(0,w)}(this._encryptDataStreamIv,this._encryptDataStreamKey,s)}let c=0;if(n.ordered||n.syncWithAudio){const d=this._p2pChannel.getStats(),h=this.remoteUsers.find(g=>g.uid===n.uid),f=d==null?void 0:d.audioRecv.find(g=>g.ssrc===(h==null?void 0:h._audioSSRC));c=f==null?void 0:f.jitterBufferMs}c==null&&(c=0),Xce(La(La({},n),{},{payload:s}),c,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(nt.ON_CRYPT_ERROR,()=>{bp(()=>{O.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Et.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(nt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(nt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{O.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,vt.TOKEN_EXPIRE),this.safeEmit(Et.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(nt.ON_STREAM_FALLBACK_UPDATE,n=>{O.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(n.stream_id,", attr: ").concat(n.stream_type)),this.safeEmit(Et.STREAM_FALLBACK,n.stream_id,n.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(nt.ON_PUBLISH_STREAM,n=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:n.proxy})),O.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(n))))}),this._gateway.signal.on(nt.ENABLE_LOCAL_VIDEO,n=>{this._handleSetStreamLocalEnable("video",n.uid,!0)}),this._gateway.signal.on(nt.DISABLE_LOCAL_VIDEO,n=>{this._handleSetStreamLocalEnable("video",n.uid,!1)}),this._gateway.signal.on(De.REQUEST_TIMEOUT,(n,r)=>{if(this._joinInfo)switch(n){case We.PUBLISH:{if(!r)return;const d=r.ortc;if(d){var s,c;const h=d.some(_=>{let{stream_type:E}=_;return E===jt.Audio}),f=d.some(_=>{let{stream_type:E}=_;return E!==jt.Audio}),g=d.some(_=>{let{stream_type:E}=_;return E===jt.Screen||E===jt.ScreenLow});r.state==="offer"&&Be.publish(this._joinInfo.sid,{eventElapse:ei.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:B.TIMEOUT,audio:h,video:f,p2pid:r.p2p_id,publishRequestid:this.store.pubId,screenshare:g,audioName:h?(s=d.find(_=>{let{stream_type:E}=_;return E===jt.Audio}))===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId.toString():void 0,videoName:f?(c=d.find(_=>{let{stream_type:E}=_;return E!==jt.Audio}))===null||c===void 0||(c=c.ssrcs[0])===null||c===void 0?void 0:c.ssrcId.toString():void 0})}break}case We.SUBSCRIBE:r&&Be.subscribe(this._joinInfo.sid,{succ:!1,ec:B.TIMEOUT,audio:r.stream_type===Fe.AUDIO,video:r.stream_type===Fe.VIDEO,peerid:r.stream_id,subscribeRequestid:r.ssrcId,p2pid:this.store.p2pId,eventElapse:ei.measureFromSubscribeStart(this.store.clientId,r.ssrcId)})}}),this._gateway.signal.on(nt.ON_P2P_OK,n=>{this.uid,this._uid}),this._gateway.signal.on(nt.ON_PUBLISHED_USER_LIST,n=>{if(n==null||!n.users)return;Y("BLOCK_LOCAL_CLIENT")&&(n.users=n.users.filter(c=>!Du(c.string_id||c.stream_id,this.channelName)));const r=[],s=[];for(const c of n.users){let d=this._users.find(T=>T._uintid===c.stream_id);d?d._trust_in_room_=!0:(d=new Br(c.string_id||c.stream_id,c.stream_id),this._users.push(d),this.getListeners(Et.PUBLISHED_USER_LIST).length===0&&(O.debug("[".concat(this._clientId,"] user online"),c.stream_id),this.safeEmit(Et.USER_JOINED,d)));const h=cr.Audio&c.stream_type,f=(cr.Video|cr.LwoVideo)&c.stream_type,g=(65280&c.stream_type)!=0,_=h&&d.hasAudio,E=f&&d.hasVideo;f&&(d._trust_video_stream_added_state_=!0,d._video_added_=!0,d._videoSSRC=c.video_ssrc,d._rtxSsrcId=c.video_rtx),h&&(d._trust_audio_stream_added_state_=!0,d._audio_added_=!0,d._audioSSRC=c.audio_ssrc),h&&!_&&this.getListeners(Et.PUBLISHED_USER_LIST).length===0&&(O.info("[".concat(this._clientId,"] remote user ").concat(d.uid," published audio")),this.safeEmit(Et.USER_PUBLISHED,d,"audio")),f&&!E&&this.getListeners(Et.PUBLISHED_USER_LIST).length===0&&(O.info("[".concat(this._clientId,"] remote user ").concat(d.uid," published video")),this.safeEmit(Et.USER_PUBLISHED,d,"video")),(h&&!_||f&&!E||g)&&r.push(d),f&&this._p2pChannel.hasPendingRemoteMedia(d,"video")&&s.push({user:d,mediaType:"video"}),h&&this._p2pChannel.hasPendingRemoteMedia(d,"audio")&&s.push({user:d,mediaType:"audio"})}s.length>0&&(O.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(s.map(c=>"user: ".concat(c.user.uid,", mediaType: ").concat(c.mediaType)).join("; ")," ")),this.massSubscribe(s).catch(c=>{O.error("[".concat(this._clientId,"] mass resubscribe error"),c.toString())})),this.getListeners(Et.PUBLISHED_USER_LIST).length>0?Y("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=r:(O.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(r.map(c=>c.uid).join(", "))),this.safeEmit(Et.PUBLISHED_USER_LIST,r)):O.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(r.map(c=>c.uid).join(", ")))}),this._gateway.signal.on(nt.ON_RTP_CAPABILITY_CHANGE,n=>{const{video_codec:r}=n;this._p2pChannel instanceof Lr&&this._p2pChannel.updateRemoteRTPCapabilities(r.map(s=>s.toLowerCase()).filter(s=>{var c;return Le(c=Object.keys(nd)).call(c,s)}))})}_handleP2PEvents(){this._gateway.signal.on(nt.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(An.PUBLISH,(n,r,s)=>{const{uid:c}=n;n.forEach(d=>{const{kind:h,ssrcs:f,mid:g,isMuted:_}=d;this._handleP2PAddAudioOrVideoStream(h,c,f[0].ssrcId,g);const E=this._users.find(T=>T.uid===c);return E&&this._p2pChannel instanceof Er?this._p2pChannel.mockSubscribe(E,h,f[0].ssrcId,g).then(()=>{r()}).catch(s):r(),this._handleMuteStream(c,h,!!_)})}),this._gateway.signal.on(An.CALL,async(n,r,s)=>{if(this._p2pChannel instanceof Er)try{var c;r(await this._p2pChannel.startP2P({turnServer:(c=this._joinInfo)===null||c===void 0?void 0:c.turnServer},n))}catch(d){s(d)}}),this._gateway.signal.on(De.P2P_CONNECTION,async n=>{this._p2pChannel instanceof Er&&await this._p2pChannel.p2pConnect(n)}),this._gateway.signal.on(An.UNPUBLISH,async(n,r,s)=>{if(this._p2pChannel instanceof Er){const{unpubMsg:c,uid:d}=n,h=this._users.find(f=>f.uid===d);if(!h)return O.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(d)),void r();try{c.forEach(async f=>{let{stream_type:g}=f;const _=g===jt.Audio?Fe.AUDIO:Fe.VIDEO;await this._p2pChannel.unsubscribe(h,_),this._handleMuteStream(d,_,!0)}),r()}catch(f){s(f)}}}),this._gateway.signal.on(An.CONTROL,async(n,r)=>{const{action:s}=n;switch(s){case rc.MUTE_LOCAL_VIDEO:this._handleMuteStream(r,Fe.VIDEO,!0);break;case rc.MUTE_LOCAL_AUDIO:this._handleMuteStream(r,Fe.AUDIO,!0);break;case rc.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",r),this._handleMuteStream(r,Fe.VIDEO,!1);break;case rc.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",r),this._handleMuteStream(r,Fe.AUDIO,!1)}}),this._gateway.signal.on(An.RESTART_ICE,async(n,r,s)=>{if(this._p2pChannel instanceof Er)try{const{direction:c,iceParameter:d}=n;c!==ui.SEND_ONLY||d?r(await this._p2pChannel.restartICE(c,d)):(this._p2pChannel.handleDisconnect(c),r())}catch(c){s(c)}}),this._gateway.signal.on(An.CANDIDATE,n=>{if(this._p2pChannel instanceof Er){const{candidate:r,direction:s}=n;this._p2pChannel.addRemoteCandidate(r,s)}}),this._p2pChannel.on(Xe.RequestP2PRestartICE,async(n,r,s)=>{try{const{direction:c}=n;r(await this._gateway.sendExtensionMessage(An.RESTART_ICE,n,c===ui.SEND_ONLY))}catch(c){s(c)}}),this._p2pChannel.on(Xe.LocalCandidate,n=>{this._gateway.sendExtensionMessage(An.CANDIDATE,JSON.stringify(n),!0)}),this._p2pChannel.on(Xe.RequestP2PMuteLocal,async(n,r,s)=>{try{await this._gateway.sendExtensionMessage(An.CONTROL,n,!0),r()}catch(c){s(c)}}),this._p2pChannel.on(Xe.RequestP2PUnmuteRemote,async(n,r,s)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(n,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(c){c.code===B.DISCONNECT_P2P?r():s(c)}else r()}),this._p2pChannel.on(Xe.RequestP2PMuteRemote,async(n,r,s)=>{if(this._joinInfo)try{await this._gateway.muteRemote(n,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(c){c.code===B.DISCONNECT_P2P?r():s(c)}else r()}),this._p2pChannel.on(Xe.StateChange,(n,r)=>{r===Vt.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(Xe.RequestMuteLocal,async(n,r,s)=>{if(this._joinInfo)try{await this._gateway.muteLocal(n,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(c){c.code===B.DISCONNECT_P2P?r():s(c)}else r()}),this._p2pChannel.on(Xe.RequestUnmuteLocal,async(n,r,s)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(n,this._joinInfo.stringUid||this._joinInfo.uid),r()}catch(c){c.code===B.DISCONNECT_P2P?r():s(c)}else r()}),this._p2pChannel.on(Xe.RequestRePublish,(n,r,s)=>{this.publish(n,!1).then(r).catch(s)}),this._p2pChannel.on(Xe.RequestRePublishDataChannel,(n,r,s)=>{ae.all(n.map(async c=>{await this._p2pChannel.publishDataChannel([c]);const d={streamId:c.id,ordered:c.ordered,maxRetransmits:c.maxRetransmits,metadata:c.metadata,channelId:c._originDataChannelId};try{await this._gateway.publishDataChannel(this._uid,d,!0)}catch(h){if(h.code!==B.DISCONNECT_P2P)throw h}})).then(r).catch(s)}),this._p2pChannel.on(Xe.RequestReSubscribe,async(n,r,s)=>{try{for(const{user:c,kind:d}of n)d===Fe.VIDEO?await this.subscribe(c,"video"):await this.subscribe(c,"audio");r()}catch(c){s(c)}}),this._p2pChannel.on(Xe.RequestUpload,(n,r)=>{this._gateway.upload(n,r)}),this._p2pChannel.on(Xe.RequestUploadStats,n=>{this._gateway.uploadWRTCStats(n)}),this._p2pChannel.on(Xe.MediaReconnectStart,n=>{this.safeEmit(Et.MEDIA_RECONNECT_START,n)}),this._p2pChannel.on(Xe.MediaReconnectEnd,n=>{this.safeEmit(Et.MEDIA_RECONNECT_END,n)}),this._p2pChannel.on(Xe.NeedSignalRTT,n=>{n(this._gateway.getSignalRTT())}),this._p2pChannel.on(Xe.RequestRestartICE,async n=>{if(this._p2pChannel instanceof Er)return;const r=await this._p2pChannel.restartICE(n),s=await r.next();if(s.done)return;const c=s.value;let d;try{d=await this._gateway.restartICE({iceParameters:c})}catch(f){return void r.throw(f)}const{iceParameters:h}=function(f){const g=f.iceParameters;return{iceParameters:{iceUfrag:g.iceUfrag,icePwd:g.icePwd}}}(d);await r.next({remoteIceParameters:h})}),this._p2pChannel.on(Xe.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Xe.RequestReconnectPC,async()=>{var n;const{iceParameters:r,dtlsParameters:s,rtpCapabilities:c}=await this._p2pChannel.startP2PConnection({turnServer:(n=this._joinInfo)===null||n===void 0?void 0:n.turnServer}),{gatewayEstablishParams:d,gatewayAddress:h}=await this._gateway.reconnectPC({iceParameters:r,dtlsParameters:s,rtpCapabilities:c}),{dtlsParameters:f,iceParameters:g,candidates:_,rtpCapabilities:E,setup:T,cname:w}=J3(d,h);await this._p2pChannel.connect(g,f,_,E,T,w),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Xe.RequestUnpublishForReconnectPC,async(n,r,s)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(n,this._uid),r()):s()}),this._p2pChannel.on(Xe.P2PLost,()=>{this.safeEmit(Et.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Xe.UpdateVideoEncoder,n=>{n._encoderConfig&&this._gateway.setVideoProfile(n._encoderConfig)}),this._p2pChannel.on(Xe.ConnectionTypeChange,n=>{this.safeEmit(Et.IS_USING_CLOUD_PROXY,n)}),this._p2pChannel.on(Xe.RequestLowStreamParameter,n=>{n(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Xe.QueryClientConnectionState,n=>{n(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(n){if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new Z(B.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new Z(B.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!n)throw new Z(B.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!n.inspectType||!Array.isArray(n.inspectType))throw new Z(B.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const r=[...new Set(n.inspectType)];r.forEach(s=>{var c;if(!Le(c=["supervise","moderation"]).call(c,s))throw new Z(B.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(s," is not a valid inspect type."))}),n.inspectType=r}if(n&&n.extraInfo&&n.extraInfo.length>1024)throw new Z(B.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const r=new iS(n);this._inspect=r,this.handleVideoInspectEvents(this._inspect),await r.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},ir)}catch(r){throw Array.isArray(r)?r[0]:r}}async disableContentInspect(){if(!this._inspect)throw new Z(B.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(n){throw Array.isArray(n)?n[0]:n}}async setImageModeration(n,r){if($c(n,"enabled"),n){if(!r)throw new Z(B.INVALID_PARAMS,"[".concat(this._clientId,"] config is necessary"));if(Yt(r.interval,"interval",1e3,1/0),r&&r.extraInfo&&r.extraInfo.length>1024)throw new Z(B.INVALID_PARAMS,"[".concat(this._clientId,"] config.extraInfo length cannot exceed 1024 bytes"));if(r&&r.vendor&&r.vendor.length>1024)throw new Z(B.INVALID_PARAMS,"[".concat(this._clientId,"] config.vendor length cannot exceed 1024 bytes"));if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new Z(B.INVALID_OPERATION,"[".concat(this._clientId,'] can not enable image moderation, not joined"'));try{if(this._moderation)return void this._moderation.updateConfig(r);const s=new D1(r);this._moderation=s,this.handleImageModerationEvents(this._moderation),await s.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},ir)}catch(s){throw Array.isArray(s)?s[0]:s}}else{if(!this._moderation)throw new Z(B.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(s){throw Array.isArray(s)?s[0]:s}}}setP2PTransport(n){if(function(r){mr(r,"transport",["default","auto","relay","sd-rtn"])}(n),this.mode!=="p2p")throw new Z(B.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=n,O.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(n))}handleImageModerationEvents(n){n.on(_s.CONNECTION_STATE_CHANGE,(r,s)=>{if(this.safeEmit(Et.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,r,s),r===So.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new Z(B.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");n.inspectImage()}}),n.on(_s.CLIENT_LOCAL_VIDEO_TRACK,r=>{r(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}handleVideoInspectEvents(n){n.on(vr.CONNECTION_STATE_CHANGE,(r,s)=>{if(this.safeEmit(Et.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,r,s),s===Vo.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Et.CONTENT_INSPECT_ERROR,new Z(B.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));n.inspectImage()}}),n.on(vr.INSPECT_RESULT,(r,s)=>{var c;if((s==null?void 0:s.code)===B.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return O.debug("Stop inspect content because that has left channel"),this==null||(c=this._inspect)===null||c===void 0||c.close(),void(this._inspect=void 0);this.safeEmit(Et.CONTENT_INSPECT_RESULT,r,s)}),n.on(vr.CLIENT_LOCAL_VIDEO_TRACK,r=>{r(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}getJoinChannelServiceRecords(){return O.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(n){$c(n,"enabled"),qt("ENABLE_PUBLISH_AUDIO_FILTER",n),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(n)}_handleResetAddStream(n,r){switch(r){case"audio":n._audio_added_=!1,n._trust_audio_stream_added_state_=!0;break;case"video":n._video_added_=!1,n._trust_video_stream_added_state_=!0}}}fe([Je(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Ht.prototype,"leave",null),fe([Je({argsMap:(o,n)=>{if(!Array.isArray(n)){if(!(n instanceof Zr))return[n];n=[n]}return n.map(r=>r?Object(r).toString():"null")}}),j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",ae)],Ht.prototype,"publish",null),fe([Je({argsMap:(o,n)=>(n||(n=[]),n instanceof DB?[n.getChannelId()]:(Array.isArray(n)||(n=[n]),n.map(r=>r.getTrackId())))}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],Ht.prototype,"unpublish",null),fe([Je({argsMap:(o,n,r,s)=>[n.uid,r,s]}),j("design:type",Function),j("design:paramtypes",[Br,String,Number]),j("design:returntype",ae)],Ht.prototype,"subscribe",null),fe([Je({argsMap:(o,n,r)=>[n,r]}),j("design:type",Function),j("design:paramtypes",[Object,String]),j("design:returntype",ae)],Ht.prototype,"presubscribe",null),fe([Je({argsMap:(o,n)=>n.map(r=>{let{user:s,mediaType:c}=r;return[s==null?void 0:s.uid,c]})}),j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],Ht.prototype,"massSubscribe",null),fe([Je({argsMap:(o,n,r,s)=>[n.uid,r,s]}),j("design:type",Function),j("design:paramtypes",[Br,String,Number]),j("design:returntype",ae)],Ht.prototype,"unsubscribe",null),fe([Je({argsMap:(o,n)=>n.map(r=>{let{user:s,mediaType:c}=r;return{uid:s==null?void 0:s.uid,mediaType:c}})}),j("design:type",Function),j("design:paramtypes",[Array]),j("design:returntype",ae)],Ht.prototype,"massUnsubscribe",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],Ht.prototype,"setLowStreamParameter",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Ht.prototype,"enableDualStream",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Ht.prototype,"disableDualStream",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[String,Object]),j("design:returntype",ae)],Ht.prototype,"setClientRole",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[String,Boolean]),j("design:returntype",void 0)],Ht.prototype,"setProxyServer",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Object,Boolean]),j("design:returntype",void 0)],Ht.prototype,"setTurnServer",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",void 0)],Ht.prototype,"setLicense",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",void 0)],Ht.prototype,"startProxyServer",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ht.prototype,"stopProxyServer",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",void 0)],Ht.prototype,"setLocalAccessPointsV2",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Array,String]),j("design:returntype",void 0)],Ht.prototype,"setLocalAccessPoints",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",ae)],Ht.prototype,"setRemoteDefaultVideoStreamType",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Object,Number]),j("design:returntype",ae)],Ht.prototype,"setRemoteVideoStreamType",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Object,Number]),j("design:returntype",ae)],Ht.prototype,"setStreamFallbackOption",null),fe([Je({argsMap:(o,n)=>[n]}),j("design:type",Function),j("design:paramtypes",[String,String,Uint8Array,Boolean]),j("design:returntype",void 0)],Ht.prototype,"setEncryptionConfig",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],Ht.prototype,"renewToken",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",void 0)],Ht.prototype,"enableAudioVolumeIndicator",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[String,Boolean]),j("design:returntype",ae)],Ht.prototype,"startLiveStreaming",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],Ht.prototype,"setLiveTranscoding",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",ae)],Ht.prototype,"stopLiveStreaming",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[String,Object]),j("design:returntype",ae)],Ht.prototype,"addInjectStreamUrl",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Ht.prototype,"removeInjectStreamUrl",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Q0]),j("design:returntype",ae)],Ht.prototype,"startChannelMediaRelay",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Q0]),j("design:returntype",ae)],Ht.prototype,"updateChannelMediaRelay",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Ht.prototype,"stopChannelMediaRelay",null),fe([Je({argsMap:(o,n)=>(Array.isArray(n)||(n=[n]),[JSON.stringify(n)])}),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],Ht.prototype,"sendCustomReportMessage",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Object,Object]),j("design:returntype",ae)],Ht.prototype,"pickSVCLayer",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],Ht.prototype,"setRTMConfig",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",ae)],Ht.prototype,"enableContentInspect",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",ae)],Ht.prototype,"disableContentInspect",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Boolean,Object]),j("design:returntype",ae)],Ht.prototype,"setImageModeration",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[String]),j("design:returntype",void 0)],Ht.prototype,"setP2PTransport",null),fe([Je({reportResult:!0}),j("design:type",Function),j("design:paramtypes",[]),j("design:returntype",Array)],Ht.prototype,"getJoinChannelServiceRecords",null),fe([Je(),j("design:type",Function),j("design:paramtypes",[Boolean]),j("design:returntype",ae)],Ht.prototype,"setPublishAudioFilterEnabled",null);class f_{constructor(n,r){I(this,"id",0),I(this,"element",void 0),I(this,"peerPair",void 0),I(this,"context",void 0),I(this,"audioPlayerElement",void 0),I(this,"audioTrack",void 0),f_.count+=1,this.id=f_.count,this.element=n,this.context=r}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=n=>{const r=document.createElement("audio");r.srcObject=new MediaStream([n.track]),r.play(),this.audioPlayerElement=r}}async switchSdp(){if(!this.peerPair)return;const n=async(s,c)=>{const d=c==="offer"?await s.createOffer():await s.createAnswer();return await s.setLocalDescription(d),s.iceGatheringState==="complete"?s.localDescription:new ae(h=>{s.onicegatheringstatechange=()=>{s.iceGatheringState==="complete"&&h(s.localDescription)}})},r=async(s,c)=>await s.setRemoteDescription(c);try{const s=await n(this.peerPair[0],"offer");await r(this.peerPair[1],s);const c=await n(this.peerPair[1],"answer");await r(this.peerPair[0],c)}catch(s){throw new Z(B.LOCAL_AEC_ERROR,s.toString()).print()}}async getTracksFromMediaElement(n){if(this.audioTrack)return this.audioTrack;let r;try{n instanceof HTMLVideoElement&&(n.captureStream?n.captureStream():n.mozCaptureStream()),r=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(n).connect(r)}catch(c){throw new Z(B.LOCAL_AEC_ERROR,c.toString()).print()}if(!r)throw new Z(B.LOCAL_AEC_ERROR,"no dest node when local aec").print();const s=r.stream.getAudioTracks()[0];return this.audioTrack=s,s}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const n=this.element,r=await this.getTracksFromMediaElement(n);this.peerPair&&this.peerPair[0].addTrack(r),await this.switchSdp()}close(){O.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(n=>{n.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}I(f_,"count",0);const ele=window.AudioContext||window.webkitAudioContext;class $4{constructor(){I(this,"units",[]),I(this,"context",void 0)}processExternalMediaAEC(n){if(!this._doesEnvironmentNeedAEC())return O.debug("the system does not need to process local aec"),-1;this.context||(this.context=new ele);let r=this.units.find(s=>s&&s.getElement()===n);return r||(r=new f_(n,this.context),this.units.push(r)),r.startEchoCancellation(),O.debug("start processing local audio echo cancellation, id is",r.id),r.id}_doesEnvironmentNeedAEC(){return xt().name!==Ft.SAFARI}}fe([Je({report:Be}),j("design:type",Function),j("design:paramtypes",[HTMLAudioElement]),j("design:returntype",Number)],$4.prototype,"processExternalMediaAEC",null);const tle=new $4;function K4(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);n&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(o,c).enumerable})),r.push.apply(r,s)}return r}function Y4(o){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?K4(Object(r),!0).forEach(function(s){I(o,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):K4(Object(r)).forEach(function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(r,s))})}return o}const L1=window||document;function q4(o){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!L1)return;const r=or._cspEventHandlerPointer;if(r&&n)return void console.error(r,n);const s=c=>{if(!(c&&c.blockedURI&&(or.onSecurityPolicyViolation||or.getListeners(Gs.SECURITY_POLICY_VIOLATION).length>0)))return;const d=c.blockedURI;Y("CSP_DETECTED_HOSTNAME_LIST").some(h=>Le(d).call(d,h))&&(or.onSecurityPolicyViolation&&typeof or.onSecurityPolicyViolation=="function"&&or.onSecurityPolicyViolation(c),or.getListeners(Gs.SECURITY_POLICY_VIOLATION).length>0&&or.safeEmit(Gs.SECURITY_POLICY_VIOLATION,c))};r&&L1.removeEventListener("securitypolicyviolation",r),(n||o&&typeof o=="function"||or.getListeners(Gs.SECURITY_POLICY_VIOLATION).length>0)&&L1.addEventListener("securitypolicyviolation",s),or._cspEventHandlerPointer=s}qt("PROCESS_ID","process-".concat(Qt(8,""),"-").concat(Qt(4,""),"-").concat(Qt(4,""),"-").concat(Qt(4,""),"-").concat(Qt(12,""))),function(){let o;try{o=window.localStorage.getItem("websdk_ng_global_parameter")}catch(n){return void O.error("Error loading sdk config",n.message)}if(o)try{const n=JSON.parse(window.atob(o)),r=Date.now();O.debug("Loading global parameters from cache",n),Object.keys(n).forEach(s=>{if(Object.prototype.hasOwnProperty.call(Ci,s)){const{value:c,expires:d}=n[s];if(d&&d<=r)return;td[s]=c,Ci[s]=c}})}catch(n){O.error("Error loading mutableParamsCache: ".concat(o),n.message)}}(),Array.isArray(td.AREAS)&&td.AREAS.length>0&&GI(td.AREAS,!0);const J4=(o,n,r)=>{O.debug("setParameter key:".concat(o,", value:").concat(JSON.stringify(n))),qt(o,n,r)},or=function(o){const n=new mn,r=o,s={getListeners:n.getListeners.bind(n),on:(c,d)=>(function(h,f){h===Gs.SECURITY_POLICY_VIOLATION&&q4(f,!0)}(c,d),n.on.bind(n)(c,d)),addListener:n.addListener.bind(n),once:n.once.bind(n),off:n.off.bind(n),removeAllListeners:n.removeAllListeners.bind(n),emit:n.emit.bind(n),safeEmit:n.safeEmit.bind(n)};return Y4(Y4({},r),s)}({__TRACK_LIST__:xp,VERSION:ms,BUILD:wI,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:J4,getParameter:Y,getSupportedCodec:async function(){let o={audio:[],video:[]};try{let n=new RTCPeerConnection;n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"});const r=(await n.createOffer()).sdp;if(!r)return o;n.close(),n=null,o=function(s){const c={video:[],audio:[]};return s.match(/ VP8/i)&&c.video.push("VP8"),s.match(/ VP9/i)&&c.video.push("VP9"),s.match(/ AV1/i)&&c.video.push("AV1"),s.match(/ H264/i)&&c.video.push("H264"),s.match(/ H265/i)&&c.video.push("H265"),s.match(/ opus/i)&&c.audio.push("OPUS"),s.match(/ PCMU/i)&&c.audio.push("PCMU"),s.match(/ PCMA/i)&&c.audio.push("PCMA"),s.match(/ G722/i)&&c.audio.push("G722"),c}(r)}catch(n){throw new Z(B.CREATE_OFFER_FAILED,n.toString&&n.toString()).print()}return o},checkSystemRequirements:function(){const o=Be.reportApiInvoke(null,{name:tr.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:yn.TRACER});let n=!1;try{const d=window.RTCPeerConnection,h=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,f=window.WebSocket;n=!!(d&&h&&f)}catch(d){return O.error("check system requirement failed: ",d),!1}let r=!1;const s=xt();s.name===Ft.CHROME&&Number(s.version)>=58&&(!bre()||Tre())&&(r=!0),s.name===Ft.FIREFOX&&Number(s.version)>=56&&(r=!0),s.name===Ft.OPERA&&Number(s.version)>=45&&(r=!0),s.name===Ft.SAFARI&&Number(s.version)>=11&&(r=!0),(dj()||xt().name===Ft.QQ)&&(r=!0),O.debug("checkSystemRequirements, api:",n,"browser",r);const c=n&&r;return o.onSuccess(c),c},getDevices:function(o){return Ho.enumerateDevices(!0,!0,o)},getMicrophones:function(o){return Ho.getRecordingDevices(o)},getCameras:function(o){return Ho.getCamerasDevices(o)},getElectronScreenSources:EV,getPlaybackDevices:function(o){return Ho.getSpeakers(o)},createClient:function(){var o;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const r=Be.reportApiInvoke(null,{name:tr.CREATE_CLIENT,options:[n],tag:yn.TRACER});try{(function(s){mr(s.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),mr(s.mode,"config.mode",["rtc","live","p2p"]),s.audioCodec!==void 0&&mr(s.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),s.proxyServer!==void 0&&Xr(s.proxyServer,"config.proxyServer",1,1e4),s.turnServer!==void 0&&Ej(s.turnServer),s.httpRetryConfig!==void 0&&vj(s.httpRetryConfig),s.websocketRetryConfig!==void 0&&vj(s.websocketRetryConfig)})(n)}catch(s){throw r.onError(s),s}return Zce()||(n.codec==="vp9"&&(n.codec="vp8",O.debug("browser not support vp9, force use vp8")),qt("UNSUPPORTED_VIDEO_CODEC",["vp9"])),n.audioCodec===void 0&&(n.audioCodec="opus"),r.onSuccess(),new Ht(La(La({forceWaitGatewayResponse:!0},n),{},{role:Le(o=["rtc","p2p"]).call(o,n.mode)?"host":n.role||"audience"}))},createCameraVideoTrack:async function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.CREATE_CAM_VIDEO_TRACK,options:[v0({},o)]}),r=_0(o),s=Qt(8,"track-cam-");let c=null;const d=o.encoderConfig==="720p_auto";O.info("start create camera video track with config",JSON.stringify(o),"trackId",s);try{c=(await Go({video:r},s)).getVideoTracks()[0]||null}catch(f){throw n.onError(f),f}if(!c){const f=new he(B.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(f),f.throw(O)}o.optimizationMode&&dA(s,c,o,ic(o.encoderConfig));const h=new md(c,o,r,o.scalabiltyMode?p0(o.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},o.optimizationMode,s);return d&&h.startMonitorStats(),n.onSuccess(h.getTrackId()),O.info("create camera video success, trackId:",s),h},createCustomVideoTrack:function(o){const n=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.CREATE_CUSTOM_VIDEO_TRACK,options:[o]}),r=new ht(o.mediaStreamTrack,{width:o.width,height:o.height,frameRate:o.frameRate,bitrateMax:o.bitrateMax,bitrateMin:o.bitrateMin},o.scalabiltyMode?p0(o.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},o.optimizationMode,Qt(8,"track-cus-"),[tn.CUSTOM_TRACK]);return n.onSuccess(r.getTrackId()),O.info("create custom video track success with config",o,"trackId",r.getTrackId()),r},createScreenVideoTrack:async function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const r=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.CREATE_SCREEN_VIDEO_TRACK,options:[v0({},o),n]}),s=o.encoderConfig==="720p_auto";o.encoderConfig?typeof o.encoderConfig=="string"||o.encoderConfig.width&&o.encoderConfig.height||(o.encoderConfig.width={max:1920},o.encoderConfig.height={max:1080}):o.encoderConfig="1080p_2";const c=function(T){const w={};T.screenSourceType&&(w.mediaSource=T.screenSourceType),T.extensionId&&Hc()&&(w.extensionId=T.extensionId);const{displaySurface:A,selfBrowserSurface:L,surfaceSwitching:P,systemAudio:D}=T;(JR(107)||oj(107)||sj(93))&&(A&&(mr(A,"displaySurface",["browser","window","monitor"]),w.displaySurface=A),L?(mr(L,"selfBrowserSurface",["exclude","include"]),w.selfBrowserSurface=L):w.selfBrowserSurface="include",P&&(mr(P,"surfaceSwitching",["exclude","include"]),w.surfaceSwitching=P)),(JR(105)||oj(105)||sj(91))&&D&&(mr(D,"systemAudio",["exclude","include"]),w.systemAudio=D),T.electronScreenSourceId&&(w.sourceId=T.electronScreenSourceId);const G=T.encoderConfig?JI(T.encoderConfig):null;return w.mandatory={chromeMediaSource:"desktop",maxWidth:G?G.width:void 0,maxHeight:G?G.height:void 0},G&&(G.frameRate&&(typeof G.frameRate=="number"?(w.mandatory.maxFrameRate=G.frameRate,w.mandatory.minFrameRate=G.frameRate):(w.mandatory.maxFrameRate=G.frameRate.max||G.frameRate.ideal||G.frameRate.exact||void 0,w.mandatory.minFrameRate=G.frameRate.min||G.frameRate.ideal||G.frameRate.exact||void 0),w.frameRate=G.frameRate),G.width&&(w.width=G.width),G.height&&(w.height=G.height)),w}(o),d=Qt(8,"track-scr-v-");let h=null,f=null;const g=Lt();if(!g.supportShareAudio&&n==="enable"){const T=new he(B.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return r.onError(T),T.throw(O)}O.info("start create screen video track with config",o,"withAudio",n,"trackId",d);try{const T=await Go({screen:c,screenAudio:n==="auto"?g.supportShareAudio:n==="enable"},d);h=T.getVideoTracks()[0]||null,f=T.getAudioTracks()[0]||null}catch(T){throw r.onError(T),T}if(!h){const T=new he(B.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(T),T.throw(O)}if(!f&&n==="enable"){h&&h.stop();const T=new he(B.SHARE_AUDIO_NOT_ALLOWED);return r.onError(T),T.throw(O)}o.optimizationMode||(o.optimizationMode="detail"),o.optimizationMode&&(dA(d,h,o,o.encoderConfig&&JI(o.encoderConfig)||void 0),o.encoderConfig&&typeof o.encoderConfig!="string"&&(o.encoderConfig.bitrateMin=o.encoderConfig.bitrateMax));const _=new ht(h,o.encoderConfig?JI(o.encoderConfig):{},o.scalabiltyMode?p0(o.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},o.optimizationMode,d,[tn.SCREEN_TRACK]);if(s&&_.startMonitorStats(),!f)return r.onSuccess(_.getTrackId()),O.info("create screen video track success","video:",_.getTrackId()),_;const E=new Gt(f,void 0,Qt(8,"track-scr-a-"),!1);return r.onSuccess([_.getTrackId(),E.getTrackId()]),O.info("create screen video track success","video:",_.getTrackId(),"audio:",E.getTrackId()),[_,E]},createMicrophoneAndCameraTracks:async function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.CREATE_MIC_AND_CAM_TRACKS,options:[o,n]}),s=n.encoderConfig==="720p_auto",c=_0(n),d=DV(o),h=Qt(8,"track-mic-"),f=Qt(8,"track-cam-");let g=null,_=null;O.info("start create camera video track(".concat(f,") and microphone audio track(").concat(h,") with config, audio: ").concat(JSON.stringify(o),", video: ").concat(JSON.stringify(n)));try{const w=await Go({audio:d,video:c},"".concat(h,"-").concat(f));g=w.getAudioTracks()[0],_=w.getVideoTracks()[0]}catch(w){throw r.onError(w),w}if(!g||!_){const w=new he(B.UNEXPECTED_ERROR,"can not find tracks in media stream");return r.onError(w),w.throw(O)}n.optimizationMode&&dA(f,_,n,ic(n.encoderConfig));const E=new Fu(g,o,d,h),T=new md(_,n,c,n.scalabiltyMode?p0(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,f);return s&&T.startMonitorStats(),r.onSuccess([E.getTrackId(),T.getTrackId()]),O.info("create camera video track(".concat(f,") and microphone audio track(").concat(h,") success")),[E,T]},createMicrophoneAudioTrack:async function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.CREATE_MIC_AUDIO_TRACK,options:[o]}),r=DV(o),s=Qt(8,"track-mic-");let c=null;O.info("start create microphone audio track with config",JSON.stringify(o),"trackId",s);try{c=(await Go({audio:r},s)).getAudioTracks()[0]||null}catch(h){throw n.onError(h),h}if(!c){const h=new he(B.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(h),h.throw(O)}const d=new Fu(c,o,r,s);return n.onSuccess(d.getTrackId()),O.info("create microphone audio track success, trackId:",s),d},createCustomAudioTrack:function(o){const n=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.CREATE_CUSTOM_AUDIO_TRACK,options:[o]}),r=new Gt(o.mediaStreamTrack,o.encoderConfig?f0(o.encoderConfig):{},Qt(8,"track-cus-"),!1);return O.info("create custom audio track success with config",o,"trackId",r.getTrackId()),n.onSuccess(r.getTrackId()),r},createBufferSourceAudioTrack:async function(o){var n;const{cacheOnlineFile:r,encoderConfig:s}=o;let{source:c}=o;const d={source:c instanceof AudioBuffer?"AudioBuffer":c instanceof File?(n=File.name)!==null&&n!==void 0?n:"File":c,cacheOnlineFile:r,encoderConfig:s},h=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.CREATE_BUFFER_AUDIO_TRACK,options:[d]});if(Y("DISABLE_WEBAUDIO"))throw new he(B.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const f=Qt(8,"track-buf-");O.info("start create buffer source audio track with config",JSON.stringify(d),"trackId",f);const g=c;if(!(c instanceof AudioBuffer))try{c=await hoe(c,r)}catch(T){return h.onError(T),T.throw(O)}const _=new uoe(c),E=new fd(g,_,s?f0(s):{},f);return O.info("create buffer source audio track success, trackId:",f),h.onSuccess(E.getTrackId()),E},setAppType:function(o){if(O.debug("setAppType: ".concat(o)),!(Number.isInteger(o)&&o>=0))throw O.debug("Invalid appType"),new Z(B.INVALID_PARAMS,"invalid app type",o);qt("APP_TYPE",Math.floor(o))},setLogLevel:function(o){O.setLogLevel(o)},enableLogUpload:function(){Y("USE_NEW_LOG")?qt("UPLOAD_LOG",!0):O.enableLogUpload()},disableLogUpload:function(){Y("USE_NEW_LOG")?qt("UPLOAD_LOG",!1):O.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new Q0},checkAudioTrackIsActive:async function(o){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[n]});if(!(o instanceof Gt||o instanceof Ys)){const g=new Z(B.INVALID_TRACK,"the parameter is not a audio track");return r.onError(g),g.throw()}n&&n<1e3&&(n=1e3);const s=o instanceof Gt?o.getTrackLabel():"remote_track",c=o.getVolumeLevel();let d=c,h=c;const f=Date.now();return new ae(g=>{const _=setInterval(()=>{const E=o.getVolumeLevel();d=E>d?E:d,h=E<h?E:h;const T=d-h>1e-4,w=Date.now()-f;if(T||w>n){clearInterval(_);const A=T,L={duration:w,deviceLabel:s,maxVolumeLevel:d,result:A};O.info("[track-".concat(o.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(L))),r.onSuccess(L),g(A)}},200)})},checkVideoTrackIsActive:async function(o){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=Be.reportApiInvoke(null,{tag:yn.TRACER,name:tr.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[n]});if(!(o instanceof ht||o instanceof oc)){const T=new Z(B.INVALID_TRACK,"the parameter is not a video track");return r.onError(T),T.throw()}n&&n<1e3&&(n=1e3);const s=o instanceof ht?o.getTrackLabel():"remote_track",c=o.getMediaStreamTrack(!0),d=document.createElement("video");d.style.width="1px",d.style.height="1px",d.setAttribute("muted",""),d.muted=!0,d.setAttribute("playsinline",""),d.controls=!1,(Fr()||My())&&(d.style.opacity="0.01",d.style.position="fixed",d.style.left="0",d.style.top="0",document.body.appendChild(d)),d.srcObject=new MediaStream([c]),d.play();const h=document.createElement("canvas");h.width=160,h.height=120;let f=0,g=0;try{const T=Date.now();f=await function(w,A,L,P){let D,G=0,$=null;return new ae((X,ie)=>{function Q(){G>P&&D&&(D(),X(G));const te=L.getContext("2d");if(!te){const Se=new Z(B.UNEXPECTED_ERROR,"can not get canvas 2d context.");return O.error(Se.toString()),void ie(Se)}te.drawImage(w,0,0,160,120);const ce=te.getImageData(0,0,L.width,L.height),le=Math.floor(ce.data.length/3);if($){for(let Se=0;Se<le;Se+=3)if(ce.data[Se]!==$[Se])return G+=1,void($=ce.data);$=ce.data}else $=ce.data}setTimeout(()=>{D&&(D(),X(G))},A),D=rA(()=>{Q()},30)})}(d,n,h,4),g=Date.now()-T}catch(T){throw r.onError(T),T}Qce===Ft.SAFARI&&(d.pause(),d.remove()),d.srcObject=null;const _=f>4,E={duration:g,changedPicNum:f,deviceLabel:s,result:_};return O.info("[track-".concat(o.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(E))),r.onSuccess(E),_},setArea:GI,audioElementPlayCenter:Vi,resumeAudioContext:function(){Vi.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(o){tle.processExternalMediaAEC(o)},registerExtensions:function(o){const n=Y("PLUGIN_INFO")||[];o.forEach(r=>{"name"in r&&!Le(n).call(n,r.name)&&n.push(r.name);const s=r;s.__registered__=!0,s.logger.hookLog=O.extLog,s.reporter.hookApiInvoke=Be.extApiInvoke,s.parameters&&Object.keys(s.parameters).forEach(c=>{s.parameters[c]=Y(c)})}),J4("PLUGIN_INFO",n)},ChannelMediaRelayError:od,ChannelMediaRelayEvent:Aa,ChannelMediaRelayState:ki,RemoteStreamFallbackType:QI,RemoteStreamType:XI,ConnectionDisconnectedReason:vt,AudienceLatencyLevelType:tI,AREAS:Ot});return Object.defineProperties(or,{onAudioAutoplayFailed:{get:()=>$o.onAudioAutoplayFailed,set:o=>{$o.onAudioAutoplayFailed=o}},onAutoplayFailed:{get:()=>$o.onAutoplayFailed,set:o=>{$o.onAutoplayFailed=o}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>or._onSecurityPolicyViolation,set(o){or._onSecurityPolicyViolation=o,q4(o)}},__CLIENT_LIST__:{get:()=>Y("SHOW_GLOBAL_CLIENT_LIST")?rd:[]}}),Ho.on(tl.CAMERA_DEVICE_CHANGED,o=>{O.info("camera device changed",JSON.stringify(o)),or.onCameraChanged&&or.onCameraChanged(o),or.safeEmit(Gs.CAMERA_CHANGED,o)}),Ho.on(tl.RECORDING_DEVICE_CHANGED,o=>{O.info("microphone device changed",JSON.stringify(o)),or.onMicrophoneChanged&&or.onMicrophoneChanged(o),or.safeEmit(Gs.MICROPHONE_CHANGED,o)}),Ho.on(tl.PLAYOUT_DEVICE_CHANGED,o=>{O.debug("playout device changed",JSON.stringify(o)),or.onPlaybackDeviceChanged&&or.onPlaybackDeviceChanged(o),or.safeEmit(Gs.PLAYBACK_DEVICE_CHANGED,o)}),Vi.onAutoplayFailed=()=>{O.info("detect audio element autoplay failed"),$o.onAudioAutoplayFailed&&$o.onAudioAutoplayFailed()},zt.on("autoplay-failed",()=>{O.info("detect webaudio autoplay failed"),$o.onAudioAutoplayFailed&&$o.onAudioAutoplayFailed(),or.safeEmit(Gs.AUTOPLAY_FAILED)}),zt.on(Cr.STATE_CHANGE,(o,n)=>{O.info("audio context state changed: ".concat(n," => ").concat(o)),or.onAudioContextStateChanged&&or.onAudioContextStateChanged(o,n),or.safeEmit(Gs.AUDIO_CONTEXT_STATE_CHANGED,o,n)}),rr.on(Yc.NETWORK_STATE_CHANGE,(o,n)=>{O.info("[network-indicator] network state changed, ".concat(n," => ").concat(o))}),window&&(window.__ARTC__=or),or})})(cq);var hLe=cq.exports;const pN=Uh(hLe),pLe=({sessionid:e})=>{const[i,{isLoading:a,isSuccess:l,isRefreshing:u}]=jc({isImmediate:!1});Ji();let p=null,m=null,v=null;const y=async()=>(await i(re=>Dt.get(`http://127.0.0.1:5000/sessions/room/${e}`,{headers:{Authorization:"Bearer "+re}}),re=>{p=re.data.token,m=re.data.uid,v=re.data.channel}),v);let S={appid:"41afd2cc4bd64954b7b31d60d0eebb50",token:p,uid:m,channel:v},C={audioTrack:null,videoTrack:null},R={audioTrackMuted:!1,videoTrackMuted:!1},N=null,x={},U=null;const M=re=>`<div class="video-containers" id="video-wrapper-${re}">
      <p class="user-uid"><img class="volume-icon" id="volume-${re}" src="/img/assets/volume-on.svg" /></p>
      <div class="video-player player" id="stream-${re}"></div>
    </div>`,z=async()=>{U=pN.createClient({mode:"rtc",codec:"vp8"}),U.on("user-published",ee),U.on("user-left",oe),U.on("volume-indicator",se),U.enableAudioVolumeIndicator(),console.log("joinStreams called"),console.log("config token",S.token),console.log("config uid",S.uid),console.log("config channel",S.channel),[S.uid,C.audioTrack,C.videoTrack]=await Promise.all([U.join(S.appid,S.channel,S.token||null,S.uid||null),pN.createMicrophoneAudioTrack(),pN.createCameraVideoTrack()]).catch(me=>{console.log("errortest"),console.error(me)}),m=S.uid,console.log("localTracks",C);try{C.audioTrack&&(await C.audioTrack.setEnabled(!0),await C.audioTrack.setMuted(R.audioTrackMuted)),C.videoTrack&&(await C.videoTrack.setEnabled(!0),await C.videoTrack.setMuted(R.videoTrackMuted))}catch(me){console.error(me)}const re=document.getElementById("user-streams");if(re||console.error("Player element not found."),C.videoTrack&&re){re.insertAdjacentHTML("beforeend",M(S.uid)),C.videoTrack.play(`stream-${S.uid}`);const me=document.getElementById(`video-wrapper-${S.uid}`);re.querySelector("p > img").insertAdjacentHTML("beforeend",`<p class="user-uid">${N}</p>`),me.classList.add("video-player"),m===S.uid&&me.classList.add("small"),re.style.display="grid"}else console.error("Local video track not found.");console.log("publishing"),await U.publish([C.audioTrack,C.videoTrack])},V=async()=>{console.log("handleJoinButtonClick called"),v=await y(),S.token=p,S.uid=m,S.channel=v,N=document.getElementById("username").value,username&&(document.getElementById("join-wrapper").style.display="none",document.getElementById("foot").style.display="flex",await z())},W=()=>{(async()=>{console.log("handleMicButtonClick called"),console.log("localTracks",C),C.audioTrack&&(R.audioTrackMuted?(await C.audioTrack.setMuted(!1),R.audioTrackMuted=!1,document.getElementById(`volume-${m}`).src="/img/assets/volume-on.svg",document.getElementById("mic-btn").style.backgroundColor="greenf",micvar=!micvar,t):(await C.audioTrack.setMuted(!0),R.audioTrackMuted=!0,console.log("localUid",m),document.getElementById(`volume-${m}`).src="/img/assets/volume-off.svg",document.getElementById("mic-btn").style.backgroundColor="red"))})()},H=async()=>{console.log("handleCameraButtonClick called"),R.videoTrackMuted?(await C.videoTrack.setMuted(!1),R.videoTrackMuted=!1,document.getElementById("camera-btn").style.backgroundColor="#1f1f1f8e"):(await C.videoTrack.setMuted(!0),R.videoTrackMuted=!0,document.getElementById("camera-btn").style.backgroundColor="rgb(255, 80, 80, 0.7)")},q=async()=>{console.log("handleLeaveButtonClick called"),document.getElementById("join-wrapper").style.display="none",document.getElementById("foot").style.display="block",document.getElementById("user-streams").style.display="none",document.getElementById("user-streams").innerHTML="",console.log("Disconnecting from channel");for(const re in C){let me=C[re];me&&(me.stop(),me.close(),C[re]=null,me=null)}await U.leave(),console.log("Disconnected from channel"),document.getElementById("user-streams").classList.remove("small"),document.getElementById("user-streams").classList.remove("video-player"),document.getElementById("user-streams").classList.remove("large"),document.getElementById("user-streams").style.display="none",document.getElementById("user-streams").innerHTML="",x={},C={},R={},N="",m="",S={},window.location.reload()},ee=async(re,me)=>{if(console.log("handleUserJoined called"),console.log("user",re),console.log("mediaType",me),console.log("remoteTracks",x),x[re.uid]=re,console.log("number of users connected pre join: ",U.remoteUsers.length),U.remoteUsers.length>1){console.log("block user from joining"),oe(re),q();return}if(console.log("number of users connected: ",U.remoteUsers.length),await U.subscribe(re,me),me==="video"){const pe=document.getElementById("user-streams");if(pe){pe.style.display="flex",pe.insertAdjacentHTML("beforeend",M(re.uid));const Re=document.getElementById(`video-wrapper-${re.uid}`);if(console.log("useid",re.uid),re.videoTrack.play(`stream-${re.uid}`),Re.classList.add("video-player"),console.log("applyuing class"),m===S.uid){const Ze=document.getElementById(`video-wrapper-${m}`);Ze?(Ze.classList.add("small"),console.log("small class applied")):console.error(`Element with id video-wrapper-${S.uid} not found`)}else Re.classList.add("large")}else console.error("Player element not found.")}me==="audio"&&re.audioTrack.play()},oe=re=>{const me={...x};delete me[re.uid],x=me;const pe=document.getElementById(`video-wrapper-${re.uid}`);pe&&pe.remove(),U.unsubscribe(re)},se=re=>{for(let me=0;re.length>me;me++){const pe=re[me].uid,Re=re[me].level,Ze=document.getElementById(`volume-${pe}`);Ze&&(Ze.src=Re>0?"/img/assets/volume-on.svg":"/img/assets/volume-off.svg")}};return b.jsxs("div",{className:"room",children:[b.jsxs("div",{id:"join-wrapper",children:[b.jsx("input",{type:"text",id:"username"}),b.jsx("button",{id:"join-btn",onClick:V,children:"Join"})]}),b.jsx("div",{id:"user-streams",children:b.jsxs("div",{id:"foot",style:{display:"block"},children:[b.jsx("button",{id:"mic-btn",onClick:W,children:"Toggle Microphone"}),b.jsx("button",{id:"camera-btn",onClick:H,children:"Toggle Camera"}),b.jsx("button",{id:"leave-btn",onClick:q,children:"Leave Room"})]})})]})};function fLe(){const[e,i]=F.useState(!1),{sessionid:a}=QPe();return b.jsxs("div",{className:"Video-Room",children:[b.jsx("h1",{children:"Agora Video Chat"}),!e&&b.jsx("button",{onClick:()=>i(!0),children:"Join Room"}),e&&b.jsx(pLe,{sessionid:a}),e&&b.jsx("button",{onClick:()=>i(!1),children:"Leave Room"})]})}function mLe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M264 480A232 232 0 0 1 32 248c0-94 54-178.28 137.61-214.67a16 16 0 0 1 21.06 21.06C181.07 76.43 176 104.66 176 136c0 110.28 89.72 200 200 200 31.34 0 59.57-5.07 81.61-14.67a16 16 0 0 1 21.06 21.06C442.28 426 358 480 264 480z"},child:[]}]})(e)}function gLe({selectDate:e,setSelecteDate:i,days:a}){const[l,u]=F.useState(Wn()),p=R=>{const N=R.format("dddd"),x=Wn();return!!(a.includes(N)&&(R.date()>x.date()&&R.month()===x.month()||R.month()>x.month())&&R.year()===x.year())},m=(R=Wn().month(),N=Wn().year())=>{const x=Wn().year(N).month(R).startOf("month"),U=Wn().year(N).month(R).endOf("month"),M=[];for(let V=0;V<x.day();V++)M.push({currentMonth:!1,date:x.day(V)});for(let V=x.date();V<=U.date();V++)M.push({currentMonth:!0,date:x.date(V),today:x.date(V).toDate().toDateString()===Wn().toDate().toDateString()});const z=35-M.length;for(let V=U.date()+1;V<=U.date()+z;V++)M.push({currentMonth:!1,date:U.date(V)});return M},v=["January","February","March","April","May","June","July","August","September","October","November","December"],y=["S","M","T","W","T","F","S"],S=R=>{const N={display:"flex",h:"30px",w:"30px",justifyContent:"center",alignItems:"center",textAlign:"center",rounded:"full",transition:"background-color 0.2s, color 0.2s"};return p(R)&&(N._hover={bg:"black",rounded:"full",color:"white"},N.style={cursor:"pointer"}),N},C=R=>{p(R)&&i(R)};return b.jsxs(Sh,{maxW:"350px",maxH:"350px",p:"20px",boxShadow:"xl",children:[b.jsxs(Pe,{w:"100%",display:"flex",mb:6,p:2,borderBottom:"1px",borderColor:"grey",children:[b.jsxs(yt,{fontSize:"md",children:[v[l.month()]," ",l.year()]}),b.jsx(Mc,{}),b.jsxs(Pe,{display:"flex",alignItems:"center",gap:2,children:[b.jsx(hxe,{style:{cursor:"pointer"},onClick:()=>u(Wn().month()>=l.month()&&Wn().year()===l.year()?l:l.month(l.month()-1))}),b.jsx(yt,{fontSize:"md",style:{cursor:"pointer"},onClick:()=>u(Wn()),children:"Today"}),b.jsx(pxe,{style:{cursor:"pointer"},onClick:()=>u(l.month(l.month()+1))})]})]}),b.jsx(Sh,{w:"100%",templateColumns:"repeat(7, 1fr)",gap:2,justifyContent:"center",textAlign:"center",mb:6,children:y.map((R,N)=>b.jsx(yt,{fontSize:"sm",w:"30px",children:R},N))}),b.jsx(Sh,{w:"100%",templateColumns:"repeat(7, 1fr)",gap:2,children:m(l.month(),l.year()).map(({date:R,currentMonth:N,today:x},U)=>b.jsx(Pe,{...S(R),color:e.toDate().toDateString()===R.toDate().toDateString()||x?"white":p(R)?"brand.700":N?"black":"grey",bg:x?"brand.700":e.toDate().toDateString()===R.toDate().toDateString()?"black":void 0,onClick:()=>C(R),children:b.jsx(Pt,{as:p(R)?"b":void 0,children:R.date()})},U))})]})}function _Le({isOpen:e,onClose:i}){const a=ds();return b.jsx(b.Fragment,{children:b.jsxs(mE,{isOpen:e,onClose:i,children:[b.jsx(vE,{}),b.jsxs(gE,{children:[b.jsxs(EE,{textAlign:"center",children:[b.jsx(Nn,{objectFit:"cover",h:"350px",src:"/img/rubik.gif"}),b.jsx(yt,{color:"brand.700",mb:2,fontSize:"3xl",children:"And thats's it!"}),b.jsx(Pt,{fontSize:"lg",children:"Your booking details will be sent to you over email, make sure to attend at time!"})]}),b.jsx(_E,{mb:"20px",children:b.jsx(pn,{w:"100%",bg:"brand.700",color:"white",mr:3,onClick:()=>a("/"),children:"Take me home"})})]})]})})}function vLe(){ds();const e=Wn(),i=Wn().utcOffset(),a=Math.floor(i/60),[l,u]=F.useState(e),[p,m]=F.useState(null);Ji();const{isOpen:v,onOpen:y,onClose:S}=yC(),[C,R]=F.useState(!1),[N,{isLoading:x,isSuccess:U,isRefreshing:M}]=jc({isImmediate:!1});let z=Ul(),V=z.state&&z.state.mentor?z.state.mentor:null;console.log(V.availability),F.useEffect(()=>{m(null),l!==e&&(console.log(l,Wn()),console.log("heyy"),R(!0))},[l]);const W=q=>{const ee=V.availability.startTime,oe=V.availability.endTime,se=[],re=Wn().utcOffset(),me=Math.floor(re/60);let[pe,Re]=ee.split(":").map(Number);pe+=me;let[Ze,Qe]=oe.split(":").map(Number);Ze+=me,q?pe=12:Ze=12;for(let Oe=pe,Ie=Re;Oe<Ze;)se.push(`${Oe}:${Ie.toString().padStart(2,"0")}`),Ie+=30,Ie>=60&&(Oe+=1,Ie-=60);return se},H=()=>{Wn.extend(sq);const q=Wn().utcOffset(),ee=Math.floor(q/60),oe=p.split(":").map(Number);oe[0]-=ee;const se=Wn.utc(l.format("YYYY-MM-DD")+" "+oe.join(":")),re=Wn.utc(l.format("YYYY-MM-DD")+" 00:30"),me={mentor:V.username,date:l.format("YYYY-MM-DD"),time:se.format().slice(0,-1),duration:re.format().slice(0,-1),status:"Approved",amount:V.price_per_hour,method:"auto"};(async()=>await N(pe=>Dt.request({url:"http://127.0.0.1:5000/sessions/",headers:{Authorization:"Bearer "+pe},method:"POST",data:me}),pe=>{console.log("wohooo!!!!"),y()}))()};return b.jsx(Pe,{display:"flex",justifyContent:"center",children:b.jsxs(Pe,{display:"flex",mb:"30px",children:[b.jsxs(Pe,{display:"flex",p:"40px",bg:"white",rounded:"xl",m:"20px",boxShadow:"lg",children:[b.jsxs(Pe,{children:[b.jsx(yt,{fontSize:"xl",mb:2,children:"Schedule your lessons"}),b.jsx(gLe,{selectDate:l,setSelecteDate:u,days:V.availability.days}),b.jsxs(Pe,{display:"flex",alignItems:"center",bg:"brand.700",maxW:"350px",p:"20px",mt:"65px",rounded:"xl",boxShadow:"xl",children:[b.jsx(Nn,{src:"/img/flower.png",maxW:"80px",mr:4}),b.jsxs(Pe,{color:"white",children:[b.jsx(yt,{fontSize:"lg",children:"Prepare for your next lesson!"}),l!==e&&b.jsxs(Pt,{fontSize:"md",children:["On ",l.format("dddd, D MMM")]})]})]})]}),b.jsx(mo,{orientation:"vertical",ml:10,mr:10}),b.jsx(px,{in:C,animateOpacity:!0,children:b.jsx(Pe,{className:"horizontal-transition",children:b.jsxs(Pe,{maxW:"430px",children:[b.jsx(yt,{fontSize:"xl",mb:10,children:"Pick your slot"}),b.jsxs(Pe,{borderLeft:"4px",borderColor:"brand.700",p:"10px",mb:10,children:[b.jsxs(yt,{fontSize:"lg",ml:2,mb:2,children:[b.jsx(jr,{as:oLe}),"  Morning"]}),b.jsx(Pe,{display:"flex",flexWrap:"wrap",children:W(0).map((q,ee)=>b.jsx(pn,{m:"10px",width:"80px",isActive:p===q,onClick:()=>m(q),children:q},ee))})]}),b.jsxs(Pe,{borderLeft:"4px",borderColor:"brand.800",p:"10px",children:[b.jsxs(yt,{fontSize:"lg",ml:2,mb:2,children:[b.jsx(jr,{as:mLe}),"  Evening"]}),b.jsx(Pe,{display:"flex",flexWrap:"wrap",children:W(1).map((q,ee)=>b.jsx(pn,{m:"10px",width:"80px",isActive:p===q,onClick:()=>m(q),children:q},ee))})]}),b.jsxs(cx,{status:"info",maxW:"400px",mt:"30px",children:[b.jsx(ax,{}),"All times are shown in your Local Time Zone"]})]})})})]}),V&&b.jsxs(Pe,{bg:"brand.800",color:"white",rounded:"xl",textAlign:"center",m:"20px",p:"30px",boxShadow:"lg",maxW:"300px",h:"auto",children:[b.jsx(Dc,{size:"xl",src:V==null?void 0:V.profile_picture}),b.jsxs(yt,{fontSize:"2xl",children:[V.first_name," ",V.last_name]}),b.jsxs(Tm,{mt:2,colorScheme:V.type==="Community"?"blue":"yellow",children:[V.type," Mentor"]}),b.jsx(Pt,{textAlign:"left",mt:"20px",mb:"20px",children:V.bio}),b.jsxs(Pe,{mt:"40px",textAlign:"left",children:[p&&b.jsxs(cm,{children:[b.jsx(lm,{children:"Time"}),b.jsxs(yt,{fontSize:"xl",mt:1,mb:1,children:[p," (UTC +",a,")"]}),b.jsx(mo,{})]}),l!==e&&b.jsxs(cm,{children:[b.jsx(lm,{children:"Date"}),b.jsx(yt,{mt:1,mb:1,fontSize:"xl",children:l.format("dddd, D MMM")}),b.jsx(mo,{})]}),b.jsxs(cm,{children:[b.jsx(lm,{children:"Price"}),b.jsxs(Tb,{children:["$",V.price_per_hour]}),b.jsx(mo,{})]})]}),b.jsx(pn,{isDisabled:!p,colorScheme:"orange",mt:"40px",onClick:H,children:"Continue"})]}),b.jsx(_Le,{isOpen:v,onClose:S})]})})}function ELe(){const e=Ul();return console.log(e.state),b.jsx("h1",{children:"This is payment"})}function yLe(){Ul().pathname,Lo({base:!0,md:!1});const{authToken:e,refresh:i,setUser:a}=Ji(),[l,u]=F.useState(""),p=m=>{a(m.data),u(m.data.profile_picture)};return F.useEffect(()=>{e&&(async()=>{try{const v=await Dt.get("http://127.0.0.1:5000/student/profile",{headers:{Authorization:"Bearer "+e}});p(v)}catch(v){v.response&&v.response.status===410&&i().then(y=>{Dt.get("http://127.0.0.1:5000/student/profile",{headers:{Authorization:"Bearer "+y}}).then(S=>p(S)).then(S=>console.log("--------refresh session successfully from NavBar----->")).catch(S=>console.log({err:S}))}).catch(),console.error("An error occurred:",v.response.data)}})()},[]),b.jsxs(Pe,{display:"flex",as:"nav",alignItems:"center",m:"30px",p:"30px",h:"40px",bg:"white",rounded:"2xl",boxShadow:"base",children:[b.jsx(Pe,{children:b.jsx(bn,{to:"/",children:b.jsx(Nn,{src:"/img/logo-2.png",alt:"Logo",boxSize:"auto",width:"100px",height:"auto"})})}),b.jsx(Mc,{}),b.jsxs(Pe,{children:[b.jsx(bn,{to:"/mentor/sign-in",children:b.jsx(pn,{size:"sm",colorScheme:"facebook",variant:"outline",ml:"10px",children:"Login"})}),b.jsx(bn,{to:"/mentor/sign-up",children:b.jsx(pn,{size:"sm",colorScheme:"facebook",ml:"10px",variant:"solid",children:"Sign up"})})]})]})}function SLe(){const{authToken:e,login:i}=Ji(),a=Lo({base:!0,lg:!1}),[l,u]=F.useState({email:"",password:"",user_type:"mentor"}),[p,m]=F.useState(""),v=ds(),y=vC(),S=x=>{console.log(x)},C=x=>{const{name:U,value:M}=x.currentTarget;u({...l,[U]:M}),m(!1)},R=async()=>{await y({title:"You've been logged in successfully.",status:"success",duration:3e3,isClosable:!0})()},N=()=>{Object.values(l).every(x=>x)?(async()=>{try{const x=await Dt.post("http://127.0.0.1:5000/auth/login",l);console.log(x.data),i(x.data.access_token,x.data.refresh_token),setTimeout(()=>{v("/mentor/dashboard")},1e3),R()}catch{m("Email or Password provided are incorrect")}})():m("Both fields are required")};return b.jsx(b.Fragment,{children:b.jsx(Pe,{display:"flex",justifyContent:"center",children:b.jsxs(Pe,{display:"flex",bg:"white",rounded:"3xl",boxShadow:"xl",maxW:"1100px",m:"30px",alignItems:"center",children:[!a&&b.jsx(Nn,{src:"/img/teacher.png",h:"auto",w:"50%",roundedLeft:"3xl",objectFit:"cover"}),b.jsxs(Pe,{w:{lg:"50%"},children:[b.jsxs(Pe,{m:"50px",mb:"0px",children:[b.jsx(bn,{to:"/",children:b.jsx(Nn,{src:"/img/logo.png",mt:"40px",mb:"20px",width:"100px",height:"auto"})}),b.jsx(yt,{mb:2,children:"Mentor Login"}),b.jsxs(Pt,{children:["New User?  ",b.jsx(bn,{to:"/mentor/sign-up",children:b.jsx("span",{className:"underline",children:b.jsx("b",{children:"Sign Up."})})})]}),b.jsx(Pe,{w:"85%",mt:"20px",children:b.jsx(VC,{buttonText:"Sign in with Google",onSuccess:S,onError:()=>{console.log("Login Failed")}})})]}),b.jsxs(Pe,{m:"50px",mt:"20px",children:[b.jsxs(fo,{mb:3,isInvalid:p,children:[b.jsx(On,{children:"Email Address"}),b.jsx(Ur,{placeholder:"Enter your email address",w:"90%",name:"email",value:l.email,onChange:C})]}),b.jsxs(fo,{isInvalid:p,children:[b.jsx(On,{children:"Password"}),b.jsx(Ur,{type:"password",placeholder:"Enter your password",w:"90%",name:"password",value:l.password,onChange:C}),b.jsx(du,{children:p})]}),b.jsx(pn,{colorScheme:"facebook",type:"submit",h:"40px",w:"90%",mt:6,onClick:N,children:"Sign In"}),b.jsx(sr,{w:"85%",mt:4,justifyContent:"center",children:b.jsx(Pt,{children:b.jsx(bn,{to:"/",children:"Forgot Password?"})})})]})]})]})})})}function TLe({input:e,formError:i,onChange:a,onClick:l}){const u=Lo({base:!0,lg:!1}),p=m=>{console.log(m)};return b.jsx(b.Fragment,{children:b.jsx(Pe,{display:"flex",justifyContent:"center",children:b.jsxs(Pe,{display:"flex",bg:"white",rounded:"3xl",boxShadow:"xl",maxW:"1100px",m:"30px",alignItems:"center",children:[b.jsxs(Pe,{w:{lg:"50%"},children:[b.jsxs(Pe,{m:"50px",mb:"0px",children:[b.jsx(bn,{to:"/",children:b.jsx(Nn,{src:"/img/logo.png",mt:"40px",mb:"20px",width:"100px",height:"auto"})}),b.jsx(yt,{mb:2,children:"Start Tutoring on LexiLink"}),b.jsxs(Pt,{children:["Already have an account? ",b.jsx(bn,{to:"/mentor/sign-in",children:b.jsx("span",{className:"underline",children:b.jsx("b",{children:"Log in."})})})]}),b.jsx(Pe,{w:"90%",mt:"20px",children:b.jsx(VC,{buttonText:"Sign in with Google",onSuccess:p,onError:()=>{console.log("Login Failed")}})})]}),b.jsxs(Pe,{m:"50px",mt:"20px",children:[b.jsxs(fo,{mb:3,isInvalid:!!i.email,children:[b.jsx(On,{children:"Email Address"}),b.jsx(Ur,{placeholder:"Enter your email address",w:"90%",name:"email",value:e.email,onChange:a}),i.email&&b.jsx(du,{children:i.email})]}),b.jsxs(fo,{isInvalid:!!i.password,children:[b.jsx(On,{children:"Password"}),b.jsx(Ur,{type:"password",placeholder:"Enter your password",w:"90%",name:"password",value:e.password,onChange:a}),i.password&&b.jsx(du,{children:i.password})]}),b.jsx(pn,{colorScheme:"facebook",type:"submit",h:"40px",w:"90%",mt:6,onClick:l,children:"Create Account"})]})]}),!u&&b.jsx(Nn,{src:"/img/icecream.png",h:"auto",w:"50%",roundedRight:"3xl",objectFit:"cover"})]})})})}function bLe({input:e,formError:i,setFormError:a,onChange:l,handleStepper:u,SteppingOver:p}){const m=Lo({base:!0,md:!1}),v=async()=>{const S={...i};try{const C=await Dt.post("http://127.0.0.1:5000/auth/verify_username",{username:e.username,user_type:"mentor"});u()}catch(C){C.response&&C.response.status===400?(S.username=C.response.data.error,a({...S})):console.error("An error occurred:",C)}},y=()=>!(e.first_name&&e.username&&e.last_name);return b.jsx(b.Fragment,{children:b.jsx(Pe,{display:"flex",justifyContent:"center",children:b.jsxs(Pe,{bg:"white",rounded:"3xl",m:"40px",maxW:"800px",boxShadow:"md",p:"30px",children:[!m&&b.jsx(Pe,{m:"30px",children:b.jsx(p,{})}),b.jsx(mo,{}),b.jsxs(Pe,{m:"30px",children:[b.jsx(yt,{mb:4,fontSize:"4xl",children:"Welcome to LexiLink!"}),b.jsx(Pt,{fontSize:"lg",children:"Your presence here opens doors for students to embark on a transformative language learning journey. Through your guidance and expertise, they'll gain the confidence to navigate English with ease. The LexiLink mentor sign-up process ensures a smooth experience, taking you through each step with precision and care."})]}),b.jsx(mo,{}),b.jsxs(Pe,{m:"30px",children:[b.jsx(yt,{mb:4,fontSize:"3xl",children:"Let's get to know you!"}),b.jsxs(sr,{alignItems:"center",gap:2,justifyContent:"center",children:[b.jsxs(fo,{isInvalid:!!i.first_name,children:[b.jsx(On,{children:"First Name"}),b.jsx(Ur,{w:"85%",mb:3,placeholder:"Enter your first name",name:"first_name",value:e.first_name,onChange:l})]}),b.jsxs(fo,{isInvalid:!!i.last_name,children:[b.jsx(On,{children:"Last Name"}),b.jsx(Ur,{w:"85%",mb:3,placeholder:"Enter your last name",name:"last_name",value:e.last_name,onChange:l})]})]}),b.jsxs(fo,{isInvalid:!!i.username,children:[b.jsx(On,{children:"Username"}),b.jsx(Ur,{w:"93%",placeholder:"Enter your username",name:"username",value:e.username,onChange:l}),i.username&&b.jsx(du,{children:i.username})]})]}),b.jsx(sr,{m:"30px",justify:"flex-end",children:b.jsx(pn,{isDisabled:y(),colorScheme:"teal",onClick:v,children:"Next"})})]})})})}function CLe(e){return Fs({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zM4 12c0-.899.156-1.762.431-2.569L6 11l2 2v2l2 2 1 1v1.931C7.061 19.436 4 16.072 4 12zm14.33 4.873C17.677 16.347 16.687 16 16 16v-1a2 2 0 0 0-2-2h-4v-3a2 2 0 0 0 2-2V7h1a2 2 0 0 0 2-2v-.411C17.928 5.778 20 8.65 20 12a7.947 7.947 0 0 1-1.67 4.873z"},child:[]}]})(e)}function wLe({input:e,setInput:i,onChange:a,handleStepper:l,SteppingOver:u}){const p=Lo({base:!0,md:!1}),[m,v]=F.useState([]),y=["English","Mandarin Chinese","Hindi","Spanish","French","Standard Arabic","Bengali","Portuguese","Russian","Urdu","Indonesian","Standard German","Japanese","Nigerian Pidgin","Egyptian Spoken Arabic","Marathi","Telugu","Turkish","Tamil","Yue Chinese"],S=["country","nationality","first_language","type","expertise","education"],C=x=>{i({...e,type:x})};F.useEffect(()=>{(async()=>{try{const U=await Dt.get("https://restcountries.com/v3.1/all?fields=name,demonyms");U.data.sort((M,z)=>M.name.common.localeCompare(z.name.common)),v(U.data)}catch(U){console.error("Error fetching data:",U)}})()},[]);const R=()=>!S.every(x=>e[x]),N=()=>{l()};return b.jsx(b.Fragment,{children:b.jsx(Pe,{display:"flex",justifyContent:"center",children:b.jsxs(Pe,{bg:"white",rounded:"3xl",m:"40px",maxW:"800px",boxShadow:"md",p:"30px",children:[!p&&b.jsx(Pe,{m:"30px",children:b.jsx(u,{})}),b.jsx(mo,{}),b.jsxs(Pe,{m:"30px",children:[b.jsxs(yt,{fontSize:"3xl",mb:6,children:[b.jsx(jr,{as:CLe}),"  How Do You Identify Linguistically?"]}),b.jsxs(sr,{alignContent:"center",gap:6,justifyContent:"center",mb:4,children:[b.jsxs(Pe,{w:"50%",children:[b.jsx(On,{children:"Country"}),b.jsx(ru,{placeholder:"Select your country",name:"country",value:e.country,onChange:a,children:m==null?void 0:m.map((x,U)=>b.jsx("option",{value:x.name.common,children:x.name.common},U))})]}),b.jsxs(Pe,{w:"50%",children:[b.jsx(On,{children:"Nationality"}),b.jsx(ru,{placeholder:"Select your nationality",name:"nationality",value:e.nationality,onChange:a,children:m==null?void 0:m.map((x,U)=>b.jsx("option",{value:x.demonyms.eng.m,children:x.demonyms.eng.m},U))})]})]}),b.jsxs(Pe,{children:[b.jsx(On,{children:"First Language"}),b.jsx(ru,{placeholder:"Select your first language",name:"first_language",value:e.first_language,onChange:a,children:y.map((x,U)=>b.jsx("option",{value:x,children:x},U))})]})]}),b.jsx(mo,{}),b.jsxs(Pe,{m:"30px",mt:"50px",children:[b.jsx(sr,{children:b.jsxs(yt,{fontSize:"3xl",mb:6,children:[b.jsx(jr,{as:Ixe}),"  What type of teacher are you?"]})}),b.jsx(Pe,{mr:"80px",children:b.jsx(IC,{mb:"30px",name:"type",value:e.type,onChange:C,children:b.jsxs(CC,{spacing:5,direction:"row",children:[b.jsx(As,{colorScheme:"teal",value:"Community",children:"Community Mentor"}),b.jsx(Mc,{}),b.jsx(As,{colorScheme:"teal",value:"Professional",children:"Professional Mentor"})]})})}),b.jsx(On,{children:"Education"}),b.jsx(nk,{placeholder:"Tell us about your education",name:"education",value:e.education,onChange:a}),b.jsx(On,{mt:4,children:"Expertise"}),b.jsx(nk,{placeholder:"Let students know what a class with you will be like!",name:"expertise",value:e.expertise,onChange:a})]}),b.jsx(sr,{m:"30px",justify:"flex-end",children:b.jsx(pn,{isDisabled:R(),colorScheme:"teal",onClick:N,children:"Next"})})]})})})}function RLe(){return b.jsx("h1",{children:"hi you're in step four"})}function ILe(){const[e,i]=F.useState({email:"",password:"",username:"",first_name:"",last_name:"",country:"",nationality:"",first_language:"",education:"",expertise:"",type:"Community",availability:[],user_type:"mentor"}),[a,l]=F.useState(1),[u,p]=F.useState({email:"",password:"",username:""});let m=!0;const v=()=>{const z={...u,email:"",password:""};e.email?S(e.email)||(z.email="Invalid email address"):z.email="This field is required",e.password.length<6&&(z.password="This field must be at least 6 characters"),(async()=>{try{const V=await Dt.post("http://127.0.0.1:5000/auth/verify_email",{email:e.email,user_type:"mentor"})}catch(V){V.response&&V.response.status===400?(z.email=V.response.data.error,m=!1):console.error("An error occurred:",V)}p({...z}),e.email&&S(e.email)&&e.password.length>=6&&m&&U()})()},y=z=>{const{name:V,value:W}=z.currentTarget;i({...e,[V]:W}),p({...u,[V]:""})},S=z=>/^[^@]+@[^@]+\.[^@]+$/.test(z),C=[{title:"Personalalize"},{title:"Teaching"},{title:"Availability"}],{activeStep:R,setActiveStep:N}=zNe({index:0,count:C.length});function x(){return b.jsx(WNe,{colorScheme:"teal",size:"lg",index:R,children:C.map((z,V)=>b.jsxs(BNe,{children:[b.jsx(KNe,{children:b.jsx(GNe,{complete:b.jsx($Ne,{}),incomplete:b.jsx(oz,{}),active:b.jsx(oz,{})})}),b.jsx(Pe,{flexShrink:"0",children:b.jsx(VNe,{children:z.title})}),b.jsx(YNe,{})]},V))})}const U=()=>{l(a+1)},M=()=>{N(R+1),U()};return b.jsxs(b.Fragment,{children:[a===1&&b.jsx(TLe,{input:e,formError:u,onChange:y,onClick:v}),a===2&&b.jsx(bLe,{input:e,formError:u,setFormError:p,onChange:y,handleStepper:M,SteppingOver:x}),a===3&&b.jsx(wLe,{input:e,setInput:i,onChange:y,handleStepper:M,SteppingOver:x}),a===4&&b.jsx(RLe,{input:e,setInput:i,onChange:y,handleStepper:M,SteppingOver:x})]})}function ALe(){const e=Ul().pathname;return b.jsx(b.Fragment,{children:b.jsxs(lxe,{children:[!e.includes("sign")&&(e.includes("mentor")?b.jsx(yLe,{}):b.jsx(Mxe,{})),b.jsxs(pke,{children:[b.jsx(lo,{path:"/",element:b.jsx(Dxe,{})}),b.jsx(lo,{path:"/mentor",element:b.jsx(xz,{})}),b.jsx(lo,{path:"/mentor/sign-in",element:b.jsx(SLe,{})}),b.jsx(lo,{path:"/mentor/sign-up",element:b.jsx(ILe,{})}),b.jsx(lo,{path:"/mentor/dashboard",element:b.jsx(xz,{})}),b.jsx(lo,{path:"/sign-in",element:b.jsx(Wxe,{})}),b.jsx(lo,{path:"/sign-up",element:b.jsx(Jxe,{})}),b.jsx(lo,{path:"/browse",element:b.jsx(Lz,{})}),b.jsx(lo,{path:"/dashboard",element:b.jsx(iLe,{})}),b.jsx(lo,{path:"/profile",element:b.jsx(uLe,{})}),b.jsx(lo,{path:"/dashboard",element:b.jsx(Lz,{})}),b.jsx(lo,{path:"/room/:sessionid",element:b.jsx(fLe,{})}),b.jsx(lo,{path:"/booking/:username",element:b.jsx(vLe,{})}),b.jsx(lo,{path:"/payment",element:b.jsx(ELe,{})}),b.jsx(lo,{path:"*",element:b.jsx(Xxe,{})})]})]})})}const OLe={brand:{900:"#f2e8dd",800:"#083d77",700:"#dd4e40",600:"#74b0ab",200:"#A9A9A9",100:"#191919"},fonts:{body:"'Work Sans', 'sans-serif'",heading:"'Montserrat', 'sans-serif'"}},NLe=Iye({colors:OLe});mN.createRoot(document.getElementById("root")).render(b.jsx(twe,{theme:NLe,children:b.jsx(jxe,{clientId:"76995164858-097b9m0l06ct4h8342cdb70srium1abr.apps.googleusercontent.com",children:b.jsx(ns.StrictMode,{children:b.jsx(yke,{children:b.jsx(ALe,{})})})})}));
